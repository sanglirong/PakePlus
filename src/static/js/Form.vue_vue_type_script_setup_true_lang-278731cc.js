import{b as e,B as o}from"./index-143f5813.js";import{u as a,B as l}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{a as n,u as t,c as r}from"./system-4f24c0ce.js";import{d as s,r as i,u as c,ad as d,a0 as u,M as p,k as f,e as m,o as g,p as v,l as h,j as b,a4 as x,ae as k,m as _,V as y,eh as U,fQ as w,ah as I}from"./index-920db443.js";const C={style:{flex:"1","margin-right":"10px"}},J={class:"flex"},P={class:"flex-1 mr-10px"},F={class:"flex"},j=s({__name:"Form",emits:["register","reload"],setup(s,{emit:j}){const B=["#008cff","#35b8e0","#00cc88","#ff9d00","#ff4d4d","#5b69bc","#ff8acc","#3b3e47","#282828"],M=i(""),{t:S}=c(),L=d({propertyJson:{iconBackgroundColor:""},dataForm:{},selfUrl:""}),{propertyJson:N,selfUrl:O}=u(L),R=[{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50,onChange:H},rules:[{required:!0,message:"必填",trigger:"blur"}]},{field:"icon",label:"图标",component:"Input",slot:"icon",componentProps:{placeholder:"请选择"},rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"selfUrl",label:"访问地址",component:"Input",slot:"selfUrl",helpMessage:"仅支持PC端访问，APP端不支持。"},{field:"navigationIcon",label:"导航图标",component:"UploadImgSingle",slot:"navigationIcon"},{field:"workflowEnabled",label:"协同办公",component:"Switch",helpMessage:"关闭后该应用下不显示协同办公模块内容",defaultValue:1},{field:"sortCode",label:"排序",component:"InputNumber",defaultValue:0,componentProps:{min:"0",max:"999999",placeholder:"请输入"}},{field:"enabledMark",label:"状态",component:"Switch",defaultValue:1},{field:"description",label:"说明",component:"Textarea",componentProps:{rows:4,placeholder:"请输入"}}],V=p((()=>f(M)?S("common.editText"):S("common.addText"))),T=j,{createMessage:q}=I(),[A,{setFieldsValue:$,validate:z,resetFields:E}]=a({labelWidth:80,schemas:R}),[Q,{closeModal:W,changeLoading:D,changeOkLoading:G}]=e((function(e){E(),M.value=e.id,L.dataForm.workLogoIcon=void 0,L.selfUrl="",M.value&&(D(!0),n(M.value).then((e=>{const o=e.data;L.dataForm=e.data;const a=o.propertyJson?JSON.parse(o.propertyJson):null;L.propertyJson=a||{iconBackgroundColor:""},$(o),H(e.data.enCode),D(!1)})))}));function H(e){if(!e)return L.selfUrl="";L.selfUrl=`${window.location.origin}/JNPF_APP_${e}`}async function K(){const e=await z();if(!e)return;G(!0);const o={...e,propertyJson:JSON.stringify(L.propertyJson),workLogoIcon:L.dataForm.workLogoIcon,id:M.value};(M.value?t:r)(o).then((e=>{q.success(e.msg),G(!1),W(),T("reload")})).catch((()=>{G(!1)}))}return(e,a)=>{const n=m("jnpf-icon-picker"),t=m("jnpf-color-picker"),r=m("a-form-item-rest"),s=m("a-row"),i=m("a-input"),c=m("a-button"),d=m("a-input-group"),u=m("JnpfUploadImgSingle");return g(),v(f(o),y(e.$attrs,{onRegister:f(Q),title:V.value,showOkBtn:"",onOk:K,"destroy-on-close":""}),{default:h((()=>[b(f(l),{onRegister:f(A)},{icon:h((({model:e,field:o})=>[b(s,{type:"flex"},{default:h((()=>[x("div",C,[b(n,{value:e[o],"onUpdate:value":a=>e[o]=a,placeholder:"请选择"},null,8,["value","onUpdate:value"])]),b(r,null,{default:h((()=>[b(t,{value:f(N).iconBackgroundColor,"onUpdate:value":a[0]||(a[0]=e=>f(N).iconBackgroundColor=e),size:"small",predefine:B,name:"iconBackground"},null,8,["value"])])),_:1})])),_:2},1024)])),selfUrl:h((()=>[b(r,null,{default:h((()=>[x("div",J,[x("div",P,[b(i,{value:f(O),"onUpdate:value":a[1]||(a[1]=e=>k(O)?O.value=e:null),placeholder:"请输入",readonly:""},null,8,["value"])]),x("div",null,[b(d,{compact:""},{default:h((()=>[b(c,{onClick:a[2]||(a[2]=e=>{var o;(o=f(O))&&w(o)})},{default:h((()=>a[4]||(a[4]=[_("打开")]))),_:1,__:[4]}),b(c,{type:"primary",onClick:a[3]||(a[3]=e=>function(e){if(!e)return;const{isSuccessRef:o}=U(e);f(o)&&q.success("复制成功")}(f(O)))},{default:h((()=>a[5]||(a[5]=[_("复制")]))),_:1,__:[5]})])),_:1})])])])),_:1})])),navigationIcon:h((({model:e,field:o})=>[b(r,null,{default:h((()=>[x("div",F,[b(u,{value:e[o],"onUpdate:value":a=>e[o]=a,tipText:"210 × 60 px"},null,8,["value","onUpdate:value"])])])),_:2},1024)])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title"])}}});export{j as _};
