import{b as e,B as a}from"./index-143f5813.js";import{u as t,B as o}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{f as r}from"./formValidate-c8ab8d29.js";import{g as n,u as d,c as s}from"./integrate-cef8009f.js";import{d as i,ad as l,a0 as m,u as p,e as c,o as g,p as u,l as f,j as b,k as h,m as F,V as x,ah as y}from"./index-920db443.js";const j=i({__name:"Form",emits:["register","reload","design"],setup(i,{emit:j}){const L=l({dataForm:{id:""},btnLoading:!1}),{dataForm:_,btnLoading:k}=m(L),{createMessage:w}=y(),{t:M}=p(),N=j,[P,{closeModal:R,changeLoading:V,changeOkLoading:q}]=e((function(e){T(),L.dataForm.id=e.id||"",L.dataForm.type=e.type||1,L.dataForm.id?(V(!0),n(L.dataForm.id).then((e=>{L.dataForm=e.data,C(L.dataForm),V(!1)})).catch((()=>{V(!1)}))):C({type:L.dataForm.type})})),[v,{setFieldsValue:C,resetFields:T,validate:B}]=t({labelWidth:60,schemas:[{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:100},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:r("enCode"),trigger:"blur"}]},{field:"type",label:"类型",component:"Select",componentProps:{options:[{id:1,fullName:"事件触发"},{id:2,fullName:"定时触发"},{id:3,fullName:"webhook触发"}],disabled:!0},rules:[{required:!0,trigger:"change",message:"必填",type:"number"}]},{field:"enabledMark",label:"状态",component:"Switch",defaultValue:1},{field:"description",label:"说明 ",component:"Textarea",componentProps:{placeholder:"请输入"}}]});async function I(e){const a=await B();if(!a)return;1===e?L.btnLoading=!0:q(!0);const t={...a,id:L.dataForm.id};(L.dataForm.id?d:s)(t).then((a=>{w.success(a.msg),q(!1),L.btnLoading=!1,R(),N("reload"),1===e&&N("design",L.dataForm.id||a.data)})).catch((()=>{q(!1),L.btnLoading=!1}))}return(e,t)=>{const r=c("a-button");return g(),u(h(a),x(e.$attrs,{onRegister:h(P),title:h(_).id?h(M)("common.editText"):h(M)("common.addText"),onOk:I}),{appendFooter:f((()=>[b(r,{type:"primary",loading:h(k),onClick:t[0]||(t[0]=e=>I(1))},{default:f((()=>t[1]||(t[1]=[F("确定并设计")]))),_:1,__:[1]},8,["loading"])])),default:f((()=>[b(h(o),{onRegister:h(v)},null,8,["onRegister"])])),_:1},16,["onRegister","title"])}}});export{j as _};
