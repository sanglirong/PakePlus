import{d as e,u as t,M as a,a7 as i,e as l,o as n,g as s,a4 as o,m as d,t as c,j as r,l as p,q as y,k as u,fG as m,p as f,af as k,ah as b}from"./index-920db443.js";import{u as x}from"./index-143f5813.js";import{_ as g}from"./FieldForm.vue_vue_type_script_setup_true_lang-31f4df5b.js";import{S as _}from"./sortable.esm-02d0fe44.js";const h={class:"field-table-box"},C={class:"title"},I={key:0,class:"drag-handler icon-ym icon-ym-darg",title:"点击拖动"},v=["onClick"],w={class:"required-sign"},T={key:2},j=["onClick"],S=["onClick"],N=e({__name:"Field",props:{list:{type:Array,default:()=>[]},type:{type:Number,default:0},scrollY:{type:String,default:"calc(50vh - 218px)"}},emits:["register","itemClick"],setup(e,{emit:N}){const q=N,z=e,{t:F}=t(),{createConfirm:O}=b(),[R,{openModal:B}]=x(),J=a((()=>[{title:"拖动",dataIndex:"drag",key:"drag",align:"center",width:50},...0===z.type?[{title:"参数名称",dataIndex:"field",key:"field"},{title:"参数类型",dataIndex:"dataType",key:"dataType",width:80}]:[{title:"字段名称",dataIndex:"field",key:"field",width:110},{title:"映射字段",dataIndex:"defaultValue",key:"defaultValue",width:110}],{title:"操作",dataIndex:"action",key:"action",width:70}]));function M(e){B(!0,{item:e,list:z.list})}function V(e,t){const a=JSON.parse(JSON.stringify(t));if("add"==e)z.list.push(a);else{const e=z.list.findIndex((e=>e.id===a.id));-1!=e&&(z.list[e]=a)}}function Y(e){const t=document.querySelector(`.${e} .ant-table-tbody`);_.create(t,{handle:".drag-handler",animation:150,easing:"cubic-bezier(1, 0, 0, 1)",onStart:()=>{},onEnd:({newIndex:e,oldIndex:t})=>{!function(e,t,a){const i=e.splice(t,1)[0];e.splice(a,0,i)}(z.list,t-1,e-1)}})}return i((()=>{0===z.type?Y("params-table"):Y("field-table")})),(t,a)=>{const i=l("BasicHelp"),b=l("a-space"),x=l("a-table"),_=l("a-button");return n(),s("div",h,[o("div",C,[o("span",null,[d(c(0===e.type?"接口参数":"字段列表")+" ",1),r(i,{text:0===e.type?"接收方式:Body/json":"设置接口返回字段"},null,8,["text"])])]),r(x,{size:"small",rowKey:"id",class:k(["list",0===e.type?"params-table":"field-table"]),"data-source":e.list,columns:J.value,scroll:{x:void 0,y:e.scrollY},pagination:!1},{bodyCell:p((({column:t,record:a,index:i})=>["drag"===t.key?(n(),s("i",I)):y("",!0),"field"===t.key?(n(),s("p",{key:1,onClick:e=>function(e){q("itemClick",e)}(a),class:"cursor-pointer"},[o("span",w,c(a.required?"*":""),1),d(" "+c(a.field)+c(a.fieldName&&0===e.type?"("+a.fieldName+")":""),1)],8,v)):y("",!0),"dataType"===t.key?(n(),s("span",T,c(u(m)(a.dataType)),1)):y("",!0),"action"===t.key?(n(),f(b,{key:3,size:10},{default:p((()=>[o("i",{class:"icon-ym icon-ym-btn-edit",onClick:e=>M(a)},null,8,j),o("i",{class:"icon-ym icon-ym-delete",onClick:e=>function(e){O({iconType:"warning",title:F("common.tipTitle"),content:`此操作删除该${0===z.type?"参数":"字段"}, 是否继续?`,onOk:()=>{z.list.splice(e,1)}})}(i)},null,8,S)])),_:2},1024)):y("",!0)])),_:1},8,["class","data-source","columns","scroll"]),o("div",{class:"table-actions",onClick:a[0]||(a[0]=e=>M())},[r(_,{type:"link",preIcon:"icon-ym icon-ym-btn-add"},{default:p((()=>[d(c(u(F)("common.addText")),1)])),_:1})]),r(g,{onRegister:u(R),onReload:V,type:e.type},null,8,["onRegister","type"])])}}});export{N as _};
