import{b as e,B as a}from"./index-143f5813.js";import{d as l,g as t}from"./schedule-74da51ff.js";import{d as o,ad as n,a0 as d,e as i,o as s,g as r,j as u,l as m,k as c,p,m as f,q as g,t as b,a4 as _,co as v,V as x,ae as y,F as h,h as k,aH as F,u as Y,ah as C,n as D}from"./index-920db443.js";const I={class:"mx-50px my-20px"},M=o({__name:"Detail",emits:["register","reload"],setup(o,{emit:M}){const T=n({dataForm:{},type:0,groupId:0,visible:!1,checked:1,btnLoading:!1}),{dataForm:U,visible:H,checked:L,btnLoading:N,type:j}=d(T),w=[{id:1,fullName:"此日程"},{id:2,fullName:"此日程及后续"},{id:3,fullName:"所有日程"}],{t:R}=Y(),{createMessage:J,createConfirm:O}=C(),q=M,[B,{closeModal:E,changeLoading:S}]=e((function(e){T.dataForm.id=e.id||"",T.type=e.type||0,T.groupId=e.groupId||0,D((()=>{S(!0),t(T.groupId,T.dataForm.id).then((e=>{let a=e.data||{};a.files=a.files?JSON.parse(a.files):[],T.dataForm=a,S(!1)})).catch((()=>{S(!1)}))}))}));function V(){if(T.checked=1,1!=T.dataForm.repetition)return T.btnLoading=!1,void(T.visible=!0);O({iconType:"warning",title:R("common.tipTitle"),content:"此操作将永久删除此日程，同时删除所有参与人的日程，是否继续？",onOk:()=>{$()}})}function $(){if(T.btnLoading=!0,!T.checked&&1!=T.dataForm.repetition)return J.warning("请选择日程");l(T.dataForm.id,1!=T.dataForm.repetition?T.checked:3).then((e=>{J.success(e.msg),T.visible=!1,E(),q("reload")}))}return(e,l)=>{const t=i("a-form-item"),o=i("JnpfUploadFile"),n=i("a-form"),d=i("a-button"),Y=i("a-radio"),C=i("a-radio-group");return s(),r(h,null,[u(c(a),x(e.$attrs,{onRegister:c(B),title:c(R)("common.detailText")}),{footer:m((()=>[1==c(j)?(s(),p(d,{key:0,type:"primary",danger:"",onClick:V},{default:m((()=>l[5]||(l[5]=[f("删除")]))),_:1,__:[5]})):g("",!0),u(d,{onClick:c(E)},{default:m((()=>[f(b(c(R)("common.cancelText")),1)])),_:1},8,["onClick"])])),default:m((()=>[u(n,{class:"!mx-20px",colon:!1,model:c(U),ref:"formElRef",labelCol:{style:{width:"80px"}}},{default:m((()=>[u(t,{label:"类型"},{default:m((()=>[_("p",null,b(c(U).category),1)])),_:1}),u(t,{label:"紧急程度"},{default:m((()=>[_("p",null,b(c(U).urgent),1)])),_:1}),u(t,{label:"标题"},{default:m((()=>[_("p",null,b(c(U).title),1)])),_:1}),u(t,{label:"内容"},{default:m((()=>[_("p",null,b(c(U).content),1)])),_:1}),u(t,{label:"附件"},{default:m((()=>[u(o,{value:c(U).files,"onUpdate:value":l[0]||(l[0]=e=>c(U).files=e),disabled:"",detailed:""},null,8,["value"])])),_:1}),u(t,{label:"开始时间"},{default:m((()=>[_("p",null,b(c(v)(c(U).startDay).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1}),u(t,{label:"结束时间"},{default:m((()=>[_("p",null,b(c(v)(c(U).endDay).format("YYYY-MM-DD HH:mm:ss")),1)])),_:1}),u(t,{label:"创建人"},{default:m((()=>[_("p",null,b(c(U).creatorUserId),1)])),_:1}),u(t,{label:"参与人"},{default:m((()=>[_("p",null,b(c(U).toUserIds),1)])),_:1})])),_:1},8,["model"])])),_:1},16,["onRegister","title"]),u(c(F),{open:c(H),"onUpdate:open":l[4]||(l[4]=e=>y(H)?H.value=e:null),width:"380px",title:"删除确认",centered:""},{footer:m((()=>[u(d,{onClick:l[2]||(l[2]=e=>H.value=!1)},{default:m((()=>[f(b(c(R)("common.cancelText")),1)])),_:1}),u(d,{type:"primary",loading:c(N),onClick:l[3]||(l[3]=e=>$())},{default:m((()=>[f(b(c(R)("common.okText")),1)])),_:1},8,["loading"])])),default:m((()=>[_("div",I,[l[6]||(l[6]=_("p",{class:"mb-20px"},"此为重复日程，将删除应用于",-1)),u(C,{value:c(L),"onUpdate:value":l[1]||(l[1]=e=>y(L)?L.value=e:null)},{default:m((()=>[(s(),r(h,null,k(w,(e=>u(Y,{value:e.id,class:"!flex !mb-10px"},{default:m((()=>[f(b(e.fullName),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])])])),_:1},8,["open"])],64)}}});export{M as _};
