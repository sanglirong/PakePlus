import{b as e,B as a}from"./index-143f5813.js";import{u as o,B as n}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{f as t}from"./formValidate-c8ab8d29.js";import{b as r,u as i,c as d}from"./jquery-6353a699.js";import{d as l,ad as s,a0 as c,u as m,e as u,o as p,p as g,l as f,j as b,k as h,m as F,a4 as k,V as v,ah as x}from"./index-920db443.js";const B={class:"flex"},j={class:"flex-1 mr-10px"},y=l({__name:"Form",emits:["register","reload","design"],setup(l,{emit:y}){const _=["#008cff","#35b8e0","#00cc88","#ff9d00","#ff4d4d","#5b69bc","#ff8acc","#3b3e47","#282828"],L=s({dataForm:{},btnLoading:!1,iconBackground:""}),{dataForm:P,btnLoading:w}=c(L),{createMessage:S}=x(),{t:T}=m(),U=y,[V,{closeModal:q,changeLoading:R,changeOkLoading:C}]=e((function(e){N(),L.iconBackground="#008cff",L.dataForm.id=e.id||"",z([{field:"category",componentProps:{options:e.categoryList||[]}}]),L.dataForm.id&&(R(!0),r(L.dataForm.id).then((e=>{L.dataForm=e.data,L.iconBackground=L.dataForm.iconBackground||"#008cff",L.dataForm.visibleType=L.dataForm.visibleType||1,M(L.dataForm),R(!1)})).catch((()=>{R(!1)})))})),[I,{setFieldsValue:M,resetFields:N,validate:O,updateSchema:z}]=o({schemas:[{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:100},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:t("enCode"),trigger:"blur"}]},{field:"category",label:"分类",component:"Select",componentProps:{placeholder:"请选择",showSearch:!0},rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"sortCode",label:"排序",defaultValue:0,component:"InputNumber",componentProps:{min:0,max:999999}},{field:"commonUse",label:"通用",helpMessage:"启用后，将该打印设计设为通用打印模板",defaultValue:0,component:"Switch"},{ifShow:({values:e})=>1===e.commonUse,field:"visibleType",label:"发布范围",defaultValue:1,component:"Radio",componentProps:{options:[{fullName:"公开",id:1},{fullName:"权限设置",id:2}]}},{ifShow:({values:e})=>1===e.commonUse,field:"icon",label:"图标",slot:"icon",component:"IconPicker",rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"description",label:"说明 ",component:"Textarea",componentProps:{placeholder:"请输入"}}]});async function J(e=0){const a=await O();if(!a)return;1===e?L.btnLoading=!0:C(!0);const o={...a,iconBackground:L.iconBackground,id:L.dataForm.id};(L.dataForm.id?i:d)(o).then((o=>{S.success(o.msg),C(!1),L.btnLoading=!1,q(),U("reload"),L.dataForm.id||(L.dataForm.id=o.data),1==e&&U("design",{...a,id:L.dataForm.id})})).catch((()=>{C(!1),L.btnLoading=!1}))}return(e,o)=>{const t=u("jnpf-icon-picker"),r=u("jnpf-color-picker"),i=u("a-form-item-rest"),d=u("a-button");return p(),g(h(a),v(e.$attrs,{onRegister:h(V),title:h(P).id?h(T)("common.editText"):h(T)("common.addText"),onOk:o[2]||(o[2]=e=>J())}),{appendFooter:f((()=>[b(d,{type:"primary",loading:h(w),onClick:o[1]||(o[1]=e=>J(1))},{default:f((()=>o[3]||(o[3]=[F("确定并设计")]))),_:1,__:[3]},8,["loading"])])),default:f((()=>[b(h(n),{onRegister:h(I)},{icon:f((({model:e,field:a})=>[k("div",B,[k("div",j,[b(t,{value:e[a],"onUpdate:value":o=>e[a]=o,placeholder:"请选择"},null,8,["value","onUpdate:value"])]),b(i,null,{default:f((()=>[b(r,{value:L.iconBackground,"onUpdate:value":o[0]||(o[0]=e=>L.iconBackground=e),size:"small",predefine:_,name:"iconBackground"},null,8,["value"])])),_:1})])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title"])}}});export{y as _};
