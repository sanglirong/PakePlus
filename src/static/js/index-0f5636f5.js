import{b as e,c as t,d as a,e as i}from"./order-aaf42b07.js";import{u as o,B as r}from"./useTable-dc8c9d84.js";import{T as s}from"./TableAction-adbe36f2.js";import{d as n,r as l,u as d,co as u,e as p,a9 as _,o as m,g as c,a4 as v,j as g,l as j,m as y,t as x,k as f,i as w,p as h,aR as b,F as I,h as T,q as L,ah as M}from"./index-920db443.js";import{u as k}from"./index-9c138ba5.js";import{_ as R}from"./FlowParser.vue_vue_type_style_index_0_lang-43859d45.js";import{u as F}from"./useDefineSetting-7df030ff.js";import"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import"./visualDev-8f54ab4b.js";import"./index.vue_vue_type_script_setup_true_lang-69353133.js";import"./index-143f5813.js";import"./useWindowSizeFn-05f906e2.js";import"./log-2a5f2c26.js";import"./index-999abbee.js";import"./ArrowLeftOutlined-3fbf15bc.js";import"./Parser.vue_vue_type_script_setup_true_lang-6ddfe448.js";import"./Item.vue_vue_type_script_setup_true_lang-fef56f78.js";import"./Form.vue_vue_type_script_setup_true_lang-63005a4d.js";import"./createAsyncComponent-7e8f72ac.js";import"./DataLogList.vue_vue_type_script_setup_true_lang-c225eb8c.js";import"./index-0be8277c.js";import"./jquery-6353a699.js";import"./CustomForm.vue_vue_type_script_setup_true_lang-1aa664f4.js";import"./config-06ca91cd.js";import"./upperFirst-2cd1a2f7.js";import"./useTabs-ceeccdba.js";import"./uniqBy-e868edd7.js";import"./sortable.esm-02d0fe44.js";import"./SettingOutlined-dd6150a2.js";import"./index-1cfe4e28.js";import"./task-ee77df5a.js";import"./flowDelegate-3964bb34.js";import"./OpinionTextarea.vue_vue_type_style_index_0_lang-cb910758.js";import"./commonWords-8e03a6e1.js";import"./CommonWordsPopover.vue_vue_type_style_index_0_lang-3ee4c861.js";import"./Sign.vue_vue_type_style_index_0_lang-a3fd8868.js";import"./FlowFile.vue_vue_type_script_setup_true_lang-ff47ee4a.js";import"./document-763aa4ad.js";import"./Main.vue_vue_type_style_index_0_lang-0afb53a3.js";import"./componentMap-7e15a185.js";import"./ErrorModal.vue_vue_type_script_setup_true_lang-581230da.js";import"./CandidateModal.vue_vue_type_script_setup_true_lang-79d2d529.js";import"./index-c37d2476.js";import"./BasicLeftTree-cd55d444.js";import"./billRule-0363563b.js";import"./import-e198d900.js";import"./tip-b30e67af.js";import"./dataSource-ed26da12.js";import"./dataModel-ea807f46.js";import"./index-3b5bee70.js";import"./CopyOutlined-8d46c8b2.js";import"./ActionModal.vue_vue_type_script_setup_true_lang-22457a03.js";import"./ApprovalModal.vue_vue_type_script_setup_true_lang-8440f311.js";import"./ReduceApproverModal.vue_vue_type_script_setup_true_lang-7d94737b.js";import"./UserListModal.vue_vue_type_script_setup_true_lang-550da35d.js";import"./RecordList.vue_vue_type_style_index_0_lang-959f1fc0.js";import"./LogErrorModal.vue_vue_type_script_setup_true_lang-326503f1.js";import"./NodeFormParser.vue_vue_type_style_index_0_lang-0828e652.js";import"./SubFlowParser.vue_vue_type_style_index_0_lang-20f5de60.js";import"./StartFormParser.vue_vue_type_script_setup_true_lang-0c8077e0.js";import"./FlowChart.vue_vue_type_script_setup_true_lang-5aaf6076.js";import"./ExtraPanel.vue_vue_type_script_setup_true_lang-7c09275e.js";import"./RecordTimeList.vue_vue_type_style_index_0_lang-23988eb1.js";import"./RecordModal.vue_vue_type_style_index_0_lang-2d2d9b22.js";import"./TaskLogModal.vue_vue_type_style_index_0_lang-859a07eb.js";import"./template-c6142676.js";import"./emoji-a68b5251.js";import"./AuxiliaryList-441188d6.js";import"./pdf-3f972d03.js";import"./ViewModal.vue_vue_type_script_setup_true_lang-3d1fe22e.js";import"./Preview.vue_vue_type_style_index_0_lang-6567fb9c.js";const S={class:"jnpf-content-wrapper"},C={class:"jnpf-content-wrapper-center"},D={class:"jnpf-content-wrapper-content"},P=n({name:"extend-order",__name:"index",setup(n){const P=l("585361795057715206"),{createMessage:N}=M(),{t:H}=d(),{getFlowStatusContent:Y,getFlowStatusColor:A}=F(),[E,{openPopup:O}]=k(),q=[{title:"商品名称",dataIndex:"goodsName"},{title:"规格型号",dataIndex:"specifications",width:80},{title:"单位",dataIndex:"unit",width:80},{title:"数量",dataIndex:"qty",width:80},{title:"单价",dataIndex:"price",width:80},{title:"金额",dataIndex:"amount",width:80},{title:"折扣%",dataIndex:"discount",width:80},{title:"税率%",dataIndex:"cess",width:80},{title:"实际单价",dataIndex:"actualPrice",width:80},{title:"实际金额",dataIndex:"actualAmount",width:80}],z=[{title:"收款日期",dataIndex:"receivableDate",width:150,format:"date|YYYY-MM-DD HH:mm:ss"},{title:"收款比率%",dataIndex:"receivableRate",width:100},{title:"收款金额",dataIndex:"receivableMoney",width:100},{title:"收款方式",dataIndex:"receivableMode",width:100},{title:"收款摘要",dataIndex:"abstract"}],B={flowId:P.value},[V,{reload:W}]=o({api:e,columns:[{title:"订单编码",dataIndex:"orderCode",width:150,sorter:!0},{title:"订单日期",dataIndex:"orderDate",width:150,format:"date|YYYY-MM-DD HH:mm:ss",sorter:!0},{title:"客户名称",dataIndex:"customerName",width:200,sorter:!0},{title:"业务人员",dataIndex:"salesmanName",width:120,sorter:!0},{title:"付款金额",dataIndex:"receivableMoney",width:100,sorter:!0},{title:"制单人员",dataIndex:"creatorUser",width:120},{title:"订单备注",dataIndex:"description"},{title:"状态",dataIndex:"currentState",width:120,align:"center",sorter:!0}],searchInfo:B,useSearchForm:!0,formConfig:{schemas:[{field:"keyword",label:H("common.keyword"),component:"Input",componentProps:{placeholder:H("common.enterKeyword"),submitOnPressEnter:!0}},{field:"pickerVal",label:"订单日期",component:"DateRange",componentProps:{format:"YYYY-MM-DD HH:mm:ss",showTime:{defaultValue:[u("00:00:00","HH:mm:ss"),u("23:59:59","HH:mm:ss")]},placeholder:["开始时间","结束时间"]}}],fieldMapToTime:[["pickerVal",["startTime","endTime"]]]},actionColumn:{width:150,title:"操作",dataIndex:"action"},onExpand:function(e,i){if(!e||i.goodsList?.length||i.planList?.length)return;i.childTableLoading=!0,t(i.id).then((e=>{i.childTableLoading=!1,i.goodsList=e.data.list})).catch((()=>{i.childTableLoading=!1})),a(i.id).then((e=>{i.planList=e.data.list}))}}),[G]=o({columns:q,pagination:!1,showTableSetting:!1,canResize:!1,scroll:{x:void 0}}),[J]=o({columns:z,pagination:!1,showTableSetting:!1,canResize:!1,scroll:{x:void 0}});function K(e){return[{label:H("common.editText"),disabled:![0,8,9].includes(e.currentState),onClick:Z.bind(null,e,"-1")},{label:H("common.delText"),color:"error",disabled:![0,9].includes(e.currentState),modelConfirm:{onOk:X.bind(null,e.id)}},{label:H("common.detailText"),disabled:!e.currentState,onClick:Z.bind(null,e,0)}]}function U(e){const t=[];return f(q).forEach(((a,i)=>{if(0===i||1===i||2===i)return t[i]="";let o=e.reduce(((e,t)=>e+parseFloat(t[a.dataIndex])),0);o=Number.isNaN(o)?"":o,t[i]=o&&!Number.isInteger(o)?o.toFixed(2):o})),t}function Q(e){const t=[];return f(z).forEach(((a,i)=>{if(0===i||3===i||4===i)return t[i]="";let o=e.reduce(((e,t)=>e+parseFloat(t[a.dataIndex])),0);o=Number.isNaN(o)?"":o,t[i]=o&&!Number.isInteger(o)?o.toFixed(2):o})),t}function X(e){i(e).then((e=>{N.success(e.msg),W()}))}function Z(e,t){const a={id:e.flowTaskId||e.id,flowId:P.value,opType:t};O(!0,a)}return(e,t)=>{const a=p("a-button"),i=p("a-table-summary-cell"),o=p("a-table-summary-row"),n=p("a-table-summary"),l=p("a-tab-pane"),d=p("a-tabs"),u=p("JnpfTextTag"),M=_("loading");return m(),c("div",S,[v("div",C,[v("div",D,[g(f(r),{onRegister:f(V)},{tableTitle:j((()=>[g(a,{type:"primary",preIcon:"icon-ym icon-ym-btn-add",onClick:t[0]||(t[0]=e=>function(){const e={id:"",flowId:P.value,opType:"-1"};O(!0,e)}())},{default:j((()=>[y(x(f(H)("common.addText")),1)])),_:1})])),expandedRowRender:j((({record:e})=>[w((m(),h(d,{size:"small"},{default:j((()=>[g(l,{key:"1",tab:"订单商品"},{default:j((()=>[g(f(r),{onRegister:f(G),"data-source":e.goodsList},b({_:2},[e.goodsList&&e.goodsList.length?{name:"summary",fn:j((()=>[g(n,null,{default:j((()=>[g(o,null,{default:j((()=>[g(i,{index:0},{default:j((()=>t[1]||(t[1]=[y("合计")]))),_:1,__:[1]}),(m(!0),c(I,null,T(U(e.goodsList),((e,t)=>(m(),h(i,{key:t,index:t+1},{default:j((()=>[y(x(e),1)])),_:2},1032,["index"])))),128))])),_:2},1024)])),_:2},1024)])),key:"0"}:void 0]),1032,["onRegister","data-source"])])),_:2},1024),g(l,{key:"2",tab:"收款计划"},{default:j((()=>[g(f(r),{onRegister:f(J),"data-source":e.planList},b({_:2},[e.planList&&e.planList.length?{name:"summary",fn:j((()=>[g(n,null,{default:j((()=>[g(o,null,{default:j((()=>[g(i,{index:0},{default:j((()=>t[2]||(t[2]=[y("合计")]))),_:1,__:[2]}),(m(!0),c(I,null,T(Q(e.planList),((e,t)=>(m(),h(i,{key:t,index:t+1},{default:j((()=>[y(x(e),1)])),_:2},1032,["index"])))),128))])),_:2},1024)])),_:2},1024)])),key:"0"}:void 0]),1032,["onRegister","data-source"])])),_:2},1024)])),_:2},1024)),[[M,e.childTableLoading]])])),bodyCell:j((({column:e,record:t})=>["currentState"===e.key?(m(),h(u,{key:0,content:f(Y)(t.currentState),color:f(A)(t.currentState)},null,8,["content","color"])):L("",!0),"action"===e.key?(m(),h(f(s),{key:1,actions:K(t)},null,8,["actions"])):L("",!0)])),_:1},8,["onRegister"])])]),g(R,{onRegister:f(E),onReload:f(W)},null,8,["onRegister","onReload"])])}}});export{P as default};
