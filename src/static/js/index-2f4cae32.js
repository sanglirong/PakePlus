import{d as e,u as t,aD as o,fg as n,gz as r,a7 as i,e as a,o as s,g as l,a4 as p,j as m,l as d,m as u,t as c,k as _,p as g,q as f,gA as j,ah as y}from"./index-920db443.js";import{u as b,B as v}from"./useTable-dc8c9d84.js";import{T as k}from"./TableAction-adbe36f2.js";import{u as x}from"./index-143f5813.js";import{u as h}from"./index-9c138ba5.js";import{_ as w}from"./Form.vue_vue_type_script_setup_true_lang-f26957c7.js";import{_ as I}from"./Member.vue_vue_type_script_setup_true_lang-e894c7bd.js";import T from"./Permission-c66b6a38.js";import{_ as M}from"./ImportModal.vue_vue_type_script_setup_true_lang-772d2a6b.js";import{_ as R}from"./ExportModal.vue_vue_type_script_setup_true_lang-295b5f0e.js";import"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import"./visualDev-8f54ab4b.js";import"./index.vue_vue_type_script_setup_true_lang-69353133.js";import"./index-999abbee.js";import"./ArrowLeftOutlined-3fbf15bc.js";import"./log-2a5f2c26.js";import"./Parser.vue_vue_type_script_setup_true_lang-6ddfe448.js";import"./Item.vue_vue_type_script_setup_true_lang-fef56f78.js";import"./Form.vue_vue_type_script_setup_true_lang-63005a4d.js";import"./createAsyncComponent-7e8f72ac.js";import"./DataLogList.vue_vue_type_script_setup_true_lang-c225eb8c.js";import"./index-0be8277c.js";import"./jquery-6353a699.js";import"./useDefineSetting-7df030ff.js";import"./CustomForm.vue_vue_type_script_setup_true_lang-1aa664f4.js";import"./config-06ca91cd.js";import"./upperFirst-2cd1a2f7.js";import"./useTabs-ceeccdba.js";import"./uniqBy-e868edd7.js";import"./useWindowSizeFn-05f906e2.js";import"./sortable.esm-02d0fe44.js";import"./SettingOutlined-dd6150a2.js";import"./index-1cfe4e28.js";import"./formValidate-c8ab8d29.js";import"./userRelation-654fbd05.js";import"./permissionGroup-129512c4.js";import"./import-e198d900.js";import"./tip-b30e67af.js";import"./config-900ef1e2.js";const z={class:"jnpf-content-wrapper"},C={class:"jnpf-content-wrapper-center"},F={class:"jnpf-content-wrapper-content"},P=e({name:"permission-position",__name:"index",setup(e){const{createMessage:P}=y(),{t:D}=t(),S=o(),N=n(),[A,{openModal:O}]=x(),[L,{openModal:Y}]=x(),[q,{openPopup:B}]=h(),[E,{openModal:H}]=x(),[G,{openModal:K}]=x(),[Q,{reload:V,getForm:J,getFetchParams:W}]=b({api:r,beforeFetch:e=>(e.organizeId=e.organizeTree?.length?e.organizeTree[e.organizeTree.length-1]:"",delete e.organizeTree,e),columns:[{title:"岗位名称",dataIndex:"fullName",width:200},{title:"岗位编码",dataIndex:"enCode",width:150},{title:"岗位类型",dataIndex:"type",width:100},{title:"所属组织",dataIndex:"department"},{title:"创建时间",dataIndex:"creatorTime",width:150,format:"date|YYYY-MM-DD HH:mm:ss"},{title:"排序",dataIndex:"sortCode",width:70,align:"center"},{title:"状态",dataIndex:"enabledMark",width:80,align:"center"}],useSearchForm:!0,formConfig:{schemas:[{field:"keyword",label:D("common.keyword"),component:"Input",componentProps:{placeholder:D("common.enterKeyword"),submitOnPressEnter:!0}},{field:"organizeTree",label:"所属组织",component:"OrganizeSelect",componentProps:{placeholder:"请选择",auth:!0}},{field:"type",label:"岗位类型",component:"Select",componentProps:{placeholder:"请选择"}},{field:"enabledMark",label:"状态",component:"Select",componentProps:{placeholder:"请选择",options:[{fullName:"启用",id:1},{fullName:"禁用",id:0}]}}]},actionColumn:{width:150,title:"操作",dataIndex:"action"}});function U(e){return[{label:D("common.editText"),onClick:$.bind(null,e.id)},{label:D("common.delText"),color:"error",modelConfirm:{onOk:ee.bind(null,e.id)}}]}function X(e){return e.enabledMark?[{label:"岗位成员",onClick:te.bind(null,e.id,e.fullName)},{label:"查看权限",onClick:Z.bind(null,e.id,e.fullName)}]:[]}function Z(e,t){B(!0,{id:e,fullName:t,objectType:"position"})}function $(e=""){const t=J().getFieldsValue().organizeTree||[],o=t.length?t[t.length-1]:"";Y(!0,{id:e,organizeId:o,organizeIdTree:t})}function ee(e){j(e).then((e=>{P.success(e.msg),N.resetState(),V()}))}function te(e,t){O(!0,{id:e,fullName:t})}function oe(){H(!0,{type:"position"})}function ne(){const e={...W(),organizeId:W().organizeId||"",keyword:W().keyword||""};K(!0,{listQuery:e,type:"position"})}return i((()=>{!async function(){const e=await S.getDictionaryData("PositionType");J().updateSchema({field:"type",componentProps:{options:e}})}()})),(e,t)=>{const o=a("a-button"),n=a("a-tag");return s(),l("div",z,[p("div",C,[p("div",F,[m(_(v),{onRegister:_(Q)},{tableTitle:d((()=>[m(o,{type:"primary",preIcon:"icon-ym icon-ym-btn-add",onClick:t[0]||(t[0]=e=>$())},{default:d((()=>[u(c(_(D)("common.addText")),1)])),_:1}),m(o,{type:"link",onClick:ne},{default:d((()=>[t[1]||(t[1]=p("i",{class:"icon-ym icon-ym-btn-download button-preIcon"},null,-1)),u(c(_(D)("common.exportText")),1)])),_:1,__:[1]}),m(o,{type:"link",onClick:oe},{default:d((()=>[t[2]||(t[2]=p("i",{class:"icon-ym icon-ym-btn-upload button-preIcon"},null,-1)),u(c(_(D)("common.importText")),1)])),_:1,__:[2]})])),bodyCell:d((({column:e,record:t})=>["enabledMark"===e.key?(s(),g(n,{key:0,color:1===t.enabledMark?"success":"error"},{default:d((()=>[u(c(1==t.enabledMark?"启用":"禁用"),1)])),_:2},1032,["color"])):f("",!0),"action"===e.key?(s(),g(_(k),{key:1,actions:U(t),dropDownActions:X(t)},null,8,["actions","dropDownActions"])):f("",!0)])),_:1},8,["onRegister"])])]),m(w,{onRegister:_(L),onReload:_(V)},null,8,["onRegister","onReload"]),m(I,{onRegister:_(A)},null,8,["onRegister"]),m(T,{onRegister:_(q)},null,8,["onRegister"]),m(R,{onRegister:_(G)},null,8,["onRegister"]),m(M,{onRegister:_(E),onReload:_(V)},null,8,["onRegister","onReload"])])}}});export{P as default};
