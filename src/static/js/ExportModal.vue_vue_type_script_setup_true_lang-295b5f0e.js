import{b as a,B as e}from"./index-143f5813.js";import{d as l,r as u,M as t,c as n,e as o,o as s,p as i,l as v,j as d,a4 as r,g as c,F as p,h as m,m as f,t as g,V as h,k as x,ea as _,ah as k}from"./index-920db443.js";import{i as y}from"./config-900ef1e2.js";const N=l({__name:"ExportModal",setup(l){const[N,{closeModal:b,changeOkLoading:j}]=a((function(a){O.value=a.type||"user",F(),"company"!=O.value&&(D.value=y[O.value].exportData.map((a=>({...a,fullName:a.title,id:a.dataIndex}))));M.value=0,E.value=D.value.map((a=>a.id)),L(E.value),R.value=a.listQuery})),{createMessage:C}=k(),M=u(0),O=u("user"),U=u(!1),w=u(!1),D=u([]),E=u([]),I=u([]),R=u({}),T=[{fullName:"当前页面数据",id:0},{fullName:"全部页面数据",id:1}],A=[{fullName:"公司和部门",id:0},{fullName:"公司",id:1},{fullName:"部门",id:2}],B=t((()=>"company"==O.value?A:T));function F(a=0){if("company"!=O.value)return;let e=n(y.company.exportData[a]);D.value=e.map((a=>({...a,fullName:a.title,id:a.dataIndex}))),E.value=D.value.map((a=>a.id)),L(E.value)}function K(a){const e=a.target.checked;E.value=e?D.value.map((a=>a.id)):I.value,U.value=!e&&!!I.value.length}function L(a){const e=a.length;w.value=e===D.value.length,U.value=!!e&&e<D.value.length}function Q(){if(!E.value.length)return C.warning("请至少选择一个导出字段");j(!0);let a={...R.value,dataType:M.value,selectKey:E.value.join(",")};y[O.value].exportExcel(a).then((a=>{j(!1),a.data.url&&(_({url:a.data.url}),b())})).catch((()=>{j(!1)}))}return(a,l)=>{const u=o("a-radio"),t=o("a-radio-group"),n=o("a-form-item"),_=o("a-checkbox"),k=o("a-checkbox-group"),y=o("a-form");return s(),i(x(e),h(a.$attrs,{onRegister:x(N),title:"导出",okText:"导出",onOk:Q,destroyOnClose:"",class:"export-modal"}),{default:v((()=>[d(y,{colon:!1,labelAlign:"left",labelCol:{style:{width:"90px"}}},{default:v((()=>[l[5]||(l[5]=r("div",{class:"export-line"},[r("p",{class:"export-label"},"导出方式")],-1)),d(n,null,{default:v((()=>[d(t,{value:M.value,"onUpdate:value":l[0]||(l[0]=a=>M.value=a),onChange:l[1]||(l[1]=a=>F(M.value))},{default:v((()=>[(s(!0),c(p,null,m(B.value,(a=>(s(),i(u,{value:a.id},{default:v((()=>[f(g(a.fullName),1)])),_:2},1032,["value"])))),256))])),_:1},8,["value"])])),_:1}),l[6]||(l[6]=r("div",{class:"export-line"},[r("p",{class:"export-label"},[f("导出数据"),r("span",null,"请选择导出字段")])],-1)),d(_,{indeterminate:U.value,checked:w.value,"onUpdate:checked":l[2]||(l[2]=a=>w.value=a),onChange:K},{default:v((()=>l[4]||(l[4]=[f("全选")]))),_:1,__:[4]},8,["indeterminate","checked"]),d(k,{value:E.value,"onUpdate:value":l[3]||(l[3]=a=>E.value=a),class:"options-list",onChange:L},{default:v((()=>[(s(!0),c(p,null,m(D.value,(a=>(s(),i(_,{key:a.id,value:a.id,class:"options-item"},{default:v((()=>[f(g(a.fullName),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1,__:[5,6]})])),_:1},16,["onRegister"])}}});export{N as _};
