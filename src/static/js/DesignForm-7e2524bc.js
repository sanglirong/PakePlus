import{d as defineComponent,r as ref,e as resolveComponent,o as openBlock,g as createElementBlock,F as Fragment,a4 as createBaseVNode,t as toDisplayString,q as createCommentVNode,p as createBlock,n as nextTick,k as unref,ad as reactive,c as cloneDeep,l as withCtx,j as createVNode,V as mergeProps,m as createTextVNode,bn as buildUUID,ah as useMessage,ac as useAppStore,M as computed,w as watch,h as renderList,af as normalizeClass,c3 as Form,u as useI18n,bk as pick,aN as ModalClose,aH as Modal,e1 as _sfc_main$z,a0 as toRefs,s as inject,ae as isRef,e0 as formatToDateTime,cb as isEmpty,fI as TreeSelect,aw as useGlobSetting,fS as getSelectedList,a9 as resolveDirective,i as withDirectives,ab as ScrollContainer,aY as useDebounceFn,fE as getDataInterfaceInfo,eg as buildBitUUID,bN as DownOutlined,a7 as onMounted,eh as useCopyToClipboard,aU as toRaw,aS as normalizeProps,aP as omit,K as provide,T as useDesign,dp as DoubleRightOutlined,bC as DoubleLeftOutlined,aT as guardReactiveProps,dj as logoImg,am as normalizeStyle,cl as withModifiers,v as vShow,a5 as _export_sfc}from"./index-920db443.js";import{f as getFlowFormInfo,k as getWebhookUrl,l as getInfo,m as getVersionList,n as getFlowInfo,s as saveFlow,o as copyVersion,p as delVersion}from"./template-c6142676.js";import{b as useModalInner,B as BasicModal,u as useModal}from"./index-143f5813.js";import{t as typeTask,h as typeTrigger,b as bpmnTask,d as bpmnProcessing,e as typeProcessing,a5 as typeCondition,S as bpmnSequenceFlow,a3 as typeConfluence,f as bpmnSubFlow,Q as typeChoose,a0 as typeGateway,o as typeInclusion,s as typeExclusive,q as typeParallel,a6 as typeConnect}from"./componentMap-7e15a185.js";import{c as changeTypeByTaskShape,N as NodeUtils,t as typeConfig,g as getExternalLabelMid,h as hasGatewayType,a as triggerTypeChange,_ as _sfc_main$G}from"./Main.vue_vue_type_style_index_0_lang-0afb53a3.js";import{p as getVisualDevFormList,a as getConfigData}from"./visualDev-8f54ab4b.js";import{n as getPrintDevSelector}from"./jquery-6353a699.js";import{e as errorRuleOptions,n as nodeNoticeOptions,c as noticeOptions,a as systemFieldOptions,l as logicOptions,d as conditionTypeOptions,f as symbolOptions,g as conditionTypeOptions1,h as divideRuleOptions,p as printConditionTypeOptions,k as keyMap,o as overTimeMsgOptions,j as overTimeOptions,t as templateJsonColumns,s as sourceTypeOptions,m as defaultStep,q as typeOptions,r as formFieldTypeOptions,u as nodeOverTimeMsgOptions,v as subFlowErrorRuleOptions,w as notSupportList,b as simpleSourceTypeOptions,x as durationList,y as reminderTimeList_,z as reminderTimeList,A as remindList,B as repeatReminderList}from"./define-8efdf20f.js";import{s as systemComponentsList,d as dyOptionsList}from"./config-06ca91cd.js";import{u as useForm,B as BasicForm}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{_ as _sfc_main$y}from"./MsgModal.vue_vue_type_script_setup_true_lang-65704aaa.js";import{M as MsgTemplateDetail}from"./MsgTemplateDetail-001aea8e.js";import{u as useTable,B as BasicTable}from"./useTable-dc8c9d84.js";import{a as MODE,C as CodeEditor,M as MonacoEditor}from"./index-3b5bee70.js";import{S as SelectInterface,a as SelectInterfaceBtn}from"./index-7e2f1b8c.js";import{R as ReloadOutlined}from"./ReloadOutlined-5b95234b.js";import{a as InterfaceModal,_ as _sfc_main$D,V as ValidatePopover}from"./index-c37d2476.js";import{d as draggable}from"./vuedraggable.umd-11acc51f.js";import{_ as _sfc_main$A,a as _sfc_main$C}from"./InitiatorUserSelect.vue_vue_type_script_setup_true_lang-dfa9afb0.js";import{_ as _sfc_main$B}from"./FlowModal.vue_vue_type_script_setup_true_lang-b2e7f9ad.js";import{_ as _sfc_main$E}from"./TemplateModal.vue_vue_type_script_setup_true_lang-60c125c7.js";import{B as BatchModal,_ as _sfc_main$F}from"./WebhookRequestModal.vue_vue_type_style_index_0_lang-1411d0ba.js";import"./useWindowSizeFn-05f906e2.js";import"./log-2a5f2c26.js";import"./useTabs-ceeccdba.js";import"./upperFirst-2cd1a2f7.js";import"./uniqBy-e868edd7.js";import"./index.vue_vue_type_script_setup_true_lang-69353133.js";import"./index-9c138ba5.js";import"./ArrowLeftOutlined-3fbf15bc.js";import"./index-999abbee.js";import"./Parser.vue_vue_type_script_setup_true_lang-6ddfe448.js";import"./Item.vue_vue_type_script_setup_true_lang-fef56f78.js";import"./Form.vue_vue_type_script_setup_true_lang-63005a4d.js";import"./createAsyncComponent-7e8f72ac.js";import"./DataLogList.vue_vue_type_script_setup_true_lang-c225eb8c.js";import"./index-0be8277c.js";import"./useDefineSetting-7df030ff.js";import"./CustomForm.vue_vue_type_script_setup_true_lang-1aa664f4.js";import"./sendConfig-5e58278e.js";import"./msgTemplate-ce5c0fa7.js";import"./sortable.esm-02d0fe44.js";import"./SettingOutlined-dd6150a2.js";import"./index-1cfe4e28.js";import"./BasicLeftTree-cd55d444.js";import"./billRule-0363563b.js";import"./import-e198d900.js";import"./tip-b30e67af.js";import"./dataSource-ed26da12.js";import"./dataModel-ea807f46.js";import"./CopyOutlined-8d46c8b2.js";import"./task-ee77df5a.js";import"./accountConfig-5422c027.js";import"./integrate-cef8009f.js";const index="",propPanel="";class BpmnLintError{element;message;constructor(e,o){this.element=e,this.message=o}}class BpmnLintBase{registry;root;constructor(e,o){this.registry=e,this.root=o}error;getError(){return this.error}}let jnpfProps;class FormValidator extends BpmnLintBase{constructor(e,o,t){super(e,o),jnpfProps=t}validate(){let e=[],o=this.root.children;if(!(o&&o.length>0))return this.error=new BpmnLintError(null,"画布上不存在元素，至少包含【开始-审批-结束】节点"),!1;{let t=o.reduce(((e,o)=>{let t=("bpmn:InclusiveGateway"===o.type?o.wnGatewayType:o.type)?.replace("bpmn:","")?.toLowerCase();return e[t]||(e[t]=[]),e[t].push(o),e}),{});if(t){if(!(t.hasOwnProperty("startevent")&&t.hasOwnProperty("endevent")&&t.hasOwnProperty("usertask")))return this.error=new BpmnLintError(null,"确保画布上至少包含【开始-审批-结束】节点"),!1;if(t.startevent){if(t.startevent.length>1)return this.error=new BpmnLintError(null,"画布上只能存在一个开始节点"),!1;if(t.startevent[0]){let o=t.startevent[0].outgoing,n=t.startevent[0].incoming;n&&n.length>0&&e.push({element:t.startevent[0],error:"开始节点不存在进线，请删除多余线条！"}),o||e.push({element:t.startevent[0],error:"开始元素不能单独使用，请于其它元素进行连线使用！"})}}if(t.endevent){if(t.endevent.length>1)return this.error=new BpmnLintError(null,"画布上只能存在一个结束节点，请删除多余节点元素！"),!1;if(t.endevent[0]){let o=t.endevent[0].outgoing,n=t.endevent[0].incoming;o&&o.length>0&&e.push({element:t.endevent[0],error:"结束节点不存在出线，请删除多余线条！"}),n||e.push({element:t.endevent[0],error:"结束元素不能单独使用，请于其它元素进行连线使用！"})}}if((t.hasOwnProperty("confluence")||t.hasOwnProperty("divide"))&&!(t.confluence&&t.confluence.length&&t.divide&&t.divide.length))return this.error=new BpmnLintError(null,"请您检查分流与合流是否成对使用！"),!1;if(t.usertask){t.usertask.map((o=>{let t=o.outgoing,n=o.incoming;t?.length&&n?.length||(!changeTypeByTaskShape[o?.wnType]||2===jnpfProps.type&&changeTypeByTaskShape[o?.wnType]?e.push({element:o,error:"元素不能单独使用，请确保连接至少一个执行节点"}):changeTypeByTaskShape[o?.wnType]&&!n?.length&&e.push({element:o,error:"执行元素不能单独使用，请确保连接到触发节点"})),o?.wnType===typeTask&&t.every((e=>e.target.wnType===typeTrigger))&&e.push({element:o,error:"审批元素不能只包含触发节点, 请确保至少有一条出线与其他元素相连接"})}))}if(e&&e.length>0)return this.error=new BpmnLintError(e,e[0].error),!1}}return!0}}function validate(e,o,t){const n=[new FormValidator(e,o,t)];for(let a of n)if(!a.validate())return a.getError()}const _hoisted_1$s={class:"header-container"},_hoisted_2$p={key:0},_hoisted_3$m={class:"header-container-left"},_hoisted_4$h={key:0,class:"icon-ym icon-ym-edit"},_hoisted_5$c={key:0,class:"header-container-right"},_sfc_main$x=defineComponent({__name:"HeaderContainer",props:{formConf:{type:Object,default:{}},detailed:{type:Boolean,default:!1},showEnCode:{type:Boolean,default:!0}},emits:["onNodeNameChange"],setup(e,{emit:o}){const t=e,n=o,a=ref(!1),l=ref(null);function r(){t.detailed||(a.value=!a.value,nextTick((()=>a.value&&unref(l)?.focus())))}function i(){r(),n("onNodeNameChange",t.formConf.nodeName)}return(o,t)=>{const n=resolveComponent("a-input");return openBlock(),createElementBlock("div",_hoisted_1$s,["global"==e.formConf?.type?(openBlock(),createElementBlock("span",_hoisted_2$p,"全局属性")):(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("div",_hoisted_3$m,[a.value?(openBlock(),createBlock(n,{key:1,value:e.formConf.nodeName,"onUpdate:value":t[0]||(t[0]=o=>e.formConf.nodeName=o),ref_key:"inputRef",ref:l,onBlur:i},null,8,["value"])):(openBlock(),createElementBlock("div",{key:0,class:"node-name",onClick:r},[createBaseVNode("span",null,toDisplayString(e.formConf.nodeName),1),e.detailed?createCommentVNode("",!0):(openBlock(),createElementBlock("i",_hoisted_4$h))]))]),e.showEnCode?(openBlock(),createElementBlock("div",_hoisted_5$c,"编码："+toDisplayString(e.formConf.nodeId),1)):createCommentVNode("",!0)],64))])}}}),_sfc_main$w=defineComponent({__name:"FileModal",emits:["register","confirm"],setup(e,{emit:o}){const t=reactive({fileConfig:{}}),n=o,a=[{field:"",label:"",component:"Alert",componentProps:{message:"归档后在文档中心查看(APP端及批量审批操作不支持自动归档)",type:"warning",showIcon:!0}},{field:"permissionType",label:"查看权限",component:"Radio",componentProps:{options:[{fullName:"当前流程所有人",id:1},{fullName:"流程发起人",id:2},{fullName:"最后节点审批人",id:3}]}},{field:"templateId",label:"归档模板",component:"TreeSelect",componentProps:{options:[],lastLevel:!0},rules:[{required:!0,trigger:"change",message:"必填"}]}],[l,{closeModal:r}]=useModalInner((function(e){t.fileConfig=cloneDeep(e.fileConfig)||{},s(t.fileConfig),d(),getPrintDevSelector().then((e=>{const o=(e.data.list||[]).filter((e=>e.children&&e.children.length)).map((e=>({...e,hasChildren:!0})));f({field:"templateId",componentProps:{options:o}})}))})),[i,{setFieldsValue:s,validate:c,clearValidate:d,updateSchema:f}]=useForm({labelWidth:80,schemas:a});async function m(){const e=await c();e&&(r(),n("confirm",e))}return(e,o)=>(openBlock(),createBlock(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(l),title:"流程归档设置",onOk:m,destroyOnClose:""}),{default:withCtx((()=>[createVNode(unref(BasicForm),{onRegister:unref(i)},null,8,["onRegister"])])),_:1},16,["onRegister"]))}}),_hoisted_1$r={class:"global-setting"},_hoisted_2$o={class:"table-box"},_sfc_main$v=defineComponent({__name:"GlobalSettingModal",emits:["register","confirm"],setup(e,{emit:o}){const t=ref([]),n=ref([]),a=ref(0),l=o,{createMessage:r}=useMessage(),[i,{closeModal:s}]=useModalInner((function(e){t.value=cloneDeep(e.globalParameterList)||[],n.value=cloneDeep(e.approvalFieldList)||[]})),c=[{title:"变量类型",dataIndex:"dataType",key:"dataType",width:220},{title:"变量名称",dataIndex:"fieldName",key:"fieldName",width:250},{title:"默认值",dataIndex:"defaultValue",key:"defaultValue",width:280},{title:"操作",dataIndex:"action",key:"action",width:50,align:"center"}],d=[{title:"字段名称",dataIndex:"fieldName",key:"fieldName",width:450},{title:"控件类型",dataIndex:"jnpfKey",key:"jnpfKey",width:300},{title:"操作",dataIndex:"action",key:"action",width:50,align:"center"}],f=[{fullName:"字符串",id:"varchar"},{fullName:"整型",id:"int"},{fullName:"日期时间",id:"datetime"},{fullName:"浮点",id:"decimal"}],m=[{fullName:"单行输入",id:"input"},{fullName:"多行输入",id:"textarea"},{fullName:"数字输入",id:"inputNumber"}];function p(){0==a.value?t.value.push({dataType:"varchar",fieldName:C(),id:buildUUID()}):n.value.push({jnpfKey:"input",fieldName:"",id:buildUUID()})}function u(e){(0==a.value?t.value:n.value).splice(e,1)}function C(){if(!t.value.length)return"flow_var1";let e=-1;const o=/flow_var(\d+)/;return t.value.map((t=>{const n=t.fieldName.match(o);if(n){const o=parseInt(n[1]);o>e&&(e=o)}})),"flow_var"+ ++e}async function g(){for(let e=0;e<t.value.length;e++){if(!t.value[e].fieldName)return r.warning("变量名称不能为空");if(t.value.find(((o,n)=>o?.fieldName==t.value[e]?.fieldName&&n!=e)))return r.warning("变量名称不能重复")}for(let e=0;e<n.value.length;e++){if(!n.value[e]?.fieldName)return r.warning("字段名称不能为空");if(n.value.find(((o,t)=>o?.fieldName==n.value[e]?.fieldName&&t!=e)))return r.warning("字段名称不能重复")}l("confirm",{globalParameterList:t.value,approvalFieldList:n.value}),s()}return(e,o)=>{const l=resolveComponent("a-tab-pane"),r=resolveComponent("a-tabs"),s=resolveComponent("a-alert"),C=resolveComponent("jnpf-select"),v=resolveComponent("a-input"),_=resolveComponent("jnpf-input-number"),h=resolveComponent("jnpf-date-picker"),N=resolveComponent("jnpf-input"),k=resolveComponent("a-button"),y=resolveComponent("a-table");return openBlock(),createBlock(unref(BasicModal),mergeProps(e.$attrs,{width:"1000px",class:"jnpf-global-setting-modal",onRegister:unref(i),title:"全局设置",onOk:g,destroyOnClose:""}),{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$r,[createVNode(r,{activeKey:a.value,"onUpdate:activeKey":o[0]||(o[0]=e=>a.value=e),"tab-position":"left",class:"common-left-tabs flow-left-tabs"},{default:withCtx((()=>[(openBlock(),createBlock(l,{key:0,tab:"全局变量"})),(openBlock(),createBlock(l,{key:1,tab:"审批字段"}))])),_:1},8,["activeKey"]),createBaseVNode("div",_hoisted_2$o,[0==a.value?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(s,{message:"可通过节点属性给全局变量赋值",type:"warning","show-icon":""}),createVNode(y,{"data-source":t.value,columns:c,size:"small",pagination:!1,class:"mt-10px"},{bodyCell:withCtx((({column:e,record:t,index:n})=>["dataType"===e.key?(openBlock(),createBlock(C,{key:0,value:t.dataType,"onUpdate:value":e=>t.dataType=e,options:f},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"fieldName"===e.key?(openBlock(),createBlock(v,{key:1,value:t.fieldName,"onUpdate:value":e=>t.fieldName=e,placeholder:"请输入",maxlength:50},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"defaultValue"===e.key?(openBlock(),createElementBlock(Fragment,{key:2},[["int","decimal"].includes(t.dataType)?(openBlock(),createBlock(_,{key:0,value:t.defaultValue,"onUpdate:value":e=>t.defaultValue=e,placeholder:"请输入"},null,8,["value","onUpdate:value"])):"datetime"===t.dataType?(openBlock(),createBlock(h,{key:1,value:t.defaultValue,"onUpdate:value":e=>t.defaultValue=e,class:"w-full",placeholder:"请选择"},null,8,["value","onUpdate:value"])):(openBlock(),createBlock(N,{key:2,value:t.defaultValue,"onUpdate:value":e=>t.defaultValue=e,placeholder:"请输入"},null,8,["value","onUpdate:value"]))],64)):createCommentVNode("",!0),"action"===e.key?(openBlock(),createBlock(k,{key:3,type:"link",danger:"",onClick:e=>u(n)},{default:withCtx((()=>o[3]||(o[3]=[createBaseVNode("i",{class:"icon-ym icon-ym-app-delete"},null,-1)]))),_:2,__:[3]},1032,["onClick"])):createCommentVNode("",!0)])),_:1},8,["data-source"]),createBaseVNode("span",{class:"link-text inline-block mt-10px",onClick:o[1]||(o[1]=e=>p())},o[4]||(o[4]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("新增变量")]))],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(s,{message:"用于流程审批时自定义审批拓展字段，可在节点属性中启用字段。",type:"warning","show-icon":""}),createVNode(y,{"data-source":n.value,columns:d,size:"small",pagination:!1,class:"mt-10px"},{bodyCell:withCtx((({column:e,record:t,index:n})=>["jnpfKey"===e.key?(openBlock(),createBlock(C,{key:0,value:t.jnpfKey,"onUpdate:value":e=>t.jnpfKey=e,options:m},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"fieldName"===e.key?(openBlock(),createBlock(v,{key:1,value:t.fieldName,"onUpdate:value":e=>t.fieldName=e,placeholder:"请输入",maxlength:50},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"action"===e.key?(openBlock(),createBlock(k,{key:2,type:"link",danger:"",onClick:e=>u(n)},{default:withCtx((()=>o[5]||(o[5]=[createBaseVNode("i",{class:"icon-ym icon-ym-app-delete"},null,-1)]))),_:2,__:[5]},1032,["onClick"])):createCommentVNode("",!0)])),_:1},8,["data-source"]),createBaseVNode("span",{class:"link-text inline-block mt-10px",onClick:o[2]||(o[2]=e=>p())},o[6]||(o[6]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("新增字段")]))],64))])])])),_:1},16,["onRegister"])}}}),GlobalSettingModal_vue_vue_type_style_index_0_lang="",_hoisted_1$q={class:"mt-10px"},_hoisted_2$n={class:"mt-10px"},_hoisted_3$l={key:0,class:"mt-10px"},_hoisted_4$g={key:1,class:"mt-10px"},_hoisted_5$b={class:"mt-10px"},_hoisted_6$b={class:"mt-10px"},_hoisted_7$a={class:"mt-10px"},_hoisted_8$a={class:"mt-10px"},_hoisted_9$9={class:"mt-10px"},_hoisted_10$6={class:"mt-10px"},_hoisted_11$5={class:"mt-10px"},_hoisted_12$3={key:0,class:"file-info"},_sfc_main$u=defineComponent({inheritAttrs:!1,__name:"GlobalProperties",props:["formConf","usedFormItems","updateJnpfData","updateAllNodeFormOperates","type"],emits:["register","reload","updateConnectNameType"],setup(e,{emit:o}){const t=reactive({temporaryContent:""}),n=[{id:0,fullName:"默认"},{id:1,fullName:"自定义"}],a=[{fullName:"不允许撤回",id:1},{fullName:"发起节点允许撤回",id:2},{fullName:"所有节点允许撤回",id:3}],l=[{id:1,fullName:"创建人"},{id:2,fullName:"超级管理员"},{id:3,fullName:"自定义"}],r=[{id:3,fullName:"默认"},{id:1,fullName:"自定义"},{id:0,fullName:"关闭"}],i="failMsgConfig",s="startMsgConfig",c=o,d=useAppStore(),f=e,[m,{openModal:p}]=useModal(),[u,{openModal:C}]=useModal(),g=computed((()=>[{id:"@flowFullName",fullName:"流程名称"},{id:"@flowFullCode",fullName:"流程编码"},{id:"@launchUserName",fullName:"发起用户名"},{id:"@launchTime",fullName:"发起时间"},...f.usedFormItems.filter((e=>["input","inputNumber","textarea"].includes(e.__config__.jnpfKey)))].map((e=>({value:e.id,label:e.id+"("+e.fullName+")"}))))),v=computed((()=>{const e=f.formConf.fileConfig.permissionType;return 2==e?"流程发起人可查看":3==e?"最后节点审批人可查看":"当前流程所有人可查看"}));function _(e){t.temporaryContent+="{"+e+"}",f.formConf.titleContent=t.temporaryContent}function h(){p(!0,{fileConfig:f.formConf.fileConfig})}function N(e){f.formConf.fileConfig=e||{}}function k(){f.formConf.fileConfig={on:!0,permissionType:1,path:"",pathName:"",templateId:""}}function y(){0==f.formConf.hasAloneConfigureForms&&f.updateAllNodeFormOperates(!0,!0)}function V(){0==f.formConf.hasComment&&(f.formConf.hasCommentDeletedTips=!1)}function B(){C(!0,{globalParameterList:f.formConf.globalParameterList||[],approvalFieldList:f.formConf.approvalFieldList||[]})}function x(e){f.formConf.globalParameterList=e.globalParameterList||[],f.formConf.approvalFieldList=e.approvalFieldList||[]}function T(e,o,t){if(!o)return f.formConf[e].msgId="",f.formConf[e].msgName="",void(f.formConf[e].templateJson=[]);f.formConf[e].msgId!==o&&(f.formConf[e].msgId=o,f.formConf[e].msgName=t.fullName,f.formConf[e].templateJson=t.templateJson||[])}function w(){c("updateConnectNameType",f.formConf)}return watch((()=>f.formConf),(()=>{f.updateJnpfData(f.formConf)}),{deep:!0,immediate:!0}),watch((()=>f.formConf.titleContent),(e=>{t.temporaryContent=e})),(o,t)=>{const c=resolveComponent("jnpf-radio"),f=resolveComponent("jnpf-input"),p=resolveComponent("a-auto-complete"),C=resolveComponent("a-form-item"),b=resolveComponent("a-checkbox"),F=resolveComponent("BasicHelp"),L=resolveComponent("a-radio"),U=resolveComponent("a-radio-group"),I=resolveComponent("jnpf-select"),S=resolveComponent("jnpf-user-select"),D=resolveComponent("a-button"),$=resolveComponent("jnpf-users-select"),O=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf},null,8,["formConf"]),createVNode(O,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[2!=e.type?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(C,{label:"实例标题"},{default:withCtx((()=>[createVNode(c,{value:e.formConf.titleType,"onUpdate:value":t[0]||(t[0]=o=>e.formConf.titleType=o),options:n},null,8,["value"]),0==e.formConf.titleType?(openBlock(),createBlock(f,{key:0,class:"!mt-12px",value:e.formConf.defaultContent,"onUpdate:value":t[1]||(t[1]=o=>e.formConf.defaultContent=o),readonly:""},null,8,["value"])):(openBlock(),createBlock(p,{key:1,class:"!mt-12px",value:e.formConf.titleContent,"onUpdate:value":t[2]||(t[2]=o=>e.formConf.titleContent=o),options:g.value,placeholder:"请输入",allowClear:"",onSelect:_},null,8,["value","options"]))])),_:1}),createVNode(C,{label:"流程设置"},{default:withCtx((()=>[createVNode(b,{checked:e.formConf.hasSign,"onUpdate:checked":t[3]||(t[3]=o=>e.formConf.hasSign=o)},{default:withCtx((()=>t[27]||(t[27]=[createTextVNode("启用签名")]))),_:1,__:[27]},8,["checked"]),createBaseVNode("div",_hoisted_1$q,[createVNode(b,{checked:e.formConf.hasRevoke,"onUpdate:checked":t[4]||(t[4]=o=>e.formConf.hasRevoke=o)},{default:withCtx((()=>t[28]||(t[28]=[createTextVNode("允许撤销")]))),_:1,__:[28]},8,["checked"])]),createBaseVNode("div",_hoisted_2$n,[createVNode(b,{checked:e.formConf.hasComment,"onUpdate:checked":t[5]||(t[5]=o=>e.formConf.hasComment=o),onChange:V},{default:withCtx((()=>t[29]||(t[29]=[createTextVNode("允许评论")]))),_:1,__:[29]},8,["checked"])]),e.formConf.hasComment?(openBlock(),createElementBlock("div",_hoisted_3$l,[createVNode(b,{checked:e.formConf.hasCommentDeletedTips,"onUpdate:checked":t[6]||(t[6]=o=>e.formConf.hasCommentDeletedTips=o)},{default:withCtx((()=>t[30]||(t[30]=[createTextVNode("显示评论已被删除提示")]))),_:1,__:[30]},8,["checked"])])):createCommentVNode("",!0),unref(d).getSysConfigInfo.flowSign?(openBlock(),createElementBlock("div",_hoisted_4$g,[createVNode(b,{checked:e.formConf.hasSignFor,"onUpdate:checked":t[7]||(t[7]=o=>e.formConf.hasSignFor=o)},{default:withCtx((()=>t[31]||(t[31]=[createTextVNode("审批任务是否签收")]))),_:1,__:[31]},8,["checked"])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_5$b,[createVNode(b,{checked:e.formConf.hasAloneConfigureForms,"onUpdate:checked":t[8]||(t[8]=o=>e.formConf.hasAloneConfigureForms=o),onChange:y},{default:withCtx((()=>t[32]||(t[32]=[createTextVNode("允许审批节点独立配置表单")]))),_:1,__:[32]},8,["checked"])]),createBaseVNode("div",_hoisted_6$b,[createVNode(b,{checked:e.formConf.hasContinueAfterReject,"onUpdate:checked":t[9]||(t[9]=o=>e.formConf.hasContinueAfterReject=o)},{default:withCtx((()=>[t[33]||(t[33]=createTextVNode(" 拒绝后允许流程继续流转审批")),createVNode(F,{text:["允许时：审批拒绝继续流转，直至流程结束，","以最后节点的审批为流程的最终审批结果。"]})])),_:1,__:[33]},8,["checked"])]),createBaseVNode("div",_hoisted_7$a,[createVNode(b,{checked:e.formConf.hasInitiatorPressOverdueNode,"onUpdate:checked":t[10]||(t[10]=o=>e.formConf.hasInitiatorPressOverdueNode=o)},{default:withCtx((()=>t[34]||(t[34]=[createTextVNode("允许发起人对当前逾期节点进行催办")]))),_:1,__:[34]},8,["checked"])]),createBaseVNode("div",_hoisted_8$a,[createVNode(b,{checked:e.formConf.isShowConditions,"onUpdate:checked":t[11]||(t[11]=o=>e.formConf.isShowConditions=o),onChange:w},{default:withCtx((()=>t[35]||(t[35]=[createTextVNode("允许连线显示条件")]))),_:1,__:[35]},8,["checked"])]),e.formConf.isShowConditions?(openBlock(),createBlock(U,{key:2,class:"mt-10px",value:e.formConf.showNameType,"onUpdate:value":t[12]||(t[12]=o=>e.formConf.showNameType=o),onChange:w},{default:withCtx((()=>[createVNode(L,{value:0},{default:withCtx((()=>t[36]||(t[36]=[createTextVNode("显示连线名称")]))),_:1,__:[36]}),createVNode(L,{value:1},{default:withCtx((()=>t[37]||(t[37]=[createTextVNode("显示条件内容")]))),_:1,__:[37]})])),_:1},8,["value"])):createCommentVNode("",!0)])),_:1}),createVNode(C,{label:"审批人自动审批规则"},{default:withCtx((()=>[createVNode(b,{checked:e.formConf.autoSubmitConfig.adjacentNodeApproverRepeated,"onUpdate:checked":t[13]||(t[13]=o=>e.formConf.autoSubmitConfig.adjacentNodeApproverRepeated=o)},{default:withCtx((()=>t[38]||(t[38]=[createTextVNode("相邻节点审批人重复")]))),_:1,__:[38]},8,["checked"]),createBaseVNode("div",_hoisted_9$9,[createVNode(b,{checked:e.formConf.autoSubmitConfig.ApproverHasApproval,"onUpdate:checked":t[14]||(t[14]=o=>e.formConf.autoSubmitConfig.ApproverHasApproval=o)},{default:withCtx((()=>t[39]||(t[39]=[createTextVNode("审批人审批过该流程")]))),_:1,__:[39]},8,["checked"])]),createBaseVNode("div",_hoisted_10$6,[createVNode(b,{checked:e.formConf.autoSubmitConfig.initiatorApproverRepeated,"onUpdate:checked":t[15]||(t[15]=o=>e.formConf.autoSubmitConfig.initiatorApproverRepeated=o)},{default:withCtx((()=>t[40]||(t[40]=[createTextVNode("发起人与审批人重复")]))),_:1,__:[40]},8,["checked"])])])),_:1}),createVNode(C,{label:"流程撤回规则"},{default:withCtx((()=>[createVNode(I,{value:e.formConf.recallRule,"onUpdate:value":t[16]||(t[16]=o=>e.formConf.recallRule=o),options:a},null,8,["value"])])),_:1}),createVNode(C,{label:"异常处理"},{label:withCtx((()=>[t[41]||(t[41]=createTextVNode("异常处理")),createVNode(F,{text:"子流程发起节点人员异常时遵循该规则"})])),default:withCtx((()=>[createVNode(I,{value:e.formConf.errorRule,"onUpdate:value":t[17]||(t[17]=o=>e.formConf.errorRule=o),options:unref(errorRuleOptions),onChange:t[18]||(t[18]=o=>e.formConf.errorRuleUser=[])},null,8,["value","options"]),2===e.formConf.errorRule?(openBlock(),createBlock(S,{key:0,value:e.formConf.errorRuleUser,"onUpdate:value":t[19]||(t[19]=o=>e.formConf.errorRuleUser=o),buttonType:"button",multiple:"",class:"mt-10px"},null,8,["value"])):createCommentVNode("",!0)])),_:1}),createVNode(C,{label:"流程归档"},{default:withCtx((()=>[createVNode(b,{class:"leading-32px",checked:e.formConf.fileConfig.on,"onUpdate:checked":t[20]||(t[20]=o=>e.formConf.fileConfig.on=o)},{default:withCtx((()=>t[42]||(t[42]=[createTextVNode("开启归档（流程审批结束后自动归档）")]))),_:1,__:[42]},8,["checked"]),e.formConf.fileConfig.on?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",_hoisted_11$5,[createVNode(D,{onClick:h},{default:withCtx((()=>t[43]||(t[43]=[createTextVNode("归档设置")]))),_:1,__:[43]})]),e.formConf.fileConfig.templateId?(openBlock(),createElementBlock("div",_hoisted_12$3,[createBaseVNode("span",null,toDisplayString(v.value),1),createBaseVNode("i",{class:"icon-ym icon-ym-delete",onClick:k})])):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1}),createVNode(C,{label:"全局设置"},{default:withCtx((()=>[createVNode(D,{class:"w-full",onClick:B},{default:withCtx((()=>t[44]||(t[44]=[createTextVNode("设置")]))),_:1,__:[44]})])),_:1})],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(C,{label:"通知人"},{default:withCtx((()=>[createVNode(I,{value:e.formConf.msgUserType,"onUpdate:value":t[21]||(t[21]=o=>e.formConf.msgUserType=o),options:l,multiple:""},null,8,["value"])])),_:1}),e.formConf.msgUserType?.includes(3)?(openBlock(),createBlock(C,{key:0},{default:withCtx((()=>[t[45]||(t[45]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"选择用户")],-1)),createVNode($,{value:e.formConf.msgUserIds,"onUpdate:value":t[22]||(t[22]=o=>e.formConf.msgUserIds=o),multiple:""},null,8,["value"])])),_:1,__:[45]})):createCommentVNode("",!0),createVNode(C,null,{label:withCtx((()=>[t[46]||(t[46]=createTextVNode("执行失败")),createVNode(F,{text:"执行失败时发送通知！"})])),default:withCtx((()=>[createVNode(I,{value:e.formConf.failMsgConfig.on,"onUpdate:value":t[23]||(t[23]=o=>e.formConf.failMsgConfig.on=o),options:r},null,8,["value"])])),_:1}),1===e.formConf?.failMsgConfig?.on?(openBlock(),createBlock(C,{key:1},{default:withCtx((()=>[t[47]||(t[47]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"发送配置")],-1)),createVNode(_sfc_main$y,{value:e.formConf.failMsgConfig.msgId,title:e.formConf.failMsgConfig.msgName,messageSource:"3",onChange:t[24]||(t[24]=(e,o)=>T(i,e,o))},null,8,["value","title"])])),_:1,__:[47]})):createCommentVNode("",!0),createVNode(C,null,{label:withCtx((()=>[t[48]||(t[48]=createTextVNode("开始执行")),createVNode(F,{text:"开始执行时发送通知！"})])),default:withCtx((()=>[createVNode(I,{value:e.formConf.startMsgConfig.on,"onUpdate:value":t[25]||(t[25]=o=>e.formConf.startMsgConfig.on=o),options:r},null,8,["value"])])),_:1}),1===e.formConf?.startMsgConfig?.on?(openBlock(),createBlock(C,{key:2},{default:withCtx((()=>[t[49]||(t[49]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"发送配置")],-1)),createVNode(_sfc_main$y,{value:e.formConf.startMsgConfig.msgId,title:e.formConf.startMsgConfig.msgName,messageSource:"3",onChange:t[26]||(t[26]=(e,o)=>T(s,e,o))},null,8,["value","title"])])),_:1,__:[49]})):createCommentVNode("",!0)],64))])),_:1},8,["model"]),createVNode(_sfc_main$w,{onRegister:unref(m),onConfirm:N},null,8,["onRegister"]),createVNode(_sfc_main$v,{onRegister:unref(u),onConfirm:x},null,8,["onRegister"])],64)}}}),_hoisted_1$p=["title","onClick"],_hoisted_2$m=["title"],_sfc_main$t=defineComponent({__name:"NoticeConfig",props:["noticeConfig","funcOptions","type","isApprover"],setup(e){const o=e,t=[{title:"模板名称",dataIndex:"msgTemplateName",key:"msgTemplateName",width:170},{title:"参数名称",dataIndex:"paramJson",key:"paramJson",width:150},{title:"表单字段",dataIndex:"field",key:"field",width:150}],[n,{openModal:a}]=useModal(),l=computed((()=>{let e={title:"流程待办",help:"流程处于等待的时候"};const t=o.isApprover?"当前":"所有";return"end"==o.type&&(e.title="流程结束",e.help="流程结束的时候"),"comment"==o.type&&(e.title="流程评论",e.help="流程评论发送通知方式"),"approve"==o.type&&(e.title="节点同意",e.help=t+"节点审核人同意的时候"),"reject"==o.type&&(e.title="节点拒绝",e.help=t+"节点审核人拒绝的时候"),"back"==o.type&&(e.title="节点退回",e.help=t+"节点审核人退回的时候"),"copy"==o.type&&(e.title="节点抄送",e.help=t+"节点抄送的时候"),"overTime"==o.type&&(e.title="节点超时",e.help=t+"节点超时的时候"),"notice"==o.type&&(e.title="节点提醒",e.help=t+"节点提醒的时候"),"launch"==o.type&&(e.title="节点提醒",e.help=t+"节点提醒的时候"),e}));function r(e,t){if(!e)return o.noticeConfig.msgId="",o.noticeConfig.msgName="",void(o.noticeConfig.templateJson=[]);o.noticeConfig.msgId!==e&&(o.noticeConfig.msgId=e,o.noticeConfig.msgName=t.fullName,o.noticeConfig.templateJson=t.templateJson||[])}return(i,s)=>{const c=resolveComponent("BasicHelp"),d=resolveComponent("jnpf-select"),f=resolveComponent("a-form-item"),m=resolveComponent("a-table");return openBlock(),createElementBlock(Fragment,null,[createVNode(f,null,{label:withCtx((()=>[createTextVNode(toDisplayString(l.value.title),1),createVNode(c,{text:l.value.help},null,8,["text"])])),default:withCtx((()=>[createVNode(d,{value:e.noticeConfig.on,"onUpdate:value":s[0]||(s[0]=o=>e.noticeConfig.on=o),options:e.isApprover?unref(nodeNoticeOptions):unref(noticeOptions)},null,8,["value","options"])])),_:1}),1===e.noticeConfig.on?(openBlock(),createBlock(f,{key:0,class:"notice-config"},{default:withCtx((()=>[s[2]||(s[2]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"发送配置")],-1)),createVNode(_sfc_main$y,{value:e.noticeConfig.msgId,title:e.noticeConfig.msgName,onChange:r},null,8,["value","title"]),s[3]||(s[3]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"参数设置")],-1)),createVNode(m,{"data-source":e.noticeConfig.templateJson,columns:t,size:"small",pagination:!1},{bodyCell:withCtx((({column:t,record:n})=>["msgTemplateName"===t.key?(openBlock(),createElementBlock("p",{key:0,class:"link-text",title:n.msgTemplateName,onClick:e=>{return o=n.templateId,void a(!0,{id:o});var o}},toDisplayString(n.msgTemplateName),9,_hoisted_1$p)):createCommentVNode("",!0),"paramJson"===t.key?(openBlock(!0),createElementBlock(Fragment,{key:1},renderList(n.paramJson,((e,o)=>(openBlock(),createElementBlock("div",{class:"parameter-box",title:e.field+"("+e.fieldName+")",key:o},toDisplayString(e.field)+"("+toDisplayString(e.fieldName)+") ",9,_hoisted_2$m)))),128)):createCommentVNode("",!0),"field"===t.key?(openBlock(!0),createElementBlock(Fragment,{key:2},renderList(n.paramJson,((t,n)=>(openBlock(),createBlock(d,{value:t.relationField,"onUpdate:value":e=>t.relationField=e,options:e.funcOptions,allowClear:"",showSearch:"",fieldNames:{label:"label",options:"options1"},optionLabelProp:"label",class:normalizeClass(["!w-150px",{"!mt-8px":n>0}]),onChange:e=>function(e,t){if(!e)return;let n=o.funcOptions.filter((o=>o.id===e));if(!n.length)return;let a=n[0];t.isSubTable=!(!a.__config__||!a.__config__.isSubTable)&&a.__config__.isSubTable}(e,t),key:n},null,8,["value","onUpdate:value","options","class","onChange"])))),128)):createCommentVNode("",!0)])),emptyText:withCtx((()=>s[1]||(s[1]=[createBaseVNode("p",{class:"leading-60px"},"暂无数据",-1)]))),_:1},8,["data-source"])])),_:1,__:[2,3]})):createCommentVNode("",!0),createVNode(MsgTemplateDetail,{onRegister:unref(n)},null,8,["onRegister"])],64)}}}),_hoisted_1$o={class:"common-container"},_hoisted_2$l={class:"jnpf-content-wrapper"},_hoisted_3$k={class:"jnpf-content-wrapper-center"},_hoisted_4$f={class:"jnpf-content-wrapper-content"},_sfc_main$s=defineComponent({inheritAttrs:!1,__name:"FlowFormModal",props:{value:{default:""},title:{type:String,default:""},placeholder:{type:String,default:"请选择"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!0},size:{type:String,default:"default"},isStartForm:{type:Number,default:0},type:{type:String,default:""}},emits:["update:value","change"],setup(e,{emit:o}){const t=e,n=o,a=Form.useInjectFormItemContext(),{t:l}=useI18n(),r=ref(void 0),i=ref(!1),s=ref([]),c=computed((()=>[{title:"表单名称",dataIndex:"fullName"},{title:"表单编码",dataIndex:"enCode"},{title:"表单类型",dataIndex:"type",width:100,customRender:({record:e})=>1==e.type?"在线开发":"系统导入"}])),[d,{getForm:f,getSelectRows:m,setSelectedRowKeys:p,getSelectRowKeys:u}]=useTable({api:getVisualDevFormList,columns:c,immediate:!1,useSearchForm:!0,formConfig:{baseColProps:{span:8},schemas:[{field:"keyword",label:l("common.keyword"),component:"Input",componentProps:{placeholder:l("common.enterKeyword"),submitOnPressEnter:!0}}]},tableSetting:{size:!1,setting:!1},isCanResizeParent:!0,resizeHeightOffset:-74,rowSelection:{type:"radio",getCheckboxProps:e=>({disabled:!!e.isQuote})}}),C=computed((()=>({isRelease:"1,2",webType:2,flowStart:!!t.isStartForm,type:t.type||""}))),g=computed((()=>({...pick(t,["disabled","size","allowClear","placeholder"]),fieldNames:{label:"fullName",value:"id"},open:!1,showSearch:!1,showArrow:!0})));function v(){s.value=[],n("change","",{})}async function _(){t.disabled||(i.value=!0,nextTick((()=>{f().resetFields(),p(r.value?[r.value]:[])})))}function h(){i.value=!1}function N(){if(!u().length&&!m().length)return;if(!m().length)return n("update:value",r.value),n("change",r.value,s.value[0]),a.onFieldChange(),void h();const e=m()[0];s.value=m(),r.value=e.id,n("update:value",e.id),n("change",e.id,e),a.onFieldChange(),h()}return watch((()=>t.value),(e=>{var o;o=e,r.value=o||void 0,s.value=[{id:r.value,fullName:t.title}]}),{immediate:!0}),(e,o)=>{const t=resolveComponent("a-select");return openBlock(),createElementBlock("div",_hoisted_1$o,[createVNode(t,mergeProps({value:r.value,"onUpdate:value":o[0]||(o[0]=e=>r.value=e)},g.value,{options:s.value,onChange:v,onClick:_}),null,16,["value","options"]),createVNode(unref(Modal),{open:i.value,"onUpdate:open":o[1]||(o[1]=e=>i.value=e),title:"表单选择",width:800,class:"common-container-modal",onOk:N,onCancel:h,maskClosable:!1},{closeIcon:withCtx((()=>[createVNode(ModalClose,{canFullscreen:!1,onCancel:h})])),default:withCtx((()=>[createBaseVNode("div",_hoisted_2$l,[createBaseVNode("div",_hoisted_3$k,[createBaseVNode("div",_hoisted_4$f,[createVNode(unref(BasicTable),{onRegister:unref(d),searchInfo:C.value,class:"jnpf-sub-table"},null,8,["onRegister","searchInfo"])])])])])),_:1},8,["open"])])}}}),formulaData=[{id:"maths",fullName:"数学函数",desc:"",children:[{id:"SUM",fullName:"SUM",desc:'<ul class="formula-desc-wrapper">\n        <li><span class="formula-name">SUM</span>函数可以获取一组数值的总和</li>\n        <li>用法：<span class="formula-name">SUM</span>(数值1,数值2,...)</li>\n        <li>示例：<span class="formula-name">SUM</span>(语文成绩，数学成绩)返回两门课程总分</li>\n        </ul>'},{id:"SUBTRACT",fullName:"SUBTRACT",desc:'<ul class="formula-desc-wrapper">\n        <li><span class="formula-name">SUBTRACT</span>函数可以返回数值相减</li>\n        <li>用法：<span class="formula-name">SUBTRACT</span>(被减数,减数)</li>\n        <li>示例：<span class="formula-name">SUBTRACT</span>(总收入，总支出)返回收支总利润</li>\n        </ul>'},{id:"PRODUCT",fullName:"PRODUCT",desc:'<ul class="formula-desc-wrapper">\n        <li><span class="formula-name">PRODUCT</span>函数可以获取一组数值的乘积</li>\n        <li>用法：<span class="formula-name">PRODUCT</span>(数值1,数值2,...)</li>\n        <li>示例：<span class="formula-name">PRODUCT</span>(单价，数量)获取总价，即单价和数量的乘积</li>\n        </ul>'},{id:"DIVIDE",fullName:"DIVIDE",desc:'<ul class="formula-desc-wrapper">\n        <li><span class="formula-name">DIVIDE</span>函数可以返回数值相除</li>\n        <li>用法：<span class="formula-name">DIVIDE</span>(被除数,除数)</li>\n        <li>示例：<span class="formula-name">DIVIDE</span>(总价，单价)获取数量，即总价除单价</li>\n        </ul>'},{id:"COUNT",fullName:"COUNT",desc:'<ul class="formula-desc-wrapper">\n        <li><span class="formula-name">COUNT</span>函数可以获取参数的数量</li>\n        <li>用法：<span class="formula-name">COUNT</span>(值,值,...)</li>\n        <li>示例：<span class="formula-name">COUNT</span>(小王,小李)返回2,即人员数量</li>\n        </ul>'}]}],formulaData$1=formulaData,_hoisted_1$n={class:"formula-modal-body"},_hoisted_2$k={class:"code-editor-area"},_hoisted_3$j={class:"operation-area"},_hoisted_4$e={class:"area-item field-area"},_hoisted_5$a={class:"area-content"},_hoisted_6$a={class:"area-item formula-area"},_hoisted_7$9={class:"area-content"},_hoisted_8$9=["onMouseenter"],_hoisted_9$8={class:"area-item formula-desc-area"},_hoisted_10$5={class:"area-title"},_hoisted_11$4=["innerHTML"],_sfc_main$r=defineComponent({__name:"FormulaModal",emits:["register","confirm"],setup(e,{emit:o}){const t=o,[n,{closeModal:a}]=useModalInner((function(e){i.value=e.value,s.value=e.fieldsOptions})),l=ref(null),r=ref(null),i=ref(""),s=ref([]),c=ref(formulaData$1),d=ref(MODE.JS),f=ref(""),m=ref("请从左侧面板选择字段名和函数");function p(e){e.length&&l.value?.insert("{"+e[0]+"}")}function u(e){e.length&&"maths"!=e[0]&&l.value?.insert(e[0]+"()",!0)}function C(){t("confirm",i.value),a()}return(e,o)=>(openBlock(),createBlock(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(n),title:"公式编辑",width:800,onOk:C,destroyOnClose:"",class:"formula-modal"}),{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$n,[createBaseVNode("div",_hoisted_2$k,[createVNode(unref(CodeEditor),{ref_key:"editorRef",ref:l,value:i.value,"onUpdate:value":o[0]||(o[0]=e=>i.value=e),mode:d.value,class:"json-editor"},null,8,["value","mode"])]),createBaseVNode("div",_hoisted_3$j,[createBaseVNode("div",_hoisted_4$e,[o[1]||(o[1]=createBaseVNode("div",{class:"area-title"},"当前表单字段",-1)),createBaseVNode("div",_hoisted_5$a,[createVNode(unref(_sfc_main$z),{ref_key:"leftTreeRef",ref:r,class:"remove-active-tree",treeData:s.value,defaultExpandAll:"",onSelect:p},null,8,["treeData"])])]),createBaseVNode("div",_hoisted_6$a,[o[2]||(o[2]=createBaseVNode("div",{class:"area-title"},"函数",-1)),createBaseVNode("div",_hoisted_7$9,[createVNode(unref(_sfc_main$z),{ref_key:"leftTreeRef",ref:r,class:"remove-active-tree",treeData:c.value,defaultExpandAll:"",onSelect:u},{title:withCtx((e=>[createBaseVNode("div",{class:"w-full",onMouseenter:o=>function(e){e.desc&&(m.value=e.desc,f.value=e.id)}(e)},toDisplayString(e.fullName),41,_hoisted_8$9)])),_:1},8,["treeData"])])]),createBaseVNode("div",_hoisted_9$8,[createBaseVNode("div",_hoisted_10$5,toDisplayString(f.value),1),createBaseVNode("div",{class:"area-content",innerHTML:m.value},null,8,_hoisted_11$4)])])])])),_:1},16,["onRegister"]))}}),_hoisted_1$m={class:"condition-main"},_hoisted_2$j={key:0,class:"mb-10px"},_hoisted_3$i={class:"condition-item-title"},_hoisted_4$d=["onClick"],_hoisted_5$9={class:"condition-item-content"},_hoisted_6$9={class:"condition-item-cap"},_hoisted_7$8={key:1,class:"flex-1 w-150px"},_hoisted_8$8=["onClick"],_hoisted_9$7=["onClick"],_sfc_main$q=defineComponent({inheritAttrs:!1,__name:"ConditionModal",emits:["register","confirm"],setup(e,{emit:o}){const t=reactive({conditions:[],formFieldsOptions:[],usedFormItems:[],matchLogic:"and",activeIndex:0,activeChildIndex:0}),{conditions:n,usedFormItems:a,matchLogic:l}=toRefs(t),r={fieldName:"",symbolName:"",fieldValue:void 0,fieldType:1,fieldValueType:2,fieldLabel:"",fieldValueJnpfKey:"",logicName:"并且",field:"",symbol:"",logic:"&&",jnpfKey:"",cellKey:+new Date},i={logic:"and",groups:[r]},s=o,{createMessage:c}=useMessage(),d=inject("bpmn"),[f,{closeModal:m}]=useModalInner((function(e){t.usedFormItems=e.usedFormItems||[],t.formFieldsOptions=e.formFieldsOptions||[],t.matchLogic=cloneDeep(e.matchLogic)||"and",t.conditions=cloneDeep(e.conditions)||[],t.conditions.length||h()})),[p,{openModal:u}]=useModal(),C=computed((()=>d())),g=computed((()=>{const e=unref(C).get("jnpfData");return e?.getValue("global")||{}})),v=computed((()=>systemFieldOptions.map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id}))))),_=computed((()=>unref(g).globalParameterList||[]));function h(){t.conditions.push(cloneDeep(i))}function N(e){t.conditions.splice(e,1)}function k(e){t.conditions[t.activeIndex].groups[t.activeChildIndex].field=e,t.conditions[t.activeIndex].groups[t.activeChildIndex].fieldName=e}function y(e){e.fieldName="",e.jnpfKey="",2==e.fieldValueType&&(e.fieldValue=void 0,e.fieldLabel="",e.fieldValueJnpfKey="")}function V(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.fullName||""}function B(){if(!t.conditions.length)return c.warning("请设置条件组");if(!function(){let e=!0;for(let o=0;o<t.conditions.length;o++){const n=t.conditions[o];for(let o=0;o<n.groups.length;o++){const t=n.groups[o];if(!t.field)return c.warning(1==t.fieldType?"条件字段不能为空":"条件公式不能为空"),void(e=!1);if(!t.symbol)return c.warning("条件符号不能为空"),void(e=!1);if(!["null","notNull"].includes(t.symbol)&&(!t.fieldValue&&0!==t.fieldValue||isEmpty(t.fieldValue)))return c.warning("数据值不能为空"),void(e=!1)}}return e}())return!1;const e={matchLogic:t.matchLogic,conditions:cloneDeep(t.conditions)};s("confirm",e),m()}return(e,o)=>{const i=resolveComponent("jnpf-radio"),s=resolveComponent("jnpf-select"),c=resolveComponent("a-col"),d=resolveComponent("a-button"),m=resolveComponent("a-input-number"),C=resolveComponent("jnpf-switch"),g=resolveComponent("jnpf-time-picker"),x=resolveComponent("jnpf-date-picker"),T=resolveComponent("jnpf-organize-select"),w=resolveComponent("jnpf-dep-select"),b=resolveComponent("jnpf-role-select"),F=resolveComponent("jnpf-group-select"),L=resolveComponent("jnpf-pos-select"),U=resolveComponent("jnpf-user-select"),I=resolveComponent("jnpf-users-select"),S=resolveComponent("jnpf-area-select"),D=resolveComponent("a-input"),$=resolveComponent("a-row");return openBlock(),createElementBlock(Fragment,null,[createVNode(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(f),title:"设置条件",width:800,onOk:B,destroyOnClose:"",class:"jnpf-condition-modal"}),{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$m,[unref(n)?.length?(openBlock(),createElementBlock("div",_hoisted_2$j,[createVNode(i,{value:unref(l),"onUpdate:value":o[0]||(o[0]=e=>isRef(l)?l.value=e:null),options:unref(logicOptions),optionType:"button","button-style":"solid"},null,8,["value","options"])])):createCommentVNode("",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(n),((e,n)=>(openBlock(),createElementBlock("div",{class:"condition-item",key:n},[createBaseVNode("div",_hoisted_3$i,[o[2]||(o[2]=createBaseVNode("div",null,"条件组",-1)),createBaseVNode("i",{class:"icon-ym icon-ym-nav-close",onClick:e=>N(n)},null,8,_hoisted_4$d)]),createBaseVNode("div",_hoisted_5$9,[createBaseVNode("div",_hoisted_6$9,[o[3]||(o[3]=createTextVNode(" 以下条件全部执行： ")),createVNode(i,{value:e.logic,"onUpdate:value":o=>e.logic=o,options:unref(logicOptions),optionType:"button","button-style":"solid",size:"small"},null,8,["value","onUpdate:value","options"])]),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.groups,((e,l)=>(openBlock(),createBlock($,{gutter:8,key:n+l,class:"mb-10px"},{default:withCtx((()=>[createVNode(c,{span:3,class:"!flex items-center"},{default:withCtx((()=>[createVNode(s,{value:e.fieldType,"onUpdate:value":o=>e.fieldType=o,options:unref(conditionTypeOptions),onChange:o=>function(e){e.field="",y(e)}(e)},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1024),createVNode(c,{span:5,class:"!flex items-center"},{default:withCtx((()=>[1===e.fieldType?(openBlock(),createBlock(s,{key:0,value:e.field,"onUpdate:value":o=>e.field=o,options:unref(a),allowClear:"",showSearch:"",fieldNames:{options:"options1"},class:"!flex-1",onChange:(o,a)=>function(e,o,n,a,l){if(!o)return y(e);e.fieldName=n.__config__.label,e.jnpfKey=n.__config__.jnpfKey;const i=cloneDeep(r);for(let t of Object.keys(i))i[t]=e[t];2==(e={...i,...n}).fieldValueType&&(e.fieldValue=void 0,e.fieldLabel="",e.fieldValueJnpfKey=""),t.conditions[a].groups[l]=e}(e,o,a,n,l)},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0),3===e.fieldType?(openBlock(),createBlock(d,{key:1,onClick:o=>function(e,o,n){t.activeIndex=o,t.activeChildIndex=n,u(!0,{value:e.field,fieldsOptions:t.formFieldsOptions})}(e,n,l),class:"!flex-1"},{default:withCtx((()=>o[4]||(o[4]=[createTextVNode("公式编辑")]))),_:2,__:[4]},1032,["onClick"])):createCommentVNode("",!0)])),_:2},1024),createVNode(c,{span:4},{default:withCtx((()=>[createVNode(s,{class:"w-full",value:e.symbol,"onUpdate:value":o=>e.symbol=o,options:unref(symbolOptions),onChange:(o,t)=>function(e,o,t){e.symbolName=o?t.fullName:""}(e,o,t)},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1024),createVNode(c,{span:4},{default:withCtx((()=>[createVNode(s,{value:e.fieldValueType,"onUpdate:value":o=>e.fieldValueType=o,options:unref(conditionTypeOptions1),onChange:o=>function(e){e.fieldValue="",e.fieldLabel="",e.fieldValueJnpfKey=""}(e)},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1024),createVNode(c,{span:7,class:"!flex items-center"},{default:withCtx((()=>[1===e.fieldValueType?(openBlock(),createBlock(s,{key:0,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,options:unref(a),allowClear:"",showSearch:"",fieldNames:{options:"options1"},class:"flex-1",onChange:(o,t)=>function(e,o,t){e.fieldLabel=o?t.fullName:"",e.fieldValueJnpfKey=o?t.__config__.jnpfKey:""}(e,o,t)},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0),2===e.fieldValueType?(openBlock(),createElementBlock("div",_hoisted_7$8,["inputNumber"===e.jnpfKey?(openBlock(),createBlock(m,{key:0,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,placeholder:"请输入",precision:e.precision},null,8,["value","onUpdate:value","precision"])):"calculate"===e.jnpfKey?(openBlock(),createBlock(m,{key:1,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,placeholder:"请输入",precision:2},null,8,["value","onUpdate:value"])):["rate","slider"].includes(e.jnpfKey)?(openBlock(),createBlock(m,{key:2,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,placeholder:"请输入"},null,8,["value","onUpdate:value"])):"switch"===e.jnpfKey?(openBlock(),createBlock(C,{key:3,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o},null,8,["value","onUpdate:value"])):"timePicker"===e.jnpfKey?(openBlock(),createBlock(g,{key:4,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,format:e.format||"HH:mm:ss",allowClear:""},null,8,["value","onUpdate:value","format"])):["datePicker","createTime","modifyTime"].includes(e.jnpfKey)?(openBlock(),createBlock(x,{key:5,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,format:e.format||"YYYY-MM-DD HH:mm:ss",allowClear:"",onChange:o=>function(e,o){if(!e)return o.fieldLabel="";const t=o.format||"YYYY-MM-DD HH:mm:ss";o.fieldLabel=formatToDateTime(e,t)}(o,e)},null,8,["value","onUpdate:value","format","onChange"])):["organizeSelect","currOrganize"].includes(e.jnpfKey)?(openBlock(),createBlock(T,{key:6,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,allowClear:"",onChange:(o,t)=>function(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.organize||""}(e,o,t)},null,8,["value","onUpdate:value","onChange"])):["depSelect"].includes(e.jnpfKey)?(openBlock(),createBlock(w,{key:7,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,allowClear:"",onChange:(o,t)=>V(e,o,t)},null,8,["value","onUpdate:value","onChange"])):"roleSelect"===e.jnpfKey?(openBlock(),createBlock(b,{key:8,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,allowClear:"",onChange:(o,t)=>V(e,o,t)},null,8,["value","onUpdate:value","onChange"])):"groupSelect"===e.jnpfKey?(openBlock(),createBlock(F,{key:9,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,allowClear:"",onChange:(o,t)=>V(e,o,t)},null,8,["value","onUpdate:value","onChange"])):["posSelect","currPosition"].includes(e.jnpfKey)?(openBlock(),createBlock(L,{key:10,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,allowClear:"",onChange:(o,t)=>V(e,o,t)},null,8,["value","onUpdate:value","onChange"])):["userSelect","createUser","modifyUser"].includes(e.jnpfKey)?(openBlock(),createBlock(U,{key:11,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,hasSys:"",allowClear:"",onChange:(o,t)=>V(e,o,t)},null,8,["value","onUpdate:value","onChange"])):["usersSelect"].includes(e.jnpfKey)?(openBlock(),createBlock(I,{key:12,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,allowClear:"",onChange:(o,t)=>V(e,o,t)},null,8,["value","onUpdate:value","onChange"])):"areaSelect"===e.jnpfKey?(openBlock(),createBlock(S,{key:13,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,level:e.level,allowClear:"",onChange:(o,t)=>function(e,o,t){if(!o)return e.fieldLabel="";const n=t.map((e=>e.fullName));e.fieldLabel=n.join("/")}(e,o,t)},null,8,["value","onUpdate:value","level","onChange"])):(openBlock(),createBlock(D,{key:14,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"]))])):3===e.fieldValueType?(openBlock(),createBlock(s,{key:2,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,options:v.value,fieldNames:{label:"label",options:"options1"},allowClear:"",class:"!w-204px"},null,8,["value","onUpdate:value","options"])):4===e.fieldValueType?(openBlock(),createBlock(s,{key:3,value:e.fieldValue,"onUpdate:value":o=>e.fieldValue=o,options:_.value,fieldNames:{label:"fieldName",value:"fieldName",options:"options1"},allowClear:"",onChange:(o,t)=>function(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.fieldName||""}(e,o,t)},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0)])),_:2},1024),createVNode(c,{span:1,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e,o){t.conditions[e].groups.splice(o,1),t.conditions[e].groups.length||N(e)}(n,l)},null,8,_hoisted_8$8)])),_:2},1024)])),_:2},1024)))),128)),createBaseVNode("span",{class:"link-text inline-block",onClick:e=>function(e){t.conditions[e].groups.push(cloneDeep(r))}(n)},o[5]||(o[5]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加条件")]),8,_hoisted_9$7)])])))),128)),createBaseVNode("span",{class:"link-text inline-block",onClick:o[1]||(o[1]=e=>h())},o[6]||(o[6]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加条件组")]))])])),_:1},16,["onRegister"]),createVNode(_sfc_main$r,{onRegister:unref(p),onConfirm:k},null,8,["onRegister"])],64)}}}),_hoisted_1$l={key:0,class:"conditions-content"},_hoisted_2$i={class:"flex items-center"},_hoisted_3$h={class:"countersign-cell mt-12px"},_hoisted_4$c={class:"countersign-cell"},_hoisted_5$8={class:"countersign-cell mt-12px"},_hoisted_6$8={key:1,class:"countersign-cell mt-12px"},_hoisted_7$7={class:"countersign-cell"},_hoisted_8$7={class:"countersign-cell mt-12px"},_hoisted_9$6={key:1,class:"countersign-cell"},_hoisted_10$4={key:2,class:"countersign-cell"},_sfc_main$p=defineComponent({inheritAttrs:!1,__name:"StartNode",props:["printTplOptions","noticeOptions","formConf","getFormFieldList","updateJnpfData","initFormOperates","updateAllNodeFormOperates","usedFormItems","formFieldsOptions","flowState","versionList","type","funcOptions","updateFormFieldList","updateBpmnProperties"],emits:["updateGlobalFormId","updateDivideRule"],setup(e,{expose:o,emit:t}){const n=reactive({activeKey:1,readAllChecked:!1,writeAllChecked:!1,requiredAllChecked:!1,isReadIndeterminate:!1,isWriteIndeterminate:!1,isRequiredIndeterminate:!1,formLoading:!1});o({updateCheckStatus:k});const a=t,l=e,{activeKey:r,readAllChecked:i,writeAllChecked:s,requiredAllChecked:c,isReadIndeterminate:d,isWriteIndeterminate:f,isRequiredIndeterminate:m,formLoading:p}=toRefs(n),[u,{openModal:C}]=useModal(),g=[{title:"表单字段",dataIndex:"name",key:"name"},{title:"操作",dataIndex:"write",key:"write",align:"center",width:200}],v=computed((()=>NodeUtils.getConditionsContent(l.formConf.printConfig.conditions,l.formConf.printConfig.matchLogic)));function _(e,o){if(l.updateBpmnProperties("elementBodyName",o.fullName),a("updateGlobalFormId",e,o.fullName),!e)return l.formConf.formId="",l.formConf.formName="",l.updateFormFieldList([]),l.formConf.formOperates=l.initFormOperates(l.formConf,!0),void l.updateAllNodeFormOperates();const t=l.formConf.formId===e;l.formConf.formId=e,l.formConf.formName=o.fullName,l.getFormFieldList(e,"startForm",t)}function h(e,o){const t=e.target.checked;1==o&&(n.isReadIndeterminate=!1),2==o&&(n.isWriteIndeterminate=!1),3==o&&(n.isRequiredIndeterminate=!1),l.formConf.formOperates.forEach((e=>{1==o&&(e.read=t),2==o&&(e.write=t),3!=o||e.requiredDisabled||(e.required=t)}))}function N(){k()}function k(){const e=l.formConf.formOperates.length,o=l.formConf.formOperates.filter((e=>!e.requiredDisabled)).length;let t=0,a=0,r=0;l.formConf.formOperates.forEach((e=>{e.read&&t++,e.write&&a++,e.required&&r++})),n.readAllChecked=!!e&&e===t,n.writeAllChecked=!!e&&e===a,n.requiredAllChecked=!!e&&o===r,n.isReadIndeterminate=!!t&&t<e,n.isWriteIndeterminate=!!a&&a<e,n.isRequiredIndeterminate=!!r&&r<o}function y(){C(!0,{usedFormItems:l.usedFormItems,formFieldsOptions:l.formFieldsOptions,...l.formConf.printConfig})}function V(e){l.formConf.printConfig={...l.formConf.printConfig,...e}}function B(){l.formConf.printConfig.matchLogic="and",l.formConf.printConfig.conditions=[]}function x(e){0==e&&(l.formConf.overTimeConfig.on=0)}function T(e,o,t){if(!o)return l.formConf[e].interfaceId="",l.formConf[e].interfaceName="",void(l.formConf[e].templateJson=[]);l.formConf[e].interfaceId!==o&&(l.formConf[e].interfaceId=o,l.formConf[e].interfaceName=t.fullName,l.formConf[e].templateJson=t.templateJson.map((e=>({...e,relationField:"",sourceType:1})))||[])}function w(e,o){if(!e)return;let t=l.funcOptions.filter((o=>o.id===e));if(!t.length)return;let n=t[0];o.isSubTable=!(!n.__config__||!n.__config__.isSubTable)&&n.__config__.isSubTable}function b(){1!=n.formLoading&&(n.formLoading=!0,l.getFormFieldList(l.formConf.formId,"startForm",!0).then((()=>{n.formLoading=!1})).catch((()=>{n.formLoading=!1})))}function F(e,o,t){let n=o.split("."),a=l.formConf;for(;n.length>1;){a=a[n.shift()]}a[n[0]]=e||t}return watch((()=>n.activeKey),(e=>{2===e&&k()})),watch((()=>l.formConf),(()=>l.updateJnpfData()),{deep:!0,immediate:!0}),(o,t)=>{const n=resolveComponent("a-tab-pane"),C=resolveComponent("a-tabs"),k=resolveComponent("a-button"),L=resolveComponent("a-tooltip"),U=resolveComponent("a-form-item"),I=resolveComponent("jnpf-select"),S=resolveComponent("a-checkbox"),D=resolveComponent("jnpf-tree-select"),$=resolveComponent("a-switch"),O=resolveComponent("a-alert"),j=resolveComponent("a-input-number"),R=resolveComponent("BasicHelp"),A=resolveComponent("a-row"),M=resolveComponent("a-form"),E=resolveComponent("a-table");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:t[0]||(t[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(C,{activeKey:unref(r),"onUpdate:activeKey":t[1]||(t[1]=e=>isRef(r)?r.value=e:null),size:"small",class:"pane-tabs"},{default:withCtx((()=>[(openBlock(),createBlock(n,{key:1,tab:"基础信息"})),(openBlock(),createBlock(n,{key:2,tab:"表单权限"})),(openBlock(),createBlock(n,{key:3,tab:"流程事件"})),(openBlock(),createBlock(n,{key:4,tab:"流程通知"})),(openBlock(),createBlock(n,{key:5,tab:"超时设置"}))])),_:1},8,["activeKey"]),2!==unref(r)?(openBlock(),createBlock(M,{key:0,colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[1===unref(r)?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(U,{label:"流程表单",class:"form-item-reload"},{default:withCtx((()=>[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,isStartForm:1,onChange:_,disabled:0!=e.flowState||e.versionList.length>1},null,8,["value","title","disabled"]),0==e.flowState&&e.formConf.formId?(openBlock(),createBlock(L,{key:0,title:"刷新表单"},{default:withCtx((()=>[createVNode(k,{onClick:b},{default:withCtx((()=>[createVNode(unref(ReloadOutlined),{spin:unref(p)},null,8,["spin"])])),_:1})])),_:1})):createCommentVNode("",!0)])),_:1}),1!=l.type?(openBlock(),createBlock(U,{key:0,label:"分流规则"},{default:withCtx((()=>[createVNode(I,{value:e.formConf.divideRule,"onUpdate:value":t[2]||(t[2]=o=>e.formConf.divideRule=o),options:unref(divideRuleOptions),onChange:t[3]||(t[3]=e=>{a("updateDivideRule",l.formConf.divideRule)})},null,8,["value","options"])])),_:1})):createCommentVNode("",!0),createVNode(U,{label:"节点打印"},{default:withCtx((()=>[createVNode(S,{class:"leading-32px",checked:e.formConf.printConfig.on,"onUpdate:checked":t[4]||(t[4]=o=>e.formConf.printConfig.on=o)},{default:withCtx((()=>t[44]||(t[44]=[createTextVNode("节点打印")]))),_:1,__:[44]},8,["checked"]),e.formConf.printConfig.on?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(U,{label:"请选择打印模板",class:"!mt-12px"},{default:withCtx((()=>[createVNode(D,{value:e.formConf.printConfig.printIds,"onUpdate:value":t[5]||(t[5]=o=>e.formConf.printConfig.printIds=o),options:e.printTplOptions,multiple:"",lastLevel:"",showCheckedStrategy:unref(TreeSelect).SHOW_CHILD},null,8,["value","options","showCheckedStrategy"])])),_:1}),createVNode(U,{label:"打印条件"},{default:withCtx((()=>[createVNode(I,{value:e.formConf.printConfig.conditionType,"onUpdate:value":t[6]||(t[6]=o=>e.formConf.printConfig.conditionType=o),options:unref(printConditionTypeOptions)},null,8,["value","options"])])),_:1}),4==e.formConf.printConfig.conditionType?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(k,{onClick:y},{default:withCtx((()=>t[45]||(t[45]=[createTextVNode("设置打印条件")]))),_:1,__:[45]}),e.formConf.printConfig.conditions.length?(openBlock(),createElementBlock("div",_hoisted_1$l,[createBaseVNode("span",{onClick:y},toDisplayString(v.value),1),createBaseVNode("i",{class:"icon-ym icon-ym-delete",onClick:B})])):createCommentVNode("",!0)],64)):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1})],64)):createCommentVNode("",!0),3===unref(r)?(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(U,{label:"发起事件",class:"normal-item-content"},{default:withCtx((()=>[createVNode($,{checked:e.formConf.initFuncConfig.on,"onUpdate:checked":t[7]||(t[7]=o=>e.formConf.initFuncConfig.on=o)},null,8,["checked"])])),_:1}),e.formConf.initFuncConfig.on?(openBlock(),createBlock(U,{key:0,class:"!-mt-12px"},{default:withCtx((()=>[t[46]||(t[46]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口")],-1)),createVNode(unref(SelectInterface),{value:e.formConf.initFuncConfig.interfaceId,title:e.formConf.initFuncConfig.interfaceName,templateJson:e.formConf.initFuncConfig.templateJson,fieldOptions:e.funcOptions,sourceType:3,showSystemFullLabel:"",isFlow:"",fieldWidth:"60px",onChange:t[8]||(t[8]=(e,o)=>T(unref(keyMap).initFuncConfig,e,o)),onFieldChange:w},null,8,["value","title","templateJson","fieldOptions"])])),_:1,__:[46]})):createCommentVNode("",!0),createVNode(U,{label:"结束事件",class:"normal-item-content"},{default:withCtx((()=>[createVNode($,{checked:e.formConf.endFuncConfig.on,"onUpdate:checked":t[9]||(t[9]=o=>e.formConf.endFuncConfig.on=o)},null,8,["checked"])])),_:1}),e.formConf.endFuncConfig.on?(openBlock(),createBlock(U,{key:1,class:"!-mt-12px"},{default:withCtx((()=>[t[47]||(t[47]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口")],-1)),createVNode(unref(SelectInterface),{value:e.formConf.endFuncConfig.interfaceId,title:e.formConf.endFuncConfig.interfaceName,templateJson:e.formConf.endFuncConfig.templateJson,fieldOptions:e.funcOptions,sourceType:3,showSystemFullLabel:"",isFlow:"",fieldWidth:"60px",onChange:t[10]||(t[10]=(e,o)=>T(unref(keyMap).endFuncConfig,e,o)),onFieldChange:w},null,8,["value","title","templateJson","fieldOptions"])])),_:1,__:[47]})):createCommentVNode("",!0),createVNode(U,{label:"撤回事件",class:"normal-item-content"},{default:withCtx((()=>[createVNode($,{checked:e.formConf.flowRecallFuncConfig.on,"onUpdate:checked":t[11]||(t[11]=o=>e.formConf.flowRecallFuncConfig.on=o)},null,8,["checked"])])),_:1}),e.formConf.flowRecallFuncConfig.on?(openBlock(),createBlock(U,{key:2,class:"!-mt-12px"},{default:withCtx((()=>[t[48]||(t[48]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口")],-1)),createVNode(unref(SelectInterface),{value:e.formConf.flowRecallFuncConfig.interfaceId,title:e.formConf.flowRecallFuncConfig.interfaceName,templateJson:e.formConf.flowRecallFuncConfig.templateJson,fieldOptions:e.funcOptions,sourceType:3,showSystemFullLabel:"",isFlow:"",fieldWidth:"60px",onChange:t[12]||(t[12]=(e,o)=>T(unref(keyMap).flowRecallFuncConfig,e,o)),onFieldChange:w},null,8,["value","title","templateJson","fieldOptions"])])),_:1,__:[48]})):createCommentVNode("",!0)],64)):createCommentVNode("",!0),4===unref(r)?(openBlock(),createElementBlock(Fragment,{key:2},[createVNode(O,{message:"自定义通知以“消息中心-发送配置”为主，请移步设置；关闭：表示不提醒，默认：表示站内提醒",type:"warning",showIcon:"",class:"!mb-10px"}),createVNode(_sfc_main$t,{noticeConfig:e.formConf.waitMsgConfig,funcOptions:e.noticeOptions,type:"wait"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.endMsgConfig,funcOptions:e.noticeOptions,type:"end"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.commentMsgConfig,funcOptions:e.noticeOptions,type:"comment"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.approveMsgConfig,funcOptions:e.noticeOptions,type:"approve"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.rejectMsgConfig,funcOptions:e.noticeOptions,type:"reject"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.backMsgConfig,funcOptions:e.noticeOptions,type:"back"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.copyMsgConfig,funcOptions:e.noticeOptions,type:"copy"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.overTimeMsgConfig,funcOptions:e.noticeOptions,type:"overTime"},null,8,["noticeConfig","funcOptions"]),createVNode(_sfc_main$t,{noticeConfig:e.formConf.noticeMsgConfig,funcOptions:e.noticeOptions,type:"notice"},null,8,["noticeConfig","funcOptions"])],64)):createCommentVNode("",!0),5===unref(r)?(openBlock(),createElementBlock(Fragment,{key:3},[createVNode(U,{label:"限时设置"},{default:withCtx((()=>[createVNode(I,{value:e.formConf.timeLimitConfig.on,"onUpdate:value":t[13]||(t[13]=o=>e.formConf.timeLimitConfig.on=o),options:unref(overTimeMsgOptions),onChange:x},null,8,["value","options"]),1===e.formConf.timeLimitConfig.on?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(U,{class:"!mt-12px",label:"节点处理截止时间"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_2$i,[createVNode(I,{value:e.formConf.timeLimitConfig.nodeLimit,"onUpdate:value":t[14]||(t[14]=o=>e.formConf.timeLimitConfig.nodeLimit=o),options:unref(overTimeOptions),disabled:""},null,8,["value","options"]),t[49]||(t[49]=createBaseVNode("span",{class:"!ml-10px flex-shrink-0"},"开始",-1))]),createBaseVNode("div",_hoisted_3$h,[t[50]||(t[50]=createBaseVNode("span",{class:"w-90px inline-block"},"流程到达节点",-1)),createVNode(j,{value:e.formConf.timeLimitConfig.duringDeal,"onUpdate:value":t[15]||(t[15]=o=>e.formConf.timeLimitConfig.duringDeal=o),onChange:t[16]||(t[16]=e=>F(e,"timeLimitConfig.duringDeal",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[51]||(t[51]=createBaseVNode("span",null,"小时后，视为超时",-1))])])),_:1}),createVNode(U,{label:"限时提醒规则",class:"!mt-12px"},{default:withCtx((()=>[createVNode(I,{value:e.formConf.noticeConfig.on,"onUpdate:value":t[17]||(t[17]=o=>e.formConf.noticeConfig.on=o),options:unref(overTimeMsgOptions)},null,8,["value","options"])])),_:1}),1===e.formConf.noticeConfig.on?(openBlock(),createBlock(U,{key:0},{default:withCtx((()=>[createBaseVNode("div",_hoisted_4$c,[t[52]||(t[52]=createBaseVNode("span",{class:"w-90px inline-block"},"流程到达节点",-1)),createVNode(j,{value:e.formConf.noticeConfig.firstOver,"onUpdate:value":t[18]||(t[18]=o=>e.formConf.noticeConfig.firstOver=o),onChange:t[19]||(t[19]=e=>F(e,"noticeConfig.firstOver",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[53]||(t[53]=createBaseVNode("span",null,"小时，开始提醒通知",-1))]),createBaseVNode("div",_hoisted_5$8,[t[54]||(t[54]=createBaseVNode("span",{class:"w-90px inline-block"},"每间隔",-1)),createVNode(j,{value:e.formConf.noticeConfig.overTimeDuring,"onUpdate:value":t[20]||(t[20]=o=>e.formConf.noticeConfig.overTimeDuring=o),onChange:t[21]||(t[21]=e=>F(e,"noticeConfig.overTimeDuring",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[55]||(t[55]=createBaseVNode("span",null,"小时，提醒通知一次",-1))]),t[60]||(t[60]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"提醒事务")],-1)),createVNode(A,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(S,{checked:e.formConf.noticeConfig.overNotice,"onUpdate:checked":t[22]||(t[22]=o=>e.formConf.noticeConfig.overNotice=o)},{default:withCtx((()=>[t[56]||(t[56]=createTextVNode(" 提醒通知")),createVNode(R,{text:"勾选后才能进行提醒消息发送（站内信系统默认发送，第三方超时消息需在节点通知内配置）"})])),_:1,__:[56]},8,["checked"])])),_:1}),createCommentVNode("",!0),e.formConf.noticeConfig.overEvent?(openBlock(),createElementBlock("div",_hoisted_6$8,[t[58]||(t[58]=createBaseVNode("span",{class:"w-90px inline-block"},"在提醒通知第",-1)),createVNode(j,{value:e.formConf.noticeConfig.overEventTime,"onUpdate:value":t[24]||(t[24]=o=>e.formConf.noticeConfig.overEventTime=o),onChange:t[25]||(t[25]=e=>F(e,"noticeConfig.overEventTime",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[59]||(t[59]=createBaseVNode("span",null,"次时，执行提醒事件",-1))])):createCommentVNode("",!0)])),_:1,__:[60]})):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1}),createVNode(U,{label:"超时设置"},{default:withCtx((()=>[createVNode(I,{value:e.formConf.overTimeConfig.on,"onUpdate:value":t[26]||(t[26]=o=>e.formConf.overTimeConfig.on=o),options:unref(overTimeMsgOptions),disabled:0==e.formConf.timeLimitConfig.on},null,8,["value","options","disabled"])])),_:1}),1===e.formConf.overTimeConfig.on?(openBlock(),createBlock(U,{key:0},{default:withCtx((()=>[createBaseVNode("div",_hoisted_7$7,[t[61]||(t[61]=createBaseVNode("span",{class:"w-90px inline-block"},"超时",-1)),createVNode(j,{value:e.formConf.overTimeConfig.firstOver,"onUpdate:value":t[27]||(t[27]=o=>e.formConf.overTimeConfig.firstOver=o),onChange:t[28]||(t[28]=e=>F(e,"overTimeConfig.firstOver",0)),min:0,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[62]||(t[62]=createBaseVNode("span",null,"小时，开始超时通知",-1))]),createBaseVNode("div",_hoisted_8$7,[t[63]||(t[63]=createBaseVNode("span",{class:"w-90px inline-block"},"每间隔",-1)),createVNode(j,{value:e.formConf.overTimeConfig.overTimeDuring,"onUpdate:value":t[29]||(t[29]=o=>e.formConf.overTimeConfig.overTimeDuring=o),onChange:t[30]||(t[30]=e=>F(e,"overTimeConfig.overTimeDuring",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[64]||(t[64]=createBaseVNode("span",null,"小时，超时通知一次",-1))]),t[72]||(t[72]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"超时事务")],-1)),createVNode(A,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(S,{checked:e.formConf.overTimeConfig.overNotice,"onUpdate:checked":t[31]||(t[31]=o=>e.formConf.overTimeConfig.overNotice=o)},{default:withCtx((()=>[t[65]||(t[65]=createTextVNode(" 超时通知")),createVNode(R,{text:"勾选后才能进行提醒消息发送（站内信系统默认发送，第三方超时消息需在节点通知内配置）"})])),_:1,__:[65]},8,["checked"])])),_:1}),createCommentVNode("",!0),e.formConf.overTimeConfig.overEvent?(openBlock(),createElementBlock("div",_hoisted_9$6,[t[67]||(t[67]=createBaseVNode("span",{class:"w-90px inline-block"},"在超时通知",-1)),createVNode(j,{value:e.formConf.overTimeConfig.overEventTime,"onUpdate:value":t[33]||(t[33]=o=>e.formConf.overTimeConfig.overEventTime=o),onChange:t[34]||(t[34]=e=>F(e,"overTimeConfig.overEventTime",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[68]||(t[68]=createBaseVNode("span",null,"次时，执行超时事件",-1))])):createCommentVNode("",!0),createVNode(A,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(S,{checked:e.formConf.overTimeConfig.overAutoApprove,"onUpdate:checked":t[35]||(t[35]=o=>e.formConf.overTimeConfig.overAutoApprove=o)},{default:withCtx((()=>[t[69]||(t[69]=createTextVNode(" 超时自动审批 ")),createVNode(R,{text:"当前审批节点表单必填字段为空工单流转时不做校验，下一审批节点设置候选人员、选择分支、异常节点时当前审批节点规则失效"})])),_:1,__:[69]},8,["checked"])])),_:1}),e.formConf.overTimeConfig.overAutoApprove?(openBlock(),createElementBlock("div",_hoisted_10$4,[t[70]||(t[70]=createBaseVNode("span",{class:"w-90px inline-block"},"在超时通知",-1)),createVNode(j,{value:e.formConf.overTimeConfig.overAutoApproveTime,"onUpdate:value":t[36]||(t[36]=o=>e.formConf.overTimeConfig.overAutoApproveTime=o),onChange:t[37]||(t[37]=e=>F(e,"overTimeConfig.overAutoApproveTime",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[71]||(t[71]=createBaseVNode("span",null,"次，执行超时自动审批",-1))])):createCommentVNode("",!0)])),_:1,__:[72]})):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1},8,["model"])):(openBlock(),createBlock(E,{key:1,"data-source":e.formConf.formOperates,columns:g,size:"small",pagination:!1,scroll:{y:"calc(100vh - 197px)"}},{headerCell:withCtx((({column:e})=>["write"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(S,{checked:unref(i),"onUpdate:checked":t[38]||(t[38]=e=>isRef(i)?i.value=e:null),indeterminate:unref(d),onChange:t[39]||(t[39]=e=>h(e,1))},{default:withCtx((()=>t[73]||(t[73]=[createTextVNode("查看")]))),_:1,__:[73]},8,["checked","indeterminate"]),createVNode(S,{checked:unref(s),"onUpdate:checked":t[40]||(t[40]=e=>isRef(s)?s.value=e:null),indeterminate:unref(f),onChange:t[41]||(t[41]=e=>h(e,2))},{default:withCtx((()=>t[74]||(t[74]=[createTextVNode("编辑")]))),_:1,__:[74]},8,["checked","indeterminate"]),createVNode(S,{checked:unref(c),"onUpdate:checked":t[42]||(t[42]=e=>isRef(c)?c.value=e:null),indeterminate:unref(m),onChange:t[43]||(t[43]=e=>h(e,3))},{default:withCtx((()=>t[75]||(t[75]=[createTextVNode(" 必填 ")]))),_:1,__:[75]},8,["checked","indeterminate"])],64)):createCommentVNode("",!0)])),bodyCell:withCtx((({column:e,record:o})=>["write"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(S,{checked:o.read,"onUpdate:checked":e=>o.read=e,onChange:N},{default:withCtx((()=>t[76]||(t[76]=[createTextVNode("查看")]))),_:2,__:[76]},1032,["checked","onUpdate:checked"]),createVNode(S,{checked:o.write,"onUpdate:checked":e=>o.write=e,onChange:N},{default:withCtx((()=>t[77]||(t[77]=[createTextVNode("编辑")]))),_:2,__:[77]},1032,["checked","onUpdate:checked"]),createVNode(S,{checked:o.required,"onUpdate:checked":e=>o.required=e,disabled:o.requiredDisabled,onChange:N},{default:withCtx((()=>t[78]||(t[78]=[createTextVNode("必填")]))),_:2,__:[78]},1032,["checked","onUpdate:checked","disabled"])],64)):createCommentVNode("",!0)])),_:1},8,["data-source"])),createVNode(_sfc_main$q,{onRegister:unref(u),onConfirm:V},null,8,["onRegister"])],64)}}}),_hoisted_1$k={class:"common-tip mb-10px"},_hoisted_2$h=["onClick"],_sfc_main$o=defineComponent({inheritAttrs:!1,__name:"AssignRuleModal",props:["formConf","formFieldsOptions"],emits:["register","change"],setup(e,{emit:o}){const t=reactive({assignList:[],isSubFlow:0,childFieldOptions:[]}),n=e,{createMessage:a}=useMessage(),[l,{closeModal:r}]=useModalInner((function(e){t.assignList=e.assignList||[],t.isSubFlow=e.isSubFlow||0,t.childFieldOptions=e.childFieldOptions||[]})),i=computed((()=>cloneDeep(t.isSubFlow?t.childFieldOptions:n.formFieldsOptions).filter((e=>!["table",...systemComponentsList].includes(e?.__config__?.jnpfKey)))));function s(){let e=!0;for(let o=0;o<t.assignList.length;o++){const n=t.assignList[o],l=n.ruleList;for(let o=0;o<l.length;o++){if(!l[o].parentField){e=!1,a.error(`请选择${n.title}的上节点字段`);break}if(!l[o].childField){e=!1,a.error(`请选择${n.title}的本节点字段`);break}}}e&&(n.formConf.assignList=t.assignList,t.assignList=[],r())}return(e,o)=>{const n=resolveComponent("a-col"),a=resolveComponent("jnpf-select"),r=resolveComponent("a-button"),c=resolveComponent("a-row"),d=resolveComponent("a-tab-pane"),f=resolveComponent("a-tabs");return openBlock(),createBlock(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(l),title:"数据传递",width:700,onOk:s,class:"rule-modal"}),{default:withCtx((()=>[createVNode(f,{size:"small",class:"node-tabs"},{default:withCtx((()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.assignList,((e,l)=>(openBlock(),createBlock(d,{tab:e.title,key:l},{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$k,toDisplayString(t.isSubFlow?"当父流程流转到子流程时，将对应的上一节点表单字段赋值给子流程发起节点":"当节点流转到本节点时，将对应的上一节点的字段赋值给本节点"),1),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.ruleList,((s,d)=>(openBlock(),createBlock(c,{gutter:10,key:d,class:"mb-10px"},{default:withCtx((()=>[createVNode(n,{span:2,class:"rule-cell"},{default:withCtx((()=>[createTextVNode(toDisplayString(t.isSubFlow?"父流程":"上节点"),1)])),_:1}),createVNode(n,{span:7,class:"rule-cell"},{default:withCtx((()=>{return[createVNode(a,{value:s.parentField,"onUpdate:value":e=>s.parentField=e,options:(o=e.formFieldList,o?.length?(o.forEach((e=>{e.children?.length&&e.children.forEach((e=>{!1!==e.disabled&&(e.disabled=!1)}))})),o):o),fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"!w-full"},null,8,["value","onUpdate:value","options"])];var o})),_:2},1024),createVNode(n,{span:4,class:"rule-cell mid"},{default:withCtx((()=>o[0]||(o[0]=[createTextVNode("赋值给")]))),_:1,__:[0]}),createVNode(n,{span:2,class:"rule-cell"},{default:withCtx((()=>[createTextVNode(toDisplayString(t.isSubFlow?"子流程":"本节点"),1)])),_:1}),createVNode(n,{span:7,class:"rule-cell"},{default:withCtx((()=>[createVNode(a,{value:s.childField,"onUpdate:value":e=>s.childField=e,options:i.value,fieldNames:{options:"options1"},showSearch:"",allowClear:"",class:"!w-full"},null,8,["value","onUpdate:value","options"])])),_:2},1024),createVNode(n,{span:2,class:"rule-cell"},{default:withCtx((()=>[createVNode(r,{type:"danger",onClick:e=>function(e,o){t.assignList[e].ruleList.splice(o,1)}(l,d)},{default:withCtx((()=>o[1]||(o[1]=[createBaseVNode("i",{class:"icon-ym icon-ym-nav-close"},null,-1)]))),_:2,__:[1]},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),createBaseVNode("div",{class:"table-add-action",onClick:e=>function(e){t.assignList[e].ruleList.push({parentField:"",childField:"",childFieldOptions:[]})}(l)},[createVNode(r,{type:"link",preIcon:"icon-ym icon-ym-btn-add"},{default:withCtx((()=>o[2]||(o[2]=[createTextVNode("新增规则")]))),_:1,__:[2]})],8,_hoisted_2$h)])),_:2},1032,["tab"])))),128))])),_:1})])),_:1},16,["onRegister"])}}}),_hoisted_1$j={class:"approvers-sort-body"},_hoisted_2$g={class:"selected-item selected-item-user"},_hoisted_3$g={class:"selected-item-main"},_hoisted_4$b={class:"selected-item-text"},_hoisted_5$7={class:"name"},_hoisted_6$7=["title"],_sfc_main$n=defineComponent({__name:"ApproversSortModal",emits:["register","confirm"],setup(e,{emit:o}){const t=o,[n,{closeModal:a}]=useModalInner((function(e){if(!e.ids||!e.ids.length)return;s.value=!0,i.value=[],getSelectedList(e.ids).then((e=>{i.value=e.data.list||[],s.value=!1}))})),l=useGlobSetting(),r=ref(l.apiUrl),i=ref([]),s=ref(!1);function c(){const e=i.value.map((e=>e.id+"--user"));t("confirm",e),a()}return(e,o)=>{const t=resolveComponent("a-avatar"),a=resolveDirective("loading");return openBlock(),createBlock(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(n),title:"设置依次审批顺序",width:400,onOk:c,destroyOnClose:"",class:"approvers-sort-modal"}),{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$j,[withDirectives((openBlock(),createBlock(unref(ScrollContainer),{class:"list"},{default:withCtx((()=>[createVNode(unref(draggable),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=e=>i.value=e),animation:300,group:"selectItem",handle:".option-drag",itemKey:"id"},{item:withCtx((({element:e})=>[createBaseVNode("div",_hoisted_2$g,[createBaseVNode("div",_hoisted_3$g,[createVNode(t,{size:36,src:r.value+e.headIcon,class:"selected-item-headIcon"},null,8,["src"]),createBaseVNode("div",_hoisted_4$b,[createBaseVNode("p",_hoisted_5$7,toDisplayString(e.fullName),1),createBaseVNode("p",{class:"organize",title:e.organize},toDisplayString(e.organize),9,_hoisted_6$7)]),o[1]||(o[1]=createBaseVNode("div",{class:"option-drag"},[createBaseVNode("i",{class:"icon-ym icon-ym-darg"})],-1))])])])),_:1},8,["modelValue"])])),_:1})),[[a,s.value]])])])),_:1},16,["onRegister"])}}}),ApproversSortModal_vue_vue_type_style_index_0_lang="",_hoisted_1$i={class:"form-script-modal-body"},_hoisted_2$f={class:"main-board"},_hoisted_3$f={class:"main-board-editor"},_hoisted_4$a={class:"main-board-tips"},_sfc_main$m=defineComponent({__name:"StyleScript",props:["type"],emits:["register","confirm"],setup(e,{emit:o}){const t=o,[n,{closeModal:a}]=useModalInner((function(e){r.value=e.text})),l=ref(null),r=ref("");function i(){t("confirm",r.value),a()}return(o,t)=>(openBlock(),createBlock(unref(BasicModal),mergeProps(o.$attrs,{onRegister:unref(n),title:"自定义按钮脚本",helpMessage:"小程序不支持在线JS脚本",width:1e3,onOk:i,destroyOnClose:"",class:"form-script-modal"}),{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$i,[createBaseVNode("div",_hoisted_2$f,[createBaseVNode("div",_hoisted_3$f,[createVNode(unref(MonacoEditor),{ref_key:"editorRef",ref:l,modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e)},null,8,["modelValue"])]),createBaseVNode("div",_hoisted_4$a,[createBaseVNode("p",null,[t[1]||(t[1]=createTextVNode("支持JavaScript的脚本，")),createVNode(_sfc_main$A,{type:e.type},null,8,["type"])])])])])])),_:1},16,["onRegister"]))}}),_hoisted_1$h={class:"required-sign"},_sfc_main$l=defineComponent({__name:"AuxiliaryModal",emits:["register","confirm"],setup(e,{emit:o}){const t=reactive({dataForm:{},formFieldsOptions:[],allOptions:[],options:[],type:"add"}),{dataForm:n,formFieldsOptions:a,options:l,type:r}=toRefs(t),[i,{closeModal:s}]=useModalInner((function(e){t.type=e.type||"add",t.dataForm=cloneDeep(e.config),t.formFieldsOptions=e.formFieldsOptions||[]})),c=[{width:50,title:"序号",align:"center",customRender:({index:e})=>e+1},{title:"列名",dataIndex:"label",key:"label",width:150},{title:"字段",dataIndex:"value",key:"value"},{title:"宽度",dataIndex:"width",key:"width",width:100},{title:"显示",dataIndex:"ifShow",key:"ifShow",width:50,align:"center"},{title:"操作",dataIndex:"action",key:"action",width:50}],d=useDebounceFn(u,300),{createMessage:f}=useMessage(),m=o;function p(e,o){if(!e)return t.dataForm.interfaceId="",t.dataForm.interfaceName="",t.dataForm.templateJson=[],void C();t.dataForm.interfaceId!==e&&(t.dataForm.interfaceId=e,t.dataForm.interfaceName=o.fullName,t.dataForm.templateJson=o.templateJson.map((e=>({...e,sourceType:1})))||[],C())}function u(e){t.options=t.allOptions.filter((o=>-1!==o.value.toLowerCase().indexOf(e.toLowerCase())))}function C(){if(!t.dataForm.interfaceId)return t.allOptions=[];getDataInterfaceInfo(t.dataForm.interfaceId).then((e=>{const o=e.data;let n=o.fieldJson?JSON.parse(o.fieldJson):[];t.allOptions=n.map((e=>({...e,value:e.defaultValue})))}))}function g(){if(!t.dataForm.interfaceId)return f.warning("请选择数据接口");(function(){let e=!0;for(let o=0;o<t.dataForm.columnOptions?.length;o++)if(!t.dataForm.columnOptions[o].value){f.error("列表字段中字段不能为空"),e=!1;break}return e})()&&(m("confirm",t.dataForm),s())}return(e,o)=>{const s=resolveComponent("a-form-item"),f=resolveComponent("jnpf-select"),m=resolveComponent("jnpf-input-number"),C=resolveComponent("jnpf-date-picker"),v=resolveComponent("a-input"),_=resolveComponent("a-table"),h=resolveComponent("BasicHelp"),N=resolveComponent("a-auto-complete"),k=resolveComponent("a-input-number"),y=resolveComponent("a-checkbox"),V=resolveComponent("a-button"),B=resolveComponent("a-form");return openBlock(),createBlock(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(i),title:"add"==unref(r)?"新增":"编辑",width:600,onOk:g,class:"add-config-modal",destroyOnClose:""}),{default:withCtx((()=>[createVNode(B,{colon:!1,labelAlign:"right",ref:"formElRef",model:unref(n),labelCol:{style:{width:"80px"}}},{default:withCtx((()=>[createVNode(s,{label:"数据接口"},{default:withCtx((()=>[createVNode(unref(InterfaceModal),{value:unref(n).interfaceId,title:unref(n).interfaceName,sourceType:1,onChange:p},null,8,["value","title"])])),_:1}),createVNode(s,{label:"参数设置",style:{"margin-bottom":"0"}}),createVNode(_,{"data-source":unref(n).templateJson,columns:unref(templateJsonColumns),size:"small",pagination:!1},{bodyCell:withCtx((({column:e,record:o})=>{return["field"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",_hoisted_1$h,toDisplayString(o.required?"*":""),1),createTextVNode(" "+toDisplayString(o.field)+toDisplayString(o.fieldName?"("+o.fieldName+")":""),1)],64)):createCommentVNode("",!0),"sourceType"===e.key?(openBlock(),createBlock(f,{key:1,value:o.sourceType,"onUpdate:value":e=>o.sourceType=e,options:(t=o.required,t?sourceTypeOptions.filter((e=>3!=e.id&&4!=e.id)):sourceTypeOptions.filter((e=>4!=e.id))),class:"!w-100px",onChange:e=>o.relationField=""},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0),"relationField"===e.key?(openBlock(),createElementBlock(Fragment,{key:2},[1===o.sourceType?(openBlock(),createBlock(f,{key:0,value:o.relationField,"onUpdate:value":e=>o.relationField=e,placeholder:"请选择",options:unref(a),fieldNames:{options:"options1"},allowClear:"",showSearch:"",class:"!w-204px"},null,8,["value","onUpdate:value","options"])):2==o.sourceType?(openBlock(),createElementBlock(Fragment,{key:1},[["int","decimal"].includes(o.dataType)?(openBlock(),createBlock(m,{key:0,value:o.relationField,"onUpdate:value":e=>o.relationField=e,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"])):"datetime"==o.dataType?(openBlock(),createBlock(C,{key:1,class:"!w-full",value:o.relationField,"onUpdate:value":e=>o.relationField=e,placeholder:"请选择",format:"YYYY-MM-DD HH:mm:ss",allowClear:""},null,8,["value","onUpdate:value"])):(openBlock(),createBlock(v,{key:2,value:o.relationField,"onUpdate:value":e=>o.relationField=e,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"]))],64)):createCommentVNode("",!0)],64)):createCommentVNode("",!0)];var t})),emptyText:withCtx((()=>o[1]||(o[1]=[createBaseVNode("p",{class:"leading-60px"},"暂无数据",-1)]))),_:1},8,["data-source","columns"]),createVNode(s,{label:"设置列表字段",style:{"margin-bottom":"0"},labelCol:{style:{width:"100px"}}}),createVNode(_,{"data-source":unref(n).columnOptions,columns:c,size:"small",pagination:!1},{headerCell:withCtx((({column:e})=>["width"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(e.title),1),createVNode(h,{text:"移动端不支持宽度设置"})],64)):createCommentVNode("",!0)])),bodyCell:withCtx((({column:e,record:n,index:a})=>["label"===e.key?(openBlock(),createBlock(v,{key:0,value:n.label,"onUpdate:value":e=>n.label=e,placeholder:"请输入"},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"value"===e.key?(openBlock(),createBlock(N,{key:1,value:n.value,"onUpdate:value":e=>n.value=e,placeholder:"请输入",options:unref(l),onFocus:e=>{u(n.value)},onSearch:e=>unref(d)(n.value)},null,8,["value","onUpdate:value","options","onFocus","onSearch"])):createCommentVNode("",!0),"width"===e.key?(openBlock(),createBlock(k,{key:2,value:n.width,"onUpdate:value":e=>n.width=e,placeholder:"请输入",min:0,precision:0},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"ifShow"===e.key?(openBlock(),createBlock(y,{key:3,checked:n.ifShow,"onUpdate:checked":e=>n.ifShow=e},null,8,["checked","onUpdate:checked"])):createCommentVNode("",!0),"action"===e.key?(openBlock(),createBlock(V,{key:4,class:"action-btn",type:"link",color:"error",onClick:e=>function(e){t.dataForm.columnOptions.splice(e,1)}(a),size:"small"},{default:withCtx((()=>o[2]||(o[2]=[createTextVNode("删除")]))),_:2,__:[2]},1032,["onClick"])):createCommentVNode("",!0)])),emptyText:withCtx((()=>o[3]||(o[3]=[createBaseVNode("p",{class:"leading-60px"},"暂无数据",-1)]))),_:1},8,["data-source"]),createBaseVNode("div",{class:"table-add-action",onClick:o[0]||(o[0]=e=>{t.dataForm.columnOptions.push({value:"",label:"",width:null,ifShow:!0})})},[createVNode(V,{type:"link",preIcon:"icon-ym icon-ym-btn-add"},{default:withCtx((()=>o[4]||(o[4]=[createTextVNode("新增")]))),_:1,__:[4]})])])),_:1},8,["model"])])),_:1},16,["onRegister","title"])}}}),_hoisted_1$g={class:"log-detail-board"},_hoisted_2$e={class:"left-board"},_hoisted_3$e=["onClick"],_hoisted_4$9={class:"top"},_hoisted_5$6={class:"fullName"},_hoisted_6$6={class:"center-board"},_hoisted_7$6={class:"top"},_hoisted_8$6={class:"!mt-20px"},_hoisted_9$5={class:"top"},_hoisted_10$3={class:"top mt-10px"},_hoisted_11$3={class:"top mt-10px"},_sfc_main$k=defineComponent({__name:"AuxiliaryMessage",emits:["register","confirm"],setup(e,{emit:o}){const t=[{id:1,fullName:"提示",config:{on:0,content:""}},{id:2,fullName:"链接",config:{on:0,linkList:[]}},{id:3,fullName:"附件",config:{on:0}},{id:4,fullName:"数据",config:{on:0,dataList:[]}}],n=[{title:"数据名称",dataIndex:"fullName",key:"fullName",width:200},{title:"操作",dataIndex:"action",key:"action",width:50,fixed:"right"}],a=[{title:"链接名称",dataIndex:"fullName",key:"fullName",width:200},{title:"链接地址",dataIndex:"urlAddress",key:"urlAddress",width:360},{title:"操作",dataIndex:"action",key:"action",width:50,fixed:"right"}],l=o,[r,{closeModal:i}]=useModalInner((function(e){f.list=e.auxiliaryInfo?.length?e.auxiliaryInfo:t,f.formFieldsOptions=e.formFieldsOptions||[],f.activeKey=f.list[0].id,f.activeItem=f.list[0]})),[s,{openModal:c}]=useModal(),{createMessage:d}=useMessage(),f=reactive({list:[],activeKey:1,activeIndex:0,activeItem:{},formFieldsOptions:[]}),{list:m,activeItem:p}=toRefs(f);function u(e){if(-1==f.activeItem.config.dataList.findIndex((o=>e.id==o.id)))return f.activeItem.config.dataList.push(e);f.activeItem.config.dataList=f.activeItem.config.dataList.map((o=>e.id==o.id?e:o))}function C(){(function(e){let o=!0;for(let t=0;t<e?.length;t++){const n=e[t];if(!n.fullName){d.error("链接名称不能为空"),o=!1;break}if(!n.urlAddress){d.error("链接地址不能为空"),o=!1;break}}return o})(f.list[1].config.linkList)&&(l("confirm",f.list),i())}return(e,o)=>{const t=resolveComponent("JnpfCheckboxSingle"),l=resolveComponent("a-textarea"),i=resolveComponent("a-input"),d=resolveComponent("a-button"),g=resolveComponent("a-table"),v=resolveComponent("a-alert");return openBlock(),createElementBlock(Fragment,null,[createVNode(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(r),title:"辅助信息设置",width:"800px",class:"jnpf-log-detail-modal",onOk:C,destroyOnClose:""}),{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$g,[createBaseVNode("div",_hoisted_2$e,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(m),((e,o)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["item-box",{active:unref(p).id==e.id}]),onClick:t=>function(e,o){f.activeItem=e,f.activeIndex=o,f.activeKey=1}(e,o)},[createBaseVNode("div",_hoisted_4$9,[createBaseVNode("span",_hoisted_5$6,toDisplayString(e.fullName),1)])],10,_hoisted_3$e)))),256))]),createBaseVNode("div",_hoisted_6$6,[1==unref(p).id?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",_hoisted_7$6,[createVNode(t,{value:unref(p).config.on,"onUpdate:value":o[0]||(o[0]=e=>unref(p).config.on=e),label:"启用"},null,8,["value"])]),createBaseVNode("div",_hoisted_8$6,[o[7]||(o[7]=createTextVNode(" 提示内容： ")),createVNode(l,{value:unref(p).config.content,"onUpdate:value":o[1]||(o[1]=e=>unref(p).config.content=e),rows:17},null,8,["value"])])],64)):2==unref(p).id?(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("div",_hoisted_9$5,[createVNode(t,{value:unref(p).config.on,"onUpdate:value":o[2]||(o[2]=e=>unref(p).config.on=e),label:"启用"},null,8,["value"])]),createVNode(g,{"data-source":unref(p).config.linkList,columns:a,size:"small",pagination:!1,rowKey:"id",class:"column-table !mt-20px"},{bodyCell:withCtx((({column:e,record:t,index:n})=>["fullName"===e.key?(openBlock(),createBlock(i,{key:0,value:t.fullName,"onUpdate:value":e=>t.fullName=e,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"urlAddress"===e.key?(openBlock(),createBlock(i,{key:1,value:t.urlAddress,"onUpdate:value":e=>t.urlAddress=e,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"])):createCommentVNode("",!0),"action"===e.key?(openBlock(),createBlock(d,{key:2,type:"link",danger:"",onClick:e=>function(e){f.activeItem.config.linkList.splice(e,1)}(n)},{default:withCtx((()=>o[8]||(o[8]=[createBaseVNode("i",{class:"icon-ym icon-ym-app-delete"},null,-1)]))),_:2,__:[8]},1032,["onClick"])):createCommentVNode("",!0)])),_:1},8,["data-source"]),createBaseVNode("span",{class:"link-text inline-block mt-10px",onClick:o[3]||(o[3]=e=>{f.activeItem.config.linkList.push({fullName:"",urlAddress:""})})},o[9]||(o[9]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("新增链接")]))],64)):3==unref(p).id?(openBlock(),createElementBlock(Fragment,{key:2},[createVNode(v,{message:"读取审批人已审批当前流程已归档的流程文件",showIcon:"",type:"warning",class:"mt-10px"}),createBaseVNode("div",_hoisted_10$3,[createVNode(t,{value:unref(p).config.on,"onUpdate:value":o[4]||(o[4]=e=>unref(p).config.on=e),label:"启用"},null,8,["value"])])],64)):4==unref(p).id?(openBlock(),createElementBlock(Fragment,{key:3},[createVNode(v,{message:"通过数据接口查询数据",showIcon:"",type:"warning",class:"mt-10px"}),createBaseVNode("div",_hoisted_11$3,[createVNode(t,{value:unref(p).config.on,"onUpdate:value":o[5]||(o[5]=e=>unref(p).config.on=e),label:"启用"},null,8,["value"])]),createVNode(g,{"data-source":unref(p).config.dataList,columns:n,size:"small",pagination:!1,rowKey:"id",class:"column-table !mt-20px"},{bodyCell:withCtx((({column:e,record:t,index:n})=>["fullName"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(t.interfaceName),1)],64)):createCommentVNode("",!0),"action"===e.key?(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(d,{type:"link",danger:"",onClick:e=>function(e,o){const t=f.activeItem.config.dataList[e];c(!0,{config:t,formFieldsOptions:f.formFieldsOptions,type:o})}(n,"update")},{default:withCtx((()=>o[10]||(o[10]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-edit"},null,-1)]))),_:2,__:[10]},1032,["onClick"]),createVNode(d,{type:"link",danger:"",onClick:e=>function(e){f.activeItem.config.dataList.splice(e,1)}(n)},{default:withCtx((()=>o[11]||(o[11]=[createBaseVNode("i",{class:"icon-ym icon-ym-app-delete"},null,-1)]))),_:2,__:[11]},1032,["onClick"])],64)):createCommentVNode("",!0)])),_:1},8,["data-source"]),createBaseVNode("span",{class:"link-text inline-block mt-10px",onClick:o[6]||(o[6]=e=>function(){const e={id:"custom"+buildBitUUID(),columnOptions:[],interfaceId:"",interfaceName:"",templateJson:[]};c(!0,{config:e,formFieldsOptions:f.formFieldsOptions,type:"add"})}())},o[12]||(o[12]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("新增数据")]))],64)):createCommentVNode("",!0)])])])),_:1},16,["onRegister"]),createVNode(_sfc_main$l,{onRegister:unref(s),onConfirm:u},null,8,["onRegister"])],64)}}}),AuxiliaryMessage_vue_vue_type_style_index_0_lang="",_hoisted_1$f={class:"ant-select-arrow"},_hoisted_2$d={key:0,class:"common-tip"},_hoisted_3$d={key:1,class:"common-tip"},_hoisted_4$8={key:2,class:"common-tip"},_hoisted_5$5={key:3,class:"common-tip"},_hoisted_6$5={key:4,class:"common-tip"},_hoisted_7$5={key:5,class:"common-tip"},_hoisted_8$5={key:6,class:"common-tip"},_hoisted_9$4={class:"countersign-cell"},_hoisted_10$2={class:"countersign-cell"},_hoisted_11$2={class:"ant-form-item-label"},_hoisted_12$2={key:5},_hoisted_13$2={class:"countersign-cell mb-10px"},_hoisted_14$2={class:"countersign-cell"},_hoisted_15$1={key:2},_hoisted_16$1={class:"approver-rule-content"},_hoisted_17$1={class:"approver-content"},_hoisted_18$1={key:0,class:"approver-text"},_hoisted_19$1={class:"approver-rule-content"},_hoisted_20$1={class:"approver-content"},_hoisted_21$1={key:0,class:"approver-text"},_hoisted_22$1={class:"mt-10px"},_hoisted_23$1={class:"mt-10px"},_hoisted_24$1={class:"mt-10px"},_hoisted_25$1={class:"mt-10px"},_hoisted_26$1={key:0,class:"common-tip my-10px"},_hoisted_27$1={class:"btn-cell"},_hoisted_28$1={class:"btn-cell"},_hoisted_29$1={class:"btn-cell"},_hoisted_30$1={class:"btn-cell"},_hoisted_31$1={key:0,class:"btn-cell"},_hoisted_32$1={class:"btn-cell"},_hoisted_33$1={class:"btn-cell"},_hoisted_34$1={class:"btn-cell"},_hoisted_35$1={class:"custom-draggable-item mb-10px"},_hoisted_36$1=["onClick"],_hoisted_37$1={key:0,class:"add-btn"},_hoisted_38$1={key:0,class:"conditions-content"},_hoisted_39$1={key:1,class:"w-100%"},_hoisted_40$1=["onClick"],_hoisted_41$1={class:"flex items-center"},_hoisted_42$1={key:0,class:"mt-10px"},_hoisted_43$1={class:"countersign-cell mt-12px"},_hoisted_44={class:"countersign-cell"},_hoisted_45={class:"countersign-cell mt-12px"},_hoisted_46={key:1,class:"countersign-cell mt-12px"},_hoisted_47={class:"countersign-cell"},_hoisted_48={class:"countersign-cell mt-12px"},_hoisted_49={key:1,class:"countersign-cell"},_hoisted_50={key:2,class:"countersign-cell"},_hoisted_51={key:3,class:"countersign-cell"},_hoisted_52={key:4,class:"transfer-tip !mt-12px"},_hoisted_53={key:0,class:"common-tip !mt-12px"},_hoisted_54={key:1,class:"common-tip !mt-12px"},_hoisted_55={key:2,class:"common-tip !mt-12px"},_hoisted_56={class:"ant-form-item-label"},_sfc_main$j=defineComponent({inheritAttrs:!1,__name:"ApproverNode",props:["formConf","printTplOptions","prevNodeList","beforeNodeOptions","funcOptions","noticeOptions","formFieldsOptions","usedFormItems","getFormFieldList","initFormOperates","updateJnpfData","nodeOptions","flowState","type","updateFormFieldList","updateBpmnProperties"],emits:["updateDivideRule"],setup(e,{expose:o,emit:t}){const n=reactive({activeKey:1,assignList:[],userLabel:"",readAllChecked:!1,writeAllChecked:!1,requiredAllChecked:!1,isReadIndeterminate:!1,isWriteIndeterminate:!1,isRequiredIndeterminate:!1,conditionType:"",currentBtnIndex:0,jsJson:"({ flowInfo, formData, taskInfo, onlineUtils }) => {\n    // 在此编写代码\n    \n}",formLoading:!1});o({getContent:ie,updateCheckStatus:ue});const{activeKey:a,readAllChecked:l,writeAllChecked:r,requiredAllChecked:i,isReadIndeterminate:s,isWriteIndeterminate:c,isRequiredIndeterminate:d,formLoading:f}=toRefs(n),m=t,p=e,[u,{openModal:C}]=useModal(),[g,{openModal:v}]=useModal(),[_,{openModal:h}]=useModal(),[N,{openModal:k}]=useModal(),[y,{openModal:V}]=useModal(),B=inject("bpmn"),x=[{id:1,fullName:"无审批人范围"},{id:6,fullName:"同一公司"},{id:2,fullName:"同一部门"},{id:3,fullName:"同一岗位"},{id:4,fullName:"发起人上级"},{id:5,fullName:"发起人下属"}],T=[{id:1,fullName:"无候选人范围"},{id:6,fullName:"同一公司"},{id:2,fullName:"同一部门"},{id:3,fullName:"同一岗位"}],w=[{id:2,fullName:"同一部门"},{id:7,fullName:"同一角色"},{id:3,fullName:"同一岗位"},{id:8,fullName:"同一分组"}],b=x.map((e=>1===e.id?{id:1,fullName:"无抄送人范围"}:e)),F=[{id:0,fullName:"或签（一名审批人同意或拒绝即可）"},{id:1,fullName:"会签（无序会签，审批达到会签比例，审批通过）"},{id:2,fullName:"依次审批（按顺序依次审批）"}],L=[{id:1,fullName:"按百分比"},{id:2,fullName:"按人数"}],U=[{id:1,fullName:"实时计算"},{id:2,fullName:"延后计算"}],I=[{id:0,fullName:"无"},...L],S=[{title:"表单字段",dataIndex:"name",key:"name"},{title:"操作",dataIndex:"write",key:"write",align:"center",width:250}],D=[{id:1,fullName:"字段"},{id:2,fullName:"自定义"},{id:3,fullName:"系统参数"}],$=[{id:1,fullName:"发起人"},{id:2,fullName:"上节点审批人"}];let O=[{fullName:"指定成员",id:6},{fullName:"超时审批人",id:11},{fullName:"数据接口",id:9}];const j=computed((()=>B())),R=computed((()=>{const e=unref(j).get("jnpfData");return e?.getValue("global")||{}})),A=computed((()=>({funcOptions:p.noticeOptions,isApprover:!0}))),M=computed((()=>({formConf:p.formConf,formFieldsOptions:p.formFieldsOptions}))),E=computed((()=>{let e=[...defaultStep,...p.beforeNodeOptions];return 2==p.formConf.backType&&(e=e.filter((e=>1!=e.id))),e})),J=computed((()=>NodeUtils.getConditionsContent(p.formConf.printConfig.conditions,p.formConf.printConfig.matchLogic))),P=computed((()=>NodeUtils.getConditionsContent(p.formConf.autoAuditRule.conditions,p.formConf.autoAuditRule.matchLogic))),K=computed((()=>NodeUtils.getConditionsContent(p.formConf.autoRejectRule.conditions,p.formConf.autoRejectRule.matchLogic))),q=computed((()=>systemFieldOptions.map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id}))))),z=computed((()=>unref(R).globalParameterList||[])),H=computed((()=>unref(R).approvalFieldList||[])),G=computed((()=>6===p.formConf.assigneeType&&p.formConf.approvers.length&&p.formConf.approvers.every((e=>-1!==e.indexOf("--user")))&&2==p.formConf.counterSign)),Y=computed((()=>p.formConf.assignList.length&&p.formConf.assignList.some((e=>e.ruleList?.length)))),W=computed((()=>ae(p.usedFormItems,p.formConf.formFieldType))),Q=computed((()=>ae(p.usedFormItems,p.formConf.copyFormFieldType)));function X(e,o){if(!e)return function(){p.formConf.formName="",p.formConf.formId="";let e=[];const o=unref(j).get("jnpfData").getValue("global"),t=o.formId;t&&o.allFormMap&&o.allFormMap["form_"+t]&&(e=o.allFormMap["form_"+t]||[]);p.updateFormFieldList(e),p.formConf.formOperates=p.initFormOperates(p.formConf,!0)}();const t=p.formConf.formId===e;p.formConf.formName=o.fullName,p.formConf.formId=e,p.formConf.assignList=[],p.getFormFieldList(e,"approverForm",t)}function Z(e){2==e?.target?.value&&1==p.formConf.backNodeCode&&(p.formConf.backNodeCode=0)}function ee(){const e=function(e){const o=unref(j).get("jnpfData").getValue("global");let t=p.prevNodeList.map((e=>{let t=[];const n=o.formId,a=e.formId||n;if(a&&"start"!=e.type&&o.allFormMap&&o.allFormMap["form_"+a]){let e=cloneDeep(o.allFormMap["form_"+a])||[];e=e.filter((e=>"table"!==e.__config__.jnpfKey)),e=e.map((e=>({...e,id:e.id+"|"+a})));const n=[{id:"@prevNodeFormId",fullName:"上节点表单Id"}];t.push({fullName:"上节点表单",children:[...n,...e]})}if(n&&o.allFormMap&&o.allFormMap["form_"+n]){let e=cloneDeep(o.allFormMap["form_"+n])||[];e=e.filter((e=>"table"!==e.__config__.jnpfKey)),e=e.map((e=>({...e,id:e.id+"|"+n})));const a=[{id:"@startNodeFormId",fullName:"发起节点表单Id"}];t.push({fullName:"发起节点表单",children:[...a,...e]})}const l=cloneDeep(o.globalParameterList).map((e=>({...e,fullName:e.fieldName,id:e.fieldName+"|globalParameter"})));return l.length&&t.push({fullName:"全局变量",children:l||[]}),{nodeId:e.id,title:e.fullName,formFieldList:t,ruleList:[]}}));if(!e.length)return t;let n=[];for(let l=0;l<e.length;l++){const o=e[l];e:for(let e=0;e<t.length;e++)if(o.nodeId===t[e].nodeId){const a={nodeId:o.nodeId,title:t[e].title,formFieldList:t[e].formFieldList,ruleList:o.ruleList};n.push(a);break e}}const a=t.filter((o=>!e.some((e=>e.nodeId===o.nodeId))));return[...n,...a]}(p.formConf.assignList?cloneDeep(p.formConf.assignList):[]);C(!0,{assignList:e})}function oe(){p.formConf.approvers=[],p.formConf.approversSortList=[],p.formConf.extraRule=1,p.updateBpmnProperties("elementBodyName",ie())}function te(){p.formConf.formField=""}function ne(){p.formConf.copyFormField=""}function ae(e,o){return 2===o?e.filter((e=>"depSelect"==e.__config__.jnpfKey)):3===o?e.filter((e=>"posSelect"==e.__config__.jnpfKey)):4===o?e.filter((e=>"roleSelect"==e.__config__.jnpfKey)):5===o?e.filter((e=>"groupSelect"==e.__config__.jnpfKey)):e.filter((e=>"userSelect"==e.__config__.jnpfKey||"usersSelect"==e.__config__.jnpfKey))}function le(e){if(6!=p.formConf.assigneeType||!e||!e.length||!e.every((e=>-1!==e.indexOf("--user"))))return p.formConf.approversSortList=[];if(!p.formConf.approversSortList.length)return p.formConf.approversSortList=e;const o=p.formConf.approversSortList.filter((o=>-1!==e.indexOf(o))),t=e.filter((e=>-1===p.formConf.approversSortList.indexOf(e)));p.formConf.approversSortList=[...o,...t]}function re(e){n.userLabel=e,p.updateBpmnProperties("elementBodyName",ie())}function ie(){let e=typeConfig[bpmnTask].renderer.bodyDefaultText;return e=6!=p.formConf.assigneeType?typeOptions.find((e=>e.id===p.formConf.assigneeType))?.fullName||typeConfig[bpmnTask].renderer.bodyDefaultText:n.userLabel||typeConfig[bpmnTask].renderer.bodyDefaultText,p.formConf.content=e,e}function se(e,o){if(!e)return p.formConf.interfaceConfig.interfaceId="",p.formConf.interfaceConfig.interfaceName="",void(p.formConf.interfaceConfig.templateJson=[]);p.formConf.interfaceConfig.interfaceId!==e&&(p.formConf.interfaceConfig.interfaceId=e,p.formConf.interfaceConfig.interfaceName=o.fullName,p.formConf.interfaceConfig.templateJson=o.templateJson.map((e=>({...e,sourceType:1})))||[])}function ce(e,o){if(!e)return p.formConf.overTimeConfig.interfaceId="",p.formConf.overTimeConfig.interfaceName="",void(p.formConf.overTimeConfig.templateJson=[]);p.formConf.overTimeConfig.interfaceId!==e&&(p.formConf.overTimeConfig.interfaceId=e,p.formConf.overTimeConfig.interfaceName=o.fullName,p.formConf.overTimeConfig.templateJson=o.templateJson.map((e=>({...e,sourceType:1})))||[])}function de(e,o){if(!e)return;let t=p.funcOptions.filter((o=>o.id===e));if(!t.length)return;let n=t[0];o.isSubTable=!(!n.__config__||!n.__config__.isSubTable)&&n.__config__.isSubTable}function fe(e,o){e||(p.formConf.counterSignConfig[o]=1)}function me(e,o){const t=e.target.checked;1==o&&(n.isReadIndeterminate=!1),2==o&&(n.isWriteIndeterminate=!1),3==o&&(n.isRequiredIndeterminate=!1),p.formConf.formOperates.forEach((e=>{1==o&&(e.read=t),2==o&&(e.write=t),3!=o||e.requiredDisabled||(e.required=t)}))}function pe(){ue()}function ue(){const e=p.formConf.formOperates.length,o=p.formConf.formOperates.filter((e=>!e.requiredDisabled)).length;let t=0,a=0,l=0;p.formConf.formOperates.forEach((e=>{e.read&&t++,e.write&&a++,e.required&&!e.requiredDisabled&&l++})),n.readAllChecked=!!e&&e===t,n.writeAllChecked=!!e&&e===a,n.requiredAllChecked=!!e&&o===l,n.isReadIndeterminate=!!t&&t<e,n.isWriteIndeterminate=!!a&&a<e,n.isRequiredIndeterminate=!!l&&l<o}function Ce(){n.conditionType="print",v(!0,{usedFormItems:p.usedFormItems,formFieldsOptions:p.formFieldsOptions,...p.formConf.printConfig})}function ge(e){const o="print"==n.conditionType?"printConfig":"audit"==n.conditionType?"autoAuditRule":"autoRejectRule";p.formConf[o]={...p.formConf[o],...e}}function ve(){p.formConf.printConfig.matchLogic="and",p.formConf.printConfig.conditions=[]}function _e(e){n.conditionType=e;const o="audit"==e?"autoAuditRule":"autoRejectRule";v(!0,{usedFormItems:p.usedFormItems,formFieldsOptions:p.formFieldsOptions,...p.formConf[o]})}function he(){p.formConf.parameterList.push({field:"",fieldValueType:2,fieldValue:""})}function Ne(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.fullName||""}function ke(){h(!0,{ids:p.formConf.approversSortList})}function ye(e){p.formConf.approversSortList=e}function Ve(e){0==e&&(p.formConf.overTimeConfig.on=0)}function Be(e,o,t){if(!o)return p.formConf[e].interfaceId="",p.formConf[e].interfaceName="",void(p.formConf[e].templateJson=[]);p.formConf[e].interfaceId!==o&&(p.formConf[e].interfaceId=o,p.formConf[e].interfaceName=t.fullName,p.formConf[e].templateJson=t.templateJson.map((e=>({...e,sourceType:1})))||[])}function xe(){if(!p.formConf.customBtns.length)return"按钮1";let e=0;const o=/按钮(\d+)/;return p.formConf.customBtns.map((t=>{const n=t.label.match(o);if(n){const o=parseInt(n[1]);o>e&&(e=o)}})),"按钮"+ ++e}function Te(e){p.formConf.customBtns[n.currentBtnIndex].jsJson=e}function we(){1!=n.formLoading&&(n.formLoading=!0,p.getFormFieldList(p.formConf.formId,"approverForm",!0).then((()=>{n.formLoading=!1})).catch((()=>{n.formLoading=!1})))}function be(){V(!0,{auxiliaryInfo:p.formConf.auxiliaryInfo,formFieldsOptions:p.formFieldsOptions})}function Fe(e){p.formConf.auxiliaryInfo=e}function Le(e,o,t){let n=o.split("."),a=p.formConf;for(;n.length>1;){a=a[n.shift()]}a[n[0]]=e||t}return watch((()=>p.formConf),(()=>p.updateJnpfData(p.formConf)),{deep:!0,immediate:!0}),watch((()=>n.activeKey),(e=>{3==e&&ue()})),(o,t)=>{const C=resolveComponent("a-tab-pane"),v=resolveComponent("a-tabs"),h=resolveComponent("BasicHelp"),V=resolveComponent("a-button"),B=resolveComponent("a-tooltip"),j=resolveComponent("a-form-item"),ae=resolveComponent("a-input"),ie=resolveComponent("jnpf-radio"),ue=resolveComponent("jnpf-select"),Ue=resolveComponent("a-select-option"),Ie=resolveComponent("a-select"),Se=resolveComponent("a-input-group"),De=resolveComponent("jnpf-users-select"),$e=resolveComponent("a-input-number"),Oe=resolveComponent("a-checkbox"),je=resolveComponent("a-radio"),Re=resolveComponent("a-radio-group"),Ae=resolveComponent("a-divider"),Me=resolveComponent("jnpf-tree-select"),Ee=resolveComponent("a-col"),Je=resolveComponent("jnpf-switch"),Pe=resolveComponent("jnpf-time-picker"),Ke=resolveComponent("jnpf-date-picker"),qe=resolveComponent("jnpf-organize-select"),ze=resolveComponent("jnpf-dep-select"),He=resolveComponent("jnpf-role-select"),Ge=resolveComponent("jnpf-group-select"),Ye=resolveComponent("jnpf-pos-select"),We=resolveComponent("jnpf-user-select"),Qe=resolveComponent("jnpf-area-select"),Xe=resolveComponent("a-row"),Ze=resolveComponent("a-switch"),eo=resolveComponent("a-alert"),oo=resolveComponent("a-form"),to=resolveComponent("a-table");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:t[0]||(t[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(v,{activeKey:unref(a),"onUpdate:activeKey":t[1]||(t[1]=e=>isRef(a)?a.value=e:null),size:"small",class:"pane-tabs approver-pane-tabs"},{default:withCtx((()=>[(openBlock(),createBlock(C,{key:1,tab:"基础信息"})),(openBlock(),createBlock(C,{key:2,tab:"高级设置"})),(openBlock(),createBlock(C,{key:3,tab:"表单权限"})),(openBlock(),createBlock(C,{key:4,tab:"节点事件"})),(openBlock(),createBlock(C,{key:5,tab:"流程通知"})),(openBlock(),createBlock(C,{key:6,tab:"超时设置"}))])),_:1},8,["activeKey"]),3!==unref(a)?(openBlock(),createBlock(oo,{key:0,colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[1===unref(a)?(openBlock(),createElementBlock(Fragment,{key:0},[R.value?.hasAloneConfigureForms?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(j,{class:"form-item-reload"},{label:withCtx((()=>[t[109]||(t[109]=createTextVNode("表单设置")),createVNode(h,{text:"审批节点不设置表单，默认引用发起节点表单"})])),default:withCtx((()=>[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,onChange:X,placeholder:"请选择",disabled:0!=e.flowState},null,8,["value","title","disabled"]),0==e.flowState&&e.formConf.formId?(openBlock(),createBlock(B,{key:0,title:"刷新表单"},{default:withCtx((()=>[createVNode(V,{onClick:we},{default:withCtx((()=>[createVNode(unref(ReloadOutlined),{spin:unref(f)},null,8,["spin"])])),_:1})])),_:1})):createCommentVNode("",!0)])),_:1}),(openBlock(),createBlock(j,{key:0},{label:withCtx((()=>[t[110]||(t[110]=createTextVNode(" 数据传递 ")),createVNode(h,{text:["不设置传递规则时字段名称相同自动赋值","设置传递规则时相同名称字段会自动赋值字段后再按传递规则赋值"]})])),default:withCtx((()=>[createVNode(ae,{value:Y.value?"已设置":"",placeholder:"请设置数据传递规则",readonly:"",class:"hand",onClick:ee},{suffix:withCtx((()=>[createBaseVNode("span",_hoisted_1$f,[createVNode(unref(DownOutlined))])])),_:1},8,["value"])])),_:1}))],64)):createCommentVNode("",!0),createVNode(j,{label:"审批设置"},{default:withCtx((()=>[createVNode(ie,{value:e.formConf.assigneeType,"onUpdate:value":t[2]||(t[2]=o=>e.formConf.assigneeType=o),options:unref(typeOptions),class:"type-radio",onChange:oe},null,8,["value","options"]),createBaseVNode("div",{class:normalizeClass({"mb-10px":3!==e.formConf.assigneeType,"mt-10px":!0})},[[1,2].includes(e.formConf.assigneeType)?(openBlock(),createElementBlock("div",_hoisted_2$d,"选择主管")):createCommentVNode("",!0),3===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_3$d,"发起者自己将作为审批人处理审批单")):createCommentVNode("",!0),4===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_4$8,"选择流程表单字段的值作为审批人")):createCommentVNode("",!0),5===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_5$5,"设置审批人为审批流程中某个环节的审批人")):createCommentVNode("",!0),6===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_6$5,"指定审批人处理审批单")):createCommentVNode("",!0),7===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_7$5,"默认所有人，需要设置请指定候选人范围处理审批单")):createCommentVNode("",!0),9===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_8$5,"从目标接口中获取审批人")):createCommentVNode("",!0)],2),1==e.formConf.assigneeType?(openBlock(),createBlock(j,{key:0,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_9$4,[createVNode(ue,{value:e.formConf.approverType,"onUpdate:value":t[3]||(t[3]=o=>e.formConf.approverType=o),options:$,class:"!w-130px mr-8px"},null,8,["value"]),t[111]||(t[111]=createTextVNode(" 的 ")),createVNode(Ie,{value:e.formConf.managerLevel,"onUpdate:value":t[4]||(t[4]=o=>e.formConf.managerLevel=o),placeholder:"请选择",class:"flex-1 ml-8px"},{default:withCtx((()=>[(openBlock(),createElementBlock(Fragment,null,renderList(10,(e=>createVNode(Ue,{key:e,value:e},{default:withCtx((()=>[createTextVNode(toDisplayString(1===e?"直属主管":"第"+e+"级主管"),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])])])),_:1})):createCommentVNode("",!0),2==e.formConf.assigneeType?(openBlock(),createBlock(j,{key:1,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_10$2,[createVNode(ue,{value:e.formConf.managerApproverType,"onUpdate:value":t[5]||(t[5]=o=>e.formConf.managerApproverType=o),options:$,class:"!w-130px mr-8px"},null,8,["value"]),t[112]||(t[112]=createTextVNode(" 的部门主管 "))])])),_:1})):createCommentVNode("",!0),4===e.formConf.assigneeType?(openBlock(),createBlock(j,{key:2,label:"表单字段",class:"!mb-0"},{default:withCtx((()=>[createVNode(Se,{compact:""},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.formFieldType,"onUpdate:value":t[6]||(t[6]=o=>e.formConf.formFieldType=o),options:unref(formFieldTypeOptions),class:"!w-100px",onChange:te},null,8,["value","options"]),createVNode(ue,{value:e.formConf.formField,"onUpdate:value":t[7]||(t[7]=o=>e.formConf.formField=o),options:W.value,fieldNames:{options:"options1"},showSearch:"",style:{width:"calc(100% - 100px)"}},null,8,["value","options"])])),_:1})])),_:1})):createCommentVNode("",!0),5===e.formConf.assigneeType?(openBlock(),createBlock(j,{key:3,label:"审批节点",class:"!mb-0"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.approverNodeId,"onUpdate:value":t[8]||(t[8]=o=>e.formConf.approverNodeId=o),showSearch:"",options:e.nodeOptions},null,8,["value","options"])])),_:1})):createCommentVNode("",!0),9===e.formConf.assigneeType?(openBlock(),createBlock(j,{key:4,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_11$2,[t[113]||(t[113]=createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口",-1)),createVNode(h,{text:'请求自带参数：taskId、taskNodeId，返回结构：JSON对象{"handleId":"id1,id2"}'})]),createVNode(unref(InterfaceModal),{value:e.formConf.interfaceConfig.interfaceId,title:e.formConf.interfaceConfig.interfaceName,onChange:se},null,8,["value","title"]),e.formConf.interfaceConfig.templateJson?.length?(openBlock(),createElementBlock(Fragment,{key:0},[t[114]||(t[114]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"参数设置")],-1)),createVNode(unref(SelectInterfaceBtn),{templateJson:e.formConf.interfaceConfig.templateJson,fieldOptions:e.funcOptions,isFlow:"",showFieldFullLabel:"",showSystemFullLabel:"",onFieldChange:de},null,8,["templateJson","fieldOptions"])],64)):createCommentVNode("",!0)])),_:1})):createCommentVNode("",!0),6===e.formConf.assigneeType||7===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_12$2,[createVNode(De,{value:e.formConf.approvers,"onUpdate:value":t[9]||(t[9]=o=>e.formConf.approvers=o),buttonType:"button",modalTitle:6===e.formConf.assigneeType?"添加审批人":"添加候选人",multiple:"",onChange:le,onLabelChange:re},null,8,["value","modalTitle"])])):createCommentVNode("",!0),6===e.formConf.assigneeType||7===e.formConf.assigneeType&&e.formConf.approvers?.length?(openBlock(),createBlock(j,{key:6,class:"!mb-0 !mt-10px"},{label:withCtx((()=>[createTextVNode(toDisplayString(6===e.formConf.assigneeType?"审批人范围":"候选人范围")+" ",1),createVNode(h,{text:6===e.formConf.assigneeType?"指定成员增加人员选择范围附加条件":"候选人增加人员选择范围附加条件"},null,8,["text"])])),default:withCtx((()=>[createVNode(ue,{value:e.formConf.extraRule,"onUpdate:value":t[10]||(t[10]=o=>e.formConf.extraRule=o),options:6===e.formConf.assigneeType?x:T},null,8,["value","options"])])),_:1})):createCommentVNode("",!0)])),_:1}),createVNode(j,{label:"审批方式"},{default:withCtx((()=>[createVNode(ie,{value:e.formConf.counterSign,"onUpdate:value":t[11]||(t[11]=o=>e.formConf.counterSign=o),options:F,class:"counterSign-radio"},null,8,["value"])])),_:1}),1==e.formConf.counterSign?(openBlock(),createBlock(j,{key:1,label:"设置会签流转规则"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_13$2,[t[115]||(t[115]=createBaseVNode("span",{class:"w-70px inline-block"},"同意规则",-1)),createVNode(ue,{value:e.formConf.counterSignConfig.auditType,"onUpdate:value":t[12]||(t[12]=o=>e.formConf.counterSignConfig.auditType=o),options:L,class:"!w-120px !mx-10px"},null,8,["value"]),1===e.formConf.counterSignConfig.auditType?(openBlock(),createBlock(Ie,{key:0,value:e.formConf.counterSignConfig.auditRatio,"onUpdate:value":t[13]||(t[13]=o=>e.formConf.counterSignConfig.auditRatio=o),class:"!w-120px !mr-10px"},{default:withCtx((()=>[(openBlock(),createElementBlock(Fragment,null,renderList(10,(e=>createVNode(Ue,{key:e,value:10*e},{default:withCtx((()=>[createTextVNode(toDisplayString(10*e+"%"),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])):createCommentVNode("",!0),2===e.formConf.counterSignConfig.auditType?(openBlock(),createBlock($e,{key:1,class:"!w-120px !mr-10px",value:e.formConf.counterSignConfig.auditNum,"onUpdate:value":t[14]||(t[14]=o=>e.formConf.counterSignConfig.auditNum=o),placeholder:"请输入",precision:0,min:1,onChange:t[15]||(t[15]=e=>fe(e,"auditNum"))},null,8,["value"])):createCommentVNode("",!0),t[116]||(t[116]=createBaseVNode("span",null,"进入下一节点",-1))]),createBaseVNode("div",_hoisted_14$2,[t[117]||(t[117]=createBaseVNode("span",{class:"w-70px inline-block"},"不同意规则",-1)),createVNode(ue,{value:e.formConf.counterSignConfig.rejectType,"onUpdate:value":t[16]||(t[16]=o=>e.formConf.counterSignConfig.rejectType=o),options:I,class:"!w-120px !mx-10px"},null,8,["value"]),1===e.formConf.counterSignConfig.rejectType?(openBlock(),createBlock(Ie,{key:0,value:e.formConf.counterSignConfig.rejectRatio,"onUpdate:value":t[17]||(t[17]=o=>e.formConf.counterSignConfig.rejectRatio=o),class:"!w-120px !mr-10px"},{default:withCtx((()=>[(openBlock(),createElementBlock(Fragment,null,renderList(10,(e=>createVNode(Ue,{key:e,value:10*e},{default:withCtx((()=>[createTextVNode(toDisplayString(10*e+"%"),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])):createCommentVNode("",!0),2===e.formConf.counterSignConfig.rejectType?(openBlock(),createBlock($e,{key:1,class:"!w-120px !mr-10px",value:e.formConf.counterSignConfig.rejectNum,"onUpdate:value":t[18]||(t[18]=o=>e.formConf.counterSignConfig.rejectNum=o),placeholder:"请输入",precision:0,min:1,onChange:t[19]||(t[19]=e=>fe(e,"rejectNum"))},null,8,["value"])):createCommentVNode("",!0),e.formConf.counterSignConfig.rejectType?(openBlock(),createElementBlock("span",_hoisted_15$1,"时拒绝")):createCommentVNode("",!0)])])),_:1})):createCommentVNode("",!0),1==e.formConf.counterSign?(openBlock(),createBlock(j,{key:2},{label:withCtx((()=>[t[118]||(t[118]=createTextVNode("计算方式")),createVNode(h,{text:["实时计算：审批过程中实时进行规则判断","延后计算：在所有审批人审批完成后进行规则判断"]})])),default:withCtx((()=>[createVNode(ie,{value:e.formConf.counterSignConfig.calculateType,"onUpdate:value":t[20]||(t[20]=o=>e.formConf.counterSignConfig.calculateType=o),options:U},null,8,["value"])])),_:1})):createCommentVNode("",!0),G.value?(openBlock(),createBlock(j,{key:3,label:"设置依次审批顺序"},{default:withCtx((()=>[createVNode(V,{preIcon:"icon-ym icon-ym-btn-add",onClick:ke},{default:withCtx((()=>t[119]||(t[119]=[createTextVNode("设置审批顺序")]))),_:1,__:[119]})])),_:1})):createCommentVNode("",!0),createVNode(j,{label:"审批规则"},{default:withCtx((()=>[createVNode(Oe,{class:"leading-32px",checked:e.formConf.hasAutoApprover,"onUpdate:checked":t[21]||(t[21]=o=>e.formConf.hasAutoApprover=o)},{default:withCtx((()=>[t[120]||(t[120]=createTextVNode(" 系统审批 ")),createVNode(h,{text:"开启后由系统根据条件执行审批动作，当条件都不满足时，转人工审批。"})])),_:1,__:[120]},8,["checked"]),e.formConf.hasAutoApprover?(openBlock(),createElementBlock(Fragment,{key:0},[t[123]||(t[123]=createBaseVNode("div",{class:"ant-form-item-no-colon"},"当条件都不满足时转人工审批",-1)),createBaseVNode("div",_hoisted_16$1,[createBaseVNode("div",_hoisted_17$1,[t[121]||(t[121]=createBaseVNode("span",null,"同意",-1)),createBaseVNode("i",{class:"icon-ym icon-ym-app-rename",onClick:t[22]||(t[22]=e=>_e("audit"))})]),e.formConf.autoAuditRule?.conditions?.length?(openBlock(),createElementBlock("div",_hoisted_18$1,toDisplayString(P.value),1)):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_19$1,[createBaseVNode("div",_hoisted_20$1,[t[122]||(t[122]=createBaseVNode("span",null,"拒绝",-1)),createBaseVNode("i",{class:"icon-ym icon-ym-app-rename",onClick:t[23]||(t[23]=e=>_e("reject"))})]),e.formConf.autoRejectRule?.conditions?.length?(openBlock(),createElementBlock("div",_hoisted_21$1,toDisplayString(K.value),1)):createCommentVNode("",!0)])],64)):createCommentVNode("",!0)])),_:1}),createVNode(j,{label:"审批意见"},{default:withCtx((()=>[createVNode(Oe,{checked:e.formConf.hasSign,"onUpdate:checked":t[24]||(t[24]=o=>e.formConf.hasSign=o)},{default:withCtx((()=>t[124]||(t[124]=[createTextVNode("启用签名")]))),_:1,__:[124]},8,["checked"]),createBaseVNode("div",_hoisted_22$1,[createVNode(Oe,{checked:e.formConf.hasFile,"onUpdate:checked":t[25]||(t[25]=o=>e.formConf.hasFile=o)},{default:withCtx((()=>t[125]||(t[125]=[createTextVNode("启用附件")]))),_:1,__:[125]},8,["checked"])]),createBaseVNode("div",_hoisted_23$1,[createVNode(Oe,{checked:e.formConf.hasApprovalField,"onUpdate:checked":t[26]||(t[26]=o=>e.formConf.hasApprovalField=o)},{default:withCtx((()=>t[126]||(t[126]=[createTextVNode("启用拓展字段")]))),_:1,__:[126]},8,["checked"])]),e.formConf.hasApprovalField?(openBlock(),createBlock(ue,{key:0,value:e.formConf.approvalField,"onUpdate:value":t[27]||(t[27]=o=>e.formConf.approvalField=o),options:H.value,fieldNames:{label:"fieldName",options:"options1"},multiple:"",class:"mt-10px"},null,8,["value","options"])):createCommentVNode("",!0)])),_:1}),createVNode(j,{label:"抄送设置"},{default:withCtx((()=>[createVNode(De,{value:e.formConf.circulateUser,"onUpdate:value":t[28]||(t[28]=o=>e.formConf.circulateUser=o),buttonType:"button",modalTitle:"添加抄送人",multiple:""},null,8,["value"]),createVNode(j,{class:"!pt-10px"},{label:withCtx((()=>[t[127]||(t[127]=createTextVNode("抄送人范围")),createVNode(h,{text:"抄送人员增加人员选择范围附加条件"})])),default:withCtx((()=>[createVNode(ue,{value:e.formConf.extraCopyRule,"onUpdate:value":t[29]||(t[29]=o=>e.formConf.extraCopyRule=o),options:unref(b)},null,8,["value","options"])])),_:1}),createVNode(Oe,{checked:e.formConf.isCustomCopy,"onUpdate:checked":t[30]||(t[30]=o=>e.formConf.isCustomCopy=o)},{default:withCtx((()=>t[128]||(t[128]=[createTextVNode("允许自选抄送人")]))),_:1,__:[128]},8,["checked"]),createBaseVNode("div",_hoisted_24$1,[createVNode(Oe,{checked:e.formConf.isInitiatorCopy,"onUpdate:checked":t[31]||(t[31]=o=>e.formConf.isInitiatorCopy=o)},{default:withCtx((()=>t[129]||(t[129]=[createTextVNode("抄送给流程发起人")]))),_:1,__:[129]},8,["checked"])]),createBaseVNode("div",_hoisted_25$1,[createVNode(Oe,{checked:e.formConf.isFormFieldCopy,"onUpdate:checked":t[32]||(t[32]=o=>e.formConf.isFormFieldCopy=o)},{default:withCtx((()=>t[130]||(t[130]=[createTextVNode("抄送给表单变量")]))),_:1,__:[130]},8,["checked"])]),e.formConf.isFormFieldCopy?(openBlock(),createElementBlock("div",_hoisted_26$1,"选择流程表单字段的值作为抄送人")):createCommentVNode("",!0),e.formConf.isFormFieldCopy?(openBlock(),createBlock(j,{key:1,class:"!mb-0"},{default:withCtx((()=>[createVNode(Se,{compact:""},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.copyFormFieldType,"onUpdate:value":t[33]||(t[33]=o=>e.formConf.copyFormFieldType=o),options:unref(formFieldTypeOptions),class:"!w-100px",onChange:ne},null,8,["value","options"]),createVNode(ue,{value:e.formConf.copyFormField,"onUpdate:value":t[34]||(t[34]=o=>e.formConf.copyFormField=o),options:Q.value,fieldNames:{options:"options1"},showSearch:"",style:{width:"calc(100% - 100px)"}},null,8,["value","options"])])),_:1})])),_:1})):createCommentVNode("",!0)])),_:1})],64)):createCommentVNode("",!0),2===unref(a)?(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(j,{label:"处置操作"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_27$1,[createVNode(Oe,{checked:e.formConf.hasAuditBtn,"onUpdate:checked":t[35]||(t[35]=o=>e.formConf.hasAuditBtn=o)},{default:withCtx((()=>t[131]||(t[131]=[createTextVNode("同意")]))),_:1,__:[131]},8,["checked"]),createVNode(ae,{value:e.formConf.auditBtnText,"onUpdate:value":t[36]||(t[36]=o=>e.formConf.auditBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_28$1,[createVNode(Oe,{checked:e.formConf.hasRejectBtn,"onUpdate:checked":t[37]||(t[37]=o=>e.formConf.hasRejectBtn=o)},{default:withCtx((()=>t[132]||(t[132]=[createTextVNode("拒绝")]))),_:1,__:[132]},8,["checked"]),createVNode(ae,{value:e.formConf.rejectBtnText,"onUpdate:value":t[38]||(t[38]=o=>e.formConf.rejectBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_29$1,[createVNode(Oe,{checked:e.formConf.hasBackBtn,"onUpdate:checked":t[39]||(t[39]=o=>e.formConf.hasBackBtn=o)},{default:withCtx((()=>t[133]||(t[133]=[createTextVNode("退回")]))),_:1,__:[133]},8,["checked"]),createVNode(ae,{value:e.formConf.backBtnText,"onUpdate:value":t[40]||(t[40]=o=>e.formConf.backBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_30$1,[createVNode(Oe,{checked:e.formConf.hasFreeApproverBtn,"onUpdate:checked":t[41]||(t[41]=o=>e.formConf.hasFreeApproverBtn=o),onChange:t[42]||(t[42]=o=>{e.formConf.hasFreeApproverBtn||(p.formConf.hasReduceApproverBtn=!1)})},{default:withCtx((()=>t[134]||(t[134]=[createTextVNode("加签")]))),_:1,__:[134]},8,["checked"]),createVNode(ae,{value:e.formConf.freeApproverBtnText,"onUpdate:value":t[43]||(t[43]=o=>e.formConf.freeApproverBtnText=o),placeholder:"请输入"},null,8,["value"])]),e.formConf.hasFreeApproverBtn?(openBlock(),createElementBlock("div",_hoisted_31$1,[createVNode(Oe,{checked:e.formConf.hasReduceApproverBtn,"onUpdate:checked":t[44]||(t[44]=o=>e.formConf.hasReduceApproverBtn=o)},{default:withCtx((()=>t[135]||(t[135]=[createTextVNode("减签")]))),_:1,__:[135]},8,["checked"]),createVNode(ae,{value:e.formConf.reduceApproverBtnText,"onUpdate:value":t[45]||(t[45]=o=>e.formConf.reduceApproverBtnText=o),placeholder:"请输入"},null,8,["value"])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_32$1,[createVNode(Oe,{checked:e.formConf.hasTransferBtn,"onUpdate:checked":t[46]||(t[46]=o=>e.formConf.hasTransferBtn=o)},{default:withCtx((()=>t[136]||(t[136]=[createTextVNode("转审")]))),_:1,__:[136]},8,["checked"]),createVNode(ae,{value:e.formConf.transferBtnText,"onUpdate:value":t[47]||(t[47]=o=>e.formConf.transferBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_33$1,[createVNode(Oe,{checked:e.formConf.hasAssistBtn,"onUpdate:checked":t[48]||(t[48]=o=>e.formConf.hasAssistBtn=o)},{default:withCtx((()=>t[137]||(t[137]=[createTextVNode("协办")]))),_:1,__:[137]},8,["checked"]),createVNode(ae,{value:e.formConf.assistBtnText,"onUpdate:value":t[49]||(t[49]=o=>e.formConf.assistBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_34$1,[createVNode(Oe,{checked:e.formConf.hasSaveAuditBtn,"onUpdate:checked":t[50]||(t[50]=o=>e.formConf.hasSaveAuditBtn=o)},{default:withCtx((()=>t[138]||(t[138]=[createTextVNode("暂存")]))),_:1,__:[138]},8,["checked"]),createVNode(ae,{value:e.formConf.saveAuditBtnText,"onUpdate:value":t[51]||(t[51]=o=>e.formConf.saveAuditBtnText=o),placeholder:"请输入"},null,8,["value"])])])),_:1}),e.formConf.hasBackBtn?(openBlock(),createBlock(j,{key:0},{label:withCtx((()=>[t[139]||(t[139]=createTextVNode("退回设置")),createVNode(h,{text:"纯表单流程设置退回到发起节点无效"})])),default:withCtx((()=>[t[143]||(t[143]=createBaseVNode("div",{class:"form-item-content"},null,-1)),createVNode(j,{label:"被退回的节点重新提交时"},{default:withCtx((()=>[createVNode(Re,{value:e.formConf.backType,"onUpdate:value":t[52]||(t[52]=o=>e.formConf.backType=o),class:"counterSign-radio",onChange:Z},{default:withCtx((()=>[createVNode(je,{value:1},{default:withCtx((()=>[t[140]||(t[140]=createTextVNode("重新审批")),createVNode(h,{text:"若流程为A->B->C，C退回至A，则C->A->B->C"})])),_:1,__:[140]}),createVNode(je,{value:2},{default:withCtx((()=>[t[141]||(t[141]=createTextVNode("从当前节点审批")),createVNode(h,{text:"若流程为A->B->C，C退回至A，则C->A->C"})])),_:1,__:[141]}),createVNode(je,{value:3},{default:withCtx((()=>[t[142]||(t[142]=createTextVNode("自定义审批")),createVNode(h,{text:"由用户选择重新审批或从当前节点审批"})])),_:1,__:[142]})])),_:1},8,["value"])])),_:1}),createVNode(j,{label:"设置退回到的节点",class:"!mb-0px"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.backNodeCode,"onUpdate:value":t[53]||(t[53]=o=>e.formConf.backNodeCode=o),options:E.value,showSearch:""},null,8,["value","options"])])),_:1})])),_:1,__:[143]})):createCommentVNode("",!0),createVNode(Ae,null,{default:withCtx((()=>t[144]||(t[144]=[createBaseVNode("text",{class:"approver-text"},"自定义按钮区",-1)]))),_:1,__:[144]}),createVNode(j,{class:"custom-draggable-list"},{default:withCtx((()=>[createVNode(unref(draggable),{modelValue:e.formConf.customBtns,"onUpdate:modelValue":t[54]||(t[54]=o=>e.formConf.customBtns=o),animation:300,group:"selectItem",handle:".option-drag",itemKey:"value"},{item:withCtx((({element:o,index:a})=>[createBaseVNode("div",_hoisted_35$1,[t[147]||(t[147]=createBaseVNode("div",{class:"custom-line-icon option-drag"},[createBaseVNode("i",{class:"icon-ym icon-ym-darg"})],-1)),createVNode(Se,{class:"btn-cell ml-15px mr-15px",style:{"margin-bottom":"0"},compact:""},{default:withCtx((()=>[createVNode(ae,{value:o.label,"onUpdate:value":e=>o.label=e,maxlength:4,onBlur:e=>function(e){if(""===e.element.label){const o={...e.element,label:xe()};p.formConf.customBtns[e.index]=o}}({element:o,index:a})},null,8,["value","onUpdate:value","onBlur"]),createVNode(V,{onClick:e=>function(e,o){n.currentBtnIndex=o,k(!0,{text:e.jsJson||n.jsJson})}(o,a)},{default:withCtx((()=>t[145]||(t[145]=[createTextVNode("事件")]))),_:2,__:[145]},1032,["onClick"])])),_:2},1024),createBaseVNode("div",{class:"close-btn custom-line-icon",onClick:o=>e.formConf.customBtns.splice(a,1)},t[146]||(t[146]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn"},null,-1)]),8,_hoisted_36$1)])])),_:1},8,["modelValue"]),e.formConf.customBtns?.length<5?(openBlock(),createElementBlock("div",_hoisted_37$1,[createVNode(V,{type:"link",preIcon:"icon-ym icon-ym-btn-add",onClick:t[55]||(t[55]=e=>function(){const e={value:"btn_"+buildBitUUID(),label:xe(),jsJson:n.jsJson};p.formConf.customBtns.push(e)}())},{default:withCtx((()=>t[148]||(t[148]=[createTextVNode("添加按钮")]))),_:1,__:[148]})])):createCommentVNode("",!0)])),_:1}),createVNode(j,{label:"节点打印"},{default:withCtx((()=>[createVNode(Oe,{class:"leading-32px",checked:e.formConf.printConfig.on,"onUpdate:checked":t[56]||(t[56]=o=>e.formConf.printConfig.on=o)},{default:withCtx((()=>t[149]||(t[149]=[createTextVNode("节点打印")]))),_:1,__:[149]},8,["checked"]),e.formConf.printConfig.on?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(j,{label:"请选择打印模板",class:"!mt-12px"},{default:withCtx((()=>[createVNode(Me,{value:e.formConf.printConfig.printIds,"onUpdate:value":t[57]||(t[57]=o=>e.formConf.printConfig.printIds=o),options:e.printTplOptions,multiple:"",lastLevel:"",showCheckedStrategy:unref(TreeSelect).SHOW_CHILD},null,8,["value","options","showCheckedStrategy"])])),_:1}),createVNode(j,{label:"打印条件"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.printConfig.conditionType,"onUpdate:value":t[58]||(t[58]=o=>e.formConf.printConfig.conditionType=o),options:unref(printConditionTypeOptions)},null,8,["value","options"])])),_:1}),4==e.formConf.printConfig.conditionType?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(V,{onClick:Ce},{default:withCtx((()=>t[150]||(t[150]=[createTextVNode("设置打印条件")]))),_:1,__:[150]}),e.formConf.printConfig.conditions.length?(openBlock(),createElementBlock("div",_hoisted_38$1,[createBaseVNode("span",{onClick:Ce},toDisplayString(J.value),1),createBaseVNode("i",{class:"icon-ym icon-ym-delete",onClick:ve})])):createCommentVNode("",!0)],64)):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1}),createVNode(j,{label:"节点参数"},{default:withCtx((()=>[createBaseVNode("div",{class:"parameter-content"},[t[151]||(t[151]=createBaseVNode("span",null,"参数设置",-1)),createBaseVNode("i",{class:"icon-ym icon-ym-btn-add",onClick:he})]),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.parameterList,((o,t)=>(openBlock(),createBlock(Xe,{gutter:8,class:"condition-main mt-10px",key:t},{default:withCtx((()=>[createVNode(Ee,{span:8,class:"overflow-auto"},{default:withCtx((()=>[createVNode(ue,{value:o.field,"onUpdate:value":e=>o.field=e,options:z.value,fieldNames:{label:"fieldName",value:"fieldName",options:"options1"}},null,8,["value","onUpdate:value","options"])])),_:2},1024),createVNode(Ee,{span:5,class:"overflow-auto"},{default:withCtx((()=>[createVNode(ue,{value:o.fieldValueType,"onUpdate:value":e=>o.fieldValueType=e,options:D,onChange:e=>function(e){e.fieldValue="",e.fieldLabel=""}(o)},null,8,["value","onUpdate:value","onChange"])])),_:2},1024),createVNode(Ee,{span:9,class:"overflow-auto"},{default:withCtx((()=>[1===o.fieldValueType?(openBlock(),createBlock(ue,{key:0,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,options:e.usedFormItems,allowClear:"",showSearch:"",fieldNames:{options:"options1"},class:"w-100%",onChange:(e,t)=>function(e,o,t){e.fieldLabel=o?t.fullName:"",e.fieldValueJnpfKey=o?t.__config__.jnpfKey:""}(o,e,t)},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0),2===o.fieldValueType?(openBlock(),createElementBlock("div",_hoisted_39$1,["inputNumber"===o.jnpfKey?(openBlock(),createBlock($e,{key:0,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",precision:o.precision},null,8,["value","onUpdate:value","precision"])):"calculate"===o.jnpfKey?(openBlock(),createBlock($e,{key:1,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",precision:2},null,8,["value","onUpdate:value"])):["rate","slider"].includes(o.jnpfKey)?(openBlock(),createBlock($e,{key:2,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入"},null,8,["value","onUpdate:value"])):"switch"===o.jnpfKey?(openBlock(),createBlock(Je,{key:3,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e},null,8,["value","onUpdate:value"])):"timePicker"===o.jnpfKey?(openBlock(),createBlock(Pe,{key:4,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,format:o.format||"HH:mm:ss",allowClear:""},null,8,["value","onUpdate:value","format"])):["datePicker","createTime","modifyTime"].includes(o.jnpfKey)?(openBlock(),createBlock(Ke,{key:5,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,format:o.format,allowClear:"",onChange:e=>function(e,o){if(!e)return o.fieldLabel="";const t=o.format||"YYYY-MM-DD HH:mm:ss";o.fieldLabel=formatToDateTime(e,t)}(e,o)},null,8,["value","onUpdate:value","format","onChange"])):["organizeSelect","currOrganize"].includes(o.jnpfKey)?(openBlock(),createBlock(qe,{key:6,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>function(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.organize||""}(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["depSelect"].includes(o.jnpfKey)?(openBlock(),createBlock(ze,{key:7,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ne(o,e,t)},null,8,["value","onUpdate:value","onChange"])):"roleSelect"===o.jnpfKey?(openBlock(),createBlock(He,{key:8,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ne(o,e,t)},null,8,["value","onUpdate:value","onChange"])):"groupSelect"===o.jnpfKey?(openBlock(),createBlock(Ge,{key:9,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ne(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["posSelect","currPosition"].includes(o.jnpfKey)?(openBlock(),createBlock(Ye,{key:10,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ne(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["userSelect","createUser","modifyUser"].includes(o.jnpfKey)?(openBlock(),createBlock(We,{key:11,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,hasSys:"",allowClear:"",onChange:(e,t)=>Ne(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["usersSelect"].includes(o.jnpfKey)?(openBlock(),createBlock(De,{key:12,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ne(o,e,t)},null,8,["value","onUpdate:value","onChange"])):"areaSelect"===o.jnpfKey?(openBlock(),createBlock(Qe,{key:13,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,level:o.level,allowClear:"",onChange:(e,t)=>function(e,o,t){if(!o)return e.fieldLabel="";const n=t.map((e=>e.fullName));e.fieldLabel=n.join("/")}(o,e,t)},null,8,["value","onUpdate:value","level","onChange"])):(openBlock(),createBlock(ae,{key:14,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"]))])):3===o.fieldValueType?(openBlock(),createBlock(ue,{key:2,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,options:q.value,fieldNames:{label:"label",options:"options1"},allowClear:"",class:"w-100%"},null,8,["value","onUpdate:value","options"])):createCommentVNode("",!0)])),_:2},1024),createVNode(Ee,{span:2,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e){p.formConf.parameterList.splice(e,1)}(t)},null,8,_hoisted_40$1)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),1!=p.type?(openBlock(),createBlock(j,{key:1,label:"分流规则"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.divideRule,"onUpdate:value":t[59]||(t[59]=o=>e.formConf.divideRule=o),options:unref(divideRuleOptions),onChange:t[60]||(t[60]=e=>{m("updateDivideRule",p.formConf.divideRule)})},null,8,["value","options"])])),_:1})):createCommentVNode("",!0),createVNode(j,{label:"辅助信息"},{default:withCtx((()=>[createVNode(V,{preIcon:"icon-ym icon-ym-btn-add",onClick:be},{default:withCtx((()=>t[152]||(t[152]=[createTextVNode("辅助信息设置")]))),_:1,__:[152]})])),_:1})],64)):createCommentVNode("",!0),4===unref(a)?(openBlock(),createElementBlock(Fragment,{key:2},[createVNode(j,{label:"同意事件",class:"normal-item-content"},{default:withCtx((()=>[createVNode(Ze,{checked:e.formConf.approveFuncConfig.on,"onUpdate:checked":t[61]||(t[61]=o=>e.formConf.approveFuncConfig.on=o)},null,8,["checked"])])),_:1}),e.formConf.approveFuncConfig.on?(openBlock(),createBlock(j,{key:0,class:"!-mt-12px"},{default:withCtx((()=>[t[153]||(t[153]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口")],-1)),createVNode(unref(SelectInterface),{value:e.formConf.approveFuncConfig.interfaceId,title:e.formConf.approveFuncConfig.interfaceName,templateJson:e.formConf.approveFuncConfig.templateJson,fieldOptions:e.funcOptions,sourceType:3,showSystemFullLabel:"",isFlow:"",fieldWidth:"60px",onChange:t[62]||(t[62]=(e,o)=>Be(unref(keyMap).approveFuncConfig,e,o)),onFieldChange:de},null,8,["value","title","templateJson","fieldOptions"])])),_:1,__:[153]})):createCommentVNode("",!0),createVNode(j,{label:"拒绝事件",class:"normal-item-content"},{default:withCtx((()=>[createVNode(Ze,{checked:e.formConf.rejectFuncConfig.on,"onUpdate:checked":t[63]||(t[63]=o=>e.formConf.rejectFuncConfig.on=o)},null,8,["checked"])])),_:1}),e.formConf.rejectFuncConfig.on?(openBlock(),createBlock(j,{key:1,class:"!-mt-12px"},{default:withCtx((()=>[t[154]||(t[154]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口")],-1)),createVNode(unref(SelectInterface),{value:e.formConf.rejectFuncConfig.interfaceId,title:e.formConf.rejectFuncConfig.interfaceName,templateJson:e.formConf.rejectFuncConfig.templateJson,fieldOptions:e.funcOptions,sourceType:3,showSystemFullLabel:"",isFlow:"",fieldWidth:"60px",onChange:t[64]||(t[64]=(e,o)=>Be(unref(keyMap).rejectFuncConfig,e,o)),onFieldChange:de},null,8,["value","title","templateJson","fieldOptions"])])),_:1,__:[154]})):createCommentVNode("",!0),createVNode(j,{label:"退回事件",class:"normal-item-content"},{default:withCtx((()=>[createVNode(Ze,{checked:e.formConf.backFuncConfig.on,"onUpdate:checked":t[65]||(t[65]=o=>e.formConf.backFuncConfig.on=o)},null,8,["checked"])])),_:1}),e.formConf.backFuncConfig.on?(openBlock(),createBlock(j,{key:2,class:"!-mt-12px"},{default:withCtx((()=>[t[155]||(t[155]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口")],-1)),createVNode(unref(SelectInterface),{value:e.formConf.backFuncConfig.interfaceId,title:e.formConf.backFuncConfig.interfaceName,templateJson:e.formConf.backFuncConfig.templateJson,fieldOptions:e.funcOptions,sourceType:3,showSystemFullLabel:"",isFlow:"",fieldWidth:"60px",onChange:t[66]||(t[66]=(e,o)=>Be(unref(keyMap).backFuncConfig,e,o)),onFieldChange:de},null,8,["value","title","templateJson","fieldOptions"])])),_:1,__:[155]})):createCommentVNode("",!0),createVNode(j,{label:"撤回事件",class:"normal-item-content"},{default:withCtx((()=>[createVNode(Ze,{checked:e.formConf.recallFuncConfig.on,"onUpdate:checked":t[67]||(t[67]=o=>e.formConf.recallFuncConfig.on=o)},null,8,["checked"])])),_:1}),e.formConf.recallFuncConfig.on?(openBlock(),createBlock(j,{key:3,class:"!-mt-12px"},{default:withCtx((()=>[t[156]||(t[156]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口")],-1)),createVNode(unref(SelectInterface),{value:e.formConf.recallFuncConfig.interfaceId,title:e.formConf.recallFuncConfig.interfaceName,templateJson:e.formConf.recallFuncConfig.templateJson,fieldOptions:e.funcOptions,sourceType:3,showSystemFullLabel:"",isFlow:"",fieldWidth:"60px",onChange:t[68]||(t[68]=(e,o)=>Be(unref(keyMap).recallFuncConfig,e,o)),onFieldChange:de},null,8,["value","title","templateJson","fieldOptions"])])),_:1,__:[156]})):createCommentVNode("",!0)],64)):createCommentVNode("",!0),5===unref(a)?(openBlock(),createElementBlock(Fragment,{key:3},[createVNode(eo,{message:"自定义通知以“消息中心-发送配置”为主，请移步设置；关闭：表示不提醒，默认：表示站内提醒",type:"warning",showIcon:"",class:"!mb-10px"}),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.approveMsgConfig,type:"approve"},A.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.rejectMsgConfig,type:"reject"},A.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.backMsgConfig,type:"back"},A.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.copyMsgConfig,type:"copy"},A.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.overTimeMsgConfig,type:"overTime"},A.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.noticeMsgConfig,type:"notice"},A.value),null,16,["noticeConfig"])],64)):createCommentVNode("",!0),6===unref(a)?(openBlock(),createElementBlock(Fragment,{key:4},[createVNode(j,{label:"限时设置"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.timeLimitConfig.on,"onUpdate:value":t[69]||(t[69]=o=>e.formConf.timeLimitConfig.on=o),options:unref(nodeOverTimeMsgOptions),onChange:Ve},null,8,["value","options"]),1===e.formConf.timeLimitConfig.on?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(j,{class:"!mt-12px",label:"节点处理截止时间"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_41$1,[createVNode(ue,{value:e.formConf.timeLimitConfig.nodeLimit,"onUpdate:value":t[70]||(t[70]=o=>e.formConf.timeLimitConfig.nodeLimit=o),options:unref(overTimeOptions)},null,8,["value","options"]),t[157]||(t[157]=createBaseVNode("span",{class:"!ml-10px flex-shrink-0"},"开始",-1))]),2===e.formConf.timeLimitConfig.nodeLimit?(openBlock(),createElementBlock("div",_hoisted_42$1,[createVNode(ue,{value:e.formConf.timeLimitConfig.formField,"onUpdate:value":t[71]||(t[71]=o=>e.formConf.timeLimitConfig.formField=o),options:e.usedFormItems,fieldNames:{options:"options1"},showSearch:"",allowClear:""},null,8,["value","options"])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_43$1,[t[158]||(t[158]=createBaseVNode("span",{class:"w-85px inline-block"},"流程到达节点",-1)),createVNode($e,{value:e.formConf.timeLimitConfig.duringDeal,"onUpdate:value":t[72]||(t[72]=o=>e.formConf.timeLimitConfig.duringDeal=o),onChange:t[73]||(t[73]=e=>Le(e,"timeLimitConfig.duringDeal",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[159]||(t[159]=createBaseVNode("span",null,"小时后，视为超时",-1))])])),_:1}),createVNode(j,{label:"限时提醒规则",class:"!mt-12px"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.noticeConfig.on,"onUpdate:value":t[74]||(t[74]=o=>e.formConf.noticeConfig.on=o),options:unref(nodeOverTimeMsgOptions)},null,8,["value","options"])])),_:1}),1===e.formConf.noticeConfig.on?(openBlock(),createBlock(j,{key:0},{default:withCtx((()=>[createBaseVNode("div",_hoisted_44,[t[160]||(t[160]=createBaseVNode("span",{class:"w-85px inline-block"},"流程到达节点",-1)),createVNode($e,{value:e.formConf.noticeConfig.firstOver,"onUpdate:value":t[75]||(t[75]=o=>e.formConf.noticeConfig.firstOver=o),min:1,onChange:t[76]||(t[76]=e=>Le(e,"noticeConfig.firstOver",1)),precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[161]||(t[161]=createBaseVNode("span",null,"小时，开始提醒通知",-1))]),createBaseVNode("div",_hoisted_45,[t[162]||(t[162]=createBaseVNode("span",{class:"w-85px inline-block"},"每间隔",-1)),createVNode($e,{value:e.formConf.noticeConfig.overTimeDuring,"onUpdate:value":t[77]||(t[77]=o=>e.formConf.noticeConfig.overTimeDuring=o),onChange:t[78]||(t[78]=e=>Le(e,"noticeConfig.overTimeDuring",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[163]||(t[163]=createBaseVNode("span",null,"小时，提醒通知一次",-1))]),t[168]||(t[168]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"提醒事务")],-1)),createVNode(Xe,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(Oe,{checked:e.formConf.noticeConfig.overNotice,"onUpdate:checked":t[79]||(t[79]=o=>e.formConf.noticeConfig.overNotice=o)},{default:withCtx((()=>[t[164]||(t[164]=createTextVNode(" 提醒通知")),createVNode(h,{text:"勾选后才能进行提醒消息发送（站内信系统默认发送，第三方超时消息需在节点通知内配置）"})])),_:1,__:[164]},8,["checked"])])),_:1}),createCommentVNode("",!0),e.formConf.noticeConfig.overEvent?(openBlock(),createElementBlock("div",_hoisted_46,[t[166]||(t[166]=createBaseVNode("span",{class:"w-85px inline-block"},"在提醒通知第",-1)),createVNode($e,{value:e.formConf.noticeConfig.overEventTime,"onUpdate:value":t[81]||(t[81]=o=>e.formConf.noticeConfig.overEventTime=o),onChange:t[82]||(t[82]=e=>Le(e,"noticeConfig.overEventTime",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[167]||(t[167]=createBaseVNode("span",null,"次时，执行提醒事件",-1))])):createCommentVNode("",!0)])),_:1,__:[168]})):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1}),createVNode(j,{label:"超时设置"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.overTimeConfig.on,"onUpdate:value":t[83]||(t[83]=o=>e.formConf.overTimeConfig.on=o),options:unref(nodeOverTimeMsgOptions),disabled:0==e.formConf.timeLimitConfig.on},null,8,["value","options","disabled"])])),_:1}),1===e.formConf.overTimeConfig.on?(openBlock(),createBlock(j,{key:0},{default:withCtx((()=>[createBaseVNode("div",_hoisted_47,[t[169]||(t[169]=createBaseVNode("span",{class:"w-85px inline-block"},"超时",-1)),createVNode($e,{value:e.formConf.overTimeConfig.firstOver,"onUpdate:value":t[84]||(t[84]=o=>e.formConf.overTimeConfig.firstOver=o),onChange:t[85]||(t[85]=e=>Le(e,"overTimeConfig.firstOver",0)),min:0,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[170]||(t[170]=createBaseVNode("span",null,"小时，开始超时通知",-1))]),createBaseVNode("div",_hoisted_48,[t[171]||(t[171]=createBaseVNode("span",{class:"w-85px inline-block"},"每间隔",-1)),createVNode($e,{value:e.formConf.overTimeConfig.overTimeDuring,"onUpdate:value":t[86]||(t[86]=o=>e.formConf.overTimeConfig.overTimeDuring=o),onChange:t[87]||(t[87]=e=>Le(e,"overTimeConfig.overTimeDuring",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[172]||(t[172]=createBaseVNode("span",null,"小时，超时通知一次",-1))]),t[183]||(t[183]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"超时事务")],-1)),createVNode(Xe,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(Oe,{checked:e.formConf.overTimeConfig.overNotice,"onUpdate:checked":t[88]||(t[88]=o=>e.formConf.overTimeConfig.overNotice=o)},{default:withCtx((()=>[t[173]||(t[173]=createTextVNode(" 超时通知")),createVNode(h,{text:"勾选后才能进行提醒消息发送（站内信系统默认发送，第三方超时消息需在节点通知内配置）"})])),_:1,__:[173]},8,["checked"])])),_:1}),createCommentVNode("",!0),e.formConf.overTimeConfig.overEvent?(openBlock(),createElementBlock("div",_hoisted_49,[t[175]||(t[175]=createBaseVNode("span",{class:"w-85px inline-block"},"在超时通知",-1)),createVNode($e,{value:e.formConf.overTimeConfig.overEventTime,"onUpdate:value":t[90]||(t[90]=o=>e.formConf.overTimeConfig.overEventTime=o),onChange:t[91]||(t[91]=e=>Le(e,"overTimeConfig.overEventTime",1)),min:1,precision:0,class:"!w-90px !mx-5px"},null,8,["value"]),t[176]||(t[176]=createBaseVNode("span",null,"次时，执行超时事件",-1))])):createCommentVNode("",!0),createVNode(Xe,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(Oe,{checked:e.formConf.overTimeConfig.overAutoApprove,"onUpdate:checked":t[92]||(t[92]=o=>e.formConf.overTimeConfig.overAutoApprove=o),onChange:t[93]||(t[93]=o=>{e.formConf.overTimeConfig.overAutoApprove&&(p.formConf.overTimeConfig.overAutoTransfer=!1)})},{default:withCtx((()=>[t[177]||(t[177]=createTextVNode(" 超时自动审批 ")),createVNode(h,{text:"当前审批节点表单必填字段为空工单流转时不做校验，下一审批节点设置候选人员、选择分支、异常节点时当前审批节点规则失效"})])),_:1,__:[177]},8,["checked"])])),_:1}),e.formConf.overTimeConfig.overAutoApprove?(openBlock(),createElementBlock("div",_hoisted_50,[t[178]||(t[178]=createBaseVNode("span",{class:"w-85px inline-block"},"在超时通知",-1)),createVNode($e,{value:e.formConf.overTimeConfig.overAutoApproveTime,"onUpdate:value":t[94]||(t[94]=o=>e.formConf.overTimeConfig.overAutoApproveTime=o),onChange:t[95]||(t[95]=e=>Le(e,"overTimeConfig.overAutoApproveTime",1)),min:1,precision:0,class:"!w-90px !mx-5px"},null,8,["value"]),t[179]||(t[179]=createBaseVNode("span",null,"次，执行超时自动审批",-1))])):createCommentVNode("",!0),createVNode(Xe,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(Oe,{checked:e.formConf.overTimeConfig.overAutoTransfer,"onUpdate:checked":t[96]||(t[96]=o=>e.formConf.overTimeConfig.overAutoTransfer=o),onChange:t[97]||(t[97]=o=>{e.formConf.overTimeConfig.overAutoTransfer&&(p.formConf.overTimeConfig.overAutoApprove=!1)})},{default:withCtx((()=>t[180]||(t[180]=[createTextVNode(" 超时自动转审 ")]))),_:1,__:[180]},8,["checked"])])),_:1}),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createElementBlock("div",_hoisted_51,[t[181]||(t[181]=createBaseVNode("span",{class:"w-85px inline-block"},"在超时通知",-1)),createVNode($e,{value:e.formConf.overTimeConfig.overAutoTransferTime,"onUpdate:value":t[98]||(t[98]=o=>e.formConf.overTimeConfig.overAutoTransferTime=o),onChange:t[99]||(t[99]=e=>Le(e,"overTimeConfig.overAutoTransferTime",1)),min:1,precision:0,class:"!w-90px !mx-5px"},null,8,["value"]),t[182]||(t[182]=createBaseVNode("span",null,"次，执行超时自动转审",-1))])):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createElementBlock("div",_hoisted_52,"转审人设置")):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createBlock(ie,{key:5,value:e.formConf.overTimeConfig.overTimeType,"onUpdate:value":t[100]||(t[100]=o=>e.formConf.overTimeConfig.overTimeType=o),options:unref(O),class:"type-radio transfer-radio"},null,8,["value","options"])):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createElementBlock(Fragment,{key:6},[6===e.formConf.overTimeConfig.overTimeType?(openBlock(),createElementBlock("div",_hoisted_53,"指定转审人处理审批单")):createCommentVNode("",!0),9===e.formConf.overTimeConfig.overTimeType?(openBlock(),createElementBlock("div",_hoisted_54,"从目标接口中获取审批人")):createCommentVNode("",!0),11===e.formConf.overTimeConfig.overTimeType?(openBlock(),createElementBlock("div",_hoisted_55,"选择与超时审批人相关的设置")):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1,__:[183]})):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer&&1===e.formConf.overTimeConfig.on?(openBlock(),createElementBlock(Fragment,{key:1},[6===e.formConf.overTimeConfig.overTimeType?(openBlock(),createBlock(j,{key:0,class:"!mb-0"},{default:withCtx((()=>[createVNode(De,{value:e.formConf.overTimeConfig.reApprovers,"onUpdate:value":t[101]||(t[101]=o=>e.formConf.overTimeConfig.reApprovers=o),buttonType:"button",modalTitle:"添加转审人",multiple:!1},null,8,["value"])])),_:1})):createCommentVNode("",!0),11===e.formConf.overTimeConfig.overTimeType?(openBlock(),createBlock(j,{key:1,class:"!mb-0 !mt-10px"},{default:withCtx((()=>[createVNode(ue,{value:e.formConf.overTimeConfig.overTimeExtraRule,"onUpdate:value":t[102]||(t[102]=o=>e.formConf.overTimeConfig.overTimeExtraRule=o),options:w},null,8,["value"])])),_:1})):createCommentVNode("",!0),9===e.formConf.overTimeConfig.overTimeType?(openBlock(),createBlock(j,{key:2,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_56,[t[184]||(t[184]=createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口",-1)),createVNode(h,{text:'请求自带参数：taskId、taskNodeId，返回结构：JSON对象{"handleId":"id1,id2"}'})]),createVNode(unref(InterfaceModal),{value:e.formConf.overTimeConfig.interfaceId,title:e.formConf.overTimeConfig.interfaceName,onChange:ce},null,8,["value","title"]),e.formConf.overTimeConfig.templateJson?.length?(openBlock(),createElementBlock(Fragment,{key:0},[t[185]||(t[185]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"参数设置")],-1)),createVNode(unref(SelectInterfaceBtn),{templateJson:e.formConf.overTimeConfig.templateJson,fieldOptions:e.funcOptions,isFlow:"",showFieldFullLabel:"",showSystemFullLabel:"",onFieldChange:de},null,8,["templateJson","fieldOptions"])],64)):createCommentVNode("",!0)])),_:1})):createCommentVNode("",!0)],64)):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1},8,["model"])):(openBlock(),createBlock(to,{key:1,"data-source":e.formConf.formOperates,columns:S,size:"small",pagination:!1,scroll:{y:"calc(100vh - 197px)"}},{headerCell:withCtx((({column:e})=>["write"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(Oe,{checked:unref(l),"onUpdate:checked":t[103]||(t[103]=e=>isRef(l)?l.value=e:null),indeterminate:unref(s),onChange:t[104]||(t[104]=e=>me(e,1))},{default:withCtx((()=>t[186]||(t[186]=[createTextVNode("查看")]))),_:1,__:[186]},8,["checked","indeterminate"]),createVNode(Oe,{checked:unref(r),"onUpdate:checked":t[105]||(t[105]=e=>isRef(r)?r.value=e:null),indeterminate:unref(c),onChange:t[106]||(t[106]=e=>me(e,2))},{default:withCtx((()=>t[187]||(t[187]=[createTextVNode("编辑")]))),_:1,__:[187]},8,["checked","indeterminate"]),createVNode(Oe,{checked:unref(i),"onUpdate:checked":t[107]||(t[107]=e=>isRef(i)?i.value=e:null),indeterminate:unref(d),onChange:t[108]||(t[108]=e=>me(e,3))},{default:withCtx((()=>t[188]||(t[188]=[createTextVNode(" 必填 ")]))),_:1,__:[188]},8,["checked","indeterminate"])],64)):createCommentVNode("",!0)])),bodyCell:withCtx((({column:e,record:o})=>["write"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(Oe,{checked:o.read,"onUpdate:checked":e=>o.read=e,onChange:pe},{default:withCtx((()=>t[189]||(t[189]=[createTextVNode("查看")]))),_:2,__:[189]},1032,["checked","onUpdate:checked"]),createVNode(Oe,{checked:o.write,"onUpdate:checked":e=>o.write=e,onChange:pe},{default:withCtx((()=>t[190]||(t[190]=[createTextVNode("编辑")]))),_:2,__:[190]},1032,["checked","onUpdate:checked"]),createVNode(Oe,{checked:o.required,"onUpdate:checked":e=>o.required=e,disabled:o.requiredDisabled,onChange:pe},{default:withCtx((()=>t[191]||(t[191]=[createTextVNode("必填")]))),_:2,__:[191]},1032,["checked","onUpdate:checked","disabled"])],64)):createCommentVNode("",!0)])),_:1},8,["data-source"])),createVNode(_sfc_main$o,mergeProps({onRegister:unref(u)},M.value),null,16,["onRegister"]),createVNode(_sfc_main$q,{onRegister:unref(g),onConfirm:ge},null,8,["onRegister"]),createVNode(_sfc_main$n,{onRegister:unref(_),onConfirm:ye},null,8,["onRegister"]),createVNode(_sfc_main$m,{type:"workflow",onRegister:unref(N),onConfirm:Te},null,8,["onRegister"]),createVNode(_sfc_main$k,{onRegister:unref(y),onConfirm:Fe},null,8,["onRegister"])],64)}}}),_hoisted_1$e={class:"ant-select-arrow"},_hoisted_2$c={key:0,class:"common-tip"},_hoisted_3$c={key:1,class:"common-tip"},_hoisted_4$7={key:2,class:"common-tip"},_hoisted_5$4={key:3,class:"common-tip"},_hoisted_6$4={key:4,class:"common-tip"},_hoisted_7$4={class:"countersign-cell"},_hoisted_8$4={class:"countersign-cell"},_hoisted_9$3={class:"ant-form-item-label"},_hoisted_10$1={key:5},_hoisted_11$1={class:"countersign-cell mb-10px"},_hoisted_12$1={class:"countersign-cell"},_hoisted_13$1={key:2},_hoisted_14$1={class:"mt-10px"},_hoisted_15={class:"mt-10px"},_hoisted_16={class:"mt-10px"},_hoisted_17={key:0,class:"common-tip my-10px"},_hoisted_18={class:"btn-cell"},_hoisted_19={class:"btn-cell"},_hoisted_20={class:"btn-cell"},_hoisted_21={class:"btn-cell"},_hoisted_22={class:"custom-draggable-item mb-10px"},_hoisted_23=["onClick"],_hoisted_24={key:0,class:"add-btn"},_hoisted_25={key:0,class:"conditions-content"},_hoisted_26={key:1,class:"w-100%"},_hoisted_27=["onClick"],_hoisted_28={class:"flex items-center"},_hoisted_29={key:0,class:"mt-10px"},_hoisted_30={class:"countersign-cell mt-12px"},_hoisted_31={class:"countersign-cell"},_hoisted_32={class:"countersign-cell mt-12px"},_hoisted_33={key:1,class:"countersign-cell mt-12px"},_hoisted_34={class:"countersign-cell"},_hoisted_35={class:"countersign-cell mt-12px"},_hoisted_36={key:1,class:"countersign-cell"},_hoisted_37={key:2,class:"countersign-cell"},_hoisted_38={key:3,class:"countersign-cell"},_hoisted_39={key:4,class:"transfer-tip !mt-12px"},_hoisted_40={key:0,class:"common-tip !mt-12px"},_hoisted_41={key:1,class:"common-tip !mt-12px"},_hoisted_42={key:2,class:"common-tip !mt-12px"},_hoisted_43={class:"ant-form-item-label"},_sfc_main$i=defineComponent({inheritAttrs:!1,__name:"ProcessingNode",props:["formConf","printTplOptions","prevNodeList","beforeNodeOptions","funcOptions","noticeOptions","formFieldsOptions","usedFormItems","getFormFieldList","initFormOperates","updateJnpfData","nodeOptions","flowState","type","updateFormFieldList","updateBpmnProperties"],emits:["updateDivideRule"],setup(e,{expose:o,emit:t}){const n=reactive({activeKey:1,assignList:[],userLabel:"",readAllChecked:!1,writeAllChecked:!1,requiredAllChecked:!1,isReadIndeterminate:!1,isWriteIndeterminate:!1,isRequiredIndeterminate:!1,conditionType:"",currentBtnIndex:0,jsJson:"({ flowInfo, formData, taskInfo, onlineUtils }) => {\n    // 在此编写代码\n    \n}",formLoading:!1});o({getContent:ne,updateCheckStatus:de});const{activeKey:a,readAllChecked:l,writeAllChecked:r,requiredAllChecked:i,isReadIndeterminate:s,isWriteIndeterminate:c,isRequiredIndeterminate:d,formLoading:f}=toRefs(n),m=t,p=e,[u,{openModal:C}]=useModal(),[g,{openModal:v}]=useModal(),[_,{openModal:h}]=useModal(),[N,{openModal:k}]=useModal(),y=inject("bpmn"),V=[{id:1,fullName:"无办理人范围"},{id:6,fullName:"同一公司"},{id:2,fullName:"同一部门"},{id:3,fullName:"同一岗位"},{id:4,fullName:"发起人上级"},{id:5,fullName:"发起人下属"}],B=[{id:1,fullName:"无候选人范围"},{id:6,fullName:"同一公司"},{id:2,fullName:"同一部门"},{id:3,fullName:"同一岗位"}],x=[{id:2,fullName:"同一部门"},{id:7,fullName:"同一角色"},{id:3,fullName:"同一岗位"},{id:8,fullName:"同一分组"}],T=V.map((e=>1===e.id?{id:1,fullName:"无抄送人范围"}:e)),w=[{id:0,fullName:"或签（一名成员办理即可）"},{id:1,fullName:"会签（无序会签，办理达到会签比例，办理通过）"}],b=[{id:1,fullName:"按百分比"},{id:2,fullName:"按人数"}],F=[{id:1,fullName:"实时计算"},{id:2,fullName:"延后计算"}],L=[{id:0,fullName:"无"},...b],U=[{title:"表单字段",dataIndex:"name",key:"name"},{title:"操作",dataIndex:"write",key:"write",align:"center",width:250}],I=[{id:1,fullName:"字段"},{id:2,fullName:"自定义"},{id:3,fullName:"系统参数"}],S=[{id:1,fullName:"发起人"},{id:2,fullName:"上节点办理人"}],D=[{fullName:"指定成员",id:6},{fullName:"超时办理人",id:11},{fullName:"数据接口",id:9}],$=computed((()=>y())),O=computed((()=>{const e=unref($).get("jnpfData");return e?.getValue("global")||{}})),j=computed((()=>({funcOptions:p.noticeOptions,isApprover:!0}))),R=computed((()=>({formConf:p.formConf,formFieldsOptions:p.formFieldsOptions}))),A=computed((()=>{let e=[...defaultStep,...p.beforeNodeOptions];return 2==p.formConf.backType&&(e=e.filter((e=>1!=e.id))),e})),M=computed((()=>NodeUtils.getConditionsContent(p.formConf.printConfig.conditions,p.formConf.printConfig.matchLogic))),E=computed((()=>systemFieldOptions.map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id}))))),J=computed((()=>unref(O).globalParameterList||[])),P=computed((()=>unref(O).approvalFieldList||[])),K=computed((()=>6===p.formConf.assigneeType&&p.formConf.approvers.length&&p.formConf.approvers.every((e=>-1!==e.indexOf("--user")))&&2==p.formConf.counterSign)),q=computed((()=>p.formConf.assignList.length&&p.formConf.assignList.some((e=>e.ruleList?.length)))),z=computed((()=>ee(p.usedFormItems,p.formConf.formFieldType))),H=computed((()=>ee(p.usedFormItems,p.formConf.copyFormFieldType)));function G(e,o){if(!e)return function(){p.formConf.formName="",p.formConf.formId="";let e=[];const o=unref($).get("jnpfData").getValue("global"),t=o.formId;t&&o.allFormMap&&o.allFormMap["form_"+t]&&(e=o.allFormMap["form_"+t]||[]);p.updateFormFieldList(e),p.formConf.formOperates=p.initFormOperates(p.formConf,!0)}();const t=p.formConf.formId===e;p.formConf.formName=o.fullName,p.formConf.formId=e,p.formConf.assignList=[],p.getFormFieldList(e,"approverForm",t)}function Y(e){2==e?.target?.value&&1==p.formConf.backNodeCode&&(p.formConf.backNodeCode=0)}function W(){const e=function(e){const o=unref($).get("jnpfData").getValue("global");let t=p.prevNodeList.map((e=>{let t=[];const n=e.formId;if(n&&"start"!=e.type&&o.allFormMap&&o.allFormMap["form_"+n]){let e=cloneDeep(o.allFormMap["form_"+n])||[];e=e.filter((e=>"table"!==e.__config__.jnpfKey)),e=e.map((e=>({...e,id:e.id+"|"+n})));const a=[{id:"@prevNodeFormId",fullName:"上节点表单Id"}];t.push({fullName:"上节点表单",children:[...a,...e]})}const a=o.formId;if(a&&o.allFormMap&&o.allFormMap["form_"+a]){let e=cloneDeep(o.allFormMap["form_"+a])||[];e=e.filter((e=>"table"!==e.__config__.jnpfKey)),e=e.map((e=>({...e,id:e.id+"|"+a})));const n=[{id:"@startNodeFormId",fullName:"发起节点表单Id"}];t.push({fullName:"发起节点表单",children:[...n,...e]})}const l=cloneDeep(o.globalParameterList).map((e=>({...e,fullName:e.fieldName,id:e.fieldName+"|globalParameter"})));return l.length&&t.push({fullName:"全局变量",children:l||[]}),{nodeId:e.id,title:e.fullName,formFieldList:t,ruleList:[]}}));if(!e.length)return t;let n=[];for(let l=0;l<e.length;l++){const o=e[l];e:for(let e=0;e<t.length;e++)if(o.nodeId===t[e].nodeId){const a={nodeId:o.nodeId,title:t[e].title,formFieldList:t[e].formFieldList,ruleList:o.ruleList};n.push(a);break e}}const a=t.filter((o=>!e.some((e=>e.nodeId===o.nodeId))));return[...n,...a]}(p.formConf.assignList?cloneDeep(p.formConf.assignList):[]);C(!0,{assignList:e})}function Q(){p.formConf.approvers=[],p.formConf.approversSortList=[],p.formConf.extraRule=1,p.updateBpmnProperties("elementBodyName",ne())}function X(){p.formConf.formField=""}function Z(){p.formConf.copyFormField=""}function ee(e,o){return 2===o?e.filter((e=>"depSelect"==e.__config__.jnpfKey)):3===o?e.filter((e=>"posSelect"==e.__config__.jnpfKey)):4===o?e.filter((e=>"roleSelect"==e.__config__.jnpfKey)):5===o?e.filter((e=>"groupSelect"==e.__config__.jnpfKey)):e.filter((e=>"userSelect"==e.__config__.jnpfKey||"usersSelect"==e.__config__.jnpfKey))}function oe(e){if(6!=p.formConf.assigneeType||!e||!e.length||!e.every((e=>-1!==e.indexOf("--user"))))return p.formConf.approversSortList=[];if(!p.formConf.approversSortList.length)return p.formConf.approversSortList=e;const o=p.formConf.approversSortList.filter((o=>-1!==e.indexOf(o))),t=e.filter((e=>-1===p.formConf.approversSortList.indexOf(e)));p.formConf.approversSortList=[...o,...t]}function te(e){n.userLabel=e,p.updateBpmnProperties("elementBodyName",ne())}function ne(){let e=typeConfig[bpmnProcessing].renderer.bodyDefaultText;return e=6!=p.formConf.assigneeType?typeOptions.find((e=>e.id===p.formConf.assigneeType))?.fullName||typeConfig[bpmnProcessing].renderer.bodyDefaultText:n.userLabel||typeConfig[bpmnProcessing].renderer.bodyDefaultText,p.formConf.content=e,e}function ae(e,o){if(!e)return p.formConf.interfaceConfig.interfaceId="",p.formConf.interfaceConfig.interfaceName="",void(p.formConf.interfaceConfig.templateJson=[]);p.formConf.interfaceConfig.interfaceId!==e&&(p.formConf.interfaceConfig.interfaceId=e,p.formConf.interfaceConfig.interfaceName=o.fullName,p.formConf.interfaceConfig.templateJson=o.templateJson.map((e=>({...e,sourceType:1})))||[])}function le(e,o){if(!e)return p.formConf.overTimeConfig.interfaceId="",p.formConf.overTimeConfig.interfaceName="",void(p.formConf.overTimeConfig.templateJson=[]);p.formConf.overTimeConfig.interfaceId!==e&&(p.formConf.overTimeConfig.interfaceId=e,p.formConf.overTimeConfig.interfaceName=o.fullName,p.formConf.overTimeConfig.templateJson=o.templateJson.map((e=>({...e,sourceType:1})))||[])}function re(e,o){if(!e)return;let t=p.funcOptions.filter((o=>o.id===e));if(!t.length)return;let n=t[0];o.isSubTable=!(!n.__config__||!n.__config__.isSubTable)&&n.__config__.isSubTable}function ie(e,o){e||(p.formConf.counterSignConfig[o]=1)}function se(e,o){const t=e.target.checked;1==o&&(n.isReadIndeterminate=!1),2==o&&(n.isWriteIndeterminate=!1),3==o&&(n.isRequiredIndeterminate=!1),p.formConf.formOperates.forEach((e=>{1==o&&(e.read=t),2==o&&(e.write=t),3!=o||e.requiredDisabled||(e.required=t)}))}function ce(){de()}function de(){const e=p.formConf.formOperates.length,o=p.formConf.formOperates.filter((e=>!e.requiredDisabled)).length;let t=0,a=0,l=0;p.formConf.formOperates.forEach((e=>{e.read&&t++,e.write&&a++,e.required&&!e.requiredDisabled&&l++})),n.readAllChecked=!!e&&e===t,n.writeAllChecked=!!e&&e===a,n.requiredAllChecked=!!e&&o===l,n.isReadIndeterminate=!!t&&t<e,n.isWriteIndeterminate=!!a&&a<e,n.isRequiredIndeterminate=!!l&&l<o}function fe(){n.conditionType="print",v(!0,{usedFormItems:p.usedFormItems,formFieldsOptions:p.formFieldsOptions,...p.formConf.printConfig})}function me(e){const o="print"==n.conditionType?"printConfig":"audit"==n.conditionType?"autoAuditRule":"autoRejectRule";p.formConf[o]={...p.formConf[o],...e}}function pe(){p.formConf.printConfig.matchLogic="and",p.formConf.printConfig.conditions=[]}function ue(){p.formConf.parameterList.push({field:"",fieldValueType:2,fieldValue:""})}function Ce(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.fullName||""}function ge(){h(!0,{ids:p.formConf.approversSortList})}function ve(e){p.formConf.approversSortList=e}function _e(e){0==e&&(p.formConf.overTimeConfig.on=0)}function he(e){p.formConf.customBtns[n.currentBtnIndex].jsJson=e}function Ne(e,o,t){let n=o.split("."),a=p.formConf;for(;n.length>1;){a=a[n.shift()]}a[n[0]]=e||t}function ke(){1!=n.formLoading&&(n.formLoading=!0,p.getFormFieldList(p.formConf.formId,"approverForm",!0).then((()=>{n.formLoading=!1})).catch((()=>{n.formLoading=!1})))}return watch((()=>p.formConf),(()=>p.updateJnpfData(p.formConf)),{deep:!0,immediate:!0}),watch((()=>n.activeKey),(e=>{3==e&&de()})),(o,t)=>{const C=resolveComponent("a-tab-pane"),v=resolveComponent("a-tabs"),h=resolveComponent("BasicHelp"),y=resolveComponent("a-button"),$=resolveComponent("a-tooltip"),ee=resolveComponent("a-form-item"),ne=resolveComponent("a-input"),de=resolveComponent("jnpf-radio"),ye=resolveComponent("jnpf-select"),Ve=resolveComponent("a-select-option"),Be=resolveComponent("a-select"),xe=resolveComponent("a-input-group"),Te=resolveComponent("jnpf-users-select"),we=resolveComponent("a-input-number"),be=resolveComponent("a-checkbox"),Fe=resolveComponent("a-radio"),Le=resolveComponent("a-radio-group"),Ue=resolveComponent("a-divider"),Ie=resolveComponent("jnpf-tree-select"),Se=resolveComponent("a-col"),De=resolveComponent("jnpf-switch"),$e=resolveComponent("jnpf-time-picker"),Oe=resolveComponent("jnpf-date-picker"),je=resolveComponent("jnpf-organize-select"),Re=resolveComponent("jnpf-dep-select"),Ae=resolveComponent("jnpf-role-select"),Me=resolveComponent("jnpf-group-select"),Ee=resolveComponent("jnpf-pos-select"),Je=resolveComponent("jnpf-user-select"),Pe=resolveComponent("jnpf-area-select"),Ke=resolveComponent("a-row"),qe=resolveComponent("a-alert"),ze=resolveComponent("a-form"),He=resolveComponent("a-table");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:t[0]||(t[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(v,{activeKey:unref(a),"onUpdate:activeKey":t[1]||(t[1]=e=>isRef(a)?a.value=e:null),size:"small",class:"pane-tabs approver-pane-tabs"},{default:withCtx((()=>[(openBlock(),createBlock(C,{key:1,tab:"基础信息"})),(openBlock(),createBlock(C,{key:2,tab:"高级设置"})),(openBlock(),createBlock(C,{key:3,tab:"表单权限"})),(openBlock(),createBlock(C,{key:5,tab:"流程通知"})),(openBlock(),createBlock(C,{key:6,tab:"超时设置"}))])),_:1},8,["activeKey"]),3!==unref(a)?(openBlock(),createBlock(ze,{key:0,colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[1===unref(a)?(openBlock(),createElementBlock(Fragment,{key:0},[O.value?.hasAloneConfigureForms?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(ee,{class:"form-item-reload"},{label:withCtx((()=>[t[88]||(t[88]=createTextVNode("表单设置")),createVNode(h,{text:"办理节点不设置表单，默认引用发起节点表单"})])),default:withCtx((()=>[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,onChange:G,placeholder:"请选择",disabled:0!=e.flowState},null,8,["value","title","disabled"]),0==e.flowState&&e.formConf.formId?(openBlock(),createBlock($,{key:0,title:"刷新表单"},{default:withCtx((()=>[createVNode(y,{onClick:ke},{default:withCtx((()=>[createVNode(unref(ReloadOutlined),{spin:unref(f)},null,8,["spin"])])),_:1})])),_:1})):createCommentVNode("",!0)])),_:1}),(openBlock(),createBlock(ee,{key:0},{label:withCtx((()=>[t[89]||(t[89]=createTextVNode(" 数据传递 ")),createVNode(h,{text:["不设置传递规则时字段名称相同自动赋值","设置传递规则时相同名称字段会自动赋值字段后再按传递规则赋值"]})])),default:withCtx((()=>[createVNode(ne,{value:q.value?"已设置":"",placeholder:"请设置数据传递规则",readonly:"",class:"hand",onClick:W},{suffix:withCtx((()=>[createBaseVNode("span",_hoisted_1$e,[createVNode(unref(DownOutlined))])])),_:1},8,["value"])])),_:1}))],64)):createCommentVNode("",!0),createVNode(ee,{label:"办理设置"},{default:withCtx((()=>[createVNode(de,{value:e.formConf.assigneeType,"onUpdate:value":t[2]||(t[2]=o=>e.formConf.assigneeType=o),options:unref(typeOptions).filter((e=>5!=e.id&&7!=e.id)),class:"type-radio",onChange:Q},null,8,["value","options"]),createBaseVNode("div",{class:normalizeClass({"mb-10px":3!==e.formConf.assigneeType,"mt-10px":!0})},[[1,2].includes(e.formConf.assigneeType)?(openBlock(),createElementBlock("div",_hoisted_2$c,"选择主管")):createCommentVNode("",!0),3===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_3$c,"发起者自己将作为办理人处理办理单")):createCommentVNode("",!0),4===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_4$7,"选择流程表单字段的值作为办理人")):createCommentVNode("",!0),6===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_5$4,"指定办理人处理办理单")):createCommentVNode("",!0),9===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_6$4,"从目标接口中获取办理人")):createCommentVNode("",!0)],2),1==e.formConf.assigneeType?(openBlock(),createBlock(ee,{key:0,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_7$4,[createVNode(ye,{value:e.formConf.approverType,"onUpdate:value":t[3]||(t[3]=o=>e.formConf.approverType=o),options:S,class:"!w-130px mr-8px"},null,8,["value"]),t[90]||(t[90]=createTextVNode(" 的 ")),createVNode(Be,{value:e.formConf.managerLevel,"onUpdate:value":t[4]||(t[4]=o=>e.formConf.managerLevel=o),placeholder:"请选择",class:"flex-1 ml-8px"},{default:withCtx((()=>[(openBlock(),createElementBlock(Fragment,null,renderList(10,(e=>createVNode(Ve,{key:e,value:e},{default:withCtx((()=>[createTextVNode(toDisplayString(1===e?"直属主管":"第"+e+"级主管"),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])])])),_:1})):createCommentVNode("",!0),2==e.formConf.assigneeType?(openBlock(),createBlock(ee,{key:1,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_8$4,[createVNode(ye,{value:e.formConf.managerApproverType,"onUpdate:value":t[5]||(t[5]=o=>e.formConf.managerApproverType=o),options:S,class:"!w-130px mr-8px"},null,8,["value"]),t[91]||(t[91]=createTextVNode(" 的部门主管 "))])])),_:1})):createCommentVNode("",!0),4===e.formConf.assigneeType?(openBlock(),createBlock(ee,{key:2,label:"表单字段",class:"!mb-0"},{default:withCtx((()=>[createVNode(xe,{compact:""},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.formFieldType,"onUpdate:value":t[6]||(t[6]=o=>e.formConf.formFieldType=o),options:unref(formFieldTypeOptions),class:"!w-100px",onChange:X},null,8,["value","options"]),createVNode(ye,{value:e.formConf.formField,"onUpdate:value":t[7]||(t[7]=o=>e.formConf.formField=o),options:z.value,fieldNames:{options:"options1"},showSearch:"",style:{width:"calc(100% - 100px)"}},null,8,["value","options"])])),_:1})])),_:1})):createCommentVNode("",!0),5===e.formConf.assigneeType?(openBlock(),createBlock(ee,{key:3,label:"办理节点",class:"!mb-0"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.approverNodeId,"onUpdate:value":t[8]||(t[8]=o=>e.formConf.approverNodeId=o),showSearch:"",options:e.nodeOptions},null,8,["value","options"])])),_:1})):createCommentVNode("",!0),9===e.formConf.assigneeType?(openBlock(),createBlock(ee,{key:4,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_9$3,[t[92]||(t[92]=createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口",-1)),createVNode(h,{text:'请求自带参数：taskId、taskNodeId，返回结构：JSON对象{"handleId":"id1,id2"}'})]),createVNode(unref(InterfaceModal),{value:e.formConf.interfaceConfig.interfaceId,title:e.formConf.interfaceConfig.interfaceName,onChange:ae},null,8,["value","title"]),e.formConf.interfaceConfig.templateJson?.length?(openBlock(),createElementBlock(Fragment,{key:0},[t[93]||(t[93]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"参数设置")],-1)),createVNode(unref(SelectInterfaceBtn),{templateJson:e.formConf.interfaceConfig.templateJson,fieldOptions:e.funcOptions,isFlow:"",showFieldFullLabel:"",showSystemFullLabel:"",onFieldChange:re},null,8,["templateJson","fieldOptions"])],64)):createCommentVNode("",!0)])),_:1})):createCommentVNode("",!0),6===e.formConf.assigneeType||7===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_10$1,[createVNode(Te,{value:e.formConf.approvers,"onUpdate:value":t[9]||(t[9]=o=>e.formConf.approvers=o),buttonType:"button",modalTitle:6===e.formConf.assigneeType?"添加办理人":"添加候选人",multiple:"",onChange:oe,onLabelChange:te},null,8,["value","modalTitle"])])):createCommentVNode("",!0),6===e.formConf.assigneeType||7===e.formConf.assigneeType&&e.formConf.approvers?.length?(openBlock(),createBlock(ee,{key:6,class:"!mb-0 !mt-10px"},{label:withCtx((()=>[createTextVNode(toDisplayString(6===e.formConf.assigneeType?"办理人范围":"候选人范围")+" ",1),createVNode(h,{text:6===e.formConf.assigneeType?"指定成员增加人员选择范围附加条件":"候选人增加人员选择范围附加条件"},null,8,["text"])])),default:withCtx((()=>[createVNode(ye,{value:e.formConf.extraRule,"onUpdate:value":t[10]||(t[10]=o=>e.formConf.extraRule=o),options:6===e.formConf.assigneeType?V:B},null,8,["value","options"])])),_:1})):createCommentVNode("",!0)])),_:1}),createVNode(ee,{label:"办理方式"},{default:withCtx((()=>[createVNode(de,{value:e.formConf.counterSign,"onUpdate:value":t[11]||(t[11]=o=>e.formConf.counterSign=o),options:w,class:"counterSign-radio"},null,8,["value"])])),_:1}),1==e.formConf.counterSign?(openBlock(),createBlock(ee,{key:1,label:"设置会签流转规则"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_11$1,[t[94]||(t[94]=createBaseVNode("span",{class:"w-70px inline-block"},"同意规则",-1)),createVNode(ye,{value:e.formConf.counterSignConfig.auditType,"onUpdate:value":t[12]||(t[12]=o=>e.formConf.counterSignConfig.auditType=o),options:b,class:"!w-120px !mx-10px"},null,8,["value"]),1===e.formConf.counterSignConfig.auditType?(openBlock(),createBlock(Be,{key:0,value:e.formConf.counterSignConfig.auditRatio,"onUpdate:value":t[13]||(t[13]=o=>e.formConf.counterSignConfig.auditRatio=o),class:"!w-120px !mr-10px"},{default:withCtx((()=>[(openBlock(),createElementBlock(Fragment,null,renderList(10,(e=>createVNode(Ve,{key:e,value:10*e},{default:withCtx((()=>[createTextVNode(toDisplayString(10*e+"%"),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])):createCommentVNode("",!0),2===e.formConf.counterSignConfig.auditType?(openBlock(),createBlock(we,{key:1,class:"!w-120px !mr-10px",value:e.formConf.counterSignConfig.auditNum,"onUpdate:value":t[14]||(t[14]=o=>e.formConf.counterSignConfig.auditNum=o),placeholder:"请输入",precision:0,min:1,onChange:t[15]||(t[15]=e=>ie(e,"auditNum"))},null,8,["value"])):createCommentVNode("",!0),t[95]||(t[95]=createBaseVNode("span",null,"进入下一节点",-1))]),createBaseVNode("div",_hoisted_12$1,[t[96]||(t[96]=createBaseVNode("span",{class:"w-70px inline-block"},"不同意规则",-1)),createVNode(ye,{value:e.formConf.counterSignConfig.rejectType,"onUpdate:value":t[16]||(t[16]=o=>e.formConf.counterSignConfig.rejectType=o),options:L,class:"!w-120px !mx-10px"},null,8,["value"]),1===e.formConf.counterSignConfig.rejectType?(openBlock(),createBlock(Be,{key:0,value:e.formConf.counterSignConfig.rejectRatio,"onUpdate:value":t[17]||(t[17]=o=>e.formConf.counterSignConfig.rejectRatio=o),class:"!w-120px !mr-10px"},{default:withCtx((()=>[(openBlock(),createElementBlock(Fragment,null,renderList(10,(e=>createVNode(Ve,{key:e,value:10*e},{default:withCtx((()=>[createTextVNode(toDisplayString(10*e+"%"),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])):createCommentVNode("",!0),2===e.formConf.counterSignConfig.rejectType?(openBlock(),createBlock(we,{key:1,class:"!w-120px !mr-10px",value:e.formConf.counterSignConfig.rejectNum,"onUpdate:value":t[18]||(t[18]=o=>e.formConf.counterSignConfig.rejectNum=o),placeholder:"请输入",precision:0,min:1,onChange:t[19]||(t[19]=e=>ie(e,"rejectNum"))},null,8,["value"])):createCommentVNode("",!0),e.formConf.counterSignConfig.rejectType?(openBlock(),createElementBlock("span",_hoisted_13$1,"时拒绝")):createCommentVNode("",!0)])])),_:1})):createCommentVNode("",!0),1==e.formConf.counterSign?(openBlock(),createBlock(ee,{key:2},{label:withCtx((()=>[t[97]||(t[97]=createTextVNode("计算方式")),createVNode(h,{text:["实时计算：办理过程中实时进行规则判断","延后计算：在所有办理人办理完成后进行规则判断"]})])),default:withCtx((()=>[createVNode(de,{value:e.formConf.counterSignConfig.calculateType,"onUpdate:value":t[20]||(t[20]=o=>e.formConf.counterSignConfig.calculateType=o),options:F},null,8,["value"])])),_:1})):createCommentVNode("",!0),K.value?(openBlock(),createBlock(ee,{key:3,label:"设置依次办理顺序"},{default:withCtx((()=>[createVNode(y,{preIcon:"icon-ym icon-ym-btn-add",onClick:ge},{default:withCtx((()=>t[98]||(t[98]=[createTextVNode("设置办理顺序")]))),_:1,__:[98]})])),_:1})):createCommentVNode("",!0),createVNode(ee,{label:"办理意见"},{default:withCtx((()=>[createVNode(be,{checked:e.formConf.hasSign,"onUpdate:checked":t[21]||(t[21]=o=>e.formConf.hasSign=o)},{default:withCtx((()=>t[99]||(t[99]=[createTextVNode("启用签名")]))),_:1,__:[99]},8,["checked"]),createBaseVNode("div",_hoisted_14$1,[createVNode(be,{checked:e.formConf.hasFile,"onUpdate:checked":t[22]||(t[22]=o=>e.formConf.hasFile=o)},{default:withCtx((()=>t[100]||(t[100]=[createTextVNode("启用附件")]))),_:1,__:[100]},8,["checked"])]),e.formConf.hasApprovalField?(openBlock(),createBlock(ye,{key:0,value:e.formConf.approvalField,"onUpdate:value":t[23]||(t[23]=o=>e.formConf.approvalField=o),options:P.value,fieldNames:{label:"fieldName",options:"options1"},multiple:"",class:"mt-10px"},null,8,["value","options"])):createCommentVNode("",!0)])),_:1}),createVNode(ee,{label:"抄送设置"},{default:withCtx((()=>[createVNode(Te,{value:e.formConf.circulateUser,"onUpdate:value":t[24]||(t[24]=o=>e.formConf.circulateUser=o),buttonType:"button",modalTitle:"添加抄送人",multiple:""},null,8,["value"]),createVNode(ee,{class:"!pt-10px"},{label:withCtx((()=>[t[101]||(t[101]=createTextVNode("抄送人范围")),createVNode(h,{text:"抄送人员增加人员选择范围附加条件"})])),default:withCtx((()=>[createVNode(ye,{value:e.formConf.extraCopyRule,"onUpdate:value":t[25]||(t[25]=o=>e.formConf.extraCopyRule=o),options:unref(T)},null,8,["value","options"])])),_:1}),createVNode(be,{checked:e.formConf.isCustomCopy,"onUpdate:checked":t[26]||(t[26]=o=>e.formConf.isCustomCopy=o)},{default:withCtx((()=>t[102]||(t[102]=[createTextVNode("允许自选抄送人")]))),_:1,__:[102]},8,["checked"]),createBaseVNode("div",_hoisted_15,[createVNode(be,{checked:e.formConf.isInitiatorCopy,"onUpdate:checked":t[27]||(t[27]=o=>e.formConf.isInitiatorCopy=o)},{default:withCtx((()=>t[103]||(t[103]=[createTextVNode("抄送给流程发起人")]))),_:1,__:[103]},8,["checked"])]),createBaseVNode("div",_hoisted_16,[createVNode(be,{checked:e.formConf.isFormFieldCopy,"onUpdate:checked":t[28]||(t[28]=o=>e.formConf.isFormFieldCopy=o)},{default:withCtx((()=>t[104]||(t[104]=[createTextVNode("抄送给表单变量")]))),_:1,__:[104]},8,["checked"])]),e.formConf.isFormFieldCopy?(openBlock(),createElementBlock("div",_hoisted_17,"选择流程表单字段的值作为抄送人")):createCommentVNode("",!0),e.formConf.isFormFieldCopy?(openBlock(),createBlock(ee,{key:1,class:"!mb-0"},{default:withCtx((()=>[createVNode(xe,{compact:""},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.copyFormFieldType,"onUpdate:value":t[29]||(t[29]=o=>e.formConf.copyFormFieldType=o),options:unref(formFieldTypeOptions),class:"!w-100px",onChange:Z},null,8,["value","options"]),createVNode(ye,{value:e.formConf.copyFormField,"onUpdate:value":t[30]||(t[30]=o=>e.formConf.copyFormField=o),options:H.value,fieldNames:{options:"options1"},showSearch:"",style:{width:"calc(100% - 100px)"}},null,8,["value","options"])])),_:1})])),_:1})):createCommentVNode("",!0)])),_:1})],64)):createCommentVNode("",!0),2===unref(a)?(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(ee,{label:"处置操作"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_18,[createVNode(be,{checked:e.formConf.hasAuditBtn,"onUpdate:checked":t[31]||(t[31]=o=>e.formConf.hasAuditBtn=o)},{default:withCtx((()=>t[105]||(t[105]=[createTextVNode("办理")]))),_:1,__:[105]},8,["checked"]),createVNode(ne,{value:e.formConf.auditBtnText,"onUpdate:value":t[32]||(t[32]=o=>e.formConf.auditBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_19,[createVNode(be,{checked:e.formConf.hasBackBtn,"onUpdate:checked":t[33]||(t[33]=o=>e.formConf.hasBackBtn=o)},{default:withCtx((()=>t[106]||(t[106]=[createTextVNode("退回")]))),_:1,__:[106]},8,["checked"]),createVNode(ne,{value:e.formConf.backBtnText,"onUpdate:value":t[34]||(t[34]=o=>e.formConf.backBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_20,[createVNode(be,{checked:e.formConf.hasTransferBtn,"onUpdate:checked":t[35]||(t[35]=o=>e.formConf.hasTransferBtn=o)},{default:withCtx((()=>t[107]||(t[107]=[createTextVNode("转办")]))),_:1,__:[107]},8,["checked"]),createVNode(ne,{value:e.formConf.transferBtnText,"onUpdate:value":t[36]||(t[36]=o=>e.formConf.transferBtnText=o),placeholder:"请输入"},null,8,["value"])]),createBaseVNode("div",_hoisted_21,[createVNode(be,{checked:e.formConf.hasSaveAuditBtn,"onUpdate:checked":t[37]||(t[37]=o=>e.formConf.hasSaveAuditBtn=o)},{default:withCtx((()=>t[108]||(t[108]=[createTextVNode("暂存")]))),_:1,__:[108]},8,["checked"]),createVNode(ne,{value:e.formConf.saveAuditBtnText,"onUpdate:value":t[38]||(t[38]=o=>e.formConf.saveAuditBtnText=o),placeholder:"请输入"},null,8,["value"])])])),_:1}),e.formConf.hasBackBtn?(openBlock(),createBlock(ee,{key:0},{label:withCtx((()=>[t[109]||(t[109]=createTextVNode("退回设置")),createVNode(h,{text:"纯表单流程设置退回到发起节点无效"})])),default:withCtx((()=>[t[113]||(t[113]=createBaseVNode("div",{class:"form-item-content"},null,-1)),createVNode(ee,{label:"被退回的节点重新提交时"},{default:withCtx((()=>[createVNode(Le,{value:e.formConf.backType,"onUpdate:value":t[39]||(t[39]=o=>e.formConf.backType=o),class:"counterSign-radio",onChange:Y},{default:withCtx((()=>[createVNode(Fe,{value:1},{default:withCtx((()=>[t[110]||(t[110]=createTextVNode("重新办理")),createVNode(h,{text:"若流程为A->B->C，C退回至A，则C->A->B->C"})])),_:1,__:[110]}),createVNode(Fe,{value:2},{default:withCtx((()=>[t[111]||(t[111]=createTextVNode("从当前节点办理")),createVNode(h,{text:"若流程为A->B->C，C退回至A，则C->A->C"})])),_:1,__:[111]}),createVNode(Fe,{value:3},{default:withCtx((()=>[t[112]||(t[112]=createTextVNode("自定义办理")),createVNode(h,{text:"由用户选择重新办理或从当前节点办理"})])),_:1,__:[112]})])),_:1},8,["value"])])),_:1}),createVNode(ee,{label:"设置退回到的节点",class:"!mb-0px"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.backNodeCode,"onUpdate:value":t[40]||(t[40]=o=>e.formConf.backNodeCode=o),options:A.value,showSearch:""},null,8,["value","options"])])),_:1})])),_:1,__:[113]})):createCommentVNode("",!0),createVNode(Ue,null,{default:withCtx((()=>t[114]||(t[114]=[createBaseVNode("text",{class:"approver-text"},"自定义按钮区",-1)]))),_:1,__:[114]}),createVNode(ee,{class:"custom-draggable-list"},{default:withCtx((()=>[createVNode(unref(draggable),{modelValue:e.formConf.customBtns,"onUpdate:modelValue":t[41]||(t[41]=o=>e.formConf.customBtns=o),animation:300,group:"selectItem",handle:".option-drag",itemKey:"value"},{item:withCtx((({element:o,index:a})=>[createBaseVNode("div",_hoisted_22,[t[117]||(t[117]=createBaseVNode("div",{class:"custom-line-icon option-drag"},[createBaseVNode("i",{class:"icon-ym icon-ym-darg"})],-1)),createVNode(xe,{class:"btn-cell ml-15px mr-15px",style:{"margin-bottom":"0"},compact:""},{default:withCtx((()=>[createVNode(ne,{value:o.label,"onUpdate:value":e=>o.label=e,maxlength:4,onBlur:e=>function(e){if(""===e.element.label){const o={...e.element,label:"按钮"+(e.index+1)};p.formConf.customBtns[e.index]=o}}({element:o,index:a})},null,8,["value","onUpdate:value","onBlur"]),createVNode(y,{onClick:e=>function(e,o){n.currentBtnIndex=o,k(!0,{text:e.jsJson||n.jsJson})}(o,a)},{default:withCtx((()=>t[115]||(t[115]=[createTextVNode("事件")]))),_:2,__:[115]},1032,["onClick"])])),_:2},1024),createBaseVNode("div",{class:"close-btn custom-line-icon",onClick:o=>e.formConf.customBtns.splice(a,1)},t[116]||(t[116]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn"},null,-1)]),8,_hoisted_23)])])),_:1},8,["modelValue"]),e.formConf.customBtns?.length<5?(openBlock(),createElementBlock("div",_hoisted_24,[createVNode(y,{type:"link",preIcon:"icon-ym icon-ym-btn-add",onClick:t[42]||(t[42]=e=>function(){const e={value:"btn_"+buildBitUUID(),label:"按钮"+(p.formConf.customBtns.length+1),jsJson:n.jsJson};p.formConf.customBtns.push(e)}())},{default:withCtx((()=>t[118]||(t[118]=[createTextVNode("添加按钮")]))),_:1,__:[118]})])):createCommentVNode("",!0)])),_:1}),createVNode(ee,{label:"节点打印"},{default:withCtx((()=>[createVNode(be,{class:"leading-32px",checked:e.formConf.printConfig.on,"onUpdate:checked":t[43]||(t[43]=o=>e.formConf.printConfig.on=o)},{default:withCtx((()=>t[119]||(t[119]=[createTextVNode("节点打印")]))),_:1,__:[119]},8,["checked"]),e.formConf.printConfig.on?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(ee,{label:"请选择打印模板",class:"!mt-12px"},{default:withCtx((()=>[createVNode(Ie,{value:e.formConf.printConfig.printIds,"onUpdate:value":t[44]||(t[44]=o=>e.formConf.printConfig.printIds=o),options:e.printTplOptions,multiple:"",lastLevel:"",showCheckedStrategy:unref(TreeSelect).SHOW_CHILD},null,8,["value","options","showCheckedStrategy"])])),_:1}),createVNode(ee,{label:"打印条件"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.printConfig.conditionType,"onUpdate:value":t[45]||(t[45]=o=>e.formConf.printConfig.conditionType=o),options:unref(printConditionTypeOptions)},null,8,["value","options"])])),_:1}),4==e.formConf.printConfig.conditionType?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(y,{onClick:fe},{default:withCtx((()=>t[120]||(t[120]=[createTextVNode("设置打印条件")]))),_:1,__:[120]}),e.formConf.printConfig.conditions.length?(openBlock(),createElementBlock("div",_hoisted_25,[createBaseVNode("span",{onClick:fe},toDisplayString(M.value),1),createBaseVNode("i",{class:"icon-ym icon-ym-delete",onClick:pe})])):createCommentVNode("",!0)],64)):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1}),createVNode(ee,{label:"节点参数"},{default:withCtx((()=>[createBaseVNode("div",{class:"parameter-content"},[t[121]||(t[121]=createBaseVNode("span",null,"参数设置",-1)),createBaseVNode("i",{class:"icon-ym icon-ym-btn-add",onClick:ue})]),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.parameterList,((o,t)=>(openBlock(),createBlock(Ke,{gutter:8,class:"condition-main mt-10px",key:t},{default:withCtx((()=>[createVNode(Se,{span:8,class:"overflow-auto"},{default:withCtx((()=>[createVNode(ye,{value:o.field,"onUpdate:value":e=>o.field=e,options:J.value,fieldNames:{label:"fieldName",value:"fieldName",options:"options1"}},null,8,["value","onUpdate:value","options"])])),_:2},1024),createVNode(Se,{span:5,class:"overflow-auto"},{default:withCtx((()=>[createVNode(ye,{value:o.fieldValueType,"onUpdate:value":e=>o.fieldValueType=e,options:I,onChange:e=>function(e){e.fieldValue="",e.fieldLabel=""}(o)},null,8,["value","onUpdate:value","onChange"])])),_:2},1024),createVNode(Se,{span:9,class:"overflow-auto"},{default:withCtx((()=>[1===o.fieldValueType?(openBlock(),createBlock(ye,{key:0,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,options:e.usedFormItems,allowClear:"",showSearch:"",fieldNames:{options:"options1"},class:"w-100%",onChange:(e,t)=>function(e,o,t){e.fieldLabel=o?t.fullName:"",e.fieldValueJnpfKey=o?t.__config__.jnpfKey:""}(o,e,t)},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0),2===o.fieldValueType?(openBlock(),createElementBlock("div",_hoisted_26,["inputNumber"===o.jnpfKey?(openBlock(),createBlock(we,{key:0,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",precision:o.precision},null,8,["value","onUpdate:value","precision"])):"calculate"===o.jnpfKey?(openBlock(),createBlock(we,{key:1,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",precision:2},null,8,["value","onUpdate:value"])):["rate","slider"].includes(o.jnpfKey)?(openBlock(),createBlock(we,{key:2,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入"},null,8,["value","onUpdate:value"])):"switch"===o.jnpfKey?(openBlock(),createBlock(De,{key:3,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e},null,8,["value","onUpdate:value"])):"timePicker"===o.jnpfKey?(openBlock(),createBlock($e,{key:4,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,format:o.format||"HH:mm:ss",allowClear:""},null,8,["value","onUpdate:value","format"])):["datePicker","createTime","modifyTime"].includes(o.jnpfKey)?(openBlock(),createBlock(Oe,{key:5,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,format:o.format,allowClear:"",onChange:e=>function(e,o){if(!e)return o.fieldLabel="";const t=o.format||"YYYY-MM-DD HH:mm:ss";o.fieldLabel=formatToDateTime(e,t)}(e,o)},null,8,["value","onUpdate:value","format","onChange"])):["organizeSelect","currOrganize"].includes(o.jnpfKey)?(openBlock(),createBlock(je,{key:6,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>function(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.organize||""}(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["depSelect"].includes(o.jnpfKey)?(openBlock(),createBlock(Re,{key:7,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ce(o,e,t)},null,8,["value","onUpdate:value","onChange"])):"roleSelect"===o.jnpfKey?(openBlock(),createBlock(Ae,{key:8,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ce(o,e,t)},null,8,["value","onUpdate:value","onChange"])):"groupSelect"===o.jnpfKey?(openBlock(),createBlock(Me,{key:9,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ce(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["posSelect","currPosition"].includes(o.jnpfKey)?(openBlock(),createBlock(Ee,{key:10,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ce(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["userSelect","createUser","modifyUser"].includes(o.jnpfKey)?(openBlock(),createBlock(Je,{key:11,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,hasSys:"",allowClear:"",onChange:(e,t)=>Ce(o,e,t)},null,8,["value","onUpdate:value","onChange"])):["usersSelect"].includes(o.jnpfKey)?(openBlock(),createBlock(Te,{key:12,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",onChange:(e,t)=>Ce(o,e,t)},null,8,["value","onUpdate:value","onChange"])):"areaSelect"===o.jnpfKey?(openBlock(),createBlock(Pe,{key:13,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,level:o.level,allowClear:"",onChange:(e,t)=>function(e,o,t){if(!o)return e.fieldLabel="";const n=t.map((e=>e.fullName));e.fieldLabel=n.join("/")}(o,e,t)},null,8,["value","onUpdate:value","level","onChange"])):(openBlock(),createBlock(ne,{key:14,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"]))])):3===o.fieldValueType?(openBlock(),createBlock(ye,{key:2,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,options:E.value,fieldNames:{label:"label",options:"options1"},allowClear:"",class:"w-100%"},null,8,["value","onUpdate:value","options"])):createCommentVNode("",!0)])),_:2},1024),createVNode(Se,{span:2,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e){p.formConf.parameterList.splice(e,1)}(t)},null,8,_hoisted_27)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),1!=p.type?(openBlock(),createBlock(ee,{key:1,label:"分流规则"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.divideRule,"onUpdate:value":t[46]||(t[46]=o=>e.formConf.divideRule=o),options:unref(divideRuleOptions),onChange:t[47]||(t[47]=e=>{m("updateDivideRule",p.formConf.divideRule)})},null,8,["value","options"])])),_:1})):createCommentVNode("",!0)],64)):createCommentVNode("",!0),5===unref(a)?(openBlock(),createElementBlock(Fragment,{key:2},[createVNode(qe,{message:"自定义通知以“消息中心-发送配置”为主，请移步设置；关闭：表示不提醒，默认：表示站内提醒",type:"warning",showIcon:"",class:"!mb-10px"}),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.backMsgConfig,type:"back"},j.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.copyMsgConfig,type:"copy"},j.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.overTimeMsgConfig,type:"overTime"},j.value),null,16,["noticeConfig"]),createVNode(_sfc_main$t,mergeProps({noticeConfig:e.formConf.noticeMsgConfig,type:"notice"},j.value),null,16,["noticeConfig"])],64)):createCommentVNode("",!0),6===unref(a)?(openBlock(),createElementBlock(Fragment,{key:3},[createVNode(ee,{label:"限时设置"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.timeLimitConfig.on,"onUpdate:value":t[48]||(t[48]=o=>e.formConf.timeLimitConfig.on=o),options:unref(nodeOverTimeMsgOptions),onChange:_e},null,8,["value","options"]),1===e.formConf.timeLimitConfig.on?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(ee,{class:"!mt-12px",label:"节点处理截止时间"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_28,[createVNode(ye,{value:e.formConf.timeLimitConfig.nodeLimit,"onUpdate:value":t[49]||(t[49]=o=>e.formConf.timeLimitConfig.nodeLimit=o),options:unref(overTimeOptions)},null,8,["value","options"]),t[122]||(t[122]=createBaseVNode("span",{class:"!ml-10px flex-shrink-0"},"开始",-1))]),2===e.formConf.timeLimitConfig.nodeLimit?(openBlock(),createElementBlock("div",_hoisted_29,[createVNode(ye,{value:e.formConf.timeLimitConfig.formField,"onUpdate:value":t[50]||(t[50]=o=>e.formConf.timeLimitConfig.formField=o),options:e.usedFormItems,fieldNames:{options:"options1"},showSearch:"",allowClear:""},null,8,["value","options"])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_30,[t[123]||(t[123]=createBaseVNode("span",{class:"w-85px inline-block"},"流程到达节点",-1)),createVNode(we,{value:e.formConf.timeLimitConfig.duringDeal,"onUpdate:value":t[51]||(t[51]=o=>e.formConf.timeLimitConfig.duringDeal=o),onChange:t[52]||(t[52]=e=>Ne(e,"timeLimitConfig.duringDeal",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[124]||(t[124]=createBaseVNode("span",null,"小时后，视为超时",-1))])])),_:1}),createVNode(ee,{label:"限时提醒规则",class:"!mt-12px"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.noticeConfig.on,"onUpdate:value":t[53]||(t[53]=o=>e.formConf.noticeConfig.on=o),options:unref(nodeOverTimeMsgOptions)},null,8,["value","options"])])),_:1}),1===e.formConf.noticeConfig.on?(openBlock(),createBlock(ee,{key:0},{default:withCtx((()=>[createBaseVNode("div",_hoisted_31,[t[125]||(t[125]=createBaseVNode("span",{class:"w-85px inline-block"},"流程到达节点",-1)),createVNode(we,{value:e.formConf.noticeConfig.firstOver,"onUpdate:value":t[54]||(t[54]=o=>e.formConf.noticeConfig.firstOver=o),onChange:t[55]||(t[55]=e=>Ne(e,"noticeConfig.firstOver",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[126]||(t[126]=createBaseVNode("span",null,"小时，开始提醒通知",-1))]),createBaseVNode("div",_hoisted_32,[t[127]||(t[127]=createBaseVNode("span",{class:"w-85px inline-block"},"每间隔",-1)),createVNode(we,{value:e.formConf.noticeConfig.overTimeDuring,"onUpdate:value":t[56]||(t[56]=o=>e.formConf.noticeConfig.overTimeDuring=o),onChange:t[57]||(t[57]=e=>Ne(e,"noticeConfig.overTimeDuring",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[128]||(t[128]=createBaseVNode("span",null,"小时，提醒通知一次",-1))]),t[133]||(t[133]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"提醒事务")],-1)),createVNode(Ke,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(be,{checked:e.formConf.noticeConfig.overNotice,"onUpdate:checked":t[58]||(t[58]=o=>e.formConf.noticeConfig.overNotice=o)},{default:withCtx((()=>[t[129]||(t[129]=createTextVNode(" 提醒通知")),createVNode(h,{text:"勾选后才能进行提醒消息发送（站内信系统默认发送，第三方超时消息需在节点通知内配置）"})])),_:1,__:[129]},8,["checked"])])),_:1}),createCommentVNode("",!0),e.formConf.noticeConfig.overEvent?(openBlock(),createElementBlock("div",_hoisted_33,[t[131]||(t[131]=createBaseVNode("span",{class:"w-85px inline-block"},"在提醒通知第",-1)),createVNode(we,{value:e.formConf.noticeConfig.overEventTime,"onUpdate:value":t[60]||(t[60]=o=>e.formConf.noticeConfig.overEventTime=o),onChange:t[61]||(t[61]=e=>Ne(e,"noticeConfig.overEventTime",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[132]||(t[132]=createBaseVNode("span",null,"次时，执行提醒事件",-1))])):createCommentVNode("",!0)])),_:1,__:[133]})):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1}),createVNode(ee,{label:"超时设置"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.overTimeConfig.on,"onUpdate:value":t[62]||(t[62]=o=>e.formConf.overTimeConfig.on=o),options:unref(nodeOverTimeMsgOptions),disabled:0==e.formConf.timeLimitConfig.on},null,8,["value","options","disabled"])])),_:1}),1===e.formConf.overTimeConfig.on?(openBlock(),createBlock(ee,{key:0},{default:withCtx((()=>[createBaseVNode("div",_hoisted_34,[t[134]||(t[134]=createBaseVNode("span",{class:"w-85px inline-block"},"超时",-1)),createVNode(we,{value:e.formConf.overTimeConfig.firstOver,"onUpdate:value":t[63]||(t[63]=o=>e.formConf.overTimeConfig.firstOver=o),onChange:t[64]||(t[64]=e=>Ne(e,"overTimeConfig.firstOver",0)),min:0,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[135]||(t[135]=createBaseVNode("span",null,"小时，开始超时通知",-1))]),createBaseVNode("div",_hoisted_35,[t[136]||(t[136]=createBaseVNode("span",{class:"w-85px inline-block"},"每间隔",-1)),createVNode(we,{value:e.formConf.overTimeConfig.overTimeDuring,"onUpdate:value":t[65]||(t[65]=o=>e.formConf.overTimeConfig.overTimeDuring=o),onChange:t[66]||(t[66]=e=>Ne(e,"overTimeConfig.overTimeDuring",1)),min:1,precision:0,class:"!w-90px !mx-8px"},null,8,["value"]),t[137]||(t[137]=createBaseVNode("span",null,"小时，超时通知一次",-1))]),t[148]||(t[148]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"超时事务")],-1)),createVNode(Ke,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(be,{checked:e.formConf.overTimeConfig.overNotice,"onUpdate:checked":t[67]||(t[67]=o=>e.formConf.overTimeConfig.overNotice=o)},{default:withCtx((()=>[t[138]||(t[138]=createTextVNode(" 超时通知")),createVNode(h,{text:"勾选后才能进行提醒消息发送（站内信系统默认发送，第三方超时消息需在节点通知内配置）"})])),_:1,__:[138]},8,["checked"])])),_:1}),createCommentVNode("",!0),e.formConf.overTimeConfig.overEvent?(openBlock(),createElementBlock("div",_hoisted_36,[t[140]||(t[140]=createBaseVNode("span",{class:"w-85px inline-block"},"在超时通知",-1)),createVNode(we,{value:e.formConf.overTimeConfig.overEventTime,"onUpdate:value":t[69]||(t[69]=o=>e.formConf.overTimeConfig.overEventTime=o),onChange:t[70]||(t[70]=e=>Ne(e,"overTimeConfig.overEventTime",1)),min:1,precision:0,class:"!w-90px !mx-5px"},null,8,["value"]),t[141]||(t[141]=createBaseVNode("span",null,"次时，执行超时事件",-1))])):createCommentVNode("",!0),createVNode(Ke,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(be,{checked:e.formConf.overTimeConfig.overAutoApprove,"onUpdate:checked":t[71]||(t[71]=o=>e.formConf.overTimeConfig.overAutoApprove=o),onChange:t[72]||(t[72]=o=>{e.formConf.overTimeConfig.overAutoApprove&&(p.formConf.overTimeConfig.overAutoTransfer=!1)})},{default:withCtx((()=>[t[142]||(t[142]=createTextVNode(" 超时自动办理 ")),createVNode(h,{text:"当前办理节点表单必填字段为空工单流转时不做校验，下一办理节点设置候选人员、选择分支、异常节点时当前办理节点规则失效"})])),_:1,__:[142]},8,["checked"])])),_:1}),e.formConf.overTimeConfig.overAutoApprove?(openBlock(),createElementBlock("div",_hoisted_37,[t[143]||(t[143]=createBaseVNode("span",{class:"w-85px inline-block"},"在超时通知",-1)),createVNode(we,{value:e.formConf.overTimeConfig.overAutoApproveTime,"onUpdate:value":t[73]||(t[73]=o=>e.formConf.overTimeConfig.overAutoApproveTime=o),onChange:t[74]||(t[74]=e=>Ne(e,"overTimeConfig.overAutoApproveTime",1)),min:1,precision:0,class:"!w-90px !mx-5px"},null,8,["value"]),t[144]||(t[144]=createBaseVNode("span",null,"次，执行超时自动办理",-1))])):createCommentVNode("",!0),createVNode(Ke,{class:"leading-32px block"},{default:withCtx((()=>[createVNode(be,{checked:e.formConf.overTimeConfig.overAutoTransfer,"onUpdate:checked":t[75]||(t[75]=o=>e.formConf.overTimeConfig.overAutoTransfer=o),onChange:t[76]||(t[76]=o=>{e.formConf.overTimeConfig.overAutoTransfer&&(p.formConf.overTimeConfig.overAutoApprove=!1)})},{default:withCtx((()=>t[145]||(t[145]=[createTextVNode(" 超时自动转办 ")]))),_:1,__:[145]},8,["checked"])])),_:1}),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createElementBlock("div",_hoisted_38,[t[146]||(t[146]=createBaseVNode("span",{class:"w-85px inline-block"},"在超时通知",-1)),createVNode(we,{value:e.formConf.overTimeConfig.overAutoTransferTime,"onUpdate:value":t[77]||(t[77]=o=>e.formConf.overTimeConfig.overAutoTransferTime=o),onChange:t[78]||(t[78]=e=>Ne(e,"overTimeConfig.overAutoTransferTime",1)),min:1,precision:0,class:"!w-90px !mx-5px"},null,8,["value"]),t[147]||(t[147]=createBaseVNode("span",null,"次，执行超时自动转办",-1))])):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createElementBlock("div",_hoisted_39,"转办人设置")):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createBlock(de,{key:5,value:e.formConf.overTimeConfig.overTimeType,"onUpdate:value":t[79]||(t[79]=o=>e.formConf.overTimeConfig.overTimeType=o),options:D,class:"type-radio transfer-radio"},null,8,["value"])):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer?(openBlock(),createElementBlock(Fragment,{key:6},[6===e.formConf.overTimeConfig.overTimeType?(openBlock(),createElementBlock("div",_hoisted_40,"指定转办人处理办理单")):createCommentVNode("",!0),9===e.formConf.overTimeConfig.overTimeType?(openBlock(),createElementBlock("div",_hoisted_41,"从目标接口中获取办理人")):createCommentVNode("",!0),11===e.formConf.overTimeConfig.overTimeType?(openBlock(),createElementBlock("div",_hoisted_42,"选择与超时办理人相关的设置")):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1,__:[148]})):createCommentVNode("",!0),e.formConf.overTimeConfig.overAutoTransfer&&1===e.formConf.overTimeConfig.on?(openBlock(),createElementBlock(Fragment,{key:1},[6===e.formConf.overTimeConfig.overTimeType?(openBlock(),createBlock(ee,{key:0,class:"!mb-0"},{default:withCtx((()=>[createVNode(Te,{value:e.formConf.overTimeConfig.reApprovers,"onUpdate:value":t[80]||(t[80]=o=>e.formConf.overTimeConfig.reApprovers=o),buttonType:"button",modalTitle:"添加转办人",multiple:!1},null,8,["value"])])),_:1})):createCommentVNode("",!0),11===e.formConf.overTimeConfig.overTimeType?(openBlock(),createBlock(ee,{key:1,class:"!mb-0 !mt-10px"},{default:withCtx((()=>[createVNode(ye,{value:e.formConf.overTimeConfig.overTimeExtraRule,"onUpdate:value":t[81]||(t[81]=o=>e.formConf.overTimeConfig.overTimeExtraRule=o),options:x},null,8,["value"])])),_:1})):createCommentVNode("",!0),9===e.formConf.overTimeConfig.overTimeType?(openBlock(),createBlock(ee,{key:2,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_43,[t[149]||(t[149]=createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口",-1)),createVNode(h,{text:'请求自带参数：taskId、taskNodeId，返回结构：JSON对象{"handleId":"id1,id2"}'})]),createVNode(unref(InterfaceModal),{value:e.formConf.overTimeConfig.interfaceId,title:e.formConf.overTimeConfig.interfaceName,onChange:le},null,8,["value","title"]),e.formConf.overTimeConfig.templateJson?.length?(openBlock(),createElementBlock(Fragment,{key:0},[t[150]||(t[150]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"参数设置")],-1)),createVNode(unref(SelectInterfaceBtn),{templateJson:e.formConf.overTimeConfig.templateJson,fieldOptions:e.funcOptions,isFlow:"",showFieldFullLabel:"",showSystemFullLabel:"",onFieldChange:re},null,8,["templateJson","fieldOptions"])],64)):createCommentVNode("",!0)])),_:1})):createCommentVNode("",!0)],64)):createCommentVNode("",!0)],64)):createCommentVNode("",!0)])),_:1},8,["model"])):(openBlock(),createBlock(He,{key:1,"data-source":e.formConf.formOperates,columns:U,size:"small",pagination:!1,scroll:{y:"calc(100vh - 197px)"}},{headerCell:withCtx((({column:e})=>["write"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(be,{checked:unref(l),"onUpdate:checked":t[82]||(t[82]=e=>isRef(l)?l.value=e:null),indeterminate:unref(s),onChange:t[83]||(t[83]=e=>se(e,1))},{default:withCtx((()=>t[151]||(t[151]=[createTextVNode("查看")]))),_:1,__:[151]},8,["checked","indeterminate"]),createVNode(be,{checked:unref(r),"onUpdate:checked":t[84]||(t[84]=e=>isRef(r)?r.value=e:null),indeterminate:unref(c),onChange:t[85]||(t[85]=e=>se(e,2))},{default:withCtx((()=>t[152]||(t[152]=[createTextVNode("编辑")]))),_:1,__:[152]},8,["checked","indeterminate"]),createVNode(be,{checked:unref(i),"onUpdate:checked":t[86]||(t[86]=e=>isRef(i)?i.value=e:null),indeterminate:unref(d),onChange:t[87]||(t[87]=e=>se(e,3))},{default:withCtx((()=>t[153]||(t[153]=[createTextVNode(" 必填 ")]))),_:1,__:[153]},8,["checked","indeterminate"])],64)):createCommentVNode("",!0)])),bodyCell:withCtx((({column:e,record:o})=>["write"===e.key?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(be,{checked:o.read,"onUpdate:checked":e=>o.read=e,onChange:ce},{default:withCtx((()=>t[154]||(t[154]=[createTextVNode("查看")]))),_:2,__:[154]},1032,["checked","onUpdate:checked"]),createVNode(be,{checked:o.write,"onUpdate:checked":e=>o.write=e,onChange:ce},{default:withCtx((()=>t[155]||(t[155]=[createTextVNode("编辑")]))),_:2,__:[155]},1032,["checked","onUpdate:checked"]),createVNode(be,{checked:o.required,"onUpdate:checked":e=>o.required=e,disabled:o.requiredDisabled,onChange:ce},{default:withCtx((()=>t[156]||(t[156]=[createTextVNode("必填")]))),_:2,__:[156]},1032,["checked","onUpdate:checked","disabled"])],64)):createCommentVNode("",!0)])),_:1},8,["data-source"])),createVNode(_sfc_main$o,mergeProps({onRegister:unref(u)},R.value),null,16,["onRegister"]),createVNode(_sfc_main$q,{onRegister:unref(g),onConfirm:me},null,8,["onRegister"]),createVNode(_sfc_main$n,{onRegister:unref(_),onConfirm:ve},null,8,["onRegister"]),createVNode(_sfc_main$m,{type:"workflow",onRegister:unref(N),onConfirm:he},null,8,["onRegister"])],64)}}}),_hoisted_1$d={class:"ant-select-arrow"},_hoisted_2$b={key:0,class:"common-tip"},_hoisted_3$b={key:1,class:"common-tip"},_hoisted_4$6={key:2,class:"common-tip"},_hoisted_5$3={key:3,class:"common-tip"},_hoisted_6$3={key:4,class:"common-tip"},_hoisted_7$3={key:5,class:"common-tip"},_hoisted_8$3={key:6,class:"common-tip"},_hoisted_9$2={class:"countersign-cell"},_hoisted_10={class:"countersign-cell"},_hoisted_11={class:"ant-form-item-label"},_hoisted_12={key:5},_hoisted_13={key:0,class:"common-tip !mt-12px"},_hoisted_14={key:1,class:"common-tip !mt-12px"},_sfc_main$h=defineComponent({inheritAttrs:!1,__name:"SubFlowNode",props:["printTplOptions","prevNodeList","noticeOptions","formFieldsOptions","formConf","getFormFieldList","updateJnpfData","transformFormJson","transformFieldList","beforeNodeOptions","type","updateBpmnProperties"],emits:["updateDivideRule"],setup(e,{expose:o,emit:t}){const n=reactive({activeKey:1,childFieldOptions:[],userLabel:"",childOptions:[]}),{childFieldOptions:a}=toRefs(n);o({getSubFlowFormInfo:B});const{createMessage:l}=useMessage(),r=t,i=e,{activeKey:s}=toRefs(n),c=inject("bpmn"),[d,{openModal:f}]=useModal(),m=[{id:1,fullName:"发起人"},{id:2,fullName:"上节点审批人"}],p=[{id:1,fullName:"无审批人范围"},{id:6,fullName:"同一公司"},{id:2,fullName:"同一部门"},{id:3,fullName:"同一岗位"},{id:4,fullName:"发起人上级"},{id:5,fullName:"发起人下属"}],u=[{id:1,fullName:"无候选人范围"},{id:6,fullName:"同一公司"},{id:2,fullName:"同一部门"},{id:3,fullName:"同一岗位"}],C=computed((()=>c())),g=computed((()=>({formConf:i.formConf,formFieldsOptions:i.formFieldsOptions}))),v=computed((()=>{return e=n.childOptions,2===(o=i.formConf.formFieldType)?e.filter((e=>"depSelect"==e.__config__.jnpfKey)):3===o?e.filter((e=>"posSelect"==e.__config__.jnpfKey)):4===o?e.filter((e=>"roleSelect"==e.__config__.jnpfKey)):5===o?e.filter((e=>"groupSelect"==e.__config__.jnpfKey)):e.filter((e=>"userSelect"==e.__config__.jnpfKey||"usersSelect"==e.__config__.jnpfKey));var e,o}));function _(e,o){if(!e)return i.formConf.interfaceConfig.interfaceId="",i.formConf.interfaceConfig.interfaceName="",void(i.formConf.interfaceConfig.templateJson=[]);i.formConf.interfaceConfig.interfaceId!==e&&(i.formConf.interfaceConfig.interfaceId=e,i.formConf.interfaceConfig.interfaceName=o.fullName,i.formConf.interfaceConfig.templateJson=o.templateJson.map((e=>({...e,sourceType:1})))||[])}function h(){i.formConf.formField=""}function N(e,o){if(!e)return;let t=n.childFieldOptions.filter((o=>o.id===e));if(!t.length)return;let a=t[0];o.isSubTable=!(!a.__config__||!a.__config__.isSubTable)&&a.__config__.isSubTable}function k(){i.formConf.approvers=[],i.formConf.approversSortList=[],i.formConf.extraRule=1,i.updateBpmnProperties("elementBodyName",y())}function y(){let e=typeConfig[bpmnTask].renderer.bodyDefaultText;return e=6!=i.formConf.assigneeType&&1==i.formConf.subFlowLaunchPermission?typeOptions.find((e=>e.id===i.formConf.assigneeType))?.fullName||typeConfig[bpmnTask].renderer.bodyDefaultText:n.userLabel||typeConfig[bpmnTask].renderer.bodyDefaultText,i.formConf.content=e,e}function V(e,o){if(!e)return i.formConf.flowId="",i.formConf.flowName="",i.formConf.assignList=[],i.formConf.approvers=[],n.childFieldOptions=[],n.childOptions=[],i.formConf.subFlowLaunchPermission=1,void i.updateBpmnProperties("elementBodyName",y());i.formConf.flowId!==e&&(i.formConf.flowId=e,i.formConf.flowName=o.fullName,i.formConf.assignList=[],i.formConf.approvers=[],i.formConf.subFlowLaunchPermission=o.visibleType||1,i.updateBpmnProperties("elementBodyName",y()),B())}function B(){i.formConf.flowId&&getFlowFormInfo(i.formConf.flowId).then((e=>{let{type:o=1,formData:t}=e.data;i.formConf.formId=e.data.id;let a={},l=[],r=[];t&&(a=JSON.parse(t)),l=2==o?i.transformFormJson(a):a.fields,r=i.transformFieldList(l).filter((e=>"table"!==e.__config__.jnpfKey)),n.childFieldOptions=r.map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id,disabled:!1}))),n.childOptions=n.childFieldOptions.filter((e=>"table"!==e.__config__.jnpfKey&&!e.__config__.isSubTable))}))}function x(e,o){T(o.map((e=>e.fullName)).join())}function T(e){n.userLabel=e,i.updateBpmnProperties("elementBodyName",y())}function w(){if(!i.formConf.flowId)return l.error("请选择子流程表单");const e=function(e){const o=unref(C).get("jnpfData").getValue("global");let t=i.prevNodeList.map((e=>{let t=[];const n=e.formId,a=o.formId,l=n||a;if(l&&"start"!=e.type&&o.allFormMap&&o.allFormMap["form_"+l]){let e=cloneDeep(o.allFormMap["form_"+l])||[];e=e.filter((e=>"table"!==e.__config__.jnpfKey)),e=e.map((e=>({...e,id:e.id+"|"+l})));const n=[{id:"@prevNodeFormId",fullName:"上节点表单Id"}];t.push({fullName:"上节点表单",children:[...n,...e]})}if(n&&a&&o.allFormMap&&o.allFormMap["form_"+a]){let e=cloneDeep(o.allFormMap["form_"+a])||[];e=e.filter((e=>"table"!==e.__config__.jnpfKey)),e=e.map((e=>({...e,id:e.id+"|"+a})));const n=[{id:"@startNodeFormId",fullName:"发起节点表单Id"}];t.push({fullName:"发起节点表单",children:[...n,...e]})}const r=cloneDeep(o.globalParameterList).map((e=>({...e,fullName:e.fieldName,id:e.fieldName+"|globalParameter"})));return r.length&&t.push({fullName:"全局变量",children:r||[]}),{nodeId:e.id,title:e.fullName,formFieldList:t,ruleList:[]}}));if(!e.length)return t;let n=[];for(let l=0;l<e.length;l++){const o=e[l];e:for(let e=0;e<t.length;e++)if(o.nodeId===t[e].nodeId){const a={nodeId:o.nodeId,title:t[e].title,formFieldList:t[e].formFieldList,ruleList:o.ruleList};n.push(a);break e}}const a=t.filter((o=>!e.some((e=>e.nodeId===o.nodeId))));return[...n,...a]}(i.formConf.assignList?cloneDeep(i.formConf.assignList):[]);f(!0,{assignList:e,childFieldOptions:n.childFieldOptions,isSubFlow:1})}return watch((()=>i.formConf),(()=>i.updateJnpfData()),{deep:!0,immediate:!0}),onMounted((()=>{B()})),(o,t)=>{const n=resolveComponent("a-tab-pane"),l=resolveComponent("a-tabs"),c=resolveComponent("a-radio"),f=resolveComponent("a-radio-group"),C=resolveComponent("a-form-item"),y=resolveComponent("a-input"),B=resolveComponent("jnpf-radio"),b=resolveComponent("jnpf-select"),F=resolveComponent("a-select-option"),L=resolveComponent("a-select"),U=resolveComponent("a-input-group"),I=resolveComponent("BasicHelp"),S=resolveComponent("jnpf-users-select"),D=resolveComponent("jnpf-user-select"),$=resolveComponent("a-alert"),O=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:t[0]||(t[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(l,{activeKey:unref(s),"onUpdate:activeKey":t[1]||(t[1]=e=>isRef(s)?s.value=e:null),size:"small",class:"pane-tabs"},{default:withCtx((()=>[(openBlock(),createBlock(n,{key:1,tab:"基础信息"})),(openBlock(),createBlock(n,{key:2,tab:"节点通知"}))])),_:1},8,["activeKey"]),createVNode(O,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[1===unref(s)?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(C,{label:"子流程类型"},{default:withCtx((()=>[createVNode(f,{value:e.formConf.isAsync,"onUpdate:value":t[2]||(t[2]=o=>e.formConf.isAsync=o),class:"common-radio"},{default:withCtx((()=>[createVNode(c,{value:0},{default:withCtx((()=>t[20]||(t[20]=[createTextVNode("同步")]))),_:1,__:[20]}),createVNode(c,{value:1},{default:withCtx((()=>t[21]||(t[21]=[createTextVNode("异步")]))),_:1,__:[21]})])),_:1},8,["value"])])),_:1}),createVNode(C,{label:"子流程表单"},{default:withCtx((()=>[createVNode(_sfc_main$B,{value:e.formConf.flowId,isCheckSubFlow:1,title:e.formConf.flowName,onChange:V},null,8,["value","title"])])),_:1}),createVNode(C,{label:"子流程传递"},{default:withCtx((()=>[createVNode(y,{value:e.formConf.assignList.length?"已设置":"",placeholder:"请设置子流程传递规则",readonly:"",class:"hand",onClick:w},{suffix:withCtx((()=>[createBaseVNode("span",_hoisted_1$d,[createVNode(unref(DownOutlined))])])),_:1},8,["value"])])),_:1}),createVNode(C,{label:"发起设置"},{default:withCtx((()=>[t[26]||(t[26]=createBaseVNode("div",{class:"common-tip mb-10px"},"指定的成员作为子流程发起人，多人时，发起多个子流程",-1)),1==i.formConf.subFlowLaunchPermission?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(B,{value:e.formConf.assigneeType,"onUpdate:value":t[3]||(t[3]=o=>e.formConf.assigneeType=o),options:unref(typeOptions),class:"type-radio",onChange:k},null,8,["value","options"]),createBaseVNode("div",{class:normalizeClass({"mb-10px":3!==e.formConf.assigneeType,"mt-10px":!0})},[[1,2].includes(e.formConf.assigneeType)?(openBlock(),createElementBlock("div",_hoisted_2$b,"选择主管")):createCommentVNode("",!0),3===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_3$b,"发起者自己将作为审批人处理审批单")):createCommentVNode("",!0),4===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_4$6,"选择流程表单字段的值作为审批人")):createCommentVNode("",!0),5===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_5$3,"设置审批人为审批流程中某个环节的审批人")):createCommentVNode("",!0),6===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_6$3,"指定审批人处理审批单")):createCommentVNode("",!0),7===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_7$3,"默认所有人，需要设置请指定候选人范围处理审批单")):createCommentVNode("",!0),9===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_8$3,"从目标接口中获取审批人")):createCommentVNode("",!0)],2),1==e.formConf.assigneeType?(openBlock(),createBlock(C,{key:0,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_9$2,[createVNode(b,{value:e.formConf.approverType,"onUpdate:value":t[4]||(t[4]=o=>e.formConf.approverType=o),options:m,class:"!w-130px mr-8px"},null,8,["value"]),t[22]||(t[22]=createTextVNode(" 的 ")),createVNode(L,{value:e.formConf.managerLevel,"onUpdate:value":t[5]||(t[5]=o=>e.formConf.managerLevel=o),placeholder:"请选择",class:"flex-1 ml-8px"},{default:withCtx((()=>[(openBlock(),createElementBlock(Fragment,null,renderList(10,(e=>createVNode(F,{key:e,value:e},{default:withCtx((()=>[createTextVNode(toDisplayString(1===e?"直属主管":"第"+e+"级主管"),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"])])])),_:1})):createCommentVNode("",!0),2==e.formConf.assigneeType?(openBlock(),createBlock(C,{key:1,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_10,[createVNode(b,{value:e.formConf.managerApproverType,"onUpdate:value":t[6]||(t[6]=o=>e.formConf.managerApproverType=o),options:m,class:"!w-130px mr-8px"},null,8,["value"]),t[23]||(t[23]=createTextVNode(" 的部门主管 "))])])),_:1})):createCommentVNode("",!0),4===e.formConf.assigneeType?(openBlock(),createBlock(C,{key:2,label:"表单字段",class:"!mb-0"},{default:withCtx((()=>[createVNode(U,{compact:""},{default:withCtx((()=>[createVNode(b,{value:e.formConf.formFieldType,"onUpdate:value":t[7]||(t[7]=o=>e.formConf.formFieldType=o),options:unref(formFieldTypeOptions),class:"!w-100px",onChange:h},null,8,["value","options"]),createVNode(b,{value:e.formConf.formField,"onUpdate:value":t[8]||(t[8]=o=>e.formConf.formField=o),options:v.value,fieldNames:{options:"options1"},showSearch:"",style:{width:"calc(100% - 100px)"}},null,8,["value","options"])])),_:1})])),_:1})):createCommentVNode("",!0),5===e.formConf.assigneeType?(openBlock(),createBlock(C,{key:3,label:"审批节点",class:"!mb-0"},{default:withCtx((()=>[createVNode(b,{value:e.formConf.approverNodeId,"onUpdate:value":t[9]||(t[9]=o=>e.formConf.approverNodeId=o),showSearch:"",options:e.beforeNodeOptions},null,8,["value","options"])])),_:1})):createCommentVNode("",!0),9===e.formConf.assigneeType?(openBlock(),createBlock(C,{key:4,class:"!mb-0"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_11,[t[24]||(t[24]=createBaseVNode("label",{class:"ant-form-item-no-colon"},"数据接口",-1)),createVNode(I,{text:'请求自带参数：taskId、taskNodeId，返回结构：JSON对象{"handleId":"id1,id2"}'})]),createVNode(unref(InterfaceModal),{value:e.formConf.interfaceConfig.interfaceId,title:e.formConf.interfaceConfig.interfaceName,onChange:_},null,8,["value","title"]),e.formConf.interfaceConfig.templateJson?.length?(openBlock(),createElementBlock(Fragment,{key:0},[t[25]||(t[25]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"参数设置")],-1)),createVNode(unref(SelectInterfaceBtn),{templateJson:e.formConf.interfaceConfig.templateJson,fieldOptions:unref(a),isFlow:"",showFieldFullLabel:"",showSystemFullLabel:"",onFieldChange:N},null,8,["templateJson","fieldOptions"])],64)):createCommentVNode("",!0)])),_:1})):createCommentVNode("",!0),6===e.formConf.assigneeType||7===e.formConf.assigneeType?(openBlock(),createElementBlock("div",_hoisted_12,[createVNode(S,{value:e.formConf.approvers,"onUpdate:value":t[10]||(t[10]=o=>e.formConf.approvers=o),buttonType:"button",modalTitle:6===e.formConf.assigneeType?"添加审批人":"添加候选人",multiple:"",onLabelChange:T},null,8,["value","modalTitle"])])):createCommentVNode("",!0),6===e.formConf.assigneeType||7===e.formConf.assigneeType&&e.formConf.approvers?.length?(openBlock(),createBlock(C,{key:6,class:"!mb-0 !mt-10px"},{label:withCtx((()=>[createTextVNode(toDisplayString(6===e.formConf.assigneeType?"审批人范围":"候选人范围")+" ",1),createVNode(I,{text:6===e.formConf.assigneeType?"指定成员增加人员选择范围附加条件":"候选人增加人员选择范围附加条件"},null,8,["text"])])),default:withCtx((()=>[createVNode(b,{value:e.formConf.extraRule,"onUpdate:value":t[11]||(t[11]=o=>e.formConf.extraRule=o),options:6===e.formConf.assigneeType?p:u},null,8,["value","options"])])),_:1})):createCommentVNode("",!0)],64)):2==i.formConf.subFlowLaunchPermission?(openBlock(),createBlock(_sfc_main$C,{key:1,value:e.formConf.approvers,"onUpdate:value":t[12]||(t[12]=o=>e.formConf.approvers=o),buttonType:"button",multiple:"",flowId:e.formConf.flowId,onChange:x,onLabelChange:T},null,8,["value","flowId"])):createCommentVNode("",!0)])),_:1,__:[26]}),createVNode(C,{label:"子流程创建规则"},{default:withCtx((()=>[createVNode(f,{value:e.formConf.createRule,"onUpdate:value":t[13]||(t[13]=o=>e.formConf.createRule=o),class:"common-radio"},{default:withCtx((()=>[createVNode(c,{value:0},{default:withCtx((()=>t[27]||(t[27]=[createTextVNode("同时创建")]))),_:1,__:[27]}),createVNode(c,{value:1},{default:withCtx((()=>t[28]||(t[28]=[createTextVNode("依次创建")]))),_:1,__:[28]})])),_:1},8,["value"]),0===e.formConf.createRule?(openBlock(),createElementBlock("div",_hoisted_13,"多个发起人时，同时创建多条子流程。")):createCommentVNode("",!0),1===e.formConf.createRule?(openBlock(),createElementBlock("div",_hoisted_14," 多个发起人时依次创建子流程，上一条流程审批结束才创建下一条。")):createCommentVNode("",!0)])),_:1}),createVNode(C,null,{label:withCtx((()=>[t[29]||(t[29]=createTextVNode("异常处理")),createVNode(I,{text:"子流程发起节点人员异常时遵循该规则"})])),default:withCtx((()=>[createVNode(b,{value:e.formConf.errorRule,"onUpdate:value":t[14]||(t[14]=o=>e.formConf.errorRule=o),options:unref(subFlowErrorRuleOptions),onChange:t[15]||(t[15]=o=>e.formConf.errorRuleUser=[])},null,8,["value","options"]),2===e.formConf.errorRule?(openBlock(),createBlock(D,{key:0,value:e.formConf.errorRuleUser,"onUpdate:value":t[16]||(t[16]=o=>e.formConf.errorRuleUser=o),buttonType:"button",multiple:"",class:"mt-10px"},null,8,["value"])):createCommentVNode("",!0)])),_:1}),1!=i.type?(openBlock(),createBlock(C,{key:0,label:"分流规则"},{default:withCtx((()=>[createVNode(b,{value:e.formConf.divideRule,"onUpdate:value":t[17]||(t[17]=o=>e.formConf.divideRule=o),options:unref(divideRuleOptions),onChange:t[18]||(t[18]=e=>{r("updateDivideRule",i.formConf.divideRule)})},null,8,["value","options"])])),_:1})):createCommentVNode("",!0),createVNode(C,null,{label:withCtx((()=>[t[30]||(t[30]=createTextVNode("子流程发起后自动提交")),createVNode(I,{text:"流程发起的下一节点设置候选人时无法自动发起审批"})])),default:withCtx((()=>[createVNode(f,{value:e.formConf.autoSubmit,"onUpdate:value":t[19]||(t[19]=o=>e.formConf.autoSubmit=o),class:"common-radio"},{default:withCtx((()=>[createVNode(c,{value:0},{default:withCtx((()=>t[31]||(t[31]=[createTextVNode("否")]))),_:1,__:[31]}),createVNode(c,{value:1},{default:withCtx((()=>t[32]||(t[32]=[createTextVNode("是")]))),_:1,__:[32]})])),_:1},8,["value"])])),_:1})],64)):createCommentVNode("",!0),2===unref(s)?(openBlock(),createElementBlock(Fragment,{key:1},[createVNode($,{message:"自定义通知以“消息中心-发送配置”为主，请移步设置；关闭：表示不提醒，默认：表示站内提醒",type:"warning",showIcon:"",class:"!mb-10px"}),createVNode(_sfc_main$t,{noticeConfig:e.formConf.launchMsgConfig,funcOptions:e.noticeOptions,type:"launch"},null,8,["noticeConfig","funcOptions"])],64)):createCommentVNode("",!0)])),_:1},8,["model"]),createVNode(_sfc_main$o,mergeProps({onRegister:unref(d)},g.value),null,16,["onRegister"])],64)}}}),_sfc_main$g=defineComponent({__name:"EndNode",setup(e){const o=reactive({formConf:{nodeName:"流程结束"}});return(e,t)=>{const n=resolveComponent("a-alert");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:o.formConf,showEnCode:!1,detailed:""},null,8,["formConf"]),createVNode(n,{message:"如果你需要在中途结束流程，请将需要结束流程的节点，连接到流程结束，并设置相应的流转条件。",type:"warning",class:"!m-10px"})],64)}}}),_hoisted_1$c={class:"condition-main overflow-auto p-15px"},_hoisted_2$a={key:0,class:"mb-10px"},_hoisted_3$a={class:"condition-item-title"},_hoisted_4$5=["onClick"],_hoisted_5$2={class:"condition-item-content"},_hoisted_6$2={class:"condition-item-cap"},_hoisted_7$2={key:1,class:"flex-1 w-150px"},_hoisted_8$2=["onClick"],_hoisted_9$1=["onClick"],_sfc_main$f=defineComponent({inheritAttrs:!1,__name:"ConnectNode",props:["type","formConf","usedFormItems","updateJnpfData","formFieldsOptions","sourceIsStart","onConnectNameChange"],setup(e){const[o,{openModal:t}]=useModal(),n=e,a={fieldName:"",symbolName:"",fieldValue:void 0,fieldType:1,fieldValueType:2,fieldLabel:"",fieldValueJnpfKey:"",logicName:"并且",field:"",symbol:"",logic:"&&",jnpfKey:"",cellKey:+new Date},l={logic:"and",groups:[a]},r=ref(0),i=ref(0),s=[...symbolOptions,{id:"null",fullName:"为空"},{id:"notNull",fullName:"不为空"}],c=inject("bpmn"),d=computed((()=>c())),f=computed((()=>{const e=unref(d).get("jnpfData");return e?.getValue("global")||{}})),m=computed((()=>systemFieldOptions.map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id}))))),p=computed((()=>unref(f).globalParameterList||[])),u=computed((()=>n.sourceIsStart?conditionTypeOptions1.filter((e=>3!=e.id)):conditionTypeOptions1));function C(e){n.formConf.conditions.splice(e,1)}function g(e){n.formConf.conditions[r.value].groups[i.value].field=e,n.formConf.conditions[r.value].groups[i.value].fieldName=e}function v(e){e.fieldName="",e.jnpfKey="",2==e.fieldValueType&&(e.fieldValue=void 0,e.fieldLabel="",e.fieldValueJnpfKey="")}function _(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.fullName||""}return watch((()=>n.formConf),(()=>n.updateJnpfData()),{deep:!0,immediate:!0}),watch((()=>n.formConf),(()=>function(){let e=unref(d).get("modeling"),o=unref(d).get("jnpfData"),t=unref(d).get("elementRegistry"),a=t.get(n.formConf?.nodeId),l=t.get(n.formConf?.nodeId+"_label"),r=getExternalLabelMid(a),i=NodeUtils.getConditionsContent(n.formConf.conditions,n.formConf.matchLogic);if(r=NodeUtils.updateLabelWaypoints(a,t,o,n.type),l)l.text=i,l.width=128,l.height=28,Object.keys(r).length>0&&(l.x=r.x,l.y=r.y),l.nodeName=n.formConf.nodeName,e.updateProperties(l,{});else if(i?.trim()){if(!unref(d).get("elementRegistry").get(a.id+"_label")){r=NodeUtils.updateLabelWaypoints(a,t,o,n.type);let l=e.createLabel(a,r,{id:a.id+"_label",businessObject:a.businessObject,text:"",wnType:"condition",di:a.di,width:128,height:0});l.x=r.x,l.y=r.y,e.updateProperties(l,{})}}return null}()),{deep:!0,immediate:!0}),(c,d)=>{const f=resolveComponent("jnpf-radio"),h=resolveComponent("jnpf-select"),N=resolveComponent("a-col"),k=resolveComponent("a-button"),y=resolveComponent("a-input-number"),V=resolveComponent("jnpf-switch"),B=resolveComponent("jnpf-time-picker"),x=resolveComponent("jnpf-date-picker"),T=resolveComponent("jnpf-organize-select"),w=resolveComponent("jnpf-dep-select"),b=resolveComponent("jnpf-role-select"),F=resolveComponent("jnpf-group-select"),L=resolveComponent("jnpf-pos-select"),U=resolveComponent("jnpf-user-select"),I=resolveComponent("jnpf-users-select"),S=resolveComponent("jnpf-area-select"),D=resolveComponent("a-input"),$=resolveComponent("a-row");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:d[0]||(d[0]=o=>e.onConnectNameChange(n.formConf?.nodeId,o))},null,8,["formConf"]),createBaseVNode("div",_hoisted_1$c,[e.formConf.conditions?.length?(openBlock(),createElementBlock("div",_hoisted_2$a,[createVNode(f,{value:e.formConf.matchLogic,"onUpdate:value":d[1]||(d[1]=o=>e.formConf.matchLogic=o),options:unref(logicOptions),optionType:"button","button-style":"solid"},null,8,["value","options"])])):createCommentVNode("",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.conditions,((o,l)=>(openBlock(),createElementBlock("div",{class:"condition-item",key:l},[createBaseVNode("div",_hoisted_3$a,[d[3]||(d[3]=createBaseVNode("div",null,"条件组",-1)),createBaseVNode("i",{class:"icon-ym icon-ym-nav-close",onClick:e=>C(l)},null,8,_hoisted_4$5)]),createBaseVNode("div",_hoisted_5$2,[createBaseVNode("div",_hoisted_6$2,[d[4]||(d[4]=createTextVNode(" 以下条件全部执行： ")),createVNode(f,{value:o.logic,"onUpdate:value":e=>o.logic=e,options:unref(logicOptions),optionType:"button","button-style":"solid",size:"small"},null,8,["value","onUpdate:value","options"])]),(openBlock(!0),createElementBlock(Fragment,null,renderList(o.groups,((o,c)=>(openBlock(),createBlock($,{gutter:8,key:l+c,wrap:"",class:"mb-10px"},{default:withCtx((()=>[createVNode(N,{span:7,class:"!flex items-center"},{default:withCtx((()=>[createVNode(h,{value:o.fieldType,"onUpdate:value":e=>o.fieldType=e,options:unref(conditionTypeOptions),onChange:e=>function(e){e.field="",v(e)}(o)},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1024),createVNode(N,{span:9,class:"!flex items-center"},{default:withCtx((()=>[1===o.fieldType?(openBlock(),createBlock(h,{key:0,value:o.field,"onUpdate:value":e=>o.field=e,options:e.usedFormItems,allowClear:"",showSearch:"",fieldNames:{options:"options1"},class:"!flex-1",onChange:(e,t)=>function(e,o,t,l,r){if(!o)return v(e);e.fieldName=t.__config__.label,e.jnpfKey=t.__config__.jnpfKey;const i=cloneDeep(a);for(let n of Object.keys(i))i[n]=e[n];2==(e={...i,...t,disabled:e.disabled}).fieldValueType&&(e.fieldValue=void 0,e.fieldLabel="",e.fieldValueJnpfKey=""),n.formConf.conditions[l].groups[r]=e}(o,e,t,l,c)},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0),3===o.fieldType?(openBlock(),createBlock(k,{key:1,onClick:e=>function(e,o,a){r.value=o,i.value=a,t(!0,{value:e.field,fieldsOptions:n.formFieldsOptions})}(o,l,c),class:"!flex-1"},{default:withCtx((()=>d[5]||(d[5]=[createTextVNode("公式编辑")]))),_:2,__:[5]},1032,["onClick"])):createCommentVNode("",!0)])),_:2},1024),createVNode(N,{span:8},{default:withCtx((()=>[createVNode(h,{class:"w-full",value:o.symbol,"onUpdate:value":e=>o.symbol=e,options:s,onChange:(e,t)=>function(e,o,t){e.symbolName=o?t.fullName:"",e.disabled=["null","notNull"].includes(o),["null","notNull"].includes(o)&&(e.fieldValueType=2,e.fieldValue="",e.fieldValueJnpfKey="")}(o,e,t)},null,8,["value","onUpdate:value","onChange"])])),_:2},1024),createVNode(N,{span:7,class:"mt-10px"},{default:withCtx((()=>[createVNode(h,{value:o.fieldValueType,"onUpdate:value":e=>o.fieldValueType=e,options:u.value,disabled:o.disabled,onChange:e=>function(e){e.fieldValue="",e.fieldLabel="",e.fieldValueJnpfKey=""}(o)},null,8,["value","onUpdate:value","options","disabled","onChange"])])),_:2},1024),createVNode(N,{span:16,class:"!flex items-center mt-10px"},{default:withCtx((()=>[1===o.fieldValueType?(openBlock(),createBlock(h,{key:0,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,options:e.usedFormItems,allowClear:"",showSearch:"",fieldNames:{options:"options1"},class:"flex-1",onChange:(e,t)=>function(e,o,t){e.fieldLabel=o?t.fullName:"",e.fieldValueJnpfKey=o?t.__config__.jnpfKey:""}(o,e,t)},null,8,["value","onUpdate:value","options","onChange"])):createCommentVNode("",!0),2===o.fieldValueType?(openBlock(),createElementBlock("div",_hoisted_7$2,["inputNumber"===o.jnpfKey?(openBlock(),createBlock(y,{key:0,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",precision:o.precision,disabled:o.disabled},null,8,["value","onUpdate:value","precision","disabled"])):"calculate"===o.jnpfKey?(openBlock(),createBlock(y,{key:1,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",precision:2,disabled:o.disabled},null,8,["value","onUpdate:value","disabled"])):["rate","slider"].includes(o.jnpfKey)?(openBlock(),createBlock(y,{key:2,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",disabled:o.disabled},null,8,["value","onUpdate:value","disabled"])):"switch"===o.jnpfKey?(openBlock(),createBlock(V,{key:3,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,disabled:o.disabled},null,8,["value","onUpdate:value","disabled"])):"timePicker"===o.jnpfKey?(openBlock(),createBlock(B,{key:4,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,format:o.format||"HH:mm:ss",allowClear:"",disabled:o.disabled},null,8,["value","onUpdate:value","format","disabled"])):["datePicker","createTime","modifyTime"].includes(o.jnpfKey)?(openBlock(),createBlock(x,{key:5,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,format:o.format||"YYYY-MM-DD HH:mm:ss",allowClear:"",disabled:o.disabled,onChange:e=>function(e,o){if(!e)return o.fieldLabel="";const t=o.format||"YYYY-MM-DD HH:mm:ss";o.fieldLabel=formatToDateTime(e,t)}(e,o)},null,8,["value","onUpdate:value","format","disabled","onChange"])):["organizeSelect","currOrganize"].includes(o.jnpfKey)?(openBlock(),createBlock(T,{key:6,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",disabled:o.disabled,onChange:(e,t)=>function(e,o,t){if(!o)return e.fieldLabel="";e.fieldLabel=t.organize||""}(o,e,t)},null,8,["value","onUpdate:value","disabled","onChange"])):["depSelect"].includes(o.jnpfKey)?(openBlock(),createBlock(w,{key:7,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",disabled:o.disabled,onChange:(e,t)=>_(o,e,t)},null,8,["value","onUpdate:value","disabled","onChange"])):"roleSelect"===o.jnpfKey?(openBlock(),createBlock(b,{key:8,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",disabled:o.disabled,onChange:(e,t)=>_(o,e,t)},null,8,["value","onUpdate:value","disabled","onChange"])):"groupSelect"===o.jnpfKey?(openBlock(),createBlock(F,{key:9,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",disabled:o.disabled,onChange:(e,t)=>_(o,e,t)},null,8,["value","onUpdate:value","disabled","onChange"])):["posSelect","currPosition"].includes(o.jnpfKey)?(openBlock(),createBlock(L,{key:10,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",disabled:o.disabled,onChange:(e,t)=>_(o,e,t)},null,8,["value","onUpdate:value","disabled","onChange"])):["userSelect","createUser","modifyUser"].includes(o.jnpfKey)?(openBlock(),createBlock(U,{key:11,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,hasSys:"",allowClear:"",disabled:o.disabled,onChange:(e,t)=>_(o,e,t)},null,8,["value","onUpdate:value","disabled","onChange"])):["usersSelect"].includes(o.jnpfKey)?(openBlock(),createBlock(I,{key:12,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,allowClear:"",disabled:o.disabled,onChange:(e,t)=>_(o,e,t)},null,8,["value","onUpdate:value","disabled","onChange"])):"areaSelect"===o.jnpfKey?(openBlock(),createBlock(S,{key:13,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,level:o.level,allowClear:"",disabled:o.disabled,onChange:(e,t)=>function(e,o,t){if(!o)return e.fieldLabel="";const n=t.map((e=>e.fullName));e.fieldLabel=n.join("/")}(o,e,t)},null,8,["value","onUpdate:value","level","disabled","onChange"])):(openBlock(),createBlock(D,{key:14,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,placeholder:"请输入",allowClear:"",disabled:o.disabled},null,8,["value","onUpdate:value","disabled"]))])):3===o.fieldValueType?(openBlock(),createBlock(h,{key:2,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,options:m.value,fieldNames:{label:"label",options:"options1"},allowClear:""},null,8,["value","onUpdate:value","options"])):4===o.fieldValueType?(openBlock(),createBlock(h,{key:3,value:o.fieldValue,"onUpdate:value":e=>o.fieldValue=e,options:p.value,fieldNames:{label:"fieldName",value:"fieldName",options:"options1"},allowClear:""},null,8,["value","onUpdate:value","options"])):createCommentVNode("",!0)])),_:2},1024),createVNode(N,{span:1,class:"text-center mt-10px"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e,o){n.formConf.conditions[e].groups.splice(o,1),n.formConf.conditions[e].groups.length||C(e)}(l,c)},null,8,_hoisted_8$2)])),_:2},1024)])),_:2},1024)))),128)),createBaseVNode("span",{class:"link-text inline-block",onClick:e=>function(e){n.formConf.conditions[e].groups.push(cloneDeep(a))}(l)},d[6]||(d[6]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加条件")]),8,_hoisted_9$1)])])))),128)),createBaseVNode("span",{class:"link-text inline-block",onClick:d[2]||(d[2]=e=>{n.formConf.conditions.push(cloneDeep(l))})},d[7]||(d[7]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加条件组")]))]),createVNode(_sfc_main$r,{onRegister:unref(o),onConfirm:g},null,8,["onRegister"])],64)}}}),_hoisted_1$b={class:"common-tip mt-12px"},_hoisted_2$9={key:1,class:"common-tip py-12px"},_hoisted_3$9={key:3,class:"countersign-cell"},_sfc_main$e=defineComponent({inheritAttrs:!1,__name:"TriggerNode",props:["formFieldsOptions","formConf","updateJnpfData","bpmn","getFormFieldList","element","updateFormFieldList","updateBpmnProperties"],setup(e,{expose:o}){o({initCondition:d});const t=[{id:1,fullName:"新增数据"},{id:2,fullName:"修改数据"},{id:3,fullName:"删除数据"}],n=()=>{const e=r.element&&r.bpmn.get("elementRegistry")?.get(r.element.id);return e?.incoming?.[0]?.source?.wnType===typeProcessing?[{id:4,fullName:"确认办理"},{id:3,fullName:"退回"}]:[{id:1,fullName:"同意"},{id:2,fullName:"拒绝"},{id:3,fullName:"退回"}]},a=ref(),l=ref(!1),r=e,i=computed((()=>2===r.formConf.triggerEvent?"通过流程的处置动作，触发执行后续流程":3===r.formConf.triggerEvent?"直接触发，执行后续流程":"通过流程表单的增删改，触发执行后续流程")),s=computed((()=>r.formFieldsOptions.filter((e=>!e?.__config__?.isSubTable)))),c=computed((()=>{let e=r.bpmn.get("elementRegistry").get(r.element.id),o=typeTask;return e.incoming.length&&(o=e.incoming[0].source.wnType),o===typeTask?"审批事件":"办理事件"}));function d(){nextTick((()=>{a.value?.init({conditionList:r.formConf.ruleList||[],matchLogic:r.formConf.ruleMatchLogic,fieldOptions:r.formFieldsOptions||[]})}))}function f(e){r.formConf.ruleList=e.conditionList||[],r.formConf.ruleMatchLogic=e.matchLogic||[]}function m(e,o){if(!e||r.formConf.formId!==e){if(!e)return r.formConf.formName="",r.formConf.formId="",r.formConf.ruleList=[],r.formConf.ruleMatchLogic="and",r.formConf.updateFieldList=[],r.updateFormFieldList(),void d();r.getFormFieldList(e,"eventTriggerForm",!1,!1),r.formConf.formName=o.fullName,r.formConf.formId=e,r.formConf.ruleList=[],r.formConf.ruleMatchLogic="and",r.formConf.updateFieldList=[]}}return watch((()=>r.formConf),(()=>r.updateJnpfData()),{deep:!0,immediate:!0}),watch([()=>r.formConf.formName,()=>r.formConf.triggerEvent,()=>r.formConf.triggerFormEvent,()=>r.formConf.actionList],(()=>{let e="";if(r.formConf.formName){let o="空白事件";1==r.formConf.triggerEvent?o=t[r.formConf.triggerFormEvent-1]?.fullName:2==r.formConf.triggerEvent&&(o=r.formConf.actionList.map((e=>n().filter((o=>o?.id==e))[0]?.fullName)).join("/")),e=`当[${r.formConf.formName}]表单[${o}]时`}r.formConf.content=e,r.updateBpmnProperties("elementBodyName",e)}),{immediate:!0}),onMounted((()=>{l.value=NodeUtils.isTriggerNode({type:r.element.wnType})})),(o,r)=>{const d=resolveComponent("a-radio"),p=resolveComponent("a-radio-group"),u=resolveComponent("a-form-item"),C=resolveComponent("jnpf-radio"),g=resolveComponent("jnpf-select"),v=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:r[0]||(r[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(v,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[l.value?(openBlock(),createBlock(u,{key:0,label:"触发类型"},{default:withCtx((()=>[createVNode(p,{value:e.formConf.isAsync,"onUpdate:value":r[1]||(r[1]=o=>e.formConf.isAsync=o),class:"common-radio"},{default:withCtx((()=>[createVNode(d,{value:1},{default:withCtx((()=>r[6]||(r[6]=[createTextVNode("异步")]))),_:1,__:[6]}),createVNode(d,{value:0},{default:withCtx((()=>r[7]||(r[7]=[createTextVNode("同步")]))),_:1,__:[7]})])),_:1},8,["value"]),createBaseVNode("div",_hoisted_1$b,toDisplayString(0===e.formConf.isAsync?"与审批流程串行，下一审批节点等待任务流程结束。当事件执行失败审批流程终止":"与审批流程并行，当事件执行失败审批流程继续流转"),1)])),_:1})):createCommentVNode("",!0),createVNode(u,{label:"触发表单"},{default:withCtx((()=>[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,disabled:l.value,type:"1",onChange:m},null,8,["value","title","disabled"])])),_:1}),createVNode(u,{label:"触发事件"},{default:withCtx((()=>[l.value?(openBlock(),createBlock(p,{key:0,value:e.formConf.triggerEvent,"onUpdate:value":r[2]||(r[2]=o=>e.formConf.triggerEvent=o),class:"common-radio"},{default:withCtx((()=>[createVNode(d,{value:2},{default:withCtx((()=>[createTextVNode(toDisplayString(c.value),1)])),_:1}),createVNode(d,{value:3},{default:withCtx((()=>r[8]||(r[8]=[createTextVNode("空白事件")]))),_:1,__:[8]})])),_:1},8,["value"])):createCommentVNode("",!0),l.value?(openBlock(),createElementBlock("div",_hoisted_2$9,toDisplayString(i.value),1)):createCommentVNode("",!0),1!==e.formConf.triggerEvent&&l.value?createCommentVNode("",!0):(openBlock(),createElementBlock(Fragment,{key:2},[createVNode(C,{class:"leading-32px",value:e.formConf.triggerFormEvent,"onUpdate:value":r[3]||(r[3]=o=>e.formConf.triggerFormEvent=o),options:t},null,8,["value"]),2===e.formConf.triggerFormEvent?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(g,{value:e.formConf.updateFieldList,"onUpdate:value":r[4]||(r[4]=o=>e.formConf.updateFieldList=o),options:s.value,fieldNames:{options:"options1"},showSearch:"",allowClear:"",multiple:""},null,8,["value","options"]),r[9]||(r[9]=createBaseVNode("div",{class:"common-tip mt-12px"},"未选择表示任意字段修改都会触发，选择了表示指定字段修改时触发",-1))],64)):createCommentVNode("",!0)],64)),2===e.formConf.triggerEvent?(openBlock(),createElementBlock("div",_hoisted_3$9,[r[10]||(r[10]=createBaseVNode("span",{class:"w-70px"},"当操作",-1)),createVNode(g,{value:e.formConf.actionList,"onUpdate:value":r[5]||(r[5]=o=>e.formConf.actionList=o),options:n(),showSearch:"",allowClear:"",multiple:""},null,8,["value","options"]),r[11]||(r[11]=createBaseVNode("span",{class:"w-70px ml-8px"},"时触发",-1))])):createCommentVNode("",!0)])),_:1}),l.value?createCommentVNode("",!0):(openBlock(),createBlock(u,{key:1,label:"触发条件"},{default:withCtx((()=>[r[12]||(r[12]=createBaseVNode("div",{class:"common-tip mb-12px"},"满足以下条件，触发执行动作",-1)),createVNode(_sfc_main$D,{ref_key:"conditionMainRef",ref:a,bordered:"",compact:"",isCustomFieldValueType:"",onConfirm:f},null,512)])),_:1,__:[12]}))])),_:1},8,["model"])],64)}}}),_sfc_main$d=defineComponent({inheritAttrs:!1,__name:"NoticeTriggerNode",props:["formConf","updateJnpfData","updateBpmnProperties"],setup(e){const o=e;function t(e,t){o.formConf.noticeId=e,o.formConf.noticeName=t.fullName,o.formConf.content=`当[${t.fullName}]通知成功时`,o.updateBpmnProperties("elementBodyName",o.formConf.content)}return watch((()=>o.formConf),(()=>o.updateJnpfData()),{deep:!0,immediate:!0}),(o,n)=>{const a=resolveComponent("a-form-item"),l=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:n[0]||(n[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(l,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(a,{label:"选择通知"},{default:withCtx((()=>[n[1]||(n[1]=createBaseVNode("div",{class:"common-tip mb-12px"},"当通知成功接收到站内短信时触发。",-1)),createVNode(_sfc_main$E,{value:e.formConf.noticeId,messageType:1,title:e.formConf.noticeName,placeholder:"请选择",onChange:t},null,8,["value","title"])])),_:1,__:[1]})])),_:1},8,["model"])],64)}}}),_sfc_main$c=defineComponent({inheritAttrs:!1,__name:"TimeTriggerNode",props:["formConf","updateJnpfData","updateBpmnProperties"],setup(e){const o=[{id:1,fullName:"触发次数"},{id:2,fullName:"指定时间"},{id:3,fullName:"不结束"}],t=e;function n(e){e||(t.formConf.endLimit=1)}function a(e){t.formConf.content=e,t.updateBpmnProperties("elementBodyName",e)}return watch((()=>t.formConf),(()=>t.updateJnpfData()),{deep:!0,immediate:!0}),(t,l)=>{const r=resolveComponent("jnpf-date-picker"),i=resolveComponent("a-form-item"),s=resolveComponent("jnpf-cron"),c=resolveComponent("jnpf-select"),d=resolveComponent("a-input-number"),f=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:l[0]||(l[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(f,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(i,{label:"触发开始时间"},{default:withCtx((()=>[createVNode(r,{value:e.formConf.startTime,"onUpdate:value":l[1]||(l[1]=o=>e.formConf.startTime=o),format:"YYYY-MM-DD HH:mm:ss",placeholder:"选择开始时间"},null,8,["value"])])),_:1}),createVNode(i,{label:"触发规则"},{default:withCtx((()=>[createVNode(i,null,{default:withCtx((()=>[l[6]||(l[6]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"Cron表达式")],-1)),createVNode(s,{value:e.formConf.cron,"onUpdate:value":l[2]||(l[2]=o=>e.formConf.cron=o),onChange:a},null,8,["value"])])),_:1,__:[6]})])),_:1}),createVNode(i,{label:"触发结束时间"},{default:withCtx((()=>[createVNode(c,{value:e.formConf.endTimeType,"onUpdate:value":l[3]||(l[3]=o=>e.formConf.endTimeType=o),options:o,class:"mb-10px"},null,8,["value"]),1===e.formConf.endTimeType?(openBlock(),createBlock(d,{key:0,value:e.formConf.endLimit,"onUpdate:value":l[4]||(l[4]=o=>e.formConf.endLimit=o),placeholder:"次数",min:1,precision:0,addonAfter:"次后结束",onChange:n},null,8,["value"])):createCommentVNode("",!0),2===e.formConf.endTimeType?(openBlock(),createBlock(r,{key:1,value:e.formConf.endTime,"onUpdate:value":l[5]||(l[5]=o=>e.formConf.endTime=o),format:"YYYY-MM-DD HH:mm:ss",placeholder:"选择结束时间"},null,8,["value"])):createCommentVNode("",!0)])),_:1})])),_:1},8,["model"])],64)}}}),_hoisted_1$a={class:"mb-10px"},_hoisted_2$8={class:"condition-main"},_hoisted_3$8={class:"condition-list"},_hoisted_4$4=["onClick"],_sfc_main$b=defineComponent({inheritAttrs:!1,__name:"WebhookTriggerNode",props:["formFieldsOptions","formConf","updateJnpfData","updateBpmnProperties","flowInfo"],setup(e){const o=useAppStore(),t=computed((()=>o.getSysConfigInfo)),{createMessage:n}=useMessage(),[a,{openModal:l}]=useModal(),[r,{openModal:i}]=useModal(),s=e;function c(){s.formConf.formFieldList.push({id:"",fullName:"",label:""})}function d(e){e.label=e.fullName?e.id+"("+e.fullName+")":e.id}function f(e){const o=e.map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id})));if(!s.formConf.formFieldList.length)return s.formConf.formFieldList=o;for(let t=0;t<o.length;t++){const e=o[t];if(e.id){const o=s.formConf.formFieldList.findIndex((o=>o.id===e.id));o<0?s.formConf.formFieldList.push(e):s.formConf.formFieldList[o]=e}else s.formConf.formFieldList.push(e)}}return watch((()=>s.formConf),(()=>s.updateJnpfData()),{deep:!0,immediate:!0}),watch((()=>s.formConf.formFieldList),(e=>{s.formConf.content=e?.length?"已设置触发":"",s.updateBpmnProperties("elementBodyName",s.formConf.content)}),{deep:!0,immediate:!0}),(o,m)=>{const p=resolveComponent("a-input"),u=resolveComponent("a-form-item"),C=resolveComponent("a-col"),g=resolveComponent("a-row"),v=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:m[0]||(m[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(v,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(u,{label:"webhook URL"},{default:withCtx((()=>[m[4]||(m[4]=createBaseVNode("p",{class:"common-tip mb-10px"},"系统生成的URL，用来接收请求字段！",-1)),createVNode(p,{value:t.value.jnpfDomain+e.formConf.webhookUrl,readonly:""},{addonAfter:withCtx((()=>[createBaseVNode("span",{class:"cursor-pointer",onClick:m[1]||(m[1]=o=>function(e){const{isSuccessRef:o}=useCopyToClipboard(e);unref(o)&&n.success("复制成功")}(t.value.jnpfDomain+e.formConf.webhookUrl))},"复制链接")])),_:1},8,["value"])])),_:1,__:[4]}),createVNode(u,{label:"添加接口字段"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$a,[createBaseVNode("span",{class:"link-text mr-20px inline-block",onClick:c},m[5]||(m[5]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("自定义添加")])),createBaseVNode("span",{class:"link-text mr-20px inline-block",onClick:m[2]||(m[2]=e=>unref(l)(!0,{}))},m[6]||(m[6]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("从JSON格式添加 ")])),createBaseVNode("span",{class:"link-text mr-20px inline-block",onClick:m[3]||(m[3]=o=>unref(i)(!0,{url:e.formConf.webhookGetFieldsUrl,randomStr:e.formConf.webhookRandomStr,id:s.flowInfo.flowId,type:"workFlow"}))},m[7]||(m[7]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("从请求接口添加 ")]))]),createBaseVNode("div",_hoisted_2$8,[createBaseVNode("div",_hoisted_3$8,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.formFieldList,((e,o)=>(openBlock(),createBlock(g,{gutter:8,key:o,class:"mt-10px"},{default:withCtx((()=>[createVNode(C,{span:10},{default:withCtx((()=>[createVNode(p,{value:e.id,"onUpdate:value":o=>e.id=o,placeholder:"字段",onChange:o=>d(e)},null,8,["value","onUpdate:value","onChange"])])),_:2},1024),createVNode(C,{span:13},{default:withCtx((()=>[createVNode(p,{value:e.fullName,"onUpdate:value":o=>e.fullName=o,placeholder:"字段说明",onChange:o=>d(e)},null,8,["value","onUpdate:value","onChange"])])),_:2},1024),createVNode(C,{span:1,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e){s.formConf.formFieldList.splice(e,1)}(o)},null,8,_hoisted_4$4)])),_:2},1024)])),_:2},1024)))),128))])])])),_:1})])),_:1},8,["model"]),createVNode(BatchModal,{onRegister:unref(a),onConfirm:f},null,8,["onRegister"]),createVNode(_sfc_main$F,{onRegister:unref(r),onConfirm:f},null,8,["onRegister"])],64)}}}),_hoisted_1$9={key:2,class:"countersign-cell"},_hoisted_2$7={class:"condition-main mb-10px"},_hoisted_3$7=["onClick"],_sfc_main$a=defineComponent({inheritAttrs:!1,__name:"GetDataNode",props:["formConf","getFormFieldList","updateJnpfData","transformFormJson","transformFieldList","dataSourceForm","updateBpmnProperties"],setup(e,{expose:o}){o({initCondition:i});const t=ref(),n=e,a=[{id:"asc",fullName:"升序"},{id:"desc",fullName:"降序"}],l=computed((()=>(4!=n.formConf.formType?(n.formConf.formFieldList||[]).filter((e=>e.id.indexOf("_jnpf_")<0&&"table"!==e.__config__.jnpfKey&&!e?.__config__?.isSubTable)):n.formConf.formFieldList||[]).filter((e=>!notSupportList.includes(e?.__config__?.jnpfKey))).map((e=>({id:e.id,fullName:e.fullName})))));function r(){n.formConf.formName="",n.formConf.formId="",n.formConf.formFieldList=[],n.formConf.sortList=[],n.formConf.ruleList=[],n.formConf.ruleMatchLogic="and",n.formConf.interfaceTemplateJson=[],n.formConf.subTable="",d(),i(),i()}function i(){t.value?.init({conditionList:n.formConf.ruleList||[],matchLogic:n.formConf.ruleMatchLogic,fieldOptions:n.formConf.formFieldList||[]})}function s(e,o){if(!e)return r();if(n.formConf.formId===e)return;n.formConf.formName=o.fullName,n.formConf.formId=e,n.formConf.ruleList=[],n.formConf.ruleMatchLogic="and",n.formConf.sortList=[],n.formConf.subTable="";const t=n.formConf.formType;4!==t&&d(n.formConf.formName),1!=t&&4!=t||n.getFormFieldList(e,"getDataForm",!1,!1),2==t&&function(e){getFlowFormInfo(e).then((e=>{let{type:o=1,formData:t}=e.data,a={},l=[];t&&(a=JSON.parse(t)),l=2==o?n.transformFormJson(a):a.fields,n.formConf.formFieldList=n.transformFieldList(l),i()}))}(e),3==t&&function(e){const o=e.fieldJson?JSON.parse(e.fieldJson):[];n.formConf.formFieldList=o.map((e=>({...e,id:e.defaultValue,fullName:e.field,label:e.field?e.defaultValue+"("+e.field+")":e.defaultValue}))),n.formConf.interfaceTemplateJson=(e.templateJson||[]).map((e=>({...e,sourceType:1,relationField:""})))}(o)}function c(e){n.formConf.ruleList=e.conditionList||[],n.formConf.ruleMatchLogic=e.matchLogic||[]}function d(e=""){n.formConf.content=e?`从[${e}]中获取数据`:"",n.updateBpmnProperties("elementBodyName",n.formConf.content)}function f(e,o){let t=cloneDeep(n.formConf.cacheFormFieldList).filter((o=>e==o.id?.split("-")[0]&&"table"!==o?.__config__?.jnpfKey));t=(t||[]).map((e=>({...e,fullName:e.fullName.replace(o.fullName+"-","")}))),n.formConf.formFieldList=t,d(o?.fullName||""),i()}return watch((()=>n.formConf),(()=>n.updateJnpfData()),{deep:!0,immediate:!0}),(o,i)=>{const d=resolveComponent("a-radio"),m=resolveComponent("BasicHelp"),p=resolveComponent("a-radio-group"),u=resolveComponent("jnpf-select"),C=resolveComponent("a-form-item"),g=resolveComponent("a-col"),v=resolveComponent("a-row"),_=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:i[0]||(i[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(_,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(C,{label:"获取方式"},{default:withCtx((()=>[createVNode(p,{value:e.formConf.formType,"onUpdate:value":i[1]||(i[1]=o=>e.formConf.formType=o),class:"common-radio formType-radio",onChange:r},{default:withCtx((()=>[createVNode(d,{value:1},{default:withCtx((()=>i[4]||(i[4]=[createTextVNode("从表单中获取")]))),_:1,__:[4]}),createVNode(d,{value:2},{default:withCtx((()=>[i[5]||(i[5]=createTextVNode("从流程中获取")),createVNode(m,{text:"只获取已完成的流程数据"})])),_:1,__:[5]}),createVNode(d,{value:3},{default:withCtx((()=>i[6]||(i[6]=[createTextVNode("从数据接口中获取")]))),_:1,__:[6]}),createVNode(d,{value:4},{default:withCtx((()=>i[7]||(i[7]=[createTextVNode("从子表中获取")]))),_:1,__:[7]})])),_:1},8,["value"]),2==e.formConf.formType?(openBlock(),createBlock(_sfc_main$B,{key:0,value:e.formConf.formId,title:e.formConf.formName,onChange:s},null,8,["value","title"])):3==e.formConf.formType?(openBlock(),createBlock(unref(SelectInterface),{key:1,value:e.formConf.formId,title:e.formConf.formName,templateJson:e.formConf.interfaceTemplateJson,fieldOptions:e.dataSourceForm,showSystemFormId:!1,fieldWidth:"60px",onChange:s},null,8,["value","title","templateJson","fieldOptions"])):(openBlock(),createElementBlock("div",_hoisted_1$9,[createBaseVNode("div",{class:normalizeClass(4==e.formConf.formType?"!w-221px":"!w-full")},[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,enableFlow:1==e.formConf.formType?"0":"1",type:"1",onChange:s},null,8,["value","title","enableFlow"])],2),4==e.formConf.formType?(openBlock(),createBlock(u,{key:0,class:"ml-8px !w-221px",value:e.formConf.subTable,"onUpdate:value":i[2]||(i[2]=o=>e.formConf.subTable=o),options:e.formConf.subTableList,allowClear:"",showSearch:"",onChange:f},null,8,["value","options"])):createCommentVNode("",!0)]))])),_:1}),3!=e.formConf.formType?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(C,{label:"获取条件"},{default:withCtx((()=>[i[8]||(i[8]=createBaseVNode("div",{class:"common-tip mb-12px"},"查询满足条件的数据，未设置条件则查询全部数据",-1)),createVNode(_sfc_main$D,{ref_key:"conditionMainRef",ref:t,bordered:"",compact:"",showFieldValueType:"",valueFieldOptions:e.dataSourceForm,onConfirm:c},null,8,["valueFieldOptions"])])),_:1,__:[8]}),createVNode(C,{label:"排序规则"},{default:withCtx((()=>[i[10]||(i[10]=createBaseVNode("div",{class:"common-tip mb-12px"},"本节点作为单值数据源时，将按照排序规则取第一条数据",-1)),createBaseVNode("div",_hoisted_2$7,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.sortList,((e,o)=>(openBlock(),createBlock(v,{gutter:8,key:o,class:"mt-10px"},{default:withCtx((()=>[createVNode(g,{span:15},{default:withCtx((()=>[createVNode(u,{value:e.field,"onUpdate:value":o=>e.field=o,options:l.value},null,8,["value","onUpdate:value","options"])])),_:2},1024),createVNode(g,{span:8},{default:withCtx((()=>[createVNode(u,{value:e.sortType,"onUpdate:value":o=>e.sortType=o,options:a},null,8,["value","onUpdate:value"])])),_:2},1024),e.required?createCommentVNode("",!0):(openBlock(),createBlock(g,{key:0,span:1,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e){n.formConf.sortList.splice(e,1)}(o)},null,8,_hoisted_3$7)])),_:2},1024))])),_:2},1024)))),128))]),createBaseVNode("span",{class:"link-text inline-block",onClick:i[3]||(i[3]=e=>{n.formConf.sortList.push({sortType:"asc",field:""})})},i[9]||(i[9]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加字段")]))])),_:1,__:[10]})],64)):createCommentVNode("",!0)])),_:1},8,["model"])],64)}}}),_hoisted_1$8={class:"countersign-cell"},_hoisted_2$6={key:0,class:"condition-main mt-12px"},_hoisted_3$6=["onClick"],_sfc_main$9=defineComponent({inheritAttrs:!1,__name:"AddDataNode",props:["formFieldsOptions","formConf","updateJnpfData","dataSourceForm","dataSourceFormList","updateBpmnProperties","getFormFieldList","updateFormFieldList","updateTransferList"],setup(e,{expose:o}){o({initCondition:r});const t=ref(),n=e,a=computed((()=>cloneDeep(n.dataSourceFormList).filter((e=>e.id==n.formConf.dataSourceForm)))),l=computed((()=>cloneDeep(n.dataSourceForm||[]).filter((e=>e.id==n.formConf.dataSourceForm))));function r(){nextTick((()=>{t.value?.init({conditionList:n.formConf.ruleList||[],matchLogic:n.formConf.ruleMatchLogic,fieldOptions:n.formFieldsOptions||[]})}))}function i(e,o){if(!e||n.formConf.formId!==e){if(!e)return n.formConf.formName="",n.formConf.formId="",n.formConf.ruleList=[],n.formConf.ruleMatchLogic="and",n.formConf.transferList=[],n.updateFormFieldList(),r(),n.formConf.content="",void n.updateBpmnProperties("elementBodyName","");n.formConf.formName=o.fullName,n.formConf.formId=e,n.formConf.ruleList=[],n.formConf.ruleMatchLogic="and",n.formConf.transferList=[],n.formConf.content=`在[${o.fullName}]表单中新增数据`,n.updateBpmnProperties("elementBodyName",n.formConf.content),n.getFormFieldList(e,"addDataForm",!1,!1)}}function s(){n.formConf.ruleList=[],n.formConf.ruleMatchLogic="and",n.updateTransferList("addDataForm"),r()}function c(e){n.formConf.ruleList=e.conditionList||[],n.formConf.ruleMatchLogic=e.matchLogic||[]}function d(){n.formConf.transferList.push({targetField:"",targetFieldLabel:"",sourceType:1,sourceValue:"",required:!1})}function f(e){let o=[];for(let t=0;t<n.formConf.transferList.length;t++){const a=n.formConf.transferList[t];a.targetField&&e!==t&&o.push(a.targetField)}return(n.formFieldsOptions||[]).filter((e=>!o.includes(e.id)&&!["table",...systemComponentsList].includes(e?.__config__?.jnpfKey)))}return watch((()=>n.formConf),(()=>n.updateJnpfData()),{deep:!0,immediate:!0}),(o,r)=>{const m=resolveComponent("a-form-item"),p=resolveComponent("jnpf-select"),u=resolveComponent("a-col"),C=resolveComponent("a-input"),g=resolveComponent("a-row"),v=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:r[0]||(r[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(v,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(m,{label:"目标表单"},{default:withCtx((()=>[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,type:"1",onChange:i},null,8,["value","title"])])),_:1}),createVNode(m,{label:"选择数据源"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$8,[createVNode(p,{value:e.formConf.dataSourceForm,"onUpdate:value":r[1]||(r[1]=o=>e.formConf.dataSourceForm=o),options:e.dataSourceFormList,showSearch:"",allowClear:"",onChange:s},null,8,["value","options"]),r[2]||(r[2]=createBaseVNode("span",{class:"w-220px ml-8px"},"的数据新增至目标表单",-1))])])),_:1}),createVNode(m,{label:"字段设置",class:"!flex-nowrap"},{default:withCtx((()=>[r[5]||(r[5]=createBaseVNode("div",{class:"common-tip"},"[必填]字段默认展示且不可删除，请至少设置一个字段",-1)),e.formConf?.transferList?.length?(openBlock(),createElementBlock("div",_hoisted_2$6,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.transferList,((e,o)=>(openBlock(),createBlock(g,{gutter:8,key:o,class:"mt-10px"},{default:withCtx((()=>[createVNode(u,{span:7},{default:withCtx((()=>[createVNode(p,{value:e.targetField,"onUpdate:value":o=>e.targetField=o,options:f(o),showSearch:"",allowClear:"",disabled:e.required,fieldNames:{options:"options1"}},null,8,["value","onUpdate:value","options","disabled"])])),_:2},1024),createVNode(u,{span:2,class:"leading-32px"},{default:withCtx((()=>r[3]||(r[3]=[createTextVNode("设为")]))),_:1,__:[3]}),createVNode(u,{span:6},{default:withCtx((()=>[createVNode(p,{value:e.sourceType,"onUpdate:value":o=>e.sourceType=o,options:unref(simpleSourceTypeOptions),onChange:o=>e.sourceValue=""},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1024),createVNode(u,{span:8},{default:withCtx((()=>[1===e.sourceType?(openBlock(),createBlock(p,{key:0,value:e.sourceValue,"onUpdate:value":o=>e.sourceValue=o,options:a.value,showSearch:"",allowClear:"",fieldNames:{options:"children"}},null,8,["value","onUpdate:value","options"])):createCommentVNode("",!0),2===e.sourceType?(openBlock(),createBlock(C,{key:1,value:e.sourceValue,"onUpdate:value":o=>e.sourceValue=o,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"])):createCommentVNode("",!0)])),_:2},1024),e.required?createCommentVNode("",!0):(openBlock(),createBlock(u,{key:0,span:1,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e){n.formConf.transferList.splice(e,1)}(o)},null,8,_hoisted_3$6)])),_:2},1024))])),_:2},1024)))),128))])):createCommentVNode("",!0),createBaseVNode("span",{class:"link-text mt-10px inline-block",onClick:d},r[4]||(r[4]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加字段")]))])),_:1,__:[5]}),createVNode(m,{label:"数据校验"},{default:withCtx((()=>[r[6]||(r[6]=createBaseVNode("div",{class:"common-tip mb-12px"},"判断目标表单中是否已存在数据，存在时不新增数据",-1)),createVNode(_sfc_main$D,{ref_key:"conditionMainRef",ref:t,bordered:"",compact:"",showFieldValueType:"",valueFieldOptions:l.value,onConfirm:c},null,8,["valueFieldOptions"])])),_:1,__:[6]})])),_:1},8,["model"])],64)}}}),_hoisted_1$7={class:"countersign-cell"},_hoisted_2$5={class:"!w-165px"},_hoisted_3$5={key:0,class:"condition-main mt-12px"},_hoisted_4$3=["onClick"],_sfc_main$8=defineComponent({inheritAttrs:!1,__name:"UpdateDataNode",props:["formFieldsOptions","formConf","updateJnpfData","dataSourceForm","dataSourceFormList","getFormFieldList","updateBpmnProperties"],setup(e,{expose:o}){o({initCondition:r});const t=ref(),n=e,a=computed((()=>cloneDeep(n.dataSourceFormList||[]).filter((e=>e.id==n.formConf.dataSourceForm)))),l=computed((()=>cloneDeep(n.dataSourceForm||[]).filter((e=>e.id==n.formConf.dataSourceForm))));function r(){nextTick((()=>{t.value?.init({conditionList:n.formConf.ruleList||[],matchLogic:n.formConf.ruleMatchLogic,fieldOptions:n.formFieldsOptions||[]})}))}function i(e,o){if(!e||n.formConf.formId!==e){if(!e)return n.formConf.formName="",n.formConf.formId="",n.formConf.ruleList=[],n.formConf.ruleMatchLogic="and",n.formConf.transferList=[],n.formConf.content="",n.updateBpmnProperties("elementBodyName",""),void r();n.getFormFieldList(e,"updateDataForm",!1,!1),n.formConf.formName=o.fullName,n.formConf.formId=e,n.formConf.ruleList=[],n.formConf.ruleMatchLogic="and",n.formConf.transferList=[],n.formConf.content=`在[${o.fullName}]表单中更新数据`,n.updateBpmnProperties("elementBodyName",n.formConf.content)}}function s(e){n.formConf.ruleList=e.conditionList||[],n.formConf.ruleMatchLogic=e.matchLogic||[]}function c(){n.formConf.transferList.push({targetField:"",targetFieldLabel:"",sourceType:1,sourceValue:"",required:!1})}function d(e){let o=[];for(let t=0;t<n.formConf.transferList.length;t++){const a=n.formConf.transferList[t];a.targetField&&e!==t&&o.push(a.targetField)}return(n.formFieldsOptions||[]).filter((e=>!o.includes(e.id)&&!["table",...systemComponentsList].includes(e?.__config__?.jnpfKey)))}return watch((()=>n.formConf),(()=>n.updateJnpfData()),{deep:!0,immediate:!0}),(o,r)=>{const f=resolveComponent("jnpf-select"),m=resolveComponent("a-form-item"),p=resolveComponent("a-col"),u=resolveComponent("a-input"),C=resolveComponent("a-row"),g=resolveComponent("a-checkbox"),v=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:r[0]||(r[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(v,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(m,{label:"更新方式"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$7,[createVNode(f,{class:"!w-165px",value:e.formConf.dataSourceForm,"onUpdate:value":r[1]||(r[1]=o=>e.formConf.dataSourceForm=o),options:e.dataSourceFormList,showSearch:"",allowClear:""},null,8,["value","options"]),r[3]||(r[3]=createBaseVNode("span",{class:"w-100px mx-8px"},"的数据，更新至",-1)),createBaseVNode("div",_hoisted_2$5,[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,type:"1",onChange:i},null,8,["value","title"])])])])),_:1}),createVNode(m,{label:"更新字段"},{default:withCtx((()=>[r[6]||(r[6]=createBaseVNode("div",{class:"common-tip"},"请至少设置一个字段",-1)),e.formConf?.transferList?.length?(openBlock(),createElementBlock("div",_hoisted_3$5,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.transferList,((e,o)=>(openBlock(),createBlock(C,{gutter:8,key:o,class:"mt-10px"},{default:withCtx((()=>[createVNode(p,{span:7},{default:withCtx((()=>[createVNode(f,{value:e.targetField,"onUpdate:value":o=>e.targetField=o,options:d(o),showSearch:"",allowClear:"",disabled:e.required,fieldNames:{options:"options1"}},null,8,["value","onUpdate:value","options","disabled"])])),_:2},1024),createVNode(p,{span:2,class:"leading-32px"},{default:withCtx((()=>r[4]||(r[4]=[createTextVNode("设为")]))),_:1,__:[4]}),createVNode(p,{span:6},{default:withCtx((()=>[createVNode(f,{value:e.sourceType,"onUpdate:value":o=>e.sourceType=o,options:unref(simpleSourceTypeOptions),onChange:o=>e.sourceValue=""},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1024),createVNode(p,{span:8},{default:withCtx((()=>[1===e.sourceType?(openBlock(),createBlock(f,{key:0,value:e.sourceValue,"onUpdate:value":o=>e.sourceValue=o,options:a.value,showSearch:"",allowClear:"",fieldNames:{options:"children"}},null,8,["value","onUpdate:value","options"])):createCommentVNode("",!0),2===e.sourceType?(openBlock(),createBlock(u,{key:1,value:e.sourceValue,"onUpdate:value":o=>e.sourceValue=o,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"])):createCommentVNode("",!0)])),_:2},1024),e.required?createCommentVNode("",!0):(openBlock(),createBlock(p,{key:0,span:1,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e){n.formConf.transferList.splice(e,1)}(o)},null,8,_hoisted_4$3)])),_:2},1024))])),_:2},1024)))),128))])):createCommentVNode("",!0),createBaseVNode("span",{class:"link-text mt-10px inline-block",onClick:c},r[5]||(r[5]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加字段")]))])),_:1,__:[6]}),createVNode(m,{label:"更新条件"},{default:withCtx((()=>[r[8]||(r[8]=createBaseVNode("div",{class:"common-tip mb-12px"},"设置数据源与目标表单是1:1/1:N的匹配关系",-1)),createVNode(_sfc_main$D,{ref_key:"conditionMainRef",ref:t,bordered:"",compact:"",showFieldValueType:"",valueFieldOptions:l.value,onConfirm:s},null,8,["valueFieldOptions"]),createVNode(g,{class:"leading-32px mt-12px",checked:e.formConf.unFoundRule,"onUpdate:checked":r[2]||(r[2]=o=>e.formConf.unFoundRule=o)},{default:withCtx((()=>r[7]||(r[7]=[createTextVNode("没有可修改的数据时，向对应表单中新增一条数据")]))),_:1,__:[7]},8,["checked"])])),_:1,__:[8]})])),_:1},8,["model"])],64)}}}),_hoisted_1$6={class:"countersign-cell"},_hoisted_2$4={key:1,class:"countersign-cell mt-12px"},_hoisted_3$4={class:"!w-135px mr-8px"},_hoisted_4$2={class:"common-tip mb-12px"},_sfc_main$7=defineComponent({inheritAttrs:!1,__name:"DeleteDataNode",props:["formFieldsOptions","formConf","updateJnpfData","getFormFieldList","dataSourceFormList","dataSourceForm","updateBpmnProperties"],setup(e,{expose:o}){o({initCondition:i});const t=e,n=ref(),a=[{fullName:"主表",id:0},{fullName:"子表",id:1}],l=[{fullName:"存在",id:1},{fullName:"不存在",id:0}];watch((()=>t.formConf),(()=>t.updateJnpfData()),{deep:!0,immediate:!0});const r=computed((()=>cloneDeep(t.dataSourceForm).filter((e=>e.id==t.formConf.dataSourceForm))));function i(){n.value?.init({conditionList:t.formConf.ruleList||[],matchLogic:t.formConf.ruleMatchLogic,fieldOptions:t.formConf.formFieldList||[]})}function s(e,o){if(!e)return c();t.formConf.formId!==e&&(t.formConf.formName=o.fullName,t.formConf.formId=e,t.formConf.ruleList=[],t.formConf.ruleMatchLogic="and",t.formConf.subTable="",t.formConf.formFieldList=[],g(),t.getFormFieldList(e,"deleteDataForm",!1,!1))}function c(){t.formConf.formName="",t.formConf.formId="",t.formConf.formFieldList=[],t.formConf.ruleList=[],t.formConf.ruleMatchLogic="and",t.formConf.subTable="",i(),g()}function d(){t.formConf.tableType=0,t.formConf.deleteCondition=1,t.formConf.dataSourceForm="",c()}function f(e){t.formConf.ruleList=e.conditionList||[],t.formConf.ruleMatchLogic=e.matchLogic||[]}function m(e,o){let n=cloneDeep(t.formConf.cacheFormFieldList).filter((o=>e==o.id?.split("-")[0]&&"table"!==o?.__config__?.jnpfKey));n=(n||[]).map((e=>({...e,fullName:e.fullName.replace(o.fullName+"-","")}))),t.formConf.formFieldList=n,t.formConf.ruleList=[],t.formConf.ruleMatchLogic="and",i()}function p(){c()}function u(){g()}function C(e,o){t.formConf.dataSourceFormName=o?.fullName,g()}function g(){let e="";1==t.formConf.deleteType?t.formConf.formName&&t.formConf.dataSourceFormName&&(e=`删除[${t.formConf.formName}]${1==t.formConf.deleteCondition?"存在":"不存在"}[${t.formConf.dataSourceFormName}]数据`):t.formConf.formName&&(e=`删除[${t.formConf.formName}]数据`),t.formConf.content=e,t.updateBpmnProperties("elementBodyName",e)}return(o,t)=>{const i=resolveComponent("a-radio"),c=resolveComponent("a-radio-group"),g=resolveComponent("jnpf-select"),v=resolveComponent("a-form-item"),_=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:t[0]||(t[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(_,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(v,{label:"触发类型"},{default:withCtx((()=>[createVNode(c,{value:e.formConf.deleteType,"onUpdate:value":t[1]||(t[1]=o=>e.formConf.deleteType=o),class:"common-radio",onChange:d},{default:withCtx((()=>[createVNode(i,{value:0},{default:withCtx((()=>t[6]||(t[6]=[createTextVNode("直接删除表")]))),_:1,__:[6]}),createVNode(i,{value:1},{default:withCtx((()=>t[7]||(t[7]=[createTextVNode("按节点删除")]))),_:1,__:[7]})])),_:1},8,["value"]),0===e.formConf.deleteType?(openBlock(),createElementBlock(Fragment,{key:0},[t[10]||(t[10]=createBaseVNode("div",{class:"common-tip my-12px"},"主表模式删除主表时同步删除子表数据，子表模式只删除子表数据",-1)),createBaseVNode("div",_hoisted_1$6,[t[8]||(t[8]=createBaseVNode("span",{class:"w-30px mr-8px"},"删除",-1)),createVNode(g,{class:"!w-80px mr-8px",value:e.formConf.tableType,"onUpdate:value":t[2]||(t[2]=o=>e.formConf.tableType=o),options:a,onChange:p},null,8,["value"]),createBaseVNode("div",{class:normalizeClass(0===e.formConf.tableType?"!w-280px":"!w-142px mr-8px")},[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,type:"1",onChange:s},null,8,["value","title"])],2),1==e.formConf.tableType?(openBlock(),createBlock(g,{key:0,class:"!w-120px",value:e.formConf.subTable,"onUpdate:value":t[3]||(t[3]=o=>e.formConf.subTable=o),options:e.formConf.subTableList,showSearch:"",allowClear:"",onChange:m},null,8,["value","options"])):createCommentVNode("",!0),t[9]||(t[9]=createBaseVNode("span",{class:"w-30px ml-8px"},"数据",-1))])],64)):(openBlock(),createElementBlock("div",_hoisted_2$4,[t[11]||(t[11]=createBaseVNode("span",{class:"w-30px mr-8px"},"删除",-1)),createBaseVNode("div",_hoisted_3$4,[createVNode(_sfc_main$s,{value:e.formConf.formId,title:e.formConf.formName,type:"1",onChange:s},null,8,["value","title"])]),t[12]||(t[12]=createBaseVNode("span",{class:"w-10px mr-8px"},"中",-1)),createVNode(g,{class:"!w-85px mr-8px",value:e.formConf.deleteCondition,"onUpdate:value":t[4]||(t[4]=o=>e.formConf.deleteCondition=o),options:l,onChange:u},null,8,["value"]),createVNode(g,{class:"!w-120px",value:e.formConf.dataSourceForm,"onUpdate:value":t[5]||(t[5]=o=>e.formConf.dataSourceForm=o),options:e.dataSourceFormList,showSearch:"",allowClear:"",onChange:C},null,8,["value","options"]),t[13]||(t[13]=createBaseVNode("span",{class:"w-30px ml-8px"},"数据",-1))]))])),_:1}),createVNode(v,{label:0===e.formConf.deleteType?"删除条件":"数据校验"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_4$2,toDisplayString(0===e.formConf.deleteType?"未设置条件时删除目标表单的全部数据，请慎用":"判断目标表单中是否存在获取的数据"),1),createVNode(_sfc_main$D,{ref_key:"conditionMainRef",ref:n,bordered:"",compact:"",showFieldValueType:"",valueFieldOptions:0===e.formConf.deleteType?e.dataSourceForm:r.value,onConfirm:f},null,8,["valueFieldOptions"])])),_:1},8,["label"])])),_:1},8,["model"])],64)}}}),_hoisted_1$5={class:"countersign-cell"},_sfc_main$6=defineComponent({inheritAttrs:!1,__name:"DataInterfaceNode",props:["formFieldsOptions","formConf","updateJnpfData","dataSourceFormList","dataSourceForm","updateBpmnProperties"],setup(e){const o=e,t=computed((()=>o.formConf.dataSourceForm?o.dataSourceForm.filter((e=>e.id==o.formConf.dataSourceForm)):[]));function n(e,t){if(!e)return o.formConf.formName="",o.formConf.formId="",o.formConf.templateJson=[],o.formConf.content="",void o.updateBpmnProperties("elementBodyName","");o.formConf.formId!==e&&(o.formConf.formName=t.fullName,o.formConf.formId=e,o.formConf.templateJson=(t.templateJson||[]).map((e=>({...e,sourceType:1,relationField:""}))),o.formConf.content=`执行[${o.formConf.formName}]数据接口`,o.updateBpmnProperties("elementBodyName",o.formConf.content))}function a(e,t){if(!e)return;let n=o.formFieldsOptions.filter((o=>o.id===e));if(!n.length)return;let a=n[0];t.isSubTable=!(!a.__config__||!a.__config__.isSubTable)&&a.__config__.isSubTable}function l(){o.formConf.templateJson=(o.formConf.templateJson||[]).map((e=>({...e,relationField:1==e.sourceType?"":e.relationField})))}return watch((()=>o.formConf),(()=>o.updateJnpfData()),{deep:!0,immediate:!0}),(o,r)=>{const i=resolveComponent("jnpf-select"),s=resolveComponent("a-form-item"),c=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:r[0]||(r[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(c,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(s,{label:"选择数据源"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$5,[createVNode(i,{value:e.formConf.dataSourceForm,"onUpdate:value":r[1]||(r[1]=o=>e.formConf.dataSourceForm=o),options:e.dataSourceFormList,showSearch:"",allowClear:"",onChange:l},null,8,["value","options"]),r[2]||(r[2]=createBaseVNode("span",{class:"w-220px ml-8px"},"的数据赋值给接口",-1))])])),_:1}),createVNode(s,{label:"执行数据接口"},{default:withCtx((()=>[createVNode(unref(SelectInterface),{value:e.formConf.formId,title:e.formConf.formName,templateJson:e.formConf.templateJson,fieldOptions:t.value,showSystemFormId:!1,sourceType:3,allowClear:!1,onChange:n,onFieldChange:a},null,8,["value","title","templateJson","fieldOptions"])])),_:1})])),_:1},8,["model"])],64)}}}),_hoisted_1$4={style:{width:"calc(100% - 100px)"}},_hoisted_2$3=["onClick"],_hoisted_3$3=["title"],_sfc_main$5=defineComponent({inheritAttrs:!1,__name:"MessageNode",props:["formFieldsOptions","formConf","updateJnpfData","dataSourceForm","updateBpmnProperties"],setup(e){const o=e,[t,{openModal:n}]=useModal(),a=[{title:"模板名称",dataIndex:"msgTemplateName",key:"msgTemplateName"},{title:"参数名称",dataIndex:"paramJson",key:"paramJson"},{title:"参数来源",dataIndex:"sourceType",key:"sourceType",width:85},{title:"参数值",dataIndex:"field",key:"field",width:150}],l=[{id:1,fullName:"字段"},{id:2,fullName:"自定义"}],r=["organizeSelect","depSelect","posSelect","userSelect","usersSelect","roleSelect","groupSelect","createUser","modifyUser","currOrganize","currPosition"],i=computed((()=>{return e=r,cloneDeep(o.dataSourceForm).map((o=>({...o,children:o.children.filter((o=>o?.__config__?.jnpfKey&&e.includes(o.__config__.jnpfKey)))}))).filter((e=>e.children?.length));var e}));return watch((()=>o.formConf),(()=>o.updateJnpfData()),{deep:!0,immediate:!0}),(r,s)=>{const c=resolveComponent("jnpf-select"),d=resolveComponent("jnpf-users-select"),f=resolveComponent("a-input-group"),m=resolveComponent("a-form-item"),p=resolveComponent("jnpf-input"),u=resolveComponent("a-table"),C=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:s[0]||(s[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(C,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(m,{label:"接收人"},{default:withCtx((()=>[createVNode(f,{compact:""},{default:withCtx((()=>[createVNode(c,{value:e.formConf.msgUserIdsSourceType,"onUpdate:value":s[1]||(s[1]=o=>e.formConf.msgUserIdsSourceType=o),options:l,class:"!w-100px",onChange:s[2]||(s[2]=o=>e.formConf.msgUserIds="")},null,8,["value"]),createBaseVNode("div",_hoisted_1$4,[1==e.formConf.msgUserIdsSourceType?(openBlock(),createBlock(c,{key:0,value:e.formConf.msgUserIds,"onUpdate:value":s[3]||(s[3]=o=>e.formConf.msgUserIds=o),options:i.value,fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"w-full"},null,8,["value","options"])):(openBlock(),createBlock(d,{key:1,value:e.formConf.msgUserIds,"onUpdate:value":s[4]||(s[4]=o=>e.formConf.msgUserIds=o),multiple:""},null,8,["value"]))])])),_:1})])),_:1}),createVNode(m,{label:"通知内容"},{default:withCtx((()=>[s[7]||(s[7]=createBaseVNode("div",{class:"ant-form-item-label"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"发送配置")],-1)),createVNode(_sfc_main$y,{value:e.formConf.msgId,title:e.formConf.msgName,messageSource:"3",onChange:s[5]||(s[5]=(e,t)=>function(e,t){if(!e)return o.formConf.msgId="",o.formConf.msgName="",o.formConf.msgTemplateJson=[],o.formConf.content="",void o.updateBpmnProperties("elementBodyName","");o.formConf.msgId!==e&&(o.formConf.msgId=e,o.formConf.msgName=t.fullName,o.formConf.msgTemplateJson=(t.templateJson||[]).map((e=>({...e,paramJson:(e.paramJson||[]).map((e=>({...e,sourceType:1})))})))||[],o.formConf.content=`执行[${o.formConf.msgName}]的消息通知`,o.updateBpmnProperties("elementBodyName",o.formConf.content))}(e,t))},null,8,["value","title"]),s[8]||(s[8]=createBaseVNode("div",{class:"ant-form-item-label !mt-12px"},[createBaseVNode("label",{class:"ant-form-item-no-colon"},"参数设置")],-1)),createVNode(u,{"data-source":e.formConf.msgTemplateJson,columns:a,size:"small",pagination:!1},{bodyCell:withCtx((({column:t,record:a})=>["msgTemplateName"===t.key?(openBlock(),createElementBlock("p",{key:0,class:"link-text !w-80px",onClick:e=>{return o=a.templateId,void n(!0,{id:o});var o}},toDisplayString(a.msgTemplateName),9,_hoisted_2$3)):createCommentVNode("",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(a.paramJson,((n,a)=>(openBlock(),createElementBlock("div",{key:a,class:normalizeClass({"!mt-8px":a>0})},["paramJson"===t.key?(openBlock(),createElementBlock("div",{key:0,class:"parameter-box !w-80px leading-32px",title:n.field+"("+n.fieldName+")"},toDisplayString(n.field)+"("+toDisplayString(n.fieldName)+") ",9,_hoisted_3$3)):createCommentVNode("",!0),"sourceType"===t.key?(openBlock(),createBlock(c,{key:1,class:"!w-75px",value:n.sourceType,"onUpdate:value":e=>n.sourceType=e,options:l,onChange:e=>n.relationField=""},null,8,["value","onUpdate:value","onChange"])):createCommentVNode("",!0),"field"===t.key?(openBlock(),createElementBlock(Fragment,{key:2},[1==n.sourceType?(openBlock(),createBlock(c,{key:0,value:n.relationField,"onUpdate:value":e=>n.relationField=e,options:e.dataSourceForm,allowClear:"",showSearch:"",fieldNames:{options:"children"},optionLabelProp:"label",class:"!w-140px",onChange:e=>function(e,t){if(!e)return;let n=o.formFieldsOptions.filter((o=>o.id===e));if(!n.length)return;let a=n[0];t.isSubTable=!(!a.__config__||!a.__config__.isSubTable)&&a.__config__.isSubTable}(e,n)},null,8,["value","onUpdate:value","options","onChange"])):(openBlock(),createBlock(p,{key:1,value:n.relationField,"onUpdate:value":e=>n.relationField=e,placeholder:"请输入"},null,8,["value","onUpdate:value"]))],64)):createCommentVNode("",!0)],2)))),128))])),emptyText:withCtx((()=>s[6]||(s[6]=[createBaseVNode("p",{class:"leading-60px"},"暂无数据",-1)]))),_:1},8,["data-source"])])),_:1,__:[7,8]})])),_:1},8,["model"]),createVNode(MsgTemplateDetail,{onRegister:unref(t)},null,8,["onRegister"])],64)}}}),_hoisted_1$3={class:"countersign-cell"},_hoisted_2$2={class:"condition-main mb-10px"},_hoisted_3$2=["onClick"],_sfc_main$4=defineComponent({inheritAttrs:!1,__name:"LaunchFlowNode",props:["formConf","updateJnpfData","dataSourceFormList","transformFormJson","transformFieldList","updateTransferList","updateBpmnProperties"],setup(e,{expose:o}){o({getFlowFormFieldList:i});const{createMessage:t}=useMessage(),n=e,a=[{id:1,fullName:"字段"},{id:2,fullName:"自定义"}];watch((()=>n.formConf),(()=>n.updateJnpfData()),{deep:!0,immediate:!0});const l=computed((()=>cloneDeep(n.dataSourceFormList||[]).filter((e=>e.id==n.formConf.dataSourceForm))));function r(e,o){if(!e)return n.formConf.flowName="",n.formConf.flowId="",n.formConf.formFieldList=[],n.formConf.transferList=[],n.formConf.initiator=[],n.formConf.launchPermission=1,n.formConf.content="",void n.updateBpmnProperties("elementBodyName","");n.formConf.flowName=o.fullName,n.formConf.flowId=e,n.formConf.transferList=[],n.formConf.initiator=[],n.formConf.launchPermission=o.visibleType||1,n.formConf.content=`发起[${n.formConf.flowName}]流程`,n.updateBpmnProperties("elementBodyName",n.formConf.content),i(!0)}function i(e=!1){n.formConf.flowId&&getFlowFormInfo(n.formConf.flowId).then((o=>{let{type:t=1,formData:a}=o.data,l={},r=[];a&&(l=JSON.parse(a)),r=2==t?n.transformFormJson(l):l.fields;let i=n.transformFieldList(r);n.formConf.formFieldList=i.map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id}))),e&&n.updateTransferList("launchFlowForm")}))}function s(e){let o=[];for(let t=0;t<n.formConf.transferList.length;t++){const a=n.formConf.transferList[t];a.targetField&&e!==t&&o.push(a.targetField)}return n.formConf.formFieldList.filter((e=>!o.includes(e.id)&&!["table",...systemComponentsList].includes(e?.__config__?.jnpfKey))).map((e=>({...e,disabled:!1})))}function c(){n.updateTransferList("launchFlowForm")}function d(e){return e.targetField?e.targetField.includes("-")?unref(l)[0]?.children:unref(l)[0]?.children.filter((e=>!e?.__config__?.isSubTable)):[]}return(o,l)=>{const i=resolveComponent("a-form-item"),f=resolveComponent("jnpf-select"),m=resolveComponent("a-col"),p=resolveComponent("a-input"),u=resolveComponent("a-row"),C=resolveComponent("a-button"),g=resolveComponent("jnpf-users-select"),v=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:l[0]||(l[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(v,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(i,{label:"选择流程"},{default:withCtx((()=>[l[6]||(l[6]=createBaseVNode("div",{class:"common-tip mb-12px"},"自动发起流程，第一个审批节点设置候选人时无法自动发起",-1)),createVNode(_sfc_main$B,{value:e.formConf.flowId,title:e.formConf.flowName,onChange:r},null,8,["value","title"])])),_:1,__:[6]}),createVNode(i,{label:"选择数据源"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_1$3,[createVNode(f,{value:e.formConf.dataSourceForm,"onUpdate:value":l[1]||(l[1]=o=>e.formConf.dataSourceForm=o),options:e.dataSourceFormList,showSearch:"",allowClear:"",onChange:c},null,8,["value","options"]),l[7]||(l[7]=createBaseVNode("span",{class:"w-220px ml-8px"},"的数据赋值给流程表单",-1))])])),_:1}),createVNode(i,{label:"字段设置"},{default:withCtx((()=>[l[10]||(l[10]=createBaseVNode("div",{class:"common-tip mb-12px"},"[必填]字段默认展示且不可删除，请至少设置一个字段",-1)),createBaseVNode("div",_hoisted_2$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.formConf.transferList,((e,o)=>(openBlock(),createBlock(u,{gutter:8,key:o,class:"mt-10px"},{default:withCtx((()=>[createVNode(m,{span:8},{default:withCtx((()=>[createVNode(f,{value:e.targetField,"onUpdate:value":o=>e.targetField=o,options:s(o),placeholder:"目标表单字段",showSearch:"",allowClear:"",disabled:e.required,fieldNames:{options:"options1"}},null,8,["value","onUpdate:value","options","disabled"])])),_:2},1024),createVNode(m,{span:2,class:"leading-32px"},{default:withCtx((()=>l[8]||(l[8]=[createTextVNode("设为")]))),_:1,__:[8]}),createVNode(m,{span:5},{default:withCtx((()=>[createVNode(f,{value:e.sourceType,"onUpdate:value":o=>e.sourceType=o,options:a,onChange:o=>e.sourceValue=""},null,8,["value","onUpdate:value","onChange"])])),_:2},1024),createVNode(m,{span:8},{default:withCtx((()=>[1===e.sourceType?(openBlock(),createBlock(f,{key:0,value:e.sourceValue,"onUpdate:value":o=>e.sourceValue=o,options:d(e),placeholder:"数据源字段",showSearch:"",allowClear:"",fieldNames:{options:"children"}},null,8,["value","onUpdate:value","options"])):createCommentVNode("",!0),2===e.sourceType?(openBlock(),createBlock(p,{key:1,value:e.sourceValue,"onUpdate:value":o=>e.sourceValue=o,placeholder:"请输入",allowClear:""},null,8,["value","onUpdate:value"])):createCommentVNode("",!0)])),_:2},1024),e.required?createCommentVNode("",!0):(openBlock(),createBlock(m,{key:0,span:1,class:"text-center"},{default:withCtx((()=>[createBaseVNode("i",{class:"icon-ym icon-ym-btn-clearn",onClick:e=>function(e){n.formConf.transferList.splice(e,1)}(o)},null,8,_hoisted_3$2)])),_:2},1024))])),_:2},1024)))),128))]),createBaseVNode("span",{class:"link-text inline-block",onClick:l[2]||(l[2]=e=>{n.formConf.transferList.push({targetField:"",targetFieldLabel:"",sourceType:1,sourceValue:"",required:!1})})},l[9]||(l[9]=[createBaseVNode("i",{class:"icon-ym icon-ym-btn-add text-14px mr-4px"},null,-1),createTextVNode("添加字段")]))])),_:1,__:[10]}),createVNode(i,{label:"发起人"},{default:withCtx((()=>[l[12]||(l[12]=createBaseVNode("div",{class:"common-tip mb-12px"},"选择多个审批人产生多条实例",-1)),e.formConf.flowId?(openBlock(),createElementBlock(Fragment,{key:1},[2==e.formConf.launchPermission?(openBlock(),createBlock(_sfc_main$C,{key:0,value:e.formConf.initiator,"onUpdate:value":l[4]||(l[4]=o=>e.formConf.initiator=o),flowId:e.formConf.flowId,buttonType:"button",multiple:""},null,8,["value","flowId"])):(openBlock(),createBlock(g,{key:1,value:e.formConf.initiator,"onUpdate:value":l[5]||(l[5]=o=>e.formConf.initiator=o),buttonType:"button",modalTitle:"添加发起人",multiple:""},null,8,["value"]))],64)):(openBlock(),createBlock(C,{key:0,preIcon:"icon-ym icon-ym-btn-add",onClick:l[3]||(l[3]=e=>unref(t).error("请选择流程表单"))},{default:withCtx((()=>l[11]||(l[11]=[createTextVNode("添加发起人")]))),_:1,__:[11]}))])),_:1,__:[12]})])),_:1},8,["model"])],64)}}}),_hoisted_1$2={style:{width:"calc(100% - 100px)"}},_hoisted_2$1={style:{width:"calc(100% - 100px)"}},_hoisted_3$1={class:"countersign-cell"},_hoisted_4$1={style:{width:"calc(100% - 100px)"}},_hoisted_5$1={class:"countersign-cell"},_hoisted_6$1={style:{width:"calc(100% - 100px)"}},_hoisted_7$1={style:{width:"calc(100% - 100px)"}},_hoisted_8$1={style:{width:"calc(100% - 100px)"}},_sfc_main$3=defineComponent({inheritAttrs:!1,__name:"ScheduleNode",props:["formFieldsOptions","formConf","updateJnpfData","dataSourceForm","updateBpmnProperties"],setup(e){const o=e,t=[{id:1,fullName:"字段"},{id:2,fullName:"自定义"}],n=["organizeSelect","depSelect","posSelect","userSelect","usersSelect","roleSelect","groupSelect","createUser","modifyUser","currOrganize","currPosition"],a=computed((()=>c(n))),l=computed((()=>c(["datePicker"])));function r(){o.formConf.reminderTime=-2}function i(e,t){if(e){if(o.formConf.send===e)return;o.formConf.send=e,o.formConf.sendName=t.fullName}else o.formConf.send="",o.formConf.sendName=""}function s(e,t){const n=e?1==o.formConf.titleSourceType?t.fullName:e:"",a=n?`创建[${n}]日程`:"";o.formConf.content=a,o.updateBpmnProperties("elementBodyName",a)}function c(e){return cloneDeep(o.dataSourceForm).map((o=>({...o,children:o.children.filter((o=>o?.__config__?.jnpfKey&&e.includes(o.__config__.jnpfKey)))})))}return watch((()=>o.formConf),(()=>o.updateJnpfData()),{deep:!0,immediate:!0}),(o,n)=>{const c=resolveComponent("jnpf-select"),d=resolveComponent("jnpf-input"),f=resolveComponent("a-input-group"),m=resolveComponent("a-form-item"),p=resolveComponent("jnpf-upload-file"),u=resolveComponent("jnpf-switch"),C=resolveComponent("jnpf-date-picker"),g=resolveComponent("jnpf-time-picker"),v=resolveComponent("jnpf-user-select"),_=resolveComponent("jnpf-color-picker"),h=resolveComponent("a-form");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$x,{formConf:e.formConf,onOnNodeNameChange:n[0]||(n[0]=o=>e.updateBpmnProperties("nodeName",o))},null,8,["formConf"]),createVNode(h,{colon:!1,model:e.formConf,class:"config-content",layout:"vertical"},{default:withCtx((()=>[createVNode(m,{label:"标题"},{default:withCtx((()=>[createVNode(f,{compact:""},{default:withCtx((()=>[createVNode(c,{value:e.formConf.titleSourceType,"onUpdate:value":n[1]||(n[1]=o=>e.formConf.titleSourceType=o),options:t,class:"!w-100px",onChange:n[2]||(n[2]=o=>e.formConf.title="")},null,8,["value"]),createBaseVNode("div",_hoisted_1$2,[1==e.formConf.titleSourceType?(openBlock(),createBlock(c,{key:0,value:e.formConf.title,"onUpdate:value":n[3]||(n[3]=o=>e.formConf.title=o),options:e.dataSourceForm,fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"w-full",onChange:s},null,8,["value","options"])):(openBlock(),createBlock(d,{key:1,value:e.formConf.title,"onUpdate:value":n[4]||(n[4]=o=>e.formConf.title=o),placeholder:"请输入",onChange:s},null,8,["value"]))])])),_:1})])),_:1}),createVNode(m,{label:"内容"},{default:withCtx((()=>[createVNode(f,{compact:""},{default:withCtx((()=>[createVNode(c,{value:e.formConf.contentsSourceType,"onUpdate:value":n[5]||(n[5]=o=>e.formConf.contentsSourceType=o),options:t,class:"!w-100px",onChange:n[6]||(n[6]=o=>e.formConf.contents="")},null,8,["value"]),createBaseVNode("div",_hoisted_2$1,[1==e.formConf.contentsSourceType?(openBlock(),createBlock(c,{key:0,value:e.formConf.contents,"onUpdate:value":n[7]||(n[7]=o=>e.formConf.contents=o),options:e.dataSourceForm,fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"w-full"},null,8,["value","options"])):(openBlock(),createBlock(d,{key:1,value:e.formConf.contents,"onUpdate:value":n[8]||(n[8]=o=>e.formConf.contents=o),placeholder:"请输入"},null,8,["value"]))])])),_:1})])),_:1}),createVNode(m,{label:"附件"},{default:withCtx((()=>[createVNode(p,{value:e.formConf.files,"onUpdate:value":n[9]||(n[9]=o=>e.formConf.files=o)},null,8,["value"])])),_:1}),createVNode(m,{label:"全天"},{default:withCtx((()=>[createVNode(u,{value:e.formConf.allDay,"onUpdate:value":n[10]||(n[10]=o=>e.formConf.allDay=o),onChange:r},null,8,["value"])])),_:1}),createVNode(m,{label:"开始时间"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_3$1,[createVNode(f,{compact:""},{default:withCtx((()=>[createVNode(c,{value:e.formConf.startDaySourceType,"onUpdate:value":n[11]||(n[11]=o=>e.formConf.startDaySourceType=o),options:t,class:"!w-100px",onChange:n[12]||(n[12]=o=>e.formConf.startDay="")},null,8,["value"]),createBaseVNode("div",_hoisted_4$1,[1==e.formConf.startDaySourceType?(openBlock(),createBlock(c,{key:0,value:e.formConf.startDay,"onUpdate:value":n[13]||(n[13]=o=>e.formConf.startDay=o),options:l.value,fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"w-full"},null,8,["value","options"])):(openBlock(),createBlock(C,{key:1,value:e.formConf.startDay,"onUpdate:value":n[14]||(n[14]=o=>e.formConf.startDay=o),format:"YYYY-MM-DD"},null,8,["value"]))])])),_:1}),e.formConf.allDay?createCommentVNode("",!0):(openBlock(),createBlock(g,{key:0,class:"ml-5px !w-180px",value:e.formConf.startTime,"onUpdate:value":n[15]||(n[15]=o=>e.formConf.startTime=o),format:"HH:mm",minuteStep:5,placeholder:"请选择"},null,8,["value"]))])])),_:1}),-1===e.formConf.duration||e.formConf.allDay?(openBlock(),createBlock(m,{key:0,label:"结束时间"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_5$1,[createVNode(f,{compact:""},{default:withCtx((()=>[createVNode(c,{value:e.formConf.endDaySourceType,"onUpdate:value":n[16]||(n[16]=o=>e.formConf.endDaySourceType=o),options:t,class:"!w-100px",onChange:n[17]||(n[17]=o=>e.formConf.endDay="")},null,8,["value"]),createBaseVNode("div",_hoisted_6$1,[1==e.formConf.endDaySourceType?(openBlock(),createBlock(c,{key:0,value:e.formConf.endDay,"onUpdate:value":n[18]||(n[18]=o=>e.formConf.endDay=o),options:l.value,fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"w-full"},null,8,["value","options"])):(openBlock(),createBlock(C,{key:1,value:e.formConf.endDay,"onUpdate:value":n[19]||(n[19]=o=>e.formConf.endDay=o),format:"YYYY-MM-DD"},null,8,["value"]))])])),_:1}),e.formConf.allDay?createCommentVNode("",!0):(openBlock(),createBlock(g,{key:0,class:"ml-5px !w-180px",value:e.formConf.endTime,"onUpdate:value":n[20]||(n[20]=o=>e.formConf.endTime=o),format:"HH:mm",minuteStep:5,placeholder:"请选择"},null,8,["value"]))])])),_:1})):createCommentVNode("",!0),-1===e.formConf.duration||e.formConf.allDay?createCommentVNode("",!0):(openBlock(),createBlock(m,{key:1,label:"时长"},{default:withCtx((()=>[createVNode(c,{value:e.formConf.duration,"onUpdate:value":n[21]||(n[21]=o=>e.formConf.duration=o),options:unref(durationList)},null,8,["value","options"])])),_:1})),createVNode(m,{label:"创建人"},{default:withCtx((()=>[createVNode(f,{compact:""},{default:withCtx((()=>[createVNode(c,{value:e.formConf.creatorUserIdSourceType,"onUpdate:value":n[22]||(n[22]=o=>e.formConf.creatorUserIdSourceType=o),options:t,class:"!w-100px",onChange:n[23]||(n[23]=o=>e.formConf.creatorUserId="")},null,8,["value"]),createBaseVNode("div",_hoisted_7$1,[1==e.formConf.creatorUserIdSourceType?(openBlock(),createBlock(c,{key:0,value:e.formConf.creatorUserId,"onUpdate:value":n[24]||(n[24]=o=>e.formConf.creatorUserId=o),options:a.value,fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"w-full"},null,8,["value","options"])):(openBlock(),createBlock(v,{key:1,value:e.formConf.creatorUserId,"onUpdate:value":n[25]||(n[25]=o=>e.formConf.creatorUserId=o)},null,8,["value"]))])])),_:1})])),_:1}),createVNode(m,{label:"参与人"},{default:withCtx((()=>[createVNode(f,{compact:""},{default:withCtx((()=>[createVNode(c,{value:e.formConf.toUserIdsSourceType,"onUpdate:value":n[26]||(n[26]=o=>e.formConf.toUserIdsSourceType=o),options:t,class:"!w-100px",onChange:n[27]||(n[27]=o=>e.formConf.toUserIds="")},null,8,["value"]),createBaseVNode("div",_hoisted_8$1,[1==e.formConf.toUserIdsSourceType?(openBlock(),createBlock(c,{key:0,value:e.formConf.toUserIds,"onUpdate:value":n[28]||(n[28]=o=>e.formConf.toUserIds=o),options:a.value,fieldNames:{options:"children"},showSearch:"",allowClear:"",class:"w-full"},null,8,["value","options"])):(openBlock(),createBlock(v,{key:1,value:e.formConf.toUserIds,"onUpdate:value":n[29]||(n[29]=o=>e.formConf.toUserIds=o),multiple:""},null,8,["value"]))])])),_:1})])),_:1}),createVNode(m,{label:"标签颜色"},{default:withCtx((()=>[createVNode(_,{value:e.formConf.color,"onUpdate:value":n[30]||(n[30]=o=>e.formConf.color=o)},null,8,["value"])])),_:1}),createVNode(m,{label:"提醒时间"},{default:withCtx((()=>[createVNode(c,{value:e.formConf.reminderTime,"onUpdate:value":n[31]||(n[31]=o=>e.formConf.reminderTime=o),options:e.formConf.allDay?unref(reminderTimeList_):unref(reminderTimeList)},null,8,["value","options"])])),_:1}),-2!==e.formConf.reminderTime?(openBlock(),createBlock(m,{key:2,label:"提醒方式"},{default:withCtx((()=>[createVNode(c,{value:e.formConf.reminderType,"onUpdate:value":n[32]||(n[32]=o=>e.formConf.reminderType=o),options:unref(remindList)},null,8,["value","options"])])),_:1})):createCommentVNode("",!0),-2!==e.formConf.reminderTime&&2==e.formConf.reminderType?(openBlock(),createBlock(m,{key:3,label:"发送配置"},{default:withCtx((()=>[createVNode(_sfc_main$y,{value:e.formConf.send,title:e.formConf.sendName,messageSource:"4",onChange:i},null,8,["value","title"])])),_:1})):createCommentVNode("",!0),createVNode(m,{label:"重复提醒"},{default:withCtx((()=>[createVNode(c,{value:e.formConf.repetition,"onUpdate:value":n[33]||(n[33]=o=>e.formConf.repetition=o),options:unref(repeatReminderList)},null,8,["value","options"])])),_:1}),1!==e.formConf.repetition?(openBlock(),createBlock(m,{key:4,label:"结束重复"},{default:withCtx((()=>[createVNode(C,{value:e.formConf.repeatTime,"onUpdate:value":n[34]||(n[34]=o=>e.formConf.repeatTime=o),format:"YYYY-MM-DD"},null,8,["value"])])),_:1})):createCommentVNode("",!0)])),_:1},8,["model"])],64)}}}),defaultGlobalForm={type:"global",nodeId:"global",allFormMap:{},formId:"",titleType:0,defaultContent:"{发起用户名}的{流程名称}",titleContent:"",hasSign:!1,hasRevoke:!1,hasComment:!0,hasCommentDeletedTips:!0,hasSignFor:!1,hasAloneConfigureForms:!1,hasContinueAfterReject:!1,hasInitiatorPressOverdueNode:!0,autoSubmitConfig:{adjacentNodeApproverRepeated:!1,ApproverHasApproval:!1,initiatorApproverRepeated:!1},recallRule:1,errorRule:1,errorRuleUser:[],fileConfig:{on:!1,permissionType:1,path:"",templateId:""},globalParameterList:[],approvalFieldList:[],isShowConditions:!0,showNameType:0},defaultTaskGlobalForm={type:"global",nodeId:"global",allFormMap:{},msgUserType:[1],msgUserIds:[],failMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},startMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]}},defaultStartForm={type:"start",nodeId:void 0,nodeName:"流程发起",formId:"",formName:"",formOperates:[],divideRule:"inclusion",printConfig:{on:!1,printIds:[],conditionType:1,conditions:[],matchLogic:"and"},timeLimitConfig:{on:0,nodeLimit:0,duringDeal:24},noticeConfig:{on:0,firstOver:1,overTimeDuring:2,overNotice:!0,overEvent:!1,overEventTime:5},overTimeConfig:{on:0,firstOver:0,overTimeDuring:2,overNotice:!0,overAutoApprove:!1,overAutoApproveTime:5,overEvent:!1,overEventTime:5},waitMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},endMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},commentMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},approveMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},rejectMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},backMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},copyMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},overTimeMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},noticeMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},initFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},endFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},flowRecallFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]}},defaultApproverForm={type:"approver",nodeId:void 0,nodeName:"审批节点",formId:"",formName:"",formOperates:[],assignList:[],assigneeType:6,approverType:1,managerApproverType:1,managerLevel:1,formFieldType:1,formField:"",approverNodeId:"",prevNodeList:[],approvers:[],approversSortList:[],extraRule:1,counterSign:0,counterSignConfig:{auditType:1,auditRatio:100,auditNum:1,rejectType:0,rejectRatio:10,rejectNum:1,calculateType:1},circulateUser:[],extraCopyRule:1,isCustomCopy:!1,isInitiatorCopy:!1,isFormFieldCopy:!1,copyFormFieldType:1,copyFormField:"",hasSign:!1,hasFile:!1,hasApprovalField:!1,approvalField:[],hasAuditBtn:!0,auditBtnText:"同意",hasRejectBtn:!0,rejectBtnText:"拒绝",hasBackBtn:!1,backBtnText:"退回",hasFreeApproverBtn:!1,freeApproverBtnText:"加签",hasReduceApproverBtn:!1,reduceApproverBtnText:"减签",hasTransferBtn:!1,transferBtnText:"转审",hasAssistBtn:!1,assistBtnText:"协办",hasSaveAuditBtn:!1,saveAuditBtnText:"暂存",backType:1,backNodeCode:0,customBtns:[],auxiliaryInfo:[],printConfig:{on:!1,printIds:[],conditionType:1,conditions:[],matchLogic:"and"},parameterList:[],hasAutoApprover:!1,autoAuditRule:{conditions:[],matchLogic:"and"},autoRejectRule:{conditions:[],matchLogic:"and"},divideRule:"inclusion",interfaceConfig:{interfaceId:"",interfaceName:"",templateJson:[]},approveMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},rejectMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},backMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},copyMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},overTimeMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},noticeMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},content:"",timeLimitConfig:{on:2,nodeLimit:0,duringDeal:24,formField:""},overTimeConfig:{on:2,firstOver:0,overTimeDuring:2,overNotice:!0,overAutoApprove:!1,overAutoApproveTime:5,overEvent:!1,overEventTime:5,overAutoTransfer:!1,overAutoTransferTime:2,overTimeType:6,interfaceId:"",interfaceName:"",templateJson:[],reApprovers:"",overTimeExtraRule:2},noticeConfig:{on:2,firstOver:1,overTimeDuring:2,overNotice:!0,overEvent:!1,overEventTime:5},approveFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},rejectFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},backFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},recallFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},overTimeFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},noticeFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]}},defaultProcessingForm={type:"processing",nodeId:void 0,nodeName:"办理节点",formId:"",formName:"",formOperates:[],assignList:[],assigneeType:6,approverType:1,managerApproverType:1,managerLevel:1,formFieldType:1,formField:"",approverNodeId:"",approvers:[],approversSortList:[],extraRule:1,counterSign:0,counterSignConfig:{auditType:1,auditRatio:100,auditNum:1,rejectType:0,rejectRatio:10,rejectNum:1,calculateType:1},circulateUser:[],extraCopyRule:1,isCustomCopy:!1,isInitiatorCopy:!1,isFormFieldCopy:!1,copyFormFieldType:1,copyFormField:"",hasSign:!1,hasFile:!1,hasApprovalField:!1,approvalField:[],hasAuditBtn:!0,auditBtnText:"确认办理",hasBackBtn:!1,backBtnText:"退回",hasTransferBtn:!1,transferBtnText:"转办",hasSaveAuditBtn:!1,saveAuditBtnText:"暂存",backType:1,backNodeCode:0,customBtns:[],printConfig:{on:!1,printIds:[],conditionType:1,conditions:[],matchLogic:"and"},parameterList:[],hasAutoApprover:!1,autoAuditRule:{conditions:[],matchLogic:"and"},autoRejectRule:{conditions:[],matchLogic:"and"},divideRule:"inclusion",interfaceConfig:{interfaceId:"",interfaceName:"",templateJson:[]},backMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},copyMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},overTimeMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},noticeMsgConfig:{on:2,msgId:"",msgName:"",templateJson:[]},content:"",timeLimitConfig:{on:2,nodeLimit:0,duringDeal:24,formField:""},overTimeConfig:{on:2,firstOver:0,overTimeDuring:2,overNotice:!0,overAutoApprove:!1,overAutoApproveTime:5,overEvent:!1,overEventTime:5,overAutoTransfer:!1,overAutoTransferTime:2,overTimeType:6,interfaceId:"",interfaceName:"",templateJson:[],reApprovers:"",overTimeExtraRule:2},noticeConfig:{on:2,firstOver:1,overTimeDuring:2,overNotice:!0,overEvent:!1,overEventTime:5},overTimeFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]},noticeFuncConfig:{on:!1,interfaceId:"",interfaceName:"",templateJson:[]}},defaultSubFlowForm={type:"subFlow",nodeId:void 0,nodeName:"子流程",isAsync:0,flowId:"",flowName:"",assignList:[],assigneeType:6,approverType:1,managerApproverType:1,managerLevel:1,formFieldType:1,formField:"",approverNodeId:"",approvers:[],approversSortList:[],extraRule:1,content:"",subFlowLaunchPermission:1,errorRule:1,errorRuleUser:[],autoSubmit:0,divideRule:"inclusion",interfaceConfig:{interfaceId:"",interfaceName:"",templateJson:[]},launchMsgConfig:{on:3,msgId:"",msgName:"",templateJson:[]},createRule:0},defaultConnectForm={type:"connect",nodeId:void 0,nodeName:"连接线",conditions:[],matchLogic:"and"},defaultTriggerForm={type:"trigger",nodeId:void 0,nodeName:"触发事件",content:"",isAsync:1,formId:"",formName:"",triggerEvent:1,triggerFormEvent:1,actionList:[],updateFieldList:[],ruleList:[],ruleMatchLogic:"and"},defaultEventTriggerForm={type:"eventTrigger",nodeId:void 0,nodeName:"事件触发",content:"",formId:"",formName:"",triggerEvent:1,triggerFormEvent:1,actionList:[],updateFieldList:[],ruleList:[],ruleMatchLogic:"and"},defaultTimeTriggerForm={type:"timeTrigger",nodeId:void 0,nodeName:"定时触发",content:"",startTime:null,cron:"",endTimeType:1,endLimit:1,endTime:null},defaultNoticeTriggerForm={type:"noticeTrigger",nodeId:void 0,nodeName:"通知触发",content:"",noticeId:"",noticeName:null},defaultWebhookTriggerForm={type:"webhookTrigger",nodeId:void 0,nodeName:"webhook触发",content:"",webhookUrl:"",webhookGetFieldsUrl:"",webhookRandomStr:"",formFieldList:[]},defaultGetDataForm={type:"getData",nodeId:void 0,nodeName:"获取数据",formType:1,formId:"",formName:"",interfaceTemplateJson:[],ruleList:[],ruleMatchLogic:"and",formFieldLis:[],cacheFormFieldList:[],sortList:[]},defaultAddDataForm={type:"addData",nodeId:void 0,nodeName:"新增数据",formId:"",formName:"",transferList:[],dataSourceForm:"",ruleList:[],ruleMatchLogic:"and"},defaultUpdateDataForm={type:"updateData",nodeId:void 0,nodeName:"更新数据",content:"",formId:"",formName:"",dataSourceForm:"",transferList:[],ruleList:[],ruleMatchLogic:"and",unFoundRule:!1},defaultDeleteDataForm={type:"deleteData",nodeId:void 0,nodeName:"删除数据",content:"",deleteType:0,tableType:0,formId:"",formName:"",subTable:"",deleteCondition:1,dataSourceForm:"",dataSourceFormName:"",ruleList:[],ruleMatchLogic:"and"},defaultDataInterfaceForm={type:"dataInterface",nodeId:void 0,nodeName:"数据接口",content:"",dataSourceForm:"",formId:"",formName:"",templateJson:[]},defaultMessageForm={type:"message",nodeId:void 0,nodeName:"消息通知",content:"",msgId:"",msgName:"",msgTemplateJson:[],msgUserIds:[],msgUserIdsSourceType:2},defaultLaunchFlowForm={type:"launchFlow",nodeId:void 0,nodeName:"发起审批",content:"",flowId:"",flowName:"",transferList:[],initiator:[],dataSourceForm:"",formFieldList:[]},defaultScheduleForm={type:"schedule",nodeId:void 0,nodeName:"创建日程",content:"",title:"",contents:"",files:[],allDay:0,startDay:"",startTime:"",duration:0,endDay:"",endTime:"",creatorUserId:"",toUserIds:[],color:"#188ae2",reminderTime:-2,reminderType:1,send:"",repetition:1,repeatTime:"",startDaySourceType:1,endDaySourceType:1,titleSourceType:1,contentsSourceType:1,creatorUserIdSourceType:1,toUserIdsSourceType:1},nodeConfig={defaultGlobalForm:defaultGlobalForm,defaultTaskGlobalForm:defaultTaskGlobalForm,defaultStartForm:defaultStartForm,defaultApproverForm:defaultApproverForm,defaultProcessingForm:defaultProcessingForm,defaultSubFlowForm:defaultSubFlowForm,defaultConnectForm:defaultConnectForm,defaultTriggerForm:defaultTriggerForm,defaultEventTriggerForm:defaultEventTriggerForm,defaultTimeTriggerForm:defaultTimeTriggerForm,defaultNoticeTriggerForm:defaultNoticeTriggerForm,defaultWebhookTriggerForm:defaultWebhookTriggerForm,defaultGetDataForm:defaultGetDataForm,defaultAddDataForm:defaultAddDataForm,defaultUpdateDataForm:defaultUpdateDataForm,defaultDeleteDataForm:defaultDeleteDataForm,defaultDataInterfaceForm:defaultDataInterfaceForm,defaultMessageForm:defaultMessageForm,defaultLaunchFlowForm:defaultLaunchFlowForm,defaultScheduleForm:defaultScheduleForm},_hoisted_1$1={class:"common-pane"},_sfc_main$2=defineComponent({__name:"index",props:["element","bpmn","flowState","versionList","type","flowInfo"],setup(__props){const props=__props,state=reactive({activeKey:1,globalForm:cloneDeep(2==props.type?nodeConfig.defaultTaskGlobalForm:nodeConfig.defaultGlobalForm),startForm:cloneDeep(nodeConfig.defaultStartForm),approverForm:cloneDeep(nodeConfig.defaultApproverForm),processingForm:cloneDeep(nodeConfig.defaultProcessingForm),subFlowForm:cloneDeep(nodeConfig.defaultSubFlowForm),connectForm:cloneDeep(nodeConfig.defaultConnectForm),triggerForm:cloneDeep(nodeConfig.defaultTriggerForm),eventTriggerForm:cloneDeep(nodeConfig.defaultEventTriggerForm),timeTriggerForm:cloneDeep(nodeConfig.defaultTimeTriggerForm),noticeTriggerForm:cloneDeep(nodeConfig.defaultNoticeTriggerForm),webhookTriggerForm:cloneDeep(nodeConfig.defaultWebhookTriggerForm),getDataForm:cloneDeep(nodeConfig.defaultGetDataForm),addDataForm:cloneDeep(nodeConfig.defaultAddDataForm),updateDataForm:cloneDeep(nodeConfig.defaultUpdateDataForm),deleteDataForm:cloneDeep(nodeConfig.defaultDeleteDataForm),dataInterfaceForm:cloneDeep(nodeConfig.defaultDataInterfaceForm),messageForm:cloneDeep(nodeConfig.defaultMessageForm),launchFlowForm:cloneDeep(nodeConfig.defaultLaunchFlowForm),scheduleForm:cloneDeep(nodeConfig.defaultScheduleForm),formFieldList:[],printTplOptions:[],prevNodeList:[],beforeNodeOptions:[],oldFormId:"",sourceIsStart:!1,dataSourceFormList:[]}),appStore=useAppStore(),updateJnpfData=useDebounceFn(handleSetJnpfData,200),startRef=ref(null),approverRef=ref(null),processingRef=ref(null),subFlowRef=ref(null),triggerRef=ref(null),getDataRef=ref(null),addDataRef=ref(null),updateDataRef=ref(null),deleteDataRef=ref(null),launchDataRef=ref(null),requiredDisabled=e=>["billRule","createUser","createTime","modifyTime","modifyUser","currPosition","currOrganize","table"].includes(e),getDataType=e=>{if(!e.__config__||!e.__config__.jnpfKey)return"";const o=e.__config__.jnpfKey;return["inputNumber","datePicker","rate","slider"].includes(o)?"number":["checkbox","uploadFile","uploadImg","cascader","organizeSelect","areaSelect"].includes(o)||["select","treeSelect","depSelect","posSelect","userSelect","usersSelect","roleSelect","groupSelect","popupSelect","popupTableSelect"].includes(o)&&e.multiple?"array":""},getBindValue=computed((()=>({...props,formConf:getFormConf(),printTplOptions:state.printTplOptions,prevNodeList:state.prevNodeList,beforeNodeOptions:state.beforeNodeOptions,sourceIsStart:state.sourceIsStart,dataSourceFormList:state.dataSourceFormList,formFieldsOptions:unref(formFieldsOptions),usedFormItems:unref(usedFormItems),funcOptions:unref(funcOptions),noticeOptions:unref(noticeOptions),nodeOptions:unref(getApproverNodeOptions),dataSourceForm:unref(getDataSourceFormList),getFormFieldList:getFormFieldList,initFormOperates:initFormOperates,updateJnpfData:updateJnpfData,updateAllNodeFormOperates:updateAllNodeFormOperates,transformFormJson:transformFormJson,transformFieldList:transformFieldList,updateTransferList:updateTransferList,updateFormFieldList:updateFormFieldList,updateBpmnProperties:updateBpmnProperties,onConnectNameChange:onConnectNameChange}))),formFieldsOptions=computed((()=>state.formFieldList.filter((e=>"table"!==e.__config__.jnpfKey)).map((e=>({...e,disabled:!1}))))),getDataSourceFormList=computed((()=>state.dataSourceFormList.map((e=>({...e,children:(e.children||[]).filter((e=>"table"!==e?.__config__?.jnpfKey&&!e?.__config__?.isSubTable))}))))),usedFormItems=computed((()=>unref(formFieldsOptions).filter((e=>e.id.indexOf("-")<0)))),funcOptions=computed((()=>unref(formFieldsOptions).map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id}))))),noticeOptions=computed((()=>[...systemFieldOptions,...unref(formFieldsOptions)].map((e=>({...e,label:e.fullName?e.id+"("+e.fullName+")":e.id}))))),getApproverNodeOptions=computed((()=>{const e=props.bpmn?.get("jnpfData");if(!props.element)return[];const o=[];for(const t in e?.data){const n=e?.data[t];NodeUtils.isApproverNode(n)&&t!=props.element?.id&&o.push({fullName:`${n.nodeName}(${n.nodeId})`,id:n.nodeId})}return o}));function init(){handleNull(),isStartNode()&&initStartNodeData(),isApproverNode()&&initApproverNodeData(),isProcessingNode()&&initProcessingNodeData(),isSubFlowNode()&&initSubFlowNodeData(),isConnectNode()&&initConnectNodeData(),(isTriggerNode()||isEventTriggerNode()||isTimeTriggerNode()||isNoticeTriggerNode()||isWebhookTriggerNode()||isGetDataNode()||isAddDataNode()||isUpdateDataNode()||isDeleteDataNode()||isDataInterfaceNode()||isMessageNode()||isLaunchFlowNode()||isScheduleNode())&&initCommonTaskData(),!props.element&&initGlobalNodeData()}function handleNull(){state.formFieldList=[],state.dataSourceFormList=[]}function initGlobalNodeData(){state.globalForm=cloneDeep(2==props.type?nodeConfig.defaultTaskGlobalForm:nodeConfig.defaultGlobalForm);const e=cloneDeep(getJnpfData("global")||{});Object.assign(state.globalForm,e),state.globalForm.formId&&getFormByAllFormMap(state.globalForm.formId)}function initStartNodeData(){state.startForm=cloneDeep(nodeConfig.defaultStartForm);const e=cloneDeep(getJnpfData(props.element.id)||{});Object.assign(state.startForm,e),state.oldFormId=state.startForm.formId,state.oldFormId&&(getFormByAllFormMap(state.oldFormId),nextTick((()=>unref(startRef)?.updateCheckStatus())),getFormFieldList(state.startForm.formId,"startForm",!0))}function initApproverNodeData(){state.approverForm=cloneDeep(nodeConfig.defaultApproverForm);const e=cloneDeep(getJnpfData(props.element.id)||{}),o=getJnpfData("global"),t=e.formId||o.formId;state.oldFormId=t,getFormByAllFormMap(t),e.formOperates=initFormOperates(e),Object.assign(state.approverForm,e),nextTick((()=>unref(approverRef)?.updateCheckStatus())),getBeforeNodeOptions(),getPrevNodeOptions(),o.hasAloneConfigureForms&&state.approverForm.formId&&getFormFieldList(state.approverForm.formId,"approverForm",!0)}function initProcessingNodeData(){state.processingForm=cloneDeep(nodeConfig.defaultProcessingForm);const e=cloneDeep(getJnpfData(props.element.id)||{}),o=getJnpfData("global"),t=e.formId||o.formId;state.oldFormId=t,getFormByAllFormMap(t),e.formOperates=initFormOperates(e),Object.assign(state.processingForm,e),nextTick((()=>unref(processingRef)?.updateCheckStatus())),getBeforeNodeOptions(),getPrevNodeOptions(),o.hasAloneConfigureForms&&state.processingForm.formId&&getFormFieldList(state.processingForm.formId,"processingForm",!0)}function initSubFlowNodeData(){state.subFlowForm=cloneDeep(nodeConfig.defaultSubFlowForm);const e=cloneDeep(getJnpfData(props.element.id)||{});Object.assign(state.subFlowForm,e),getBeforeNodeOptions(),getPrevNodeOptions();const o=getJnpfData("global");getFormByAllFormMap(e.formId||o.formId),updateFlowInfo("subFlowForm")}function initConnectNodeData(){getConnectNodeFieldList(),state.connectForm=cloneDeep(nodeConfig.defaultConnectForm);const e=cloneDeep(getJnpfData(props.element.id)||{nodeId:props.element.id});Object.assign(state.connectForm,e);let o=e.conditions||[];for(let n=0;n<o.length;n++)for(let e=0;e<unref(usedFormItems).length;e++)o[n].id===unref(usedFormItems)[e].id&&(o[n]={...o[n],...unref(usedFormItems)[e]});state.connectForm.conditions=cloneDeep(o||[]),state.connectForm.matchLogic=e.matchLogic||"and";let t=props.bpmn.get("elementRegistry").get(props.element.id);state.sourceIsStart="start"==t?.source?.wnType}function initCommonTaskData(){let key=props.element.wnType;const type=props.element.wnType,form=type+"Form";if(handleProperties(form),isTriggerNode()){const e=NodeUtils.getPreNodeList(toRaw(props.element))[0],o=getJnpfData(e?.id),t=getJnpfData("global");state.triggerForm.formId=o?.formId||t.formId,state.triggerForm.formName=o?.formName||t.formName,1==state.triggerForm.triggerEvent&&(state.triggerForm.triggerEvent=2)}if(state.oldFormId=state[form].formId,(isTriggerNode()||isEventTriggerNode()||isAddDataNode()||isUpdateDataNode()||isDeleteDataNode())&&getFormByAllFormMap(state[form].formId),isScheduleNode()&&!state[form]?.duration&&(state[form].duration=appStore.getSysConfigInfo?.duration),(isTriggerNode()||isEventTriggerNode()||isGetDataNode()||isAddDataNode()||isUpdateDataNode()||isDeleteDataNode())&&(isEventTriggerNode()&&(key="trigger"),nextTick((()=>unref(eval(key+"Ref"))?.initCondition()))),isWebhookTriggerNode()&&initWebhookTriggerNodeData(form),isTriggerNode()&&getFormFieldList(state[form].formId,form),isLaunchFlowNode()&&updateFlowInfo("launchFlowForm"),props?.element?.businessObject.$attrs?.customGroupId){const e=getJnpfData(props?.element.id);e.groupId=props.element.businessObject.$attrs.customGroupId}nextTick((()=>{getDataSourceForm()}))}function isStartNode(){return!!props.element?.wnType&&NodeUtils.isStartNode({type:props.element.wnType})}function isApproverNode(){return!!props.element?.wnType&&NodeUtils.isApproverNode({type:props.element.wnType})}function isProcessingNode(){return!!props.element?.wnType&&NodeUtils.isProcessingNode({type:props.element.wnType})}function isSubFlowNode(){return!!props.element?.wnType&&NodeUtils.isSubFlowNode({type:props.element.wnType})}function isConnectNode(){return!!props.element?.type&&NodeUtils.isConnectNode({type:props.element.type})}function isTriggerNode(){return!!props.element?.wnType&&NodeUtils.isTriggerNode({type:props.element.wnType})}function isEventTriggerNode(){return!!props.element?.wnType&&NodeUtils.isEventTriggerNode({type:props.element.wnType})}function isTimeTriggerNode(){return!!props.element?.wnType&&NodeUtils.isTimeTriggerNode({type:props.element.wnType})}function isNoticeTriggerNode(){return!!props.element?.wnType&&NodeUtils.isNoticeTriggerNode({type:props.element.wnType})}function isWebhookTriggerNode(){return!!props.element?.wnType&&NodeUtils.isWebhookTriggerNode({type:props.element.wnType})}function isGetDataNode(){return!!props.element?.wnType&&NodeUtils.isGetDataNode({type:props.element.wnType})}function isAddDataNode(){return!!props.element?.wnType&&NodeUtils.isAddDataNode({type:props.element.wnType})}function isUpdateDataNode(){return!!props.element?.wnType&&NodeUtils.isUpdateDataNode({type:props.element.wnType})}function isDeleteDataNode(){return!!props.element?.wnType&&NodeUtils.isDeleteDataNode({type:props.element.wnType})}function isDataInterfaceNode(){return!!props.element?.wnType&&NodeUtils.isDataInterfaceNode({type:props.element.wnType})}function isMessageNode(){return!!props.element?.wnType&&NodeUtils.isMessageNode({type:props.element.wnType})}function isLaunchFlowNode(){return!!props.element?.wnType&&NodeUtils.isLaunchFlowNode({type:props.element.wnType})}function isScheduleNode(){return!!props.element?.wnType&&NodeUtils.isScheduleNode({type:props.element.wnType})}async function initWebhookTriggerNodeData(e){if(!state[e].webhookUrl){const o=await getWebhookUrl(props.flowInfo.flowId);if(!o)return;state[e].webhookUrl=o.data.webhookUrl,state[e].webhookGetFieldsUrl=o.data.requestUrl,state[e].webhookRandomStr=o.data.randomStr}}function getFormByAllFormMap(e){const o=getJnpfData("global");state.formFieldList=[],e&&o.allFormMap&&o.allFormMap["form_"+e]&&(state.formFieldList=o.allFormMap["form_"+e]||[])}function handleProperties(e){state[e]=cloneDeep(nodeConfig[transformLetter(e)]);const o=cloneDeep(getJnpfData(props.element.id)||{});Object.assign(state[e],o)}function transformLetter(e){return"default"+e[0].toUpperCase()+e.slice(1)}function getJnpfData(e){const o=props.bpmn?.get("jnpfData");return o?.data[e]}function getFormConf(){return isStartNode()?state.startForm:isApproverNode()?state.approverForm:isProcessingNode()?state.processingForm:isSubFlowNode()?state.subFlowForm:isConnectNode()?state.connectForm:isTriggerNode()?state.triggerForm:isNoticeTriggerNode()?state.noticeTriggerForm:isEventTriggerNode()?state.eventTriggerForm:isTimeTriggerNode()?state.timeTriggerForm:isWebhookTriggerNode()?state.webhookTriggerForm:isGetDataNode()?state.getDataForm:isAddDataNode()?state.addDataForm:isUpdateDataNode()?state.updateDataForm:isDeleteDataNode()?state.deleteDataForm:isDataInterfaceNode()?state.dataInterfaceForm:isMessageNode()?state.messageForm:isLaunchFlowNode()?state.launchFlowForm:isScheduleNode()?state.scheduleForm:state.globalForm}function getPrintTplList(){getPrintDevSelector().then((e=>{state.printTplOptions=e.data.list.filter((e=>e.children&&e.children.length)).map((e=>({...e,hasChildren:!0})))}))}function getConnectNodeFieldList(){let e=toRaw(props.element).source.id;if(hasGatewayType.has(toRaw(props.element).source.wnType)&&(e=toRaw(props.element).source.incoming[0]?.source.id),e){const o=props.bpmn.get("jnpfData"),t=o.getValue("global");getFormByAllFormMap(o.getValue(e,"formId")||t.formId),state.formFieldList=state.formFieldList.filter((e=>"table"!==e.__config__.jnpfKey))}else state.formFieldList=[]}function updateBpmnProperties(e,o){if(!props.element)return;const t=props.bpmn.get("modeling"),n=props.bpmn.get("elementRegistry").get(props.element.id);n[e]=o,t.updateProperties(n,{})}function updateGlobalFormId(e,o){props.bpmn.get("jnpfData").setValue("global",{formId:e,formName:o})}function getFormFieldList(id,form,isSameForm=!1,updateFormOperates=!0){if(id)return new Promise(((resolve,reject)=>{getConfigData(id).then((res=>{const{type:type=1,formData:formData}=res.data;let formJson={},fieldList=[];formData&&(formJson=JSON.parse(formData)),fieldList=2==type?transformFormJson(formJson):formJson.fields;let list=transformFieldList(fieldList);state.formFieldList=list,updateFormOperates&&(state[form].formOperates=initFormOperates(state[form],!0,isSameForm)),updateAllFormMap(id,list),"startForm"===form&&updateAllNodeFormOperates(isSameForm),["getDataForm","deleteDataForm"].includes(form)&&handleGetDataForm(form,list),"addDataForm"===form&&updateTransferList(form),["eventTriggerForm","getDataForm","addDataForm","updateDataForm","deleteDataForm"].includes(form)&&("eventTriggerForm"==form&&(form="triggerForm"),unref(eval(state[form].type+"Ref"))?.initCondition()),resolve({})})).catch((()=>{reject()}))}))}function updateAllFormMap(e,o){const t=props.bpmn.get("jnpfData"),n=t.getValue("global");state.oldFormId&&!getHasSameFormId(state.oldFormId)&&delete n.allFormMap["form_"+state.oldFormId],e&&(n.allFormMap["form_"+e]=o),t.setValue("global",n),state.oldFormId=e}function getHasSameFormId(e){if(!e)return!1;let o=!1;const t=props.bpmn.get("jnpfData");for(const n in t.data){const a=t.data[n];if(a?.nodeId!==props.element?.id&&a?.formId===e){o=!0;break}}return o}function transformFormJson(e){return e.map((e=>({__config__:{label:e.filedName,jnpfKey:e.jnpfKey||"",required:e.required||!1},__vModel__:e.filedId,multiple:e.multiple||!1})))}function transformFieldList(e){let o=[];const t=(e,n)=>{if(e){if(e.__vModel__){const t=n&&n.__config__&&"table"===n.__config__.jnpfKey,a={id:t?n.__vModel__+"-"+e.__vModel__:e.__vModel__,fullName:t?n.__config__.label+"-"+e.__config__.label:e.__config__.label,...omit(e,["__config__","on","style","templateJson","addTableConf","tableConf"]),__vModel__:t?n.__vModel__+"-"+e.__vModel__:e.__vModel__,__config__:{label:t?n.__config__.label+"-"+e.__config__.label:e.__config__.label,...e.__config__}},l=a.__config__;dyOptionsList.includes(l.jnpfKey)&&"static"!==l.dataType&&delete a.options,o.push(a)}Array.isArray(e)&&e.forEach((e=>t(e,n))),e.__config__&&e.__config__.children&&Array.isArray(e.__config__.children)&&t(e.__config__.children,e)}};return t(e),o}function updateFormFieldList(e){state.formFieldList=e||[],updateAllFormMap("",e)}function initFormOperates(e,o=!1,t=!1){const n=e.formOperates||[];let a=[];const l=o=>{const t=n.filter((e=>e.id===o));return t.length?t[0].write:NodeUtils.isStartNode(e)},r=e=>{const o=n.filter((o=>o.id===e));return!o.length||o[0].read},i=e=>{const o=n.filter((o=>o.id===e));return!!o.length&&o[0].required};if(!n.length||o)for(let s=0;s<state.formFieldList.length;s++){const o=state.formFieldList[s];a.push({id:o.id,name:o.fullName,required:t?o.__config__.required||i(o.id):o.__config__.required,requiredDisabled:requiredDisabled(o.__config__.jnpfKey)||o.__config__.required,jnpfKey:o.__config__.jnpfKey,dataType:getDataType(o),read:!t||r(o.id),write:t?l(o.id):NodeUtils.isStartNode(e)})}else a=n;return a}function updateAllNodeFormOperates(e=!1,o=!1){const t=props.bpmn.get("jnpfData");for(const n in t.data){const a=t.data[n];if("approver"!==a.type&&"processing"!==a.type||a.formId||t.setValue(n,{formOperates:initFormOperates(a,!0,e)}),("approver"===a.type||"processing"===a.type)&&o){let o=[];const l=t.getValue("global"),r=l.formId;state.oldFormId=a.formId,r&&l.allFormMap&&l.allFormMap["form_"+r]&&(o=l.allFormMap["form_"+r]||[]),updateFormFieldList(o),t.setValue(n,{formOperates:initFormOperates(a,!0,e),formId:"",formName:"",assignList:[]})}}}function handleSetJnpfData(){const e=getFormConf(),o=props.bpmn?.get("jnpfData");e.nodeId&&o?.setValue(e.nodeId,e)}function getPrevNodeOptions(){const e=props.bpmn.get("jnpfData"),o=props.bpmn.get("elementRegistry");state.prevNodeList=[];const t=n=>{for(let a=0;a<n.length;a++){const l=n[a].businessObject.sourceRef.id,r=e.getValue(l,"nodeName"),i=e.getValue(l,"formId"),s=e.getValue(l,"type");if(["subFlow","gateway","confluence"].includes(s)||hasGatewayType.has(s)){const e=o.get(l);t(e?.incoming||[])}else state.prevNodeList.push({fullName:r,id:l,type:s,formId:i})}};t(toRaw(props.element)?.incoming||[])}function getBeforeNodeOptions(){const e=props.bpmn.get("jnpfData"),o=props.bpmn.get("elementRegistry"),t=toRaw(props.element)?.incoming||[];let n=[],a=[];const l=t=>{for(let r=0;r<t.length;r++){const i=t[r].businessObject.sourceRef.id,s=e.getValue(i,"nodeName"),c=e.getValue(i,"formId"),d=e.getValue(i,"type");(NodeUtils.isApproverNode({type:d})||NodeUtils.isProcessingNode({type:d}))&&(n.push({fullName:s,id:i,type:d,formId:c}),a.push(t[r].id));const f=o.get(i);if(f?.incoming?.length)for(let e=0;e<f?.incoming.length;e++){const o=f?.incoming[e];a.includes(o.id)||l([o])}}};l(t);let r=[];for(let i=0;i<n.length;i++)n[i].id===props.element.id||r.some((e=>e.id===n[i].id))||r.push(n[i]);state.beforeNodeOptions=r}function updateFlowInfo(e){state[e].flowId&&getInfo(state[e].flowId).then((o=>{const t=o.data.visibleType||1,n="subFlowForm"==e?"subFlowLaunchPermission":"launchPermission",a="subFlowForm"==e?"approvers":"initiator";"subFlowForm"==e&&unref(subFlowRef)?.getSubFlowFormInfo(),t!=state[e][n]&&(state[e][a]=[],state[e][n]=t,"launchFlowForm"==e&&unref(launchDataRef)?.getFlowFormFieldList())}))}function getDataSourceForm(){const e=getJnpfData("global"),o=[],t=n=>{const a=getJnpfData(n?.id);if("approver"==a.type)return;const l=NodeUtils.getPreNodeList(n);if(l?.length&&l.map((e=>t(e))),["getData","trigger","eventTrigger","webhookTrigger"].includes(a.type)&&n.id!==props.element.id&&!o.some((e=>e.id==n.id))){let t=[];t="getData"==a.type||"webhookTrigger"==a.type?cloneDeep(a.formFieldList)||[]:a.formId&&e.allFormMap["form_"+a.formId]?cloneDeep(e.allFormMap["form_"+a.formId]):[];t.some((e=>"@formId"===e.id))||t.unshift({fullName:"@表单ID",id:"@formId",label:"@formId(@表单ID)"}),t=t.filter((e=>"table"!==e?.__config__?.jnpfKey)).map((e=>({...omit(e,["disabled"]),label:e.fullName,id:`${e.id}|${a.nodeId}`,__config__:{...e.__config__,isSubTable:4!==a?.formType&&e?.__config__?.isSubTable}}))),t?.length&&o.push({id:n.id,fullName:a.nodeName,label:a.nodeName,children:t})}};props?.element&&t(toRaw(props.element)),state.dataSourceFormList=o}function updateTransferList(e){const o=getJnpfData("global"),t="addDataForm"==e?o.allFormMap["form_"+state[e]?.formId]||[]:state[e].formFieldList||[];let n=[];for(let a=0;a<t.length;a++)t[a].__config__?.required&&n.push({targetField:t[a].id,targetFieldLabel:t[a].fullName,sourceType:1,sourceValue:"",required:!0});state[e].transferList=n}function handleGetDataForm(e,o){4==state[e].formType||"deleteDataForm"==e&&1==state[e].tableType?(state[e].subTableList=cloneDeep(o).filter((e=>"table"==e.__config__.jnpfKey)).map((e=>({id:e.id,fullName:e.fullName}))),state[e].cacheFormFieldList=o):"deleteDataForm"==e&&0==state[e].deleteType&&0==state[e].tableType?state[e].formFieldList=o.filter((e=>!e?.__config__?.isSubTable)):state[e].formFieldList=o}function updateConnectNameType(e){let o=props.bpmn.get("elementRegistry"),t=props.bpmn.get("modeling"),n=props.bpmn.get("jnpfData"),a=o.getAll().filter((e=>e.wnType===typeCondition));n.setValue("global",{isShowConditions:e.isShowConditions,showNameType:e.showNameType}),a.map((e=>{t.updateProperties(e,{})}))}async function onConnectNameChange(e,o){if(!props.element)return;const t=props.bpmn.get("modeling"),n=props.bpmn.get("elementRegistry").get(props.element.id+"_label");n[e]=o,t.updateProperties(n,{})}function updateDivideRule(e){let o=props.bpmn.get("elementRegistry").get(props.element.id),t=props.bpmn.get("jnpfData"),n=props.bpmn.get("modeling");"parallel"!==e&&"choose"!==e||o?.outgoing.forEach((e=>{let o=props.bpmn.get("elementRegistry").get(e.id+"_label");o&&n.removeShape(o,{nested:!0});let a=t.getValue(e.id);a&&t.setValue(e.id,{...a,conditions:[]})}))}return watch((()=>props.element),(()=>{init()})),onMounted((()=>{getPrintTplList(),nextTick((()=>initGlobalNodeData()))})),(e,o)=>(openBlock(),createElementBlock("section",_hoisted_1$1,[__props.element?(openBlock(),createElementBlock(Fragment,{key:0},[isStartNode()?(openBlock(),createBlock(_sfc_main$p,mergeProps({key:0,ref_key:"startRef",ref:startRef},getBindValue.value,{onUpdateGlobalFormId:updateGlobalFormId,onUpdateDivideRule:updateDivideRule}),null,16)):isApproverNode()?(openBlock(),createBlock(_sfc_main$j,mergeProps({key:1,ref_key:"approverRef",ref:approverRef},getBindValue.value,{onUpdateDivideRule:updateDivideRule}),null,16)):isProcessingNode()?(openBlock(),createBlock(_sfc_main$i,mergeProps({key:2,ref_key:"processingRef",ref:processingRef},getBindValue.value,{onUpdateDivideRule:updateDivideRule}),null,16)):isSubFlowNode()?(openBlock(),createBlock(_sfc_main$h,mergeProps({key:3,ref_key:"subFlowRef",ref:subFlowRef},getBindValue.value,{onUpdateDivideRule:updateDivideRule}),null,16)):isConnectNode()?(openBlock(),createBlock(_sfc_main$f,normalizeProps(mergeProps({key:4},getBindValue.value)),null,16)):isTriggerNode()||isEventTriggerNode()?(openBlock(),createBlock(_sfc_main$e,mergeProps({key:5,ref_key:"triggerRef",ref:triggerRef},getBindValue.value),null,16)):isTimeTriggerNode()?(openBlock(),createBlock(_sfc_main$c,normalizeProps(mergeProps({key:6},getBindValue.value)),null,16)):isNoticeTriggerNode()?(openBlock(),createBlock(_sfc_main$d,normalizeProps(mergeProps({key:7},getBindValue.value)),null,16)):isWebhookTriggerNode()?(openBlock(),createBlock(_sfc_main$b,normalizeProps(mergeProps({key:8},getBindValue.value)),null,16)):isGetDataNode()?(openBlock(),createBlock(_sfc_main$a,mergeProps({key:9,ref_key:"getDataRef",ref:getDataRef},getBindValue.value),null,16)):isAddDataNode()?(openBlock(),createBlock(_sfc_main$9,mergeProps({key:10,ref_key:"addDataRef",ref:addDataRef},getBindValue.value),null,16)):isUpdateDataNode()?(openBlock(),createBlock(_sfc_main$8,mergeProps({key:11,ref_key:"updateDataRef",ref:updateDataRef},getBindValue.value),null,16)):isDeleteDataNode()?(openBlock(),createBlock(_sfc_main$7,mergeProps({key:12,ref_key:"deleteDataRef",ref:deleteDataRef},getBindValue.value),null,16)):isDataInterfaceNode()?(openBlock(),createBlock(_sfc_main$6,normalizeProps(mergeProps({key:13},getBindValue.value)),null,16)):isMessageNode()?(openBlock(),createBlock(_sfc_main$5,normalizeProps(mergeProps({key:14},getBindValue.value)),null,16)):isLaunchFlowNode()?(openBlock(),createBlock(_sfc_main$4,mergeProps({key:15,ref_key:"launchDataRef",ref:launchDataRef},getBindValue.value),null,16)):isScheduleNode()?(openBlock(),createBlock(_sfc_main$3,normalizeProps(mergeProps({key:16},getBindValue.value)),null,16)):(openBlock(),createBlock(_sfc_main$g,{key:17}))],64)):(openBlock(),createBlock(_sfc_main$u,mergeProps({key:1},getBindValue.value,{onUpdateConnectNameType:updateConnectNameType}),null,16))]))}}),_sfc_main$1=defineComponent({__name:"index",props:["flowInfo","flowState","versionList","type"],emits:["addVersion"],setup(e,{expose:o,emit:t}){provide("bpmn",(()=>unref(f))),o({getData:async function(){return C(),new Promise((e=>{i.errorList=[];let o=unref(f).get("canvas").getRootElement();const t=validate(unref(f).get("elementRegistry"),o,a);if(t){const e=t.element;e||u(t.message),e?.length&&e.map((e=>u(e.error)))}unref(f).saveXML({format:!0}).then((o=>{if(o){let t=unref(f).get("jnpfData"),n={},l=unref(f).get("elementRegistry").filter((e=>"bpmn:Process"!=e.type)).map((e=>e.id));Object.keys(t.data).map((e=>{const o=t.data[e];if("global"===e){if(2!=a.type){2!=o.errorRule||o.errorRuleUser.length||u("请选择异常处理人","global","全局属性"),o.fileConfig.on&&!o.fileConfig.templateId&&u("请选择归档模板","global","全局属性");let e=unref(f).get("elementRegistry").getAll()?.filter((e=>e.type===bpmnSequenceFlow));1===a.type&&(e=e.filter((e=>!hasGatewayType.has(e.target?.wnType)&&e.source?.wnType!=typeConfluence))),o.connectList=e.map((e=>e.id))}n[e]=o}if(l.includes(e)){const t=o.nodeName||""+e,l=[typeGateway,typeConfluence,typeInclusion,typeExclusive,typeParallel,typeChoose,typeConnect];if(!o?.type||o.nodeName||l.includes(o?.type)||u("节点名称不能为空",e,t),"choose"===o.divideRule&&0===a.type){unref(f).get("elementRegistry").get(o.nodeId).outgoing.some((e=>e.target.wnType===bpmnSubFlow))&&u("分流规则-选择分支配置不能选择子流程",e,t)}if("start"==o.type&&2!=a.type)o.formId||u("请选择流程表单",e,t),o.printConfig?.on&&(o.printConfig?.printIds?.length||u("请选择打印模板",e,t),4!=o.printConfig?.conditionType||o.printConfig?.conditions?.length||u("请设置打印条件",e,t));else if("approver"==o.type||o.type==typeProcessing)6!=o.assigneeType||o?.approvers?.length||u("请设置审批人",e,t),4!=o.assigneeType||o.formField||u("请选择表单字段",e,t),5!=o.assigneeType||o.approverNodeId||u("请选择节点",e,t),9!=o.assigneeType||o.interfaceConfig?.interfaceId||u("请选择数据接口",e,t),1===o.overTimeConfig?.on&&o.overTimeConfig?.overAutoTransfer&&6==o.overTimeConfig?.overTimeType&&!o?.overTimeConfig.reApprovers&&u("请设置转审人",e,t+"【超时设置】"),1===o.overTimeConfig?.on&&o.overTimeConfig?.overAutoTransfer&&9==o.overTimeConfig?.overTimeType&&!o.overTimeConfig?.interfaceId&&u("请选择超时数据接口",e,t+"【超时设置】"),o.hasAutoApprover&&(o.autoAuditRule?.conditions?.length||u("请选择同意规则配置",e,t),o.autoRejectRule?.conditions?.length||u("请选择拒绝规则配置",e,t)),o.printConfig?.on&&(o.printConfig?.printIds?.length||u("请选择打印模板",e,t),4!=o.printConfig?.conditionType||o.printConfig?.conditions?.length||u("请设置打印条件",e,t)),o.hasApprovalField&&!o.approvalField?.length&&u("请选择拓展字段",e,t);else if("subFlow"==o.type)6!=o.assigneeType&&2!=o.subFlowLaunchPermission||o?.approvers?.length||u("请设置审批人",e,t),4!=o.assigneeType||o.formField||1!=o.subFlowLaunchPermission||u("请选择表单字段",e,t),5!=o.assigneeType||o.approverNodeId||u("请选择节点",e,t),9!=o.assigneeType||o.interfaceConfig?.interfaceId||u("请选择数据接口",e,t),o.flowId||u("请选择子流程表单",e,t);else if("connect"==o.type)v(o.conditions,e,t);else if("trigger"==o.type||"eventTrigger"==o.type)o.formId||u("请选择触发表单",e,t),2!=o.triggerEvent||o.actionList?.length||u("请选择审批动作",e,t),v(o.ruleList,e,t);else if("timeTrigger"==o.type)o.startTime||u("请选择触发开始时间",e,t),o.cron||u("请设置Cron表达式",e,t),2!=o.endTimeType||o.endTime||u("请选择触发结束时间",e,t);else if("noticeTrigger"==o.type)o.noticeId||u("请选择通知模板",e,t);else if("webhookTrigger"==o.type)o.webhookUrl||u("webhook URL未生成",e,t),o.formFieldList?.length||u("请设置接口字段",e,t),function(e,o,t){for(let n=0;n<e.length;n++){const a=e[n];a.id||u(`第${n+1}行字段不能为空`,o,t),a.fullName||u(`第${n+1}行字段说明不能为空`,o,t)}}(o.formFieldList,e,t);else if("getData"==o.type){const n=1==o.formType?"请选择表单":2==o.formType?"请选择流程":3==o.formType?"请选择数据接口":"请选择主表";o.formId||u(n,e,t),4!=o.formType||o.subTable||u("请选择子表",e,t),v(o.ruleList,e,t),function(e,o,t){for(let n=0;n<e.length;n++){e[n].field||u(`第${n+1}行排序字段不能为空`,o,t)}}(o.sortList||[],e,t),3==o.formType&&h(o.interfaceTemplateJson||[],e,t)}else if("addData"==o.type||"updateData"==o.type)o.formId||u("请选择目标表单",e,t),_(o.transferList,e,t),o.ruleList?.length||"updateData"!=o.type||u("请设置更新条件",e,t),v(o.ruleList,e,t);else if("deleteData"==o.type)0===o.deleteType?(o.formId||u(0===o.tableType?"请选择表单":"请选择主表",e,t),o.subTable||1!==o.tableType||u("请选择子表",e,t),v(o.ruleList,e,t)):(o.formId||u("请选择表单",e,t),o.dataSourceForm||u("请选择数据节点",e,t),o.ruleList?.length||u("请设置数据校验",e,t),v(o.ruleList,e,t));else if("dataInterface"==o.type)o.formId||u("请选择执行数据接口",e,t),h(o.templateJson||[],e,t);else if("message"==o.type)o.msgUserIds?.length||u("请选择接收人",e,t),o.msgId||u("请选择发送配置",e,t);else if("launchFlow"==o.type)o.flowId||u("请选择发起流程",e,t),_(o.transferList,e,t),o.initiator?.length||u("请选择发起人",e,t);else if("schedule"==o.type)o.title||u("标题不能为空",e,t),o.creatorUserId||u("创建人不能为空",e,t),o.startDay&&(o.allDay||o.startTime)||u("开始时间不能为空",e,t),(o.allDay&&!o.endDay||!o.allDay&&-1==o.duration&&!o.endTime)&&u("结束时间不能为空",e,t),-2===o.reminderTime||2!=o.reminderType||o.send||u("发送配置不能为空",e,t);else if(hasGatewayType.has(o.type)){let e=unref(f).get("elementRegistry").get(o.nodeId);o.type=e.wnType}if(o.divideRule===typeChoose&&0===a.type){let n=unref(f).get("elementRegistry").get(o.nodeId),a=[];n.outgoing.forEach((e=>{triggerTypeChange[e.target.wnType]||a.push(e)})),a.length<2&&u("选择分支节点至少设置2条分支",e,t)}n[e]=o}}));let r={};1===a.type&&(n=function(e){return NodeUtils.gatewayTypeSettings(unref(f),e)}(n));const s=1!=a.type?function(e,o){let t=unref(f).get("elementRegistry");return NodeUtils.autoCreateGateWay(e.xml,t,o)}(o,t):encodeURIComponent(o.xml);i.errorList?.length||(r={flowXml:s,flowNodes:n}),e({errorList:i.errorList,data:r})}}))}))},handleSelectNode:function(e){const o=unref(f).get("elementRegistry"),t=unref(f).get("selection");let n=o.get(e);t.select(n)},destroyBpmn:function(){unref(f)?.destroy()}});const n=t,a=e,{prefixCls:l}=useDesign("basic-process"),r=ref(null),i=reactive({loading:!1,flowList:[],activeConf:{},defaultData:{},formFieldList:[],errorList:[],isAdvanced:!0}),{loading:s,isAdvanced:c}=toRefs(i),{t:d}=useI18n(),f=computed((()=>unref(r)?.getBpmn())),m=computed((()=>unref(r)?.getElement())),p=computed((()=>({...a,element:unref(m),bpmn:unref(f)})));function u(e,o="",t="流程建模"){i.errorList.push({errorInfo:e,id:o,title:t})}function C(){let e=unref(f);return NodeUtils.verificationConnect(e)}function g(){n("addVersion")}function v(e,o,t){if(e?.length)e:for(let n=0;n<e.length;n++){const a=e[n];for(let e=0;e<a.groups.length;e++){const n=a.groups[e];if(!n.field||!n.symbol){u("请完善条件组数据",o,t);break e}}}}function _(e,o,t){if(!e?.length)return u("请至少设置一个字段",o,t);for(let n=0;n<e.length;n++){const a=e[n];a.targetField||u(`第${n+1}行目标表单字段不能为空`,o,t),a.sourceValue||u(`第${n+1}行数据源字段不能为空`,o,t)}}function h(e,o,t){for(let n=0;n<e.length;n++){const a=e[n];1!=a.sourceType||a.relationField||u(`参数${a.field}字段不能为空`,o,t),a.required&&2==a.sourceType&&!a.relationField&&u(`参数${a.field}不能为空`,o,t)}}return(e,o)=>{const t=resolveComponent("a-tooltip"),n=resolveDirective("loading");return withDirectives((openBlock(),createElementBlock("div",{class:normalizeClass(`${unref(l)}`)},[createVNode(_sfc_main$G,mergeProps({ref_key:"bpmnContainer",ref:r},p.value,{onAddVersion:g}),null,16),createBaseVNode("div",{class:normalizeClass(["right-container",{open:unref(c)}])},[(openBlock(),createBlock(t,{placement:"left",title:unref(c)?unref(d)("component.form.fold"):unref(d)("component.form.unfold"),key:unref(c)},{default:withCtx((()=>[createBaseVNode("div",{class:"toggle-btn",onClick:o[0]||(o[0]=e=>c.value=!unref(c))},[unref(c)?(openBlock(),createBlock(unref(DoubleRightOutlined),{key:0})):(openBlock(),createBlock(unref(DoubleLeftOutlined),{key:1}))])])),_:1},8,["title"])),createVNode(_sfc_main$2,normalizeProps(guardReactiveProps(p.value)),null,16)],2)],2)),[[n,unref(s)]])}}}),_hoisted_1={class:"jnpf-full-modal-header"},_hoisted_2={class:"header-title"},_hoisted_3={class:"header-txt"},_hoisted_4={class:"w-250px"},_hoisted_5={class:"version-list"},_hoisted_6=["onClick"],_hoisted_7={class:"version-name"},_hoisted_8={class:"version-delete"},_hoisted_9=["onClick"],_sfc_main=defineComponent({__name:"DesignForm",emits:["register","reload"],setup(e,{emit:o}){const t=o,[n,{closeModal:a,changeLoading:l}]=useModalInner((function(e){s.activeStep=0,s.loading=!0,unref(d)?.setVisible(!1),s.errorList=[],l(!0),s.dataForm.id=e.id||"",s.dataForm.fullName=e.fullName||"",V()})),{createMessage:r}=useMessage(),{t:i}=useI18n(),s=reactive({loading:!1,btnLoading:!1,releaseBtnLoading:!1,dataForm:{},errorList:[],versionVisible:!1,versionList:[],currentVersion:{},key:+new Date,activeStep:0,flowConfig:{visibleType:1}}),c=ref(null),d=ref(null),{loading:f,btnLoading:m,releaseBtnLoading:p,dataForm:u,errorList:C,versionVisible:g,versionList:v,currentVersion:_,activeStep:h,flowConfig:N}=toRefs(s),k=[{fullName:"公开",id:1},{fullName:"权限设置",id:2}],y=computed((()=>({flowInfo:s.dataForm,flowState:s.currentVersion.state,versionList:s.versionList,type:s.dataForm.type||0,key:s.key})));function V(e=!0){getVersionList(s.dataForm.id).then((o=>{s.versionList=o.data||[],e&&(s.currentVersion=s.versionList[0],s.key=+new Date,B())})).catch((()=>{s.loading=!1,l(!1)}))}function B(){s.errorList=[],getFlowInfo(s.currentVersion.id).then((e=>{s.dataForm={...s.dataForm,...e.data},s.flowConfig=s.dataForm.flowConfig?JSON.parse(s.dataForm.flowConfig):{visibleType:1},s.loading=!1,l(!1),s.key=+new Date})).catch((()=>{s.loading=!1,l(!1)}))}async function x(e=0){unref(d)?.setVisible(!1);const o=await(unref(c)?.getData())||[];s.errorList=o.errorList||[],s.errorList.length?setTimeout((()=>{unref(d)?.setVisible(!0)}),10):function(e){s[1==e?.type?"releaseBtnLoading":"btnLoading"]=!0;const o={...e,id:s.dataForm.id,flowId:s.currentVersion.id,flowConfig:s.flowConfig?JSON.stringify(s.flowConfig):null};s.dataForm={...s.dataForm,...o,type:s.dataForm.type},saveFlow(o).then((o=>{r.success(o.msg),s.releaseBtnLoading=!1,s.btnLoading=!1,1===e?.type&&(s.currentVersion.state=1,s.key=+new Date,V(!1),t("reload"))})).catch((()=>{s.releaseBtnLoading=!1,s.btnLoading=!1}))}({...o.data,type:e})}function T(e){return 0==e?"rgba(247,171,51,0.9)":1==e?"rgba(75, 222, 0, 0.9)":"rgba(152,158,178,0.9)"}function w(){copyVersion(s.currentVersion.id).then((e=>{const o=e.data;getVersionList(s.dataForm.id).then((e=>{if(s.versionList=e.data||[],o){const e=s.versionList.filter((e=>e.id==o));s.currentVersion=e.length?e[0]:s.versionList[0],B()}}))}))}function b(e){s.activeStep=0,unref(c).handleSelectNode(e)}return(e,o)=>{const t=resolveComponent("a-tooltip"),l=resolveComponent("a-button"),F=resolveComponent("a-popover"),L=resolveComponent("a-step"),U=resolveComponent("a-steps"),I=resolveComponent("a-space"),S=resolveComponent("a-alert"),D=resolveComponent("jnpf-radio"),$=resolveComponent("a-col"),O=resolveComponent("a-row");return openBlock(),createBlock(unref(BasicModal),mergeProps(e.$attrs,{onRegister:unref(n),defaultFullscreen:"",footer:null,closable:!1,keyboard:!1,class:"jnpf-full-modal full-modal designer-modal process-designer-modal"}),{title:withCtx((()=>[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[o[8]||(o[8]=createBaseVNode("img",{src:logoImg,class:"header-logo"},null,-1)),createVNode(t,{title:unref(u)?.fullName},{default:withCtx((()=>[createBaseVNode("p",_hoisted_3," · "+toDisplayString(unref(u)?.fullName),1)])),_:1},8,["title"]),unref(_)?.id?(openBlock(),createBlock(F,{key:0,open:unref(g),"onUpdate:open":o[0]||(o[0]=e=>isRef(g)?g.value=e:null),trigger:"click",placement:"bottom",overlayClassName:"jnpf-version-popover","arrow-point-at-center":"",destroyTooltipOnHide:""},{content:withCtx((()=>[createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(v),(e=>{return openBlock(),createElementBlock("div",{class:"version-item",onClick:o=>function(e){s.currentVersion.id!=e.id&&(s.versionVisible=!1,s.currentVersion=e,B())}(e)},[createBaseVNode("span",{class:"version-badge",style:normalizeStyle({background:T(e.state)})},null,4),createBaseVNode("span",_hoisted_7,toDisplayString(e.fullName),1),createBaseVNode("span",{class:"version-state",style:normalizeStyle({background:T(e.state)})},toDisplayString((o=e.state,0==o?"设计中":1==o?"启用中":"已归档")),5),createBaseVNode("div",_hoisted_8,[!e.state&&unref(v).length>1?(openBlock(),createElementBlock("i",{key:0,class:"icon-ym icon-ym-app-delete",onClick:withModifiers((o=>{return t=e.id,void delVersion(t).then((e=>{r.success(e.msg),V(s.currentVersion.id===t)}));var t}),["stop"])},null,8,_hoisted_9)):createCommentVNode("",!0)])],8,_hoisted_6);var o})),256))]),createBaseVNode("div",{class:"add-btn",onClick:w},[createVNode(l,{type:"link",preIcon:"icon-ym icon-ym-btn-add"},{default:withCtx((()=>o[6]||(o[6]=[createTextVNode("新增流程版本")]))),_:1,__:[6]})])])])),default:withCtx((()=>[createVNode(l,{type:"text",class:"current-version"},{default:withCtx((()=>[createBaseVNode("span",{class:"version-badge",style:normalizeStyle({background:T(unref(_).state)})},null,4),createTextVNode(toDisplayString(unref(_)?.fullName)+" ",1),o[7]||(o[7]=createBaseVNode("i",{class:"icon-ym icon-ym-unfold ml-5px font text-10px"},null,-1))])),_:1,__:[7]})])),_:1},8,["open"])):createCommentVNode("",!0)]),unref(f)||2==unref(u).type?createCommentVNode("",!0):(openBlock(),createBlock(U,{key:0,current:unref(h),"onUpdate:current":o[1]||(o[1]=e=>isRef(h)?h.value=e:null),type:"navigation",size:"small",class:"header-steps tab-steps"},{default:withCtx((()=>[createVNode(L,{title:"流程建模"}),createVNode(L,{title:"流程设置"})])),_:1},8,["current"])),createVNode(I,{class:"options",size:10},{default:withCtx((()=>[createVNode(unref(ValidatePopover),{ref_key:"validatePopoverRef",ref:d,errorList:unref(C),onSelect:b},null,8,["errorList"]),1!=unref(_).state?(openBlock(),createBlock(l,{key:0,type:"primary",shape:"round",onClick:o[2]||(o[2]=e=>x(1)),loading:unref(p),disabled:unref(m)},{default:withCtx((()=>[createTextVNode(toDisplayString(2==unref(_).state?"启用":"发布"),1)])),_:1},8,["loading","disabled"])):createCommentVNode("",!0),0==unref(_).state?(openBlock(),createBlock(l,{key:1,type:"primary",shape:"round",onClick:o[3]||(o[3]=e=>x()),loading:unref(m),disabled:unref(p)},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(i)("common.saveText")),1)])),_:1},8,["loading","disabled"])):createCommentVNode("",!0),createVNode(l,{shape:"round",onClick:o[4]||(o[4]=e=>(unref(c).destroyBpmn(),void a()))},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(i)("common.closeText")),1)])),_:1})])),_:1})])])),default:withCtx((()=>[!unref(f)&&unref(u)?.id?withDirectives((openBlock(),createBlock(unref(_sfc_main$1),mergeProps({key:0,ref_key:"processRef",ref:c},y.value,{onAddVersion:w}),null,16)),[[vShow,!unref(h)]]):createCommentVNode("",!0),withDirectives(createVNode(O,{type:"flex",justify:"center",align:"middle",class:"h-full"},{default:withCtx((()=>[createVNode($,{span:12,xxl:10,class:"configuration-contain"},{default:withCtx((()=>[o[9]||(o[9]=createBaseVNode("div",{class:"title"},"发布范围",-1)),createVNode(S,{message:"设置流程发起人范围",type:"warning","show-icon":""}),createVNode(D,{class:"mt-15px",value:unref(N).visibleType,"onUpdate:value":o[5]||(o[5]=e=>unref(N).visibleType=e),options:k},null,8,["value"])])),_:1,__:[9]})])),_:1},512),[[vShow,1==unref(h)]])])),_:1},16,["onRegister"])}}}),DesignForm_vue_vue_type_style_index_0_scoped_6b4bb0fd_lang="",DesignForm_vue_vue_type_style_index_1_lang="",DesignForm=_export_sfc(_sfc_main,[["__scopeId","data-v-6b4bb0fd"]]);export{DesignForm as default};
