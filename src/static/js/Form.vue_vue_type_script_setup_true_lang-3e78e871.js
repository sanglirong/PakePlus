import{d as e,u as o,aD as n,fg as t,r as a,M as r,k as p,gn as l,e as s,o as c,p as d,l as i,j as m,V as u,co as g,go as h,gp as f,ah as b}from"./index-920db443.js";import{a as P,B as y}from"./index-9c138ba5.js";import{u as I,B as J}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{f as v}from"./formValidate-c8ab8d29.js";const x=e({__name:"Form",emits:["register","reload"],setup(e,{emit:x}){const T=x,{createMessage:O}=b(),{t:S}=o(),N=n(),k=t(),w=[{field:"groupTitleField1",label:"",component:"GroupTitle",componentProps:{content:"基础信息"},colProps:{sm:24,span:24}},{field:"parentId",label:"上级公司",component:"OrganizeSelect",slot:"parentId",rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"fullName",label:"公司名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"公司编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:v("enCode","只能输入英文、数字和小数点且小数点不能放在首尾"),trigger:"blur"}]},{field:"propertyJson.shortName",label:"公司简称",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.enterpriseNature",label:"公司性质",component:"Select",componentProps:{placeholder:"请选择",showSearch:!0}},{field:"propertyJson.industry",label:"所属行业",component:"TreeSelect",componentProps:{placeholder:"请选择",showSearch:!0}},{field:"propertyJson.foundedTime",label:"成立时间",component:"DatePicker",componentProps:{placeholder:"请选择",disabledDate:e=>e&&e>g().endOf("day")}},{field:"propertyJson.telePhone",label:"公司电话",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.fax",label:"公司传真",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.webSite",label:"公司主页",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.address",label:"公司地址",component:"Input",componentProps:{placeholder:"请输入"},colProps:{sm:24,span:24}},{field:"sortCode",label:"排序",defaultValue:0,component:"InputNumber",componentProps:{min:0,max:999999}},{field:"description",label:"说明",component:"Textarea",componentProps:{placeholder:"请输入"},colProps:{sm:24,span:24}},{field:"groupTitleField2",label:"",component:"GroupTitle",componentProps:{content:"经营信息"},colProps:{sm:24,span:24}},{field:"propertyJson.managerName",label:"公司法人",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.managerTelePhone",label:"联系电话",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.managerMobilePhone",label:"联系手机",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.manageEmail",label:"联系邮箱",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.bankName",label:"开户银行",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.bankAccount",label:"银行账户",component:"Input",componentProps:{placeholder:"请输入"}},{field:"propertyJson.businessscope",label:"经营范围",component:"Textarea",componentProps:{placeholder:"请输入"},colProps:{sm:24,span:24}}],[j,{setFieldsValue:D,resetFields:F,validate:V,updateSchema:C,clearValidate:M,getFieldsValue:_}]=I({baseColProps:{sm:12,xs:24},schemas:w}),[z,{closePopup:R,changeLoading:q,changeOkLoading:B}]=P((function(e){q(!0),F(),A.value=e.id,E.value=e.parentId||"0",G.value=[],async function(){const e=await N.getDictionaryData("EnterpriseNature");C({field:"propertyJson.enterpriseNature",componentProps:{options:e}});const o=await N.getDictionaryData("IndustryType");C({field:"propertyJson.industry",componentProps:{options:o}})}(),A.value?l(A.value).then((e=>{G.value=e.data.organizeIdTree||[];const o=e.data.propertyJson?JSON.parse(e.data.propertyJson):{},n={...e.data,propertyJson:o};D(n),q(!1)})):q(!1)})),A=a(""),E=a("0"),G=a([]),L=r((()=>p(A)?S("common.editText"):S("common.addText")));function U(e){D({parentId:e&&e.length?e[e.length-1]:""}),e&&e.length&&M("parentId")}async function $(){const e=await V();if(!e)return;B(!0);const o={enabledMark:1,id:A.value,...e,organizeIdTree:G.value,..._()};(A.value?h:f)(o).then((e=>{O.success(e.msg),B(!1),k.resetState(),R(),T("reload")})).catch((()=>{B(!1)}))}return(e,o)=>{const n=s("jnpfOrganizeSelect");return c(),d(p(y),u(e.$attrs,{onRegister:p(z),title:L.value,showOkBtn:"",onOk:$}),{default:i((()=>[m(p(J),{onRegister:p(j),class:"!px-30px"},{parentId:i((()=>[m(n,{value:G.value,"onUpdate:value":o[0]||(o[0]=e=>G.value=e),placeholder:"请选择",auth:"",isOnlyOrg:"",onChange:U,currOrgId:A.value||"0",parentId:E.value||"0"},null,8,["value","currOrgId","parentId"])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title"])}}});export{x as _};
