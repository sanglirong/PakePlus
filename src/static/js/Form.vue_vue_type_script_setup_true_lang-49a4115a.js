import{d as e,ad as a,u as o,fg as t,aD as r,M as s,gd as n,o as l,p as d,l as i,j as m,k as c,V as p,ge as u,gf as g,ah as f}from"./index-920db443.js";import{b as h,B as b}from"./index-143f5813.js";import{u as F,B as x}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{f as y}from"./formValidate-c8ab8d29.js";const M=e({__name:"Form",emits:["register","reload"],setup(e,{emit:M}){const j=M,k=a({dataForm:{id:"",fullName:"",enCode:"",type:"",enabledMark:1,globalMark:null,organizeIdsTree:[],sortCode:0,description:""}}),[w,{setFieldsValue:C,resetFields:P,validate:S,updateSchema:T}]=F({schemas:[{field:"fullName",label:"分组名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:y("fullName","不能含有特殊符号"),trigger:"blur"}]},{field:"enCode",label:"分组编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:y("enCode","只能输入英文、数字和小数点且小数点不能放在首尾"),trigger:"blur"}]},{field:"type",label:"分组类型",component:"Select",componentProps:{placeholder:"请选择",showSearch:!0,allowClear:!1},rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"sortCode",label:"排序",defaultValue:0,component:"InputNumber",componentProps:{min:0,max:999999}},{field:"enabledMark",label:"状态",defaultValue:1,component:"Switch"},{field:"description",label:"说明",component:"Textarea",componentProps:{placeholder:"请输入"}}]}),[V,{closeModal:v,changeLoading:I,changeOkLoading:N}]=h((function(e){P(),k.dataForm.id=e.id,async function(){const e=await D.getDictionaryData("groupType");T({field:"type",componentProps:{options:e}})}(),k.dataForm.id&&(I(!0),n(k.dataForm.id).then((e=>{C(e.data),I(!1)})))})),{createMessage:R}=f(),{t:_}=o(),q=t(),D=r(),B=s((()=>k.dataForm.id?_("common.editText"):_("common.addText")));async function L(){const e=await S();if(!e)return;N(!0);const a={...k.dataForm,...e};(k.dataForm.id?u:g)(a).then((e=>{R.success(e.msg),N(!1),q.resetState(),v(),j("reload")})).catch((()=>{N(!1)}))}return(e,a)=>(l(),d(c(b),p(e.$attrs,{onRegister:c(V),title:B.value,onOk:L}),{default:i((()=>[m(c(x),{onRegister:c(w)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{M as _};
