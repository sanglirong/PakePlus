import{b as e,B as o}from"./index-143f5813.js";import{u as t,B as a}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{d as n,ad as r,M as l,u as s,o as p,p as c,l as d,j as i,k as m,V as u,ah as g}from"./index-920db443.js";import{g as f,u as h,c as b}from"./table-3a9e3e55.js";const P=n({__name:"index",emits:["register","reload"],setup(n,{emit:P}){const j=r({dataForm:{}}),F=l((()=>j.dataForm.id?y("common.editText"):y("common.addText"))),I=P,{createMessage:x}=g(),{t:y}=s(),[T,{setFieldsValue:k,validate:N,resetFields:V,updateSchema:q}]=t({labelWidth:80,schemas:[{field:"projectName",label:"项目名称",component:"Input",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"projectCode",label:"项目编码",component:"Input",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"principal",label:"负责人",component:"Input",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"jackStands",label:"立项人",component:"Input",componentProps:{placeholder:"请输入"}},{field:"projectType",label:"项目类型",component:"Select",componentProps:{placeholder:"请选择"},rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"projectPhase",label:"项目阶段",component:"Input",componentProps:{placeholder:"请输入"}},{field:"customerName",label:"客户名称",component:"Input",componentProps:{placeholder:"请输入"}},{field:"interactionDate",label:"交互日期",component:"DatePicker",componentProps:{placeholder:"请选择"}},{field:"costAmount",label:"费用金额",component:"InputNumber",defaultValue:0,componentProps:{placeholder:"请输入"}},{field:"tunesAmount",label:"已用金额",component:"InputNumber",defaultValue:0,componentProps:{placeholder:"请输入"}},{field:"projectedIncome",label:"预计收入",component:"InputNumber",defaultValue:0,componentProps:{placeholder:"请输入"}},{field:"description",label:"备注",component:"Textarea",componentProps:{placeholder:"请输入",rows:3}}]}),[w,{closeModal:L,changeLoading:M,changeOkLoading:R}]=e((function(e){V(),j.dataForm.id=e.id,e.industryTypeList&&q({field:"projectType",componentProps:{options:e.industryTypeList}});j.dataForm.id&&(M(!0),f(j.dataForm.id).then((e=>{const o=e.data;j.dataForm=o,k(o),M(!1)})))}));async function _(){const e=await N();if(!e)return;R(!0);const o={...e,id:j.dataForm.id};(j.dataForm.id?h:b)(o).then((e=>{x.success(e.msg),R(!1),L(),I("reload")})).catch((()=>{R(!1)}))}return(e,t)=>(p(),c(m(o),u(e.$attrs,{onRegister:m(w),title:F.value,showOkBtn:"",onOk:_}),{default:d((()=>[i(m(a),{onRegister:m(T)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{P as _};
