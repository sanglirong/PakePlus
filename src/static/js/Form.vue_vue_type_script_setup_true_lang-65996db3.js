import{b as e,B as a}from"./index-143f5813.js";import{u as r,B as o}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{d as l,ad as s,M as n,u as t,o as p,p as c,l as d,j as i,k as m,V as u,ah as g}from"./index-920db443.js";import{g as h,u as f,c as b}from"./accountConfig-5422c027.js";import{f as I}from"./formValidate-c8ab8d29.js";const P=l({__name:"Form",emits:["register","reload"],setup(l,{emit:P}){const S=s({dataForm:{}}),w=[{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:I("enCode"),trigger:"blur"}]},{field:"channel",label:"渠道",component:"Select",defaultValue:1,componentProps:{placeholder:"请选择",options:[{fullName:"阿里云",id:1},{fullName:"腾讯云",id:2}],onChange:function(){F({appId:"",appSecret:"",endPoint:"",secretId:"",secretKey:"",appKey:"",sdkAppId:"",zoneName:"sms.tencentcloudapi.com",zoneParam:"ap-beijing",smsSignature:""}),j()}},rules:[{required:!0,trigger:"change",message:"必填",type:"number"}]},{field:"smsSignature",label:"短信签名",component:"Input",helpMessage:"选择国内消息或国际/港澳台消息，在“签名管理”⻚中获取",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>1===e.channel,field:"appId",label:"AccessKey ID",component:"Input",helpMessage:"请在“阿里云的AccessKey管理-安全信息管理”页中获得",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>1===e.channel,field:"appSecret",label:"AccessKey Secret",component:"InputPassword",helpMessage:"请在“阿里云的AccessKey管理-安全信息管理”页中获得",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>1===e.channel,field:"endPoint",label:"EndPoint",component:"Input",helpMessage:"请在“阿里云的短信服务-OpenAPI Explorer-Region&Endpoint”页中获得",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>2===e.channel,field:"secretId",label:"SecretId",component:"Input",helpMessage:"请在”腾讯云的访问管理-访问密钥- API密钥管理”⻚中获得",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>2===e.channel,field:"secretKey",label:"SecretKey",component:"InputPassword",helpMessage:"请在”腾讯云的访问管理-访问密钥- API密钥管理”⻚中获得",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>2===e.channel,field:"sdkAppId",label:"SDK AppID",component:"InputPassword",helpMessage:"请在”腾讯云的应⽤管理-应⽤列表”⻚中获得",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>2===e.channel,field:"appKey",label:"App Key",component:"InputPassword",helpMessage:"请在”腾讯云的应⽤管理-应⽤列表”⻚中获得",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>2===e.channel,field:"zoneName",label:"地域域名",component:"Input",helpMessage:"默认是国内地域域名,也⽀持指定其它地域域名",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{ifShow:({values:e})=>2===e.channel,field:"zoneParam",label:"地域参数",component:"Input",helpMessage:"默认是国内地域参数,也⽀持指定其它地域参数",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"sortCode",label:"排序",component:"InputNumber",defaultValue:0,componentProps:{min:"0",max:"999999",placeholder:"请输入"}},{field:"enabledMark",label:"状态",component:"Switch",defaultValue:1},{field:"description",label:"说明",component:"Textarea",componentProps:{rows:3,placeholder:"请输入"}}],y=n((()=>S.dataForm.id?K("common.editText"):K("common.addText"))),M=P,{createMessage:q}=g(),{t:K}=t(),[v,{setFieldsValue:F,validate:x,resetFields:A,clearValidate:j}]=r({labelWidth:145,schemas:w}),[k,{closeModal:V,changeLoading:N,changeOkLoading:C}]=e((function(e){A(),S.dataForm.id=e.id,S.dataForm.id&&(N(!0),h(S.dataForm.id).then((e=>{const a=e.data;a.secretId=2==a.channel?a.appId:"",a.secretKey=2==a.channel?a.appSecret:"",S.dataForm=a,F(a),N(!1)})))}));async function R(){const e=await x();if(!e)return;C(!0);const a={...e,id:S.dataForm.id,type:3};2===e.channel&&(a.appId=e.secretId,a.appSecret=e.secretKey);(S.dataForm.id?f:b)(a).then((e=>{q.success(e.msg),C(!1),V(),M("reload")})).catch((()=>{C(!1)}))}return(e,r)=>(p(),c(m(a),u(e.$attrs,{onRegister:m(k),title:y.value,showOkBtn:"",onOk:R}),{default:d((()=>[i(m(o),{onRegister:m(v)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{P as _};
