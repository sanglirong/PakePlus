import{A as e,J as t,K as o}from"./task-ee77df5a.js";import{j as s}from"./template-c6142676.js";import{u as r,B as a}from"./useTable-dc8c9d84.js";import{T as n}from"./TableAction-adbe36f2.js";import{d as i,ad as l,aD as p,ac as u,u as _,co as m,M as c,a7 as d,e as y,o as g,g as v,a4 as j,j as f,k as w,l as h,F as x,h as T,m as b,p as k,q as C,t as I,n as M,ah as S}from"./index-920db443.js";import{u as P}from"./index-9c138ba5.js";import{u as R,B as U}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{u as D}from"./useDefineSetting-7df030ff.js";import{_ as F}from"./FlowParser.vue_vue_type_style_index_0_lang-43859d45.js";import"./useWindowSizeFn-05f906e2.js";import"./index-143f5813.js";import"./log-2a5f2c26.js";import"./sortable.esm-02d0fe44.js";import"./SettingOutlined-dd6150a2.js";import"./index-1cfe4e28.js";import"./ArrowLeftOutlined-3fbf15bc.js";import"./useTabs-ceeccdba.js";import"./upperFirst-2cd1a2f7.js";import"./uniqBy-e868edd7.js";import"./visualDev-8f54ab4b.js";import"./index.vue_vue_type_script_setup_true_lang-69353133.js";import"./index-999abbee.js";import"./Parser.vue_vue_type_script_setup_true_lang-6ddfe448.js";import"./Item.vue_vue_type_script_setup_true_lang-fef56f78.js";import"./Form.vue_vue_type_script_setup_true_lang-63005a4d.js";import"./createAsyncComponent-7e8f72ac.js";import"./DataLogList.vue_vue_type_script_setup_true_lang-c225eb8c.js";import"./index-0be8277c.js";import"./jquery-6353a699.js";import"./CustomForm.vue_vue_type_script_setup_true_lang-1aa664f4.js";import"./config-06ca91cd.js";import"./flowDelegate-3964bb34.js";import"./OpinionTextarea.vue_vue_type_style_index_0_lang-cb910758.js";import"./commonWords-8e03a6e1.js";import"./CommonWordsPopover.vue_vue_type_style_index_0_lang-3ee4c861.js";import"./Sign.vue_vue_type_style_index_0_lang-a3fd8868.js";import"./FlowFile.vue_vue_type_script_setup_true_lang-ff47ee4a.js";import"./document-763aa4ad.js";import"./Main.vue_vue_type_style_index_0_lang-0afb53a3.js";import"./componentMap-7e15a185.js";import"./ErrorModal.vue_vue_type_script_setup_true_lang-581230da.js";import"./CandidateModal.vue_vue_type_script_setup_true_lang-79d2d529.js";import"./index-c37d2476.js";import"./BasicLeftTree-cd55d444.js";import"./billRule-0363563b.js";import"./import-e198d900.js";import"./tip-b30e67af.js";import"./dataSource-ed26da12.js";import"./dataModel-ea807f46.js";import"./index-3b5bee70.js";import"./CopyOutlined-8d46c8b2.js";import"./ActionModal.vue_vue_type_script_setup_true_lang-22457a03.js";import"./ApprovalModal.vue_vue_type_script_setup_true_lang-8440f311.js";import"./ReduceApproverModal.vue_vue_type_script_setup_true_lang-7d94737b.js";import"./UserListModal.vue_vue_type_script_setup_true_lang-550da35d.js";import"./RecordList.vue_vue_type_style_index_0_lang-959f1fc0.js";import"./LogErrorModal.vue_vue_type_script_setup_true_lang-326503f1.js";import"./NodeFormParser.vue_vue_type_style_index_0_lang-0828e652.js";import"./SubFlowParser.vue_vue_type_style_index_0_lang-20f5de60.js";import"./StartFormParser.vue_vue_type_script_setup_true_lang-0c8077e0.js";import"./FlowChart.vue_vue_type_script_setup_true_lang-5aaf6076.js";import"./ExtraPanel.vue_vue_type_script_setup_true_lang-7c09275e.js";import"./RecordTimeList.vue_vue_type_style_index_0_lang-23988eb1.js";import"./RecordModal.vue_vue_type_style_index_0_lang-2d2d9b22.js";import"./TaskLogModal.vue_vue_type_style_index_0_lang-859a07eb.js";import"./emoji-a68b5251.js";import"./AuxiliaryList-441188d6.js";import"./pdf-3f972d03.js";import"./ViewModal.vue_vue_type_script_setup_true_lang-3d1fe22e.js";import"./Preview.vue_vue_type_style_index_0_lang-6567fb9c.js";const H={class:"jnpf-content-wrapper"},A={class:"jnpf-content-wrapper-center"},L={class:"jnpf-content-wrapper-search-box"},N={class:"jnpf-content-wrapper-content bg-white"},Q=i({name:"workFlow-flowTodo",__name:"index",setup(i){const Q=l({listQuery:{keyword:"",startTime:"",endTime:"",flowCategory:"",creatorUserId:"",templateId:"",flowUrgent:""},activeKey:""}),{createMessage:Y,createConfirm:K}=S(),B=p(),O=u(),{t:E}=_(),{flowUrgentList:q,getUrgentText:V,getUrgentTextColor:z,getHandlingStatusContent:G,getHandlingStatusColor:J}=D(),[W,{openPopup:X}]=P(),Z=[{fullName:"全部",id:""},{fullName:"协办",id:7},{fullName:"退回",id:5},{fullName:"超时",id:-2}],[$,{updateSchema:ee}]=R({baseColProps:{span:6},showActionButtonGroup:!0,showAdvancedButton:!0,compact:!0,schemas:[{field:"keyword",label:E("common.keyword"),component:"Input",componentProps:{placeholder:E("common.enterKeyword"),submitOnPressEnter:!0}},{field:"pickerVal",label:"发起时间",component:"DateRange",componentProps:{format:"YYYY-MM-DD HH:mm:ss",showTime:{defaultValue:[m("00:00:00","HH:mm:ss"),m("23:59:59","HH:mm:ss")]},placeholder:["开始时间","结束时间"]}},{field:"flowCategory",label:"分类",component:"Select",componentProps:{showSearch:!0}},{field:"templateId",label:"所属流程",component:"TreeSelect",componentProps:{lastLevel:!0}},{field:"creatorUserId",label:"发起人员",component:"UserSelect"},{field:"flowUrgent",label:"紧急程度",component:"Select",componentProps:{showSearch:!0,options:q}}],fieldMapToTime:[["pickerVal",["startTime","endTime"]]]}),[te,{reload:oe,getSelectRows:se,clearSelectedRowKeys:re,redoHeight:ae}]=r({api:e,columns:[{title:"流程标题",dataIndex:"fullName",width:200},{title:"所属流程",dataIndex:"flowName",width:150},{title:"发起时间",dataIndex:"startTime",width:150,format:"date|YYYY-MM-DD HH:mm:ss"},{title:"发起人员",dataIndex:"creatorUser",width:120},{title:"审批节点",dataIndex:"currentNodeName",width:150},{title:"紧急程度",dataIndex:"flowUrgent",width:100,align:"center"},{title:"流程状态",dataIndex:"status",width:120,align:"center",helpMessage:"流转：上个节点提交或同意的审批数据"},{title:"接收时间",dataIndex:"creatorTime",width:150,format:"date|YYYY-MM-DD HH:mm:ss"}],rowSelection:{type:"checkbox"},clickToRowSelect:!1,clearSelectOnPageChange:!0,actionColumn:{width:50,title:"操作",dataIndex:"action"}}),ne=c((()=>({category:1,...Q.listQuery})));function ie(e){return[{label:"办理",onClick:le.bind(null,e)}]}function le(e){const t={id:e.taskId,flowId:e.flowId,opType:2,operatorId:e.id};X(!0,t)}async function pe(){const e=await B.getDictionaryData("businessType");ee({field:"flowCategory",componentProps:{options:e}}),s().then((e=>{ee({field:"templateId",componentProps:{options:e.data.list||[]}})}))}function ue(e){Q.listQuery={status:Q.listQuery.status,...e},M((()=>oe()))}function _e(){Q.listQuery.keyword="",Q.listQuery.startTime="",Q.listQuery.endTime="",Q.listQuery.creatorUserId="",Q.listQuery.flowCategory="",Q.listQuery.templateId="",Q.listQuery.flowUrgent="",M((()=>oe()))}function me(e){Q.listQuery.status=e,M((()=>oe()))}function ce(e){const s=se()||[];if(!s.length)return Y.error(E("common.selectDataTip"));const r={ids:s.map((e=>e.id))};"sign"==e&&(r.type=1),K({iconType:"warning",title:E("common.tipTitle"),content:"sign"==e?"确定退签，确定后进入我的待签":"确定办理，办理后进入我的在办。",onOk:()=>{("sign"==e?t:o)(r).then((e=>{Y.success(e.msg),re(),oe()}))}})}return d((()=>{pe()})),(e,t)=>{const o=y("a-tab-pane"),s=y("a-tabs"),r=y("a-button"),i=y("a-tag"),l=y("JnpfTextTag");return g(),v("div",H,[j("div",A,[j("div",L,[f(w(U),{class:"search-form",onAdvancedChange:w(ae),onRegister:w($),onSubmit:ue,onReset:_e},null,8,["onAdvancedChange","onRegister"])]),j("div",N,[f(s,{activeKey:Q.activeKey,"onUpdate:activeKey":t[0]||(t[0]=e=>Q.activeKey=e),class:"jnpf-content-wrapper-tabs",onChange:me},{default:h((()=>[(g(),v(x,null,T(Z,(e=>f(o,{key:e.id,tab:e.fullName},null,8,["tab"]))),64))])),_:1},8,["activeKey"]),f(w(a),{onRegister:w(te),searchInfo:ne.value},{tableTitle:h((()=>[f(r,{type:"primary",preIcon:"icon-ym icon-ym-btn-batch",onClick:ce},{default:h((()=>t[2]||(t[2]=[b("批量办理")]))),_:1,__:[2]}),w(O)?.getSysConfigInfo?.flowSign?(g(),k(r,{key:0,type:"warning",preIcon:"icon-ym icon-ym-btn-batch",onClick:t[1]||(t[1]=e=>ce("sign"))},{default:h((()=>t[3]||(t[3]=[b("批量退签")]))),_:1,__:[3]})):C("",!0)])),bodyCell:h((({column:e,record:o})=>["fullName"===e.key?(g(),v(x,{key:0},[o.delegateUser?(g(),k(i,{key:0,color:"success"},{default:h((()=>t[4]||(t[4]=[b("代理")]))),_:1,__:[4]})):C("",!0),b(" "+I(o.fullName),1)],64)):C("",!0),"flowUrgent"===e.key?(g(),k(l,{key:1,content:w(V)(o.flowUrgent),color:w(z)(o.flowUrgent),showTag:!1,showTextColor:""},null,8,["content","color"])):C("",!0),"status"===e.key?(g(),k(l,{key:2,content:w(G)(o.status),color:w(J)(o.status)},null,8,["content","color"])):C("",!0),"action"===e.key?(g(),k(w(n),{key:3,actions:ie(o)},null,8,["actions"])):C("",!0)])),_:1},8,["onRegister","searchInfo"])])]),f(F,{onRegister:w(W),onReload:w(oe)},null,8,["onRegister","onReload"])])}}});export{Q as default};
