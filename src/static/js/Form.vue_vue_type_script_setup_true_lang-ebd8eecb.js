import{b as e,B as a}from"./index-143f5813.js";import{u as s,B as t}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{d as o,ad as r,M as i,u as n,o as d,p as l,l as c,j as m,k as u,V as p,ah as g}from"./index-920db443.js";import{a as f,u as h,c as x}from"./variate-1d177fc7.js";const b=o({__name:"Form",emits:["register","reload"],setup(o,{emit:b}){const j=r({id:"",interfaceId:"",dataForm:{}}),I=i((()=>j.id?R("common.editText"):R("common.addText"))),F=b,{createMessage:M}=g(),{t:R}=n(),[T,{validate:_,resetFields:k,setFieldsValue:v}]=s({labelWidth:80,schemas:[{field:"fullName",label:"变量名",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,message:"必填",trigger:"blur"}]},{field:"expression",label:"JS表达式",component:"Textarea",componentProps:{placeholder:"请输入",rows:4},rules:[{required:!0,message:"必填",trigger:"blur"}]}]}),[w,{closeModal:q,changeLoading:y,changeOkLoading:B}]=e((function(e){k(),j.interfaceId=e.interfaceId,j.id=e.id,j.id&&(y(!0),f(j.id).then((e=>{v(e.data),y(!1)})).catch((()=>{y(!1)})))}));async function L(){const e=await _();if(!e)return;B(!0);const a={...e,id:j.id,interfaceId:j.interfaceId};(j.id?h:x)(a).then((e=>{M.success(e.msg),B(!1),q(),setTimeout((()=>{F("reload")}),200)})).catch((()=>{B(!1)}))}return(e,s)=>(d(),l(u(a),p(e.$attrs,{onRegister:u(w),title:I.value,onOk:L,"destroy-on-close":""}),{default:c((()=>[m(u(t),{onRegister:u(T)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{b as _};
