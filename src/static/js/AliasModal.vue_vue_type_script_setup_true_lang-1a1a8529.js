import{d as e,u as a,r as l,ad as t,a0 as d,M as n,k as i,n as s,e as o,o as r,p as u,l as m,a4 as c,dj as f,j as p,t as y,m as v,V as _,ae as g,q as x,ah as b}from"./index-920db443.js";import{y as k,z as w}from"./visualDev-8f54ab4b.js";import{b as h,B as N}from"./index-143f5813.js";const R={class:"jnpf-full-modal-header"},U={class:"header-title"},j={class:"header-txt"},K={class:"jnpf-content-wrapper"},I={class:"jnpf-content-wrapper-center"},L={class:"jnpf-content-wrapper-content bg-white p-10px"},z=e({__name:"AliasModal",emits:["register"],setup(e){const{t:z}=a(),{createMessage:C}=b(),[M,{closeModal:$,changeLoading:q}]=h((function(e){B.id=e.id,B.fullName=e.fullName||"",B.loading=!0,B.expandedRowKeys=[],q(!0),k(e.id).then((e=>{B.list=e.data,B.expandedRowKeys=e.data.map((e=>e.table)),s((()=>{const e=H.value?.$el;e.querySelector(".ant-table-body").style.height=`${i(O)}px`,q(!1),B.loading=!1}))}))})),E=l(null),H=l(null),T=[{width:50,title:"序号",dataIndex:"index",key:"index",align:"center",customRender:({index:e})=>e+1},{title:"表名",dataIndex:"table",key:"table"},{title:"规范名称",dataIndex:"aliasName",key:"aliasName"},{title:"说明",dataIndex:"comment",key:"comment"}],A=[{width:50,title:"序号",dataIndex:"index",key:"index",align:"center",customRender:({index:e})=>e+1},{title:"字段",dataIndex:"field",key:"field"},{title:"规范名称",dataIndex:"aliasName",key:"aliasName"},{title:"说明",dataIndex:"fieldName",key:"fieldName"}],B=t({id:"",fullName:"",list:[],loading:!1,btnLoading:!1,expandedRowKeys:[]}),{list:D,loading:F,btnLoading:S,expandedRowKeys:V,fullName:G}=d(B),J=n((()=>{const e=E.value?.$el;return e?e?.offsetHeight:120})),O=n((()=>window.innerHeight-i(J)-150)),P=n((()=>({columns:T,pagination:!1,size:"small",rowKey:"table",scroll:{y:i(O)}}))),Q=n((()=>({columns:A,pagination:!1,size:"small",rowKey:"field"})));return(e,a)=>{const l=o("a-tooltip"),t=o("a-step"),d=o("a-steps"),n=o("a-button"),s=o("a-space"),b=o("a-alert"),k=o("a-input"),h=o("a-table");return r(),u(i(N),_(e.$attrs,{onRegister:i(M),defaultFullscreen:"",footer:null,closable:!1,keyboard:!1,class:"jnpf-full-modal full-modal designer-modal"}),{title:m((()=>[c("div",R,[c("div",U,[a[3]||(a[3]=c("img",{src:f,class:"header-logo"},null,-1)),a[4]||(a[4]=c("span",{class:"header-dot"},null,-1)),p(l,{title:i(G)},{default:m((()=>[c("p",j,y(i(G)),1)])),_:1},8,["title"])]),p(d,{current:1,type:"navigation",size:"small",class:"header-steps tab-steps"},{default:m((()=>[p(t,{title:"命名规范"})])),_:1}),p(s,{class:"options",size:10},{default:m((()=>[p(n,{type:"primary",onClick:a[0]||(a[0]=e=>(B.btnLoading=!0,q(!0),void w(B.id,{tableList:B.list}).then((e=>{B.btnLoading=!1,q(!1),C.success(e.msg),$()})).catch((()=>{B.btnLoading=!1,q(!1)})))),disabled:i(F),loading:i(S)},{default:m((()=>[v(y(i(z)("common.saveText")),1)])),_:1},8,["disabled","loading"]),p(n,{onClick:a[1]||(a[1]=e=>i($)())},{default:m((()=>[v(y(i(z)("common.closeText")),1)])),_:1})])),_:1})])])),default:m((()=>[c("div",K,[c("div",I,[c("div",L,[p(b,{message:"规范名称命名规则：（1）只能由字母、数字、下划线组成，且不能以数字开头；（2）不能使用系统关键字或开发语言关键字",description:"系统关键字包含：tenantid、id、foreignid、flowid、flowtaskid、deleteuserid、deletetime、deletemark、version、tenant_id、foreign_id、flow_id、flow_task_id、delete_user_id、delete_time、delete_mark、f_tenant_id、f_id、f_foreign_id、f_flow_id、f_flow_task_id、f_delete_user_id、f_delete_time、f_delete_mark、f_version",type:"warning","show-icon":"",class:"mb-10px",ref_key:"alertElRef",ref:E},null,512),p(h,_({"data-source":i(D)},P.value,{expandedRowKeys:i(V),"onUpdate:expandedRowKeys":a[2]||(a[2]=e=>g(V)?V.value=e:null),ref_key:"tableElRef",ref:H}),{expandedRowRender:m((({record:e})=>[p(h,_({"data-source":e.fields},Q.value),{bodyCell:m((({column:e,record:a})=>["field"===e.key?(r(),u(k,{key:0,value:a.field,"onUpdate:value":e=>a.field=e,disabled:"",detailed:""},null,8,["value","onUpdate:value"])):x("",!0),"aliasName"===e.key?(r(),u(k,{key:1,value:a.aliasName,"onUpdate:value":e=>a.aliasName=e,placeholder:"请输入",maxlength:100},null,8,["value","onUpdate:value"])):x("",!0),"fieldName"===e.key?(r(),u(k,{key:2,value:a.fieldName,"onUpdate:value":e=>a.fieldName=e,disabled:"",detailed:""},null,8,["value","onUpdate:value"])):x("",!0)])),_:2},1040,["data-source"])])),bodyCell:m((({column:e,record:a})=>["table"===e.key?(r(),u(k,{key:0,value:a.table,"onUpdate:value":e=>a.table=e,disabled:"",detailed:""},null,8,["value","onUpdate:value"])):x("",!0),"aliasName"===e.key?(r(),u(k,{key:1,value:a.aliasName,"onUpdate:value":e=>a.aliasName=e,placeholder:"请输入",maxlength:100},null,8,["value","onUpdate:value"])):x("",!0),"comment"===e.key?(r(),u(k,{key:2,value:a.comment,"onUpdate:value":e=>a.comment=e,disabled:"",detailed:""},null,8,["value","onUpdate:value"])):x("",!0)])),_:1},16,["data-source","expandedRowKeys"])])])])])),_:1},16,["onRegister"])}}});export{z as _};
