import{b as e,B as t}from"./index-143f5813.js";import{u as o,B as a}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{di as n,d as s,ad as l,M as r,u as d,o as i,p as u,l as m,j as c,k as p,V as g,ah as h}from"./index-920db443.js";function f(e){return n.get({url:"/api/system/ModuleButton/"+e.id+"/List",data:e})}function b(e){return n.post({url:"/api/system/ModuleButton",data:e})}function I(e){return n.put({url:"/api/system/ModuleButton/"+e.id,data:e})}function M(e){return n.delete({url:"/api/system/ModuleButton/"+e})}const x=s({__name:"Form",emits:["register","reload"],setup(s,{emit:f}){const M=l({moduleId:"",id:""}),x=r((()=>M.id?P("common.editText"):P("common.addText"))),B=f,{createMessage:y}=h(),{t:P}=d(),[j,{setFieldsValue:k,validate:w,resetFields:F,updateSchema:R}]=o({labelWidth:80,schemas:[{field:"parentId",label:"上级",component:"TreeSelect",componentProps:{placeholder:"请选择"},rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"sortCode",label:"排序",component:"InputNumber",defaultValue:0,componentProps:{min:"0",max:"999999",placeholder:"请输入"}},{field:"enabledMark",label:"状态",component:"Switch",defaultValue:1},{field:"description",label:"说明",component:"Textarea",componentProps:{rows:3,placeholder:"请输入"}}]}),[S,{closeModal:T,changeLoading:V,changeOkLoading:_}]=e((function(e){F(),M.id=e.id,M.moduleId=e.moduleId,V(!0),function(e){return n.get({url:"/api/system/ModuleButton/"+e+"/Selector"})}(M.moduleId).then((e=>{let t={fullName:"顶级节点",hasChildren:!0,id:"-1",children:e.data.list};R({field:"parentId",componentProps:{options:[t]}}),V(!1)})).then((()=>{V(!1)})),M.id&&(V(!0),(t=M.id,n.get({url:"/api/system/ModuleButton/"+t})).then((e=>{const t=e.data;k(t),V(!1)})).then((()=>{V(!1)})));var t}));async function q(){const e=await w();if(!e)return;_(!0);const t={...e,moduleId:M.moduleId,id:M.id};(M.id?I:b)(t).then((e=>{y.success(e.msg),_(!1),T(),B("reload")})).catch((()=>{_(!1)}))}return(e,o)=>(i(),u(p(t),g(e.$attrs,{onRegister:p(S),title:x.value,showOkBtn:"",onOk:q}),{default:m((()=>[c(p(a),{onRegister:p(j)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{x as _,b as c,M as d,f as g};
