import{b as a,B as e}from"./index-143f5813.js";import{u as t,B as o}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{d as r,ad as s,a0 as l,M as d,o as m,p as n,l as i,j as p,k as c,V as u,ah as f}from"./index-920db443.js";import{k as g,l as y,m as F}from"./portal-935b0b1b.js";import{_ as h}from"./PortalModal.vue_vue_type_script_setup_true_lang-be0f3ce7.js";const I=r({__name:"Form",emits:["register","reload"],setup(r,{emit:I}){const b=s({category:"",dataForm:{id:"",portalId:"",fullName:"",category:"",enCode:"",homePageMark:0,sortCode:0,enabledMark:1,description:"",systemId:"",platform:"Web"},featureWebData:[],featureAppData:[],dictionaryData:[],reportData:[],screenData:[],portalData:[]}),{dataForm:_}=l(b),k=d((()=>b.dataForm.id?"编辑":"添加")),M=I,{createMessage:j}=f(),[v,{setFieldsValue:x,validate:D,clearValidate:P,resetFields:w,updateSchema:C}]=t({labelWidth:80,schemas:[{field:"portalId",label:"门户名称",component:"Select",slot:"portalId",rules:[{required:!0,message:"必填",trigger:"change"}]},{field:"category",label:"门户分类",component:"Select",componentProps:{placeholder:"请选择",disabled:!0}},{field:"sortCode",label:"排序",component:"InputNumber",defaultValue:0,componentProps:{min:"0",max:"999999",placeholder:"请输入"}},{field:"enabledMark",label:"状态",component:"Switch",defaultValue:1},{field:"description",label:"说明",component:"Textarea",componentProps:{rows:4,placeholder:"请输入"}}]}),[N,{closeModal:S,changeLoading:V,changeOkLoading:O}]=a((function(a){w(),b.dataForm.id=a.id,b.dataForm.systemId=a.systemId,C({field:"category",componentProps:{options:a.categoryList}}),b.dataForm.id?(V(!0),g(b.dataForm.id).then((a=>{b.dataForm=a.data,b.dataForm.category=b.dataForm.categoryId,x(b.dataForm),V(!1)}))):b.dataForm.platform=a.platform||"Web"}));function R(a,e){b.dataForm.fullName=e.fullName,x({portalId:a,category:e.categoryId}),P("portalId")}async function W(){const a=await D();if(!a)return;O(!0);const e={...b.dataForm,...a};(b.dataForm.id?y:F)(e).then((a=>{j.success(a.msg),O(!1),S(),setTimeout((()=>{M("reload")}),200)})).catch((()=>{O(!1)}))}return(a,t)=>(m(),n(c(e),u(a.$attrs,{onRegister:c(N),title:k.value,showOkBtn:"",onOk:W,destroyOnClose:""}),{default:i((()=>[p(c(o),{onRegister:c(v)},{portalId:i((({model:a,field:e})=>[p(h,{value:a[e],systemId:c(_).systemId,title:c(_).fullName,platform:c(_).platform,onChange:R},null,8,["value","systemId","title","platform"])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{I as _};
