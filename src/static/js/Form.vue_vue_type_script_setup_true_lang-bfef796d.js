import{d as e,r as a,u as t,aD as o,M as s,k as l,eI as n,eJ as r,o as i,p as d,l as p,j as u,V as c,eG as m,eH as g,ah as f}from"./index-920db443.js";import{b as h,B as b}from"./index-143f5813.js";import{u as v,B as I}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";const x=e({__name:"Form",emits:["register","reload"],setup(e,{emit:x}){const y=x,[T,{setFieldsValue:P,resetFields:j,validate:M,updateSchema:V}]=v({schemas:[{field:"parentId",label:"项目上级",defaultValue:"0",component:"TreeSelect",componentProps:{placeholder:"请选择",showSearch:!0},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"fullName",label:"字典名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"字典编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"sortCode",label:"排序",defaultValue:0,component:"InputNumber",componentProps:{min:0,max:999999}},{field:"enabledMark",label:"状态",defaultValue:1,component:"Switch"},{field:"description",label:"说明",component:"Textarea",componentProps:{placeholder:"请输入"}}]}),[k,{closeModal:w,changeLoading:F,changeOkLoading:R}]=h((function(e){F(!0),j(),S.value=e.id,_.value=e.isTree,q.value=e.typeId,V({field:"parentId",componentProps:{disabled:!l(_)}}),n(e.typeId,e.isTree,e.id).then((e=>{L.value=e.data.list,V([{field:"parentId",componentProps:{options:L.value}}]),S.value?r(S.value).then((e=>{P(e.data),q.value=e.data.dictionaryTypeId,F(!1)})):(P({parentId:e.data.list[0].id}),F(!1))}))})),S=a(""),_=a(0),q=a(""),L=a([]),{createMessage:B}=f(),{t:C}=t(),D=o(),N=s((()=>l(S)?C("common.editText"):C("common.addText")));async function O(){const e=await M();if(!e)return;R(!0);const a={...e,id:S.value,dictionaryTypeId:q.value};(S.value?m:g)(a).then((e=>{B.success(e.msg),R(!1),D.setDictionaryList(),w(),y("reload")})).catch((()=>{R(!1)}))}return(e,a)=>(i(),d(l(b),c(e.$attrs,{onRegister:l(k),title:N.value,onOk:O}),{default:p((()=>[u(l(I),{onRegister:l(T)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{x as _};
