import{b as e,B as a}from"./index-143f5813.js";import{d as t,u as s,r as n,ad as r,a0 as l,hw as d,k as o,e as c,o as i,p as f,l as u,a4 as m,j as p,ae as h,e1 as v,t as _,ab as g,g as D,F as k,h as y,dF as I,q as b,V as w,ah as F}from"./index-920db443.js";import{g as j,s as x}from"./interfaceOauth-318e3e16.js";const C={class:"transfer__body"},S={class:"transfer-pane left-pane"},E={class:"transfer-pane__tool"},O={class:"transfer-pane__body transfer-pane__body-tab"},R={class:"transfer-pane right-pane"},L={class:"transfer-pane__tool"},M={class:"transfer-pane__body"},N={class:"selected-item-text"},V={class:"name"},q=t({__name:"Empower",emits:["register"],setup(t){const{t:q}=s(),{createMessage:A}=F(),B=n(null),[K,{changeLoading:U,changeOkLoading:$,closeModal:z}]=e((function(e){U(!0),G.dataForm.interfaceIdentId=e.id,G.dataForm.dataInterfaceIds=[],G.treeData=[],G.selectedData=[],G.keyword="",d().then((e=>{G.treeData=e.data,T(""),j(G.dataForm.interfaceIdentId).then((e=>{G.selectedData=e.data.list||[],U(!1)}))}))})),G=r({treeData:[],dataForm:{interfaceIdentId:"",dataInterfaceIds:[]},keyword:"",selectedData:[]}),{treeData:H,selectedData:J,keyword:P}=l(G);function Q(e){if(!e.length)return;const a=W().getSelectedNode(e[0]);if(a?.hasChildren)return;J.value.some((e=>e.id===a?.id))||J.value.push(a)}function T(e){W().setSearchValue(e)}function W(){const e=o(B);if(!e)throw new Error("tree is null!");return e}function X(){G.selectedData=[]}function Y(){$(!0);const e=G.selectedData.map((e=>e.id));G.dataForm.dataInterfaceIds=e.join(","),x(G.dataForm).then((e=>{A.success(e.msg),$(!1),z()})).catch((()=>{$(!1)}))}return(e,t)=>{const s=c("a-input-search"),n=c("jnpf-empty");return i(),f(o(a),w(e.$attrs,{onRegister:o(K),title:"接口授权",width:800,onOk:Y,class:"transfer-modal"}),{default:u((()=>[m("div",C,[m("div",S,[m("div",E,[p(s,{placeholder:o(q)("common.enterKeyword"),allowClear:"",value:o(P),"onUpdate:value":t[0]||(t[0]=e=>h(P)?P.value=e:null),onSearch:T},null,8,["placeholder","value"])]),m("div",O,[p(o(v),{class:"tree-main",treeData:o(H),onSelect:Q,ref_key:"treeRef",ref:B,defaultExpandAll:""},null,8,["treeData"])])]),m("div",R,[m("div",L,[m("span",null,_(o(q)("component.jnpf.common.selected")),1),m("span",{class:"remove-all-btn",onClick:X},"清空列表")]),m("div",M,[p(o(g),null,{default:u((()=>[(i(!0),D(k,null,y(o(J),((e,a)=>(i(),D("div",{key:a,class:"selected-item"},[m("div",N,[m("p",V,_(e.fullName),1)]),p(o(I),{class:"delete-btn",onClick:e=>{return t=a,void G.selectedData.splice(t,1);var t}},null,8,["onClick"])])))),128)),o(J)?.length?b("",!0):(i(),f(n,{key:0}))])),_:1})])])])])),_:1},16,["onRegister"])}}});export{q as _};
