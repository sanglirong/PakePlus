import{d as e,r as a,u as t,aD as o,M as s,k as r,fl as l,hr as n,o as i,p as d,l as m,j as u,V as c,hs as p,ht as g,ah as f}from"./index-920db443.js";import{b as h,B as b}from"./index-143f5813.js";import{u as v,B as x}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{f as P}from"./formValidate-c8ab8d29.js";const T=e({__name:"Form",emits:["register","reload"],setup(e,{emit:T}){const j=T,[I,{setFieldsValue:V,resetFields:w,validate:F,updateSchema:M}]=v({labelWidth:80,schemas:[{field:"parentId",label:"上级",component:"TreeSelect",componentProps:{placeholder:"请输入",showSearch:!0},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:P("fullName","不能含有特殊符号"),trigger:"blur"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:P("enCode"),trigger:"blur"}]},{field:"isTree",label:"树形",defaultValue:0,component:"Switch"},{field:"sortCode",label:"排序",defaultValue:0,component:"InputNumber",componentProps:{min:0,max:999999}},{field:"description",label:"说明",component:"Textarea",componentProps:{placeholder:"请输入"}}]}),[R,{closeModal:S,changeLoading:_,changeOkLoading:k}]=h((function(e){_(!0),w(),q.value=e.id,M({field:"isTree",componentProps:{disabled:!!r(q)}}),l(e.id).then((e=>{C.value=e.data.list||[],M([{field:"parentId",componentProps:{options:C.value}}]),q.value?n(q.value).then((e=>{V(e.data),_(!1)})):_(!1)}))})),q=a(""),C=a([]),{createMessage:L}=f(),{t:N}=t(),y=o(),B=s((()=>r(q)?N("common.editText"):N("common.addText")));async function D(){const e=await F();if(!e)return;k(!0);const a={...e,id:q.value};(q.value?p:g)(a).then((e=>{L.success(e.msg),k(!1),y.setDictionaryList(),S(),setTimeout((()=>{j("reload")}),200)})).catch((()=>{k(!1)}))}return(e,a)=>(i(),d(r(b),c(e.$attrs,{onRegister:r(R),title:B.value,onOk:D}),{default:m((()=>[u(r(x),{onRegister:r(I)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{T as _};
