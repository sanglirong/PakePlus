import{a as e,u as t,B as a}from"./index-9c138ba5.js";import{d as n,u as o,ad as l,a0 as i,M as r,ha as s,w as d,n as u,e as c,o as p,g as m,j as y,l as f,a4 as b,k as g,m as k,t as _,af as w,q as h,p as I,V as x,F as v,hb as N,hc as R,ea as C,ah as M}from"./index-920db443.js";import{u as j,B as A}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{u as Q,B as T}from"./useTable-dc8c9d84.js";import{T as D}from"./TableAction-adbe36f2.js";import{u as P}from"./index-143f5813.js";import{u as S}from"./index-999abbee.js";import{_ as B}from"./Form.vue_vue_type_script_setup_true_lang-e28cb4c6.js";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-38e0066b.js";import{_ as O}from"./index.vue_vue_type_script_setup_true_lang-d7edef18.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-deb40180.js";import{_ as z}from"./index.vue_vue_type_script_setup_true_lang-f6d5c295.js";import K from"./index-82a562d7.js";const q={class:"jnpf-content-wrapper-search-box ml-10px mt-10px"},E=n({__name:"index",setup(n){const{createMessage:E}=M(),{t:G}=o(),L=l({listQuery:{category:"Web",keyword:"",type:"",enabledMark:""},systemId:"",title:"",parentId:"",isDevPlatform:!1}),{listQuery:U,title:V,systemId:$,isDevPlatform:H}=i(L),J=r((()=>({keyword:L.listQuery.keyword,category:L.listQuery.category,systemId:L.systemId,type:L.listQuery.type,enabledMark:L.listQuery.enabledMark}))),X=[{title:"菜单名称",dataIndex:"fullName",width:260},{title:"编码",dataIndex:"enCode",width:160},{title:"菜单地址",dataIndex:"urlAddress"},{title:"图标",dataIndex:"icon",width:50,align:"center"},{title:"类型",dataIndex:"type",width:70,align:"center",customRender:({record:e})=>1===e.type?"目录":2===e.type?"页面":3===e.type?"表单":4===e.type?"字典":10===e.type?"报表":5===e.type?"报表(原)":6===e.type?"大屏":7===e.type?"外链":8===e.type?"门户":9===e.type?"流程":void 0},{title:"排序",dataIndex:"sortCode",width:70,align:"center"},{title:"状态",dataIndex:"enabledMark",width:70,align:"center"}],[Y]=e((function(e){L.systemId=e.id,L.title=e.title+"的菜单管理",L.listQuery.category="Web",L.listQuery.keyword="",L.isDevPlatform=e.isDevPlatform,L.listQuery.keyword="",u((()=>oe({page:1})))})),[Z,{resetFields:ee}]=j({baseColProps:{span:6},showActionButtonGroup:!0,showAdvancedButton:!0,compact:!0,schemas:[{field:"keyword",label:G("common.keyword"),component:"Input",componentProps:{placeholder:G("common.enterKeyword"),submitOnPressEnter:!0}},{field:"type",label:"类型",component:"Select",componentProps:{placeholder:"请选择",options:[{id:1,fullName:"目录"},{id:2,fullName:"页面"},{id:3,fullName:"表单"},{id:9,fullName:"流程"},{id:4,fullName:"字典"},{id:10,fullName:"报表"},{id:5,fullName:"报表(原)"},{id:6,fullName:"大屏"},{id:8,fullName:"门户"},{id:7,fullName:"外链"}]}},{field:"enabledMark",label:"状态",component:"Select",componentProps:{placeholder:"请选择",options:[{fullName:"启用",id:1},{fullName:"禁用",id:0}]}}]}),[te,{openModal:ae}]=P(),[ne,{reload:oe}]=Q({api:s,immediate:!1,isTreeTable:!0,pagination:!1,actionColumn:{width:150,title:"操作",dataIndex:"action"}}),[le,{reload:ie}]=Q({api:s,immediate:!1,isTreeTable:!0,pagination:!1,actionColumn:{width:150,title:"操作",dataIndex:"action"}}),[re,{openDrawer:se}]=S(),[de,{openDrawer:ue}]=S(),[ce,{openDrawer:pe}]=S(),[me,{openDrawer:ye}]=S(),[fe,{openPopup:be}]=t();function ge(e){return[{label:G("common.editText"),onClick:je.bind(null,e.id,"")},{label:G("common.delText"),color:"error",disabled:1==e.isMain,modelConfirm:{onOk:Ie.bind(null,e.id)}}]}function ke(e){const t=[{label:"新建子级",onClick:je.bind(null,"",e.id)}];return 1==e?.type?t:[{label:"按钮权限",ifShow:1===e.isButtonAuthorize&&[2,3,4,9].includes(e.type),onClick:xe.bind(null,e)},{label:"列表权限",ifShow:1===e.isColumnAuthorize&&[2,3,4,9].includes(e.type),onClick:ve.bind(null,e)},{label:"表单权限",ifShow:1===e.isFormAuthorize&&[2,3,4].includes(e.type),onClick:Ne.bind(null,e)},{label:"数据权限",ifShow:1===e.isDataAuthorize&&[2,3,4,9].includes(e.type),onClick:Re.bind(null,e)},{label:"导出模板",onClick:Ce.bind(null,e.id)},{label:"查看权限",ifShow:[2,3,4,9].includes(e.type),onClick:Me.bind(null,e.id,e.fullName)}]}function _e(e){L.listQuery.keyword=e?.keyword||"",L.listQuery.type=e?.type||"",L.listQuery.enabledMark=e?.enabledMark,he()}function we(){L.listQuery.keyword="",L.listQuery.type="",L.listQuery.enabledMark="",he()}function he(){u((()=>Qe()))}function Ie(e){N(e).then((e=>{E.success(e.msg),Qe()}))}function xe(e){se(!0,{id:e.id,fullName:e.fullName})}function ve(e){ue(!0,{id:e.id,fullName:e.fullName,type:e.type})}function Ne(e){pe(!0,{id:e.id,fullName:e.fullName,type:e.type})}function Re(e){ye(!0,{id:e.id,fullName:e.fullName,type:e.type})}function Ce(e){R(e).then((e=>{C({url:e.data.url})}))}function Me(e,t){be(!0,{id:e,fullName:t,objectType:"menu"})}function je(e="",t=""){ae(!0,{id:e,category:L.listQuery.category,systemId:L.systemId,parentId:t})}function Ae(){Qe()}function Qe(){"Web"==L.listQuery.category?oe({page:1}):ie({page:1})}return d((()=>L.listQuery.category),(()=>{u((()=>ee()))}),{deep:!0}),(e,t)=>{const n=c("a-button"),o=c("jnpf-upload-btn"),l=c("a-tag"),i=c("a-tab-pane"),r=c("a-tabs");return p(),m(v,null,[y(g(a),x(e.$attrs,{onRegister:g(Y),title:g(V),class:"full-popup"}),{default:f((()=>[b("div",q,[y(g(A),{class:"search-form",onRegister:g(Z),onSubmit:_e,onReset:we},null,8,["onRegister"])]),y(r,{activeKey:g(U).category,"onUpdate:activeKey":t[2]||(t[2]=e=>g(U).category=e),class:"jnpf-content-wrapper-tabs",destroyInactiveTabPane:""},{default:f((()=>[y(i,{key:"Web",tab:"Web菜单"},{default:f((()=>[y(g(T),{onRegister:g(ne),columns:X,searchInfo:J.value},{tableTitle:f((()=>[y(n,{type:"primary",preIcon:"icon-ym icon-ym-btn-add",onClick:t[0]||(t[0]=e=>je())},{default:f((()=>[k(_(g(G)("common.addText")),1)])),_:1}),y(o,{url:"/api/system/Menu/"+g($)+"/Actions/Import",data:{category:g(U).category,systemId:g($)},onOnSuccess:Ae,accept:".bm",type:"menu"},null,8,["url","data"])])),bodyCell:f((({column:e,record:t})=>["icon"===e.key?(p(),m("i",{key:0,class:w(t.icon+" table-icon")},null,2)):h("",!0),"enabledMark"===e.key?(p(),I(l,{key:1,color:1==t.enabledMark?"success":"error"},{default:f((()=>[k(_(1==t.enabledMark?"启用":"禁用"),1)])),_:2},1032,["color"])):h("",!0),"action"===e.key?(p(),I(g(D),{key:2,actions:ge(t),dropDownActions:ke(t)},null,8,["actions","dropDownActions"])):h("",!0)])),_:1},8,["onRegister","searchInfo"])])),_:1}),g(H)?h("",!0):(p(),I(i,{key:"App",tab:"App菜单"},{default:f((()=>[y(g(T),{onRegister:g(le),columns:X,searchInfo:J.value},{tableTitle:f((()=>[y(n,{type:"primary",preIcon:"icon-ym icon-ym-btn-add",onClick:t[1]||(t[1]=e=>je())},{default:f((()=>[k(_(g(G)("common.addText")),1)])),_:1}),y(o,{url:"/api/system/Menu/"+g($)+"/Actions/Import",data:{category:g(U).category,systemId:g($)},onOnSuccess:Ae,accept:".bm",type:"menu"},null,8,["url","data"])])),bodyCell:f((({column:e,record:t})=>["icon"===e.key?(p(),m("i",{key:0,class:w(t.icon+" table-icon")},null,2)):h("",!0),"enabledMark"===e.key?(p(),I(l,{key:1,color:1==t.enabledMark?"success":"error"},{default:f((()=>[k(_(1==t.enabledMark?"启用":"禁用"),1)])),_:2},1032,["color"])):h("",!0),"action"===e.key?(p(),I(g(D),{key:2,actions:ge(t),dropDownActions:ke(t)},null,8,["actions","dropDownActions"])):h("",!0)])),_:1},8,["onRegister","searchInfo"])])),_:1}))])),_:1},8,["activeKey"]),y(B,{onRegister:g(te),onReload:Qe},null,8,["onRegister"]),y(F,{onRegister:g(re)},null,8,["onRegister"]),y(O,{onRegister:g(de)},null,8,["onRegister"]),y(W,{onRegister:g(ce)},null,8,["onRegister"]),y(z,{onRegister:g(me)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]),y(K,{onRegister:g(fe)},null,8,["onRegister"])],64)}}});export{E as _};
