import{u as e}from"./useFlowForm-3cb03b53.js";import{d as a,r as l,ad as t,a0 as n,M as d,k as s,a7 as i,e as o,o as u,g as r,a4 as c,t as p,j as m,l as y,p as f,q as v,F as b,h as k,m as g,ae as _,fi as h}from"./index-920db443.js";import"./billRule-0363563b.js";const U={class:"flow-form"},L={class:"flow-com-title"},N={class:"number"},w={key:0,class:"required-sign"},x=a({name:"SalesOrder",__name:"index",props:["config"],emits:["setPageLoad","eventReceiver"],setup(a,{expose:x,emit:M}){const T=a,q=M,F=["普通发票","专业发票","其他"],I=[{title:"商品名称",dataIndex:"goodsName",key:"goodsName"},{title:"规格型号",dataIndex:"specifications",key:"specifications"},{title:"单位",dataIndex:"unit",key:"unit"},{title:"数量",dataIndex:"qty",key:"qty"},{title:"单价",dataIndex:"price",key:"price"},{title:"金额",dataIndex:"amount",key:"amount"},{title:"备注",dataIndex:"description",key:"description"}],C=l(),j=t({dataForm:{flowId:"",id:"",billNo:"",flowTitle:"",flowUrgent:1,customerName:"",contactPhone:"",contacts:"",customerAddres:"",salesman:"",ticketNum:"",paymentMethod:"",paymentMoney:"",description:"",fileJson:"",salesDate:void 0,invoiceType:"普通发票",entryList:[]},dataRule:{flowTitle:[{required:!0,message:"流程标题不能为空",trigger:"blur"}],customerName:[{required:!0,message:"客户名称不能为空",trigger:"blur"}],salesDate:[{required:!0,message:"开单日期不能为空",trigger:"change"}],contactPhone:[{pattern:/^1[3456789]\d{9}$|^0\d{2,3}-?\d{7,8}$/,message:"请输入正确的联系电话",trigger:"blur"}]},billEnCode:"WF_SalesOrderNo",fileList:[]}),{dataForm:D,dataRule:P,fileList:R}=n(j),{init:A,getUserInfo:S,judgeShow:J,judgeWrite:Y,judgeRequired:$,dataFormSubmit:z}=e({config:T.config,selfState:j,emit:q,formRef:C,selfInit:function(){j.dataForm.flowTitle=s(S).userName+"的销售订单"}});x({dataFormSubmit:z});const H=d((()=>{const e=T.config.disabled||Y("entryList")?null:{title:"操作",dataIndex:"action",key:"action",width:50},a=[{width:50,title:"序号",dataIndex:"index",key:"index",align:"center",customRender:({index:e})=>e+1},...I.filter((e=>J(`entryList-${e.key}`)))];return e&&a.push(e),a}));function O(e){e.amount=h(parseFloat(e.price)*parseFloat(e.qty))}return i((()=>{A()})),(e,l)=>{const t=o("a-input"),n=o("a-form-item"),d=o("a-col"),i=o("jnpf-date-picker"),h=o("a-radio"),x=o("a-radio-group"),M=o("a-input-number"),T=o("jnpf-upload-file"),q=o("jnpf-textarea"),I=o("a-row"),A=o("a-form"),S=o("JnpfGroupTitle"),z=o("a-button"),W=o("a-table");return u(),r("div",U,[c("div",L,[l[14]||(l[14]=c("h1",null,"销售订单",-1)),c("span",N,"流程编码："+p(s(D).billNo),1)]),m(A,{colon:!1,labelCol:{style:{width:"100px"}},model:s(D),rules:s(P),ref_key:"formRef",ref:C,disabled:a.config.disabled},{default:y((()=>[m(I,null,{default:y((()=>[s(J)("flowTitle")?(u(),f(d,{key:0,span:12},{default:y((()=>[m(n,{label:"流程标题",name:"flowTitle"},{default:y((()=>[m(t,{value:s(D).flowTitle,"onUpdate:value":l[0]||(l[0]=e=>s(D).flowTitle=e),placeholder:"流程标题",disabled:s(Y)("flowTitle")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("customerName")?(u(),f(d,{key:1,span:12},{default:y((()=>[m(n,{label:"客户名称",name:"customerName"},{default:y((()=>[m(t,{value:s(D).customerName,"onUpdate:value":l[1]||(l[1]=e=>s(D).customerName=e),placeholder:"客户名称",disabled:s(Y)("customerName")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("salesDate")?(u(),f(d,{key:2,span:12},{default:y((()=>[m(n,{label:"开单日期",name:"salesDate"},{default:y((()=>[m(i,{value:s(D).salesDate,"onUpdate:value":l[2]||(l[2]=e=>s(D).salesDate=e),format:"YYYY-MM-DD HH:mm:ss",placeholder:"选择日期",disabled:s(Y)("salesDate")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("contacts")?(u(),f(d,{key:3,span:12},{default:y((()=>[m(n,{label:"联系人员",name:"contacts"},{default:y((()=>[m(t,{value:s(D).contacts,"onUpdate:value":l[3]||(l[3]=e=>s(D).contacts=e),placeholder:"联系人员",disabled:s(Y)("contacts")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("contactPhone")?(u(),f(d,{key:4,span:12},{default:y((()=>[m(n,{label:"联系电话",name:"contactPhone"},{default:y((()=>[m(t,{value:s(D).contactPhone,"onUpdate:value":l[4]||(l[4]=e=>s(D).contactPhone=e),placeholder:"联系电话",disabled:s(Y)("contactPhone")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("customerAddres")?(u(),f(d,{key:5,span:12},{default:y((()=>[m(n,{label:"客户地址",name:"customerAddres"},{default:y((()=>[m(t,{value:s(D).customerAddres,"onUpdate:value":l[5]||(l[5]=e=>s(D).customerAddres=e),placeholder:"客户地址",disabled:s(Y)("customerAddres")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("salesman")?(u(),f(d,{key:6,span:12},{default:y((()=>[m(n,{label:"业务人员",name:"salesman"},{default:y((()=>[m(t,{value:s(D).salesman,"onUpdate:value":l[6]||(l[6]=e=>s(D).salesman=e),placeholder:"业务人员",disabled:s(Y)("salesman")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("ticketNum")?(u(),f(d,{key:7,span:12},{default:y((()=>[m(n,{label:"发票编码",name:"ticketNum"},{default:y((()=>[m(t,{value:s(D).ticketNum,"onUpdate:value":l[7]||(l[7]=e=>s(D).ticketNum=e),placeholder:"发票编码",disabled:s(Y)("ticketNum")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("paymentMethod")?(u(),f(d,{key:8,span:12},{default:y((()=>[m(n,{label:"付款方式",name:"paymentMethod"},{default:y((()=>[m(t,{value:s(D).paymentMethod,"onUpdate:value":l[8]||(l[8]=e=>s(D).paymentMethod=e),placeholder:"付款方式",disabled:s(Y)("paymentMethod")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("invoiceType")?(u(),f(d,{key:9,span:12},{default:y((()=>[m(n,{label:"发票类型",name:"invoiceType"},{default:y((()=>[m(x,{value:s(D).invoiceType,"onUpdate:value":l[9]||(l[9]=e=>s(D).invoiceType=e),disabled:s(Y)("invoiceType")},{default:y((()=>[(u(),r(b,null,k(F,(e=>m(h,{value:e,key:e},{default:y((()=>[g(p(e),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("paymentMoney")?(u(),f(d,{key:10,span:12},{default:y((()=>[m(n,{label:"付款金额",name:"paymentMoney"},{default:y((()=>[m(M,{value:s(D).paymentMoney,"onUpdate:value":l[10]||(l[10]=e=>s(D).paymentMoney=e),min:0,placeholder:"付款金额",disabled:s(Y)("paymentMoney")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("fileJson")?(u(),f(d,{key:11,span:24},{default:y((()=>[m(n,{label:"相关附件",name:"fileJson"},{default:y((()=>[m(T,{value:s(R),"onUpdate:value":l[11]||(l[11]=e=>_(R)?R.value=e:null),type:"workFlow",disabled:s(Y)("fileJson")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0),s(J)("description")?(u(),f(d,{key:12,span:24},{default:y((()=>[m(n,{label:"开单备注",name:"description"},{default:y((()=>[m(q,{value:s(D).description,"onUpdate:value":l[12]||(l[12]=e=>s(D).description=e),placeholder:"开单备注",disabled:s(Y)("description")},null,8,["value","disabled"])])),_:1})])),_:1})):v("",!0)])),_:1})])),_:1},8,["model","rules","disabled"]),s(J)("entryList")?(u(),r(b,{key:0},[m(S,{content:"销售明细",bordered:!1}),m(W,{"data-source":s(D).entryList,columns:H.value,size:"small",pagination:!1},{headerCell:y((({column:e})=>[s($)(`entryList-${e.key}`)?(u(),r("span",w,"*")):v("",!0),g(p(e.title),1)])),bodyCell:y((({column:e,record:a,index:n})=>["goodsName"===e.key?(u(),f(t,{key:0,value:a.goodsName,"onUpdate:value":e=>a.goodsName=e,disabled:s(Y)("entryList")||s(Y)("entryList-goodsName")},null,8,["value","onUpdate:value","disabled"])):v("",!0),"specifications"===e.key?(u(),f(t,{key:1,value:a.specifications,"onUpdate:value":e=>a.specifications=e,disabled:s(Y)("entryList")||s(Y)("entryList-specifications")},null,8,["value","onUpdate:value","disabled"])):v("",!0),"unit"===e.key?(u(),f(t,{key:2,value:a.unit,"onUpdate:value":e=>a.unit=e,disabled:s(Y)("entryList")||s(Y)("entryList-unit")},null,8,["value","onUpdate:value","disabled"])):v("",!0),"qty"===e.key?(u(),f(M,{key:3,value:a.qty,"onUpdate:value":e=>a.qty=e,min:0,onChange:e=>O(a),disabled:s(Y)("entryList")||s(Y)("entryList-qty")},null,8,["value","onUpdate:value","onChange","disabled"])):v("",!0),"price"===e.key?(u(),f(M,{key:4,value:a.price,"onUpdate:value":e=>a.price=e,onChange:e=>O(a),disabled:s(Y)("entryList")||s(Y)("entryList-price")},null,8,["value","onUpdate:value","onChange","disabled"])):v("",!0),"amount"===e.key?(u(),f(M,{key:5,value:a.amount,"onUpdate:value":e=>a.amount=e,readonly:"",disabled:s(Y)("entryList")||s(Y)("entryList-amount")},null,8,["value","onUpdate:value","disabled"])):v("",!0),"description"===e.key?(u(),f(t,{key:6,value:a.description,"onUpdate:value":e=>a.description=e,disabled:s(Y)("entryList")||s(Y)("entryList-description")},null,8,["value","onUpdate:value","disabled"])):v("",!0),"action"===e.key?(u(),f(z,{key:7,class:"action-btn",type:"link",color:"error",onClick:e=>function(e){j.dataForm.entryList.splice(e,1)}(n),size:"small"},{default:y((()=>l[15]||(l[15]=[g("删除")]))),_:2,__:[15]},1032,["onClick"])):v("",!0)])),_:1},8,["data-source","columns"]),a.config.disabled||s(Y)("entryList")?v("",!0):(u(),r("div",{key:0,class:"table-add-action",onClick:l[13]||(l[13]=e=>{j.dataForm.entryList.push({goodsName:"",specifications:"",unit:"",qty:0,price:0,amount:0,description:""})})},[m(z,{type:"link",preIcon:"icon-ym icon-ym-btn-add"},{default:y((()=>l[16]||(l[16]=[g("新增")]))),_:1,__:[16]})]))],64)):v("",!0)])}}});export{x as default};
