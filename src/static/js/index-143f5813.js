import{u as e,aj as t,k as o,aF as n,d as a,a0 as l,U as s,j as r,aG as i,aH as c,Y as d,aI as u,aJ as p,ab as g,r as f,aK as h,M as m,w as y,a7 as b,a8 as C,n as H,a5 as M,e as B,a9 as k,o as S,p as F,l as v,i as O,g as P,am as T,aL as w,m as x,t as N,V as j,q as W,aM as L,aN as $,T as R,a1 as E,aO as A,L as _,aP as I,Z as V,aQ as D,aR as q,h as Y,aS as z,aT as K,ad as U,aU as X,aV as G,a2 as J,at as Q,a3 as Z}from"./index-920db443.js";import{u as ee}from"./useWindowSizeFn-05f906e2.js";import{e as te}from"./log-2a5f2c26.js";const{t:oe}=e(),ne={open:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!1},centered:{type:Boolean,default:!0},cancelText:{type:String,default:oe("common.cancelText")},okText:{type:String,default:oe("common.okText")},continueText:{type:String,default:oe("common.continueText")},closeFunc:Function},ae=Object.assign({},ne,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!1},wrapperFooterOffset:{type:Number,default:-160},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},showContinueBtn:{type:Boolean,default:!1},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},continueLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!1},keyboard:{type:Boolean,default:!1},maskStyle:Object,okType:{type:String,default:"primary"},continueType:{type:String,default:"default"},okButtonProps:Object,cancelButtonProps:Object,continueButtonProps:Object,title:{type:String},open:{type:Boolean},width:{type:[String,Number],default:600},wrapClassName:{type:String},zIndex:{type:Number}});function le(e){const a=(e,t)=>getComputedStyle(e)[t],l=t=>{if(!t)return;t.setAttribute("data-drag",o(e.draggable));const n=t.querySelector(".ant-modal-header"),l=t.querySelector(".ant-modal");n&&l&&o(e.draggable)&&(n.style.cursor="move",n.onmousedown=e=>{if(!e)return;const t=e.clientX,o=e.clientY,n=document.body.clientWidth,s=document.documentElement.clientHeight,r=l.offsetWidth,i=l.offsetHeight,c=l.offsetLeft,d=n-l.offsetLeft-r,u=l.offsetTop;let p=s-l.offsetTop-i;p<0&&(p=s-l.offsetTop);const g=a(l,"left"),f=a(l,"top");let h=+g,m=+f;g.includes("%")?(h=+document.body.clientWidth*(+g.replace(/%/g,"")/100),m=+document.body.clientHeight*(+f.replace(/%/g,"")/100)):(h=+g.replace(/px/g,""),m=+f.replace(/px/g,"")),document.onmousemove=function(e){let n=e.clientX-t,a=e.clientY-o;-n>c?n=-c:n>d&&(n=d),-a>u?a=-u:a>p&&(a=p),l.style.cssText+=`;left:${n+h}px;top:${a+m}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};t((()=>{o(e.open)&&o(e.draggable)&&n((()=>{(()=>{const t=document.querySelectorAll(".ant-modal-wrap");for(const n of Array.from(t)){if(!n)continue;const t=a(n,"display"),s=n.getAttribute("data-drag");"none"!==t&&(null===s||o(e.destroyOnClose))&&l(n)}})()}),30)}))}const se=a({name:"Modal",inheritAttrs:!1,props:ae,emits:["cancel"],setup(e,{slots:t,emit:n}){const{open:a,draggable:u,destroyOnClose:p}=l(e),g=s({excludeDefaultKeys:!1});le({open:a,destroyOnClose:p,draggable:u});const f=e=>{n("cancel",e)};return()=>{let n;const a={...o(g),...e,onCancel:f};return r(c,a,"function"==typeof(l=n=i(t))||"[object Object]"===Object.prototype.toString.call(l)&&!d(l)?n:{default:()=>[n]});var l}}}),re=Symbol();function ie(){return u(re)}const ce=a({name:"ModalWrapper",components:{ScrollContainer:g},inheritAttrs:!1,props:{loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:50},height:{type:Number},footerOffset:{type:Number,default:0},open:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},emits:["height-change","ext-height"],setup(e,{emit:n}){const a=f(null),l=f(null),s=f(0),r=f(0);let i=0;ee(d.bind(null)),h(l,(()=>{d()}),{attributes:!0,subtree:!0,childList:!0}),p({redoModalHeight:d},re);const c=m((()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${o(s)}px`})));async function d(){if(!e.open)return;const t=o(a);if(!t)return;const r=t.$el.parentElement;if(r){r.style.padding="0",await H();try{const t=r.parentElement&&r.parentElement.parentElement;if(!t)return;const a=getComputedStyle(t).top,c=Number.parseInt(a);let d=window.innerHeight-2*c+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;c<40&&(d-=26),await H();const u=o(l);if(!u)return;await H(),i=u.scrollHeight,e.fullScreen?s.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:s.value=e.height?e.height:i>d?d:i,n("height-change",o(s))}catch(c){}}}return t((()=>{e.useWrapper&&d()})),y((()=>e.fullScreen),(e=>{d(),e?r.value=s.value:s.value=r.value})),b((()=>{const{modalHeaderHeight:t,modalFooterHeight:o}=e;n("ext-height",t+o)})),C((()=>{})),{wrapperRef:a,spinRef:l,spinStyle:c,scrollTop:async function(){H((()=>{const e=o(a);e&&e?.scrollTo?.(0)}))},setModalHeight:d}}}),de=["loading-tip"];const ue=M(ce,[["render",function(e,t,o,n,a,l){const s=B("ScrollContainer"),r=k("loading");return S(),F(s,{ref:"wrapperRef"},{default:v((()=>[O((S(),P("div",{ref:"spinRef",style:T(e.spinStyle),"loading-tip":e.loadingTip},[w(e.$slots,"default")],12,de)),[[r,e.loading]])])),_:3},512)}]]);const pe=M(a({name:"BasicModalFooter",props:ae,emits:["ok","continue","cancel"],setup:(e,{emit:t})=>({handleOk:function(e){t("ok",e)},handleContinue:function(e){t("continue",e)},handleCancel:function(e){t("cancel",e)}})}),[["render",function(e,t,o,n,a,l){const s=B("a-button");return S(),P("div",null,[w(e.$slots,"insertFooter"),e.showContinueBtn?(S(),F(s,j({key:0,type:e.continueType,onClick:e.handleContinue,loading:e.continueLoading,disabled:e.confirmLoading},e.continueButtonProps),{default:v((()=>[x(N(e.continueText),1)])),_:1},16,["type","onClick","loading","disabled"])):W("",!0),e.showCancelBtn?(S(),F(s,j({key:1},e.cancelButtonProps,{onClick:e.handleCancel}),{default:v((()=>[x(N(e.cancelText),1)])),_:1},16,["onClick"])):W("",!0),w(e.$slots,"centerFooter"),e.showOkBtn?(S(),F(s,j({key:2,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps,{disabled:e.okButtonProps?.disabled||e.continueLoading}),{default:v((()=>[x(N(e.okText),1)])),_:1},16,["type","onClick","loading","disabled"])):W("",!0),w(e.$slots,"appendFooter")])}]]),ge=a({name:"BasicModalHeader",components:{BasicTitle:L},props:{helpMessage:{type:[String,Array]},title:{type:String}},emits:["dblclick"]});const fe=M(a({name:"BasicModal",components:{Modal:se,ModalWrapper:ue,ModalClose:$,ModalFooter:pe,ModalHeader:M(ge,[["render",function(e,t,o,n,a,l){const s=B("BasicTitle");return S(),F(s,{helpMessage:e.helpMessage},{default:v((()=>[x(N(e.title),1)])),_:1},8,["helpMessage"])}]])},inheritAttrs:!1,props:ae,emits:["open-change","height-change","cancel","ok","register","update:open"],setup(e,{emit:n,attrs:a,slots:l}){const s=f(!1),r=f(null),i=f(null),{prefixCls:c}=R("basic-modal"),d=f(0),u={setModalProps:function(e){r.value=D(o(r)||{},e),Reflect.has(e,"open")&&(s.value=!!e.open);Reflect.has(e,"defaultFullscreen")&&(M.value=!!e.defaultFullscreen)},emitOpen:void 0,redoModalHeight:()=>{H((()=>{o(i)&&o(i).setModalHeight()}))}},p=E();p&&n("register",u,p.uid);const g=m((()=>({...e,...o(r)}))),h=m((()=>!o(g).title&&!l.title)),{handleFullScreen:b,getWrapClassName:C,fullScreenRef:M}=A({modalWrapperRef:i,extHeightRef:d,wrapClassName:_(g.value,"wrapClassName")}),B=m((()=>({...{...o(g),open:o(s),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0},wrapClassName:o(C)}))),k=m((()=>{const e={...a,...o(g),open:o(s)};return e.wrapClassName=`${e?.wrapClassName||""} ${o(C)}`,o(M)?I(e,["height","title"]):I(e,"title")})),S=m((()=>I(o(k),["class"]))),F=m((()=>{if(!o(M))return o(B).height}));return t((()=>{s.value=!!e.open,M.value=!!e.defaultFullscreen})),y((()=>o(s)),(t=>{n("open-change",t),n("update:open",t),p&&u.emitOpen?.(t,p.uid),H((()=>{e.scrollTop&&t&&o(i)&&o(i).scrollTop()}))}),{immediate:!1}),{handleCancel:async function(t){if(t?.stopPropagation(),!t.target?.classList?.contains(c+"-close--custom"))if(e.closeFunc&&V(e.closeFunc)){const t=await e.closeFunc();s.value=!t}else s.value=!1,n("cancel",t)},getBindValue:k,getFooterBindValue:S,getProps:B,handleFullScreen:b,fullScreenRef:M,getMergeProps:g,handleOk:function(e){n("ok",e)},openRef:s,omit:I,modalWrapperRef:i,handleExtHeight:function(e){d.value=e},handleHeightChange:function(e){n("height-change",e)},handleTitleDbClick:function(t){e.canFullscreen&&(t.stopPropagation(),b(t))},getWrapperHeight:F,isNoTitle:h}}}),[["render",function(e,t,o,n,a,l){const s=B("ModalClose"),i=B("ModalHeader"),c=B("ModalFooter"),d=B("ModalWrapper"),u=B("Modal");return S(),F(u,j(e.getBindValue,{onCancel:e.handleCancel}),q({default:v((()=>[r(d,j({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,open:e.openRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"open","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:v((()=>[w(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","open","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:v((()=>[r(s,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])])),key:"0"},e.isNoTitle?void 0:{name:"title",fn:v((()=>[r(i,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])])),key:"1"},e.$slots.footer?void 0:{name:"footer",fn:v((()=>[r(c,j(e.getFooterBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),q({_:2},[Y(Object.keys(e.$slots),(t=>({name:t,fn:v((o=>[w(e.$slots,t,z(K(o||{})))]))})))]),1040,["onOk","onCancel"])])),key:"2"},Y(Object.keys(e.omit(e.$slots,"default")),(t=>({name:t,fn:v((o=>[w(e.$slots,t,z(K(o||{})))]))})))]),1040,["onCancel"])}]]),he=U({}),me=U({});function ye(){const e=f(null),t=f(!1),n=f("");const a=()=>{const t=o(e);return t||te("useModal instance is undefined!"),t};return[function(a,l){if(!E())throw new Error("useModal() can only be used inside setup() or functional components!");n.value=l,C((()=>{e.value=null,t.value=!1,he[o(n)]=null})),o(t)&&J()&&a===o(e)||(e.value=a,t.value=!0,a.emitOpen=(e,t)=>{me[t]=e})},{setModalProps:e=>{a()?.setModalProps(e)},getOpen:m((()=>me[~~o(n)])),redoModalHeight:()=>{a()?.redoModalHeight?.()},openModal:(e=!0,t,l=!0)=>{if(a()?.setModalProps({open:e,confirmLoading:!1}),!t)return;const s=o(n);if(l)return he[s]=null,void(he[s]=X(t));G(X(he[s]),X(t))||(he[s]=X(t))},closeModal:()=>{a()?.setModalProps({open:!1})}}]}const be=e=>{const n=f(null),a=E(),l=f(""),s=()=>{const e=o(n);return e||te("useModalInner instance is undefined!"),e};return t((()=>{const t=he[o(l)];t&&e&&V(e)&&H((()=>{e(t)}))})),[(e,t)=>{Q((()=>{n.value=null})),l.value=t,n.value=e,a?.emit("register",e,t)},{changeLoading:(e=!0)=>{s()?.setModalProps({loading:e})},getOpen:m((()=>me[~~o(l)])),changeOkLoading:(e=!0)=>{s()?.setModalProps({confirmLoading:e})},changeContinueLoading:(e=!0)=>{s()?.setModalProps({continueLoading:e})},closeModal:()=>{s()?.setModalProps({open:!1})},setModalProps:e=>{s()?.setModalProps(e)},redoModalHeight:()=>{const e=s()?.redoModalHeight;e&&e()}}]},Ce=Z(fe);export{Ce as B,ie as a,be as b,ye as u};
