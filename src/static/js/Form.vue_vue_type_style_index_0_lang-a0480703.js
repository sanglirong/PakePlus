import{d as a,u as e,aD as t,r as o,ad as l,a0 as n,M as i,w as s,fE as d,e as r,o as p,p as u,l as c,a4 as f,k as m,ae as y,g,F as h,h as v,j as J,m as b,t as D,i as S,v as P,q as k,ee as N,ab as C,e1 as F,V as w,bN as q,hk as x,hl as O,n as E,ah as _}from"./index-920db443.js";import{a as T,B as L}from"./index-9c138ba5.js";import{u as V,B as I}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{g as j,a as K}from"./dataModel-ea807f46.js";import{g as R}from"./dataSource-ed26da12.js";import{B as U}from"./BasicLeftTree-cd55d444.js";import{M}from"./index-3b5bee70.js";import{u as z}from"./index-143f5813.js";import B from"./PageExplainModal-5690c6dc.js";import{_ as A}from"./Field.vue_vue_type_script_setup_true_lang-f47f93dd.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-cf683205.js";import{g as H}from"./variate-1d177fc7.js";const W={class:"ml-10px steps"},$={class:"config h-full"},G={class:"left-pane"},X={class:"box"},Y={class:"middle-pane"},Z={class:"title-box"},aa={class:"cursor-pointer"},ea={style:{float:"right",color:"#8492a6","padding-left":"10px"}},ta={key:0,class:"right-pane"},oa={key:0,class:"config h-full"},la={class:"middle-pane"},na={class:"!w-80px"},ia={key:2,class:"mt-20px ml-50px"},sa={key:3,class:"middle-pane !mb-10px"},da={class:"title-box"},ra={key:0,class:"cursor-pointer"},pa={key:0,class:"right-pane"},ua={key:1,class:"config h-full"},ca={key:2,class:"jsStaticData"},fa={class:"json-box"},ma="(data) => {\r\n    // 处理数据逻辑\r\n\r\n    // 返回所需的数据\r\n    return data\r\n}",ya="(data) => {\r\n    // 返回true表示接口验证成功！\r\n\r\n    // 返回false表示接口验证失败！\r\n    return true\r\n}",ga=a({__name:"Form",emits:["register","reload"],setup(a,{emit:ga}){const ha={staticData:"",sqlData:{dbLinkId:"",sql:""},apiData:{method:1,url:"",header:[],query:[],body:"",bodyType:0}},{t:va}=e(),Ja=t(),ba=o(null),Da=o(null),Sa=l({activeStep:0,keyword:"",treeData:[],dbOptions:[],treeLoading:!1,dataForm:{fullName:"",enCode:"",category:"",type:2,hasPage:0,sortCode:0,enabledMark:1,description:""},dataConfigJson:ha,dataCountJson:ha,dataEchoJson:ha,dataJsJson:"",dataExceptionJson:"",fieldJson:[],parameterJson:[],methodOptions:[{fullName:"GET",id:1},{fullName:"POST",id:2}],restaurants:[{value:"Postman-Token"},{value:"Host"},{value:"User-Agent"},{value:"Accept"},{value:"Accept-Encoding"},{value:"Connection"}],pathRules:[{required:!0,message:"必填",trigger:"blur"}],echoPathRules:[{required:!0,message:"必填",trigger:"blur"}],key:+new Date,sqlType:0,activeKey:0,list:[],fieldTreeData:[],apiData:ha.apiData,hasPageDisabled:!1,treeKey:+new Date}),{activeStep:Pa,dataForm:ka,dataConfigJson:Na,dataCountJson:Ca,dataEchoJson:Fa,dataJsJson:wa,dataExceptionJson:qa,fieldJson:xa,parameterJson:Oa,dbOptions:Ea,treeData:_a,keyword:Ta,methodOptions:La,pathRules:Va,key:Ia,activeKey:ja,fieldTreeData:Ka,apiData:Ra,hasPageDisabled:Ua}=n(Sa),Ma=[{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"category",label:"分类",component:"TreeSelect",componentProps:{placeholder:"请选择"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"type",label:"类型",component:"Radio",defaultValue:2,componentProps:{options:[{fullName:"静态数据",id:2},{fullName:"SQL操作",id:1},{fullName:"API操作",id:3}],onChange:function(a){Sa.dataForm.type=a,Sa.dataForm.action=1===a?3:null,Wa({action:Sa.dataForm.action})}}},{ifShow:({values:a})=>1===a.type,field:"action",label:"动作",component:"Radio",componentProps:{options:[{fullName:"查询",id:3},{fullName:"增加",id:1},{fullName:"修改",id:2},{fullName:"删除",id:4}],onChange:a=>{!function(a,e="sql"){"sql"==e&&(Sa.dataForm.action=a);Sa[e+"action"]=a;let t={action:a};3!==a&&"sql"==e&&(t.hasPage=0,Sa.dataForm.hasPage=0);Wa(t)}(a,"sql")}}},{field:"sortCode",label:"排序",component:"InputNumber",defaultValue:0,componentProps:{min:0,max:999999}},{field:"enabledMark",label:"状态",component:"Switch",defaultValue:1},{ifShow:({values:a})=>3===a.type||1===a.type&&3===a.action,field:"hasPage",label:"分页",component:"Switch",defaultValue:0,slot:"hasPage"},{field:"isPostPosition",label:"鉴权",component:"Switch",helpMessage:"开启后作为鉴权接口",defaultValue:0,componentProps:{onChange:function(a){Sa.dataForm.isPostPosition=a,a&&(Sa.dataForm.hasPage=0);Sa.hasPageDisabled=!!a}}},{field:"description",label:"说明",component:"Textarea",componentProps:{placeholder:"请输入",row:3}}],za=[{fullName:"none",id:0},{fullName:"form-data",id:1},{fullName:"x-www-form-urlencoded",id:2},{fullName:"json",id:3},{fullName:"xml",id:4}],Ba=[{title:"Header",key:0},{title:"Query",key:1},{title:"Body",key:2}],Aa=ga,{createMessage:Qa}=_(),[Ha,{setFieldsValue:Wa,validate:$a,resetFields:Ga,updateSchema:Xa}]=V({labelWidth:80,schemas:Ma}),[Ya,{closePopup:Za,changeLoading:ae,changeOkLoading:ee}]=T((async function(a){Sa.activeStep=0,Sa.keyword="",Sa.dataForm={fullName:"",enCode:"",category:"",type:2,hasPage:0,action:"1",sortCode:0,enabledMark:1,description:""},Sa.fieldJson=[],Sa.parameterJson=[],Sa.fieldTreeData=[],Sa.dataConfigJson=JSON.parse(JSON.stringify(ha)),Sa.dataConfigJson.sqlData.dbLinkId="0",Sa.dataCountJson=JSON.parse(JSON.stringify(ha)),Sa.dataEchoJson=JSON.parse(JSON.stringify(ha)),Sa.dataJsJson=JSON.parse(JSON.stringify(ma)),Sa.dataExceptionJson=JSON.parse(JSON.stringify(ya)),Ga(),Sa.dataForm.id=a.id;const e=await Ja.getDictionaryData("DataInterfaceType");Xa([{field:"category",componentProps:{options:e}}]),R().then((e=>{let t=e.data.list||[];t=t.filter((a=>a.children&&a.children.length)),t[0]&&t[0].children&&t[0].children.length&&(t[0]=t[0].children[0]),delete t[0].children,Sa.dbOptions=t,Sa.hasPageDisabled=!1,Sa.treeData=[],ne.currentPage=1,ie.value=!1,Sa.dataForm.id?(ae(!0),d(Sa.dataForm.id).then((a=>{Sa.dataForm=a.data,Wa({fullName:Sa.dataForm.fullName,enCode:Sa.dataForm.enCode,category:Sa.dataForm.category,type:Sa.dataForm.type,action:Sa.dataForm.action,sortCode:Sa.dataForm.sortCode,enabledMark:Sa.dataForm.enabledMark,description:Sa.dataForm.description,hasPage:Sa.dataForm.hasPage,isPostPosition:Sa.dataForm.isPostPosition,id:Sa.dataForm.id}),Sa.dataConfigJson=a.data.dataConfigJson?JSON.parse(a.data.dataConfigJson):JSON.parse(JSON.stringify(ha)),Sa.dataConfigJson.sqlData.dbLinkId||(Sa.dataConfigJson.sqlData.dbLinkId="0"),Sa.dataCountJson=a.data.dataCountJson?JSON.parse(a.data.dataCountJson):JSON.parse(JSON.stringify(ha)),Sa.dataEchoJson=a.data.dataEchoJson?JSON.parse(a.data.dataEchoJson):JSON.parse(JSON.stringify(ha)),Sa.parameterJson=a.data.parameterJson?JSON.parse(a.data.parameterJson):[],Sa.fieldJson=a.data.fieldJson?JSON.parse(a.data.fieldJson):[],Sa.dataJsJson=a.data.dataJsJson,Sa.dataExceptionJson=a.data.dataExceptionJson,1!=Sa.dataConfigJson.apiData.bodyType&&2!=Sa.dataConfigJson.apiData.bodyType||(Sa.dataConfigJson.apiData.body=Sa.dataConfigJson.apiData.body?JSON.parse(Sa.dataConfigJson.apiData.body):[]),1!=Sa.dataEchoJson.apiData.bodyType&&2!=Sa.dataEchoJson.apiData.bodyType||(Sa.dataEchoJson.apiData.body=Sa.dataEchoJson.apiData.body?JSON.parse(Sa.dataEchoJson.apiData.body):[]),ye(),setTimeout((()=>{me()}),200),ae(!1),Xa([{field:"isPostPosition",componentProps:{disabled:!0}}]),(Sa.dataForm.hasPage||Sa.dataForm.isPostPosition)&&(Sa.hasPageDisabled=!0)}))):(Xa([{field:"category",defaultValue:a.category}]),ye(),setTimeout((()=>{me()}),200)),H().then((a=>Sa.fieldTreeData=a.data))}))})),[te,{openModal:oe}]=z(),le=o(),ne=l({currentPage:1,pageSize:30}),ie=o(!1),se=o(null),de=i((()=>{const a=+new Date;return{defaultExpandAll:!1,treeData:Sa.treeData,loading:Sa.treeLoading,loadData:ke,onSelect:Ce,key:a}})),re=i((()=>`添加${Ba[Sa.activeKey]?.title||""}参数`)),pe=i((()=>{Sa.key=+new Date;let a=["基本信息","数据配置"];return 2===Sa.dataForm.type?a:(1===Sa.dataForm.type&&1===Sa.dataForm.hasPage&&(a=[...a,"数量统计","数据回显"]),3===Sa.dataForm.type&&0===Sa.dataForm.hasPage&&(a=[...a,"异常验证"]),3===Sa.dataForm.type&&1===Sa.dataForm.hasPage&&(a=[...a,"数据回显","异常验证"]),3===Sa.dataForm.type&&1===Sa.dataForm.isPostPosition?a:[...a,"数据处理"])})),ue=i((()=>{const a=[{value:"@lotSnowID",tips:"批量生成不同雪花ID"},{value:"@snowFlakeID",tips:"系统生成雪花ID"},{value:"@userId",tips:"当前用户"},{value:"@userAndSubordinates",tips:"当前用户及下属"},{value:"@organizeId",tips:"当前组织"},{value:"@organizationAndSuborganization",tips:"当前组织及子组织"},{value:"@branchManageOrganize",tips:"当前分管组织"}],e={value:"@keyword",tips:"关键词搜索"};return Sa.dataForm.hasPage?2===Sa.activeStep?[...a,e]:3===Sa.activeStep?[...a,{value:"@showKey",tips:"回显字段查询key"},{value:"@showValue",tips:"回显字段值"}]:[...a,{value:"@offsetSize",tips:"开始数据条数"},{value:"@pageSize",tips:"返回数据条数"},e]:a})),ce=i((()=>(0===Sa.activeKey&&(Sa.list=Sa.apiData.header||[]),1===Sa.activeKey&&(Sa.list=Sa.apiData.query||[]),2===Sa.activeKey&&(Sa.list=Sa.apiData.body||[]),Sa.list))),fe=i((()=>{let a=[{id:1,fullName:"接口参数",hasChildren:!0,children:Sa.parameterJson.map((a=>({...a,fullName:a.field,parameter:1,type:1})))},{id:2,fullName:"变量",hasChildren:!0,children:Sa.fieldTreeData}];if(a=a.filter((a=>a.children&&a.children.length)),!Sa.dataForm.hasPage)return a;return[...a,1==Sa.activeStep?{id:3,fullName:"分页参数",hasChildren:!0,children:[{fullName:"currentPage",id:"currentPage",parameter:1,type:1},{fullName:"pageSize",id:"pageSize",parameter:1,type:1},{fullName:"keyword",id:"keyword",parameter:1,type:1}]}:{id:4,fullName:"回显参数",hasChildren:!0,children:[{fullName:"showKey",id:"showKey",parameter:1,type:1},{fullName:"showValue",id:"showValue",parameter:1,type:1}]}]}));function me(){const a=se.value,e=a?.getScrollWrap();e?.addEventListener("scroll",(()=>{e.scrollHeight-e.clientHeight-e.scrollTop<=200&&!Sa.treeLoading&&!ie.value&&(ne.currentPage+=1,ye())}))}function ye(){Sa.treeLoading=!0;const a={linkId:Sa.dataConfigJson.sqlData.dbLinkId,keyword:Sa.keyword,pageSize:ne.pageSize,currentPage:ne.currentPage};j(a).then((a=>{Sa.treeLoading=!1,a.data.list.length<ne.pageSize&&(ie.value=!0),Sa.treeData=[...Sa.treeData,...a.data.list],Sa.treeData=Sa.treeData.map((a=>({...a,fullName:a.tableName?a.table+"("+a.tableName+")":a.table,isLeaf:!1,id:a.table,icon:1==a.type?"icon-ym icon-ym-view":"icon-ym icon-ym-generator-tableGrid"}))),Sa.treeKey=+new Date})).catch((()=>{Sa.treeLoading=!1,Sa.treeData=[]}))}async function ge(){const a=await $a();if(!a)return;if(!Sa.dataConfigJson.staticData&&2==Sa.dataForm.type)return Qa.error("请输入静态数据");ee(!0),1!=Sa.dataConfigJson.apiData.bodyType&&2!=Sa.dataConfigJson.apiData.bodyType||(Sa.dataConfigJson.apiData.body=JSON.stringify(Sa.dataConfigJson.apiData.body)),1!=Sa.dataEchoJson.apiData.bodyType&&2!=Sa.dataEchoJson.apiData.bodyType||(Sa.dataEchoJson.apiData.body=JSON.stringify(Sa.dataEchoJson.apiData.body));const e={...Sa.dataForm,...a,id:Sa.dataForm.id,dataConfigJson:JSON.stringify(Sa.dataConfigJson),dataCountJson:JSON.stringify(Sa.dataCountJson),dataEchoJson:JSON.stringify(Sa.dataEchoJson),dataJsJson:Sa.dataJsJson,dataExceptionJson:Sa.dataExceptionJson,fieldJson:JSON.stringify(Sa.fieldJson),parameterJson:JSON.stringify(Sa.parameterJson)};(Sa.dataForm.id?x:O)(e).then((a=>{Qa.success(a.msg),ee(!1),Za(),Aa("reload")})).catch((()=>{ee(!1)}))}function he(a){Sa.dataForm.hasPage=a,a&&Wa({isPostPosition:0}),Xa([{field:"isPostPosition",componentProps:{disabled:!!a}}])}function ve(){Sa.activeStep-=1,Sa.activeKey=0}async function Je(){if(await $a()){if(1===Sa.dataForm.type){if(1===Sa.activeStep&&!Sa.dataConfigJson.sqlData.sql)return Qa.warning("请输入SQL查询语句");if(Sa.dataForm.hasPage){if(2===Sa.activeStep&&!Sa.dataCountJson.sqlData.sql)return Qa.warning("请输入SQL语句");if(3===Sa.activeStep&&!Sa.dataEchoJson.sqlData.sql)return Qa.warning("请输入SQL语句")}be()}if(3===Sa.dataForm.type)if(1===Sa.activeStep||2===Sa.activeStep&&Sa.dataForm.hasPage)try{if(!(await(le.value?.validate())))return;!function(){const a=Sa.apiData.header||[],e=Sa.apiData.query||[];for(let t=0;t<a.length;t++)if(!a[t].field)return Qa.warning("参数名称不能为空");for(let t=0;t<e.length;t++)if(!e[t].field)return Qa.warning("参数名称不能为空");if((1===Sa.apiData.bodyType||2===Sa.apiData.bodyType)&&Array.isArray(Sa.apiData.body)&&Sa.apiData.body?.length)for(let t=0;t<Sa.apiData.body.length;t++)if(!Sa.apiData.body[t].field)return Qa.warning("参数名称不能为空");be()}()}catch(a){}else be();2===Sa.dataForm.type&&be()}}function be(){if(Sa.activeStep+=1,1===Sa.dataForm.type&&(_e()&&De(),Sa.dataForm.hasPage)){const a=Sa.dataConfigJson.sqlData.dbLinkId;0==Sa.dataCountJson.sqlData.dbLinkId&&Sa.dataCountJson.sqlData.dbLinkId||2!==Sa.activeStep||(Sa.dataCountJson.sqlData.dbLinkId=a),0==Sa.dataEchoJson.sqlData.dbLinkId&&Sa.dataEchoJson.sqlData.dbLinkId||3!==Sa.activeStep||(Sa.dataEchoJson.sqlData.dbLinkId=a)}3===Sa.dataForm.type&&((1===Sa.activeStep||2===Sa.activeStep&&Sa.dataForm.hasPage)&&(Sa.activeKey=0),_e()&&De(),Sa.activeStep===m(pe).length-2&&(Sa.dataExceptionJson||(Sa.dataExceptionJson=ya)))}function De(){Sa.dataJsJson||(Sa.dataJsJson=ma)}function Se(a){a.field&&ba.value?.insert("{"+a.field+"}")}function Pe(){const a=m(Da);if(!a)throw new Error("tree is null!");return a}function ke(a){return new Promise((e=>{K(Sa.dataConfigJson.sqlData.dbLinkId,a.dataRef.table).then((t=>{const o=t.data.list.map((e=>({...e,isLeaf:!0,fullName:e.fieldName?e.field+"("+e.fieldName+")":e.field,id:a.dataRef.table+"-"+e.field})));Pe().updateNodeByKey(a.eventKey,{children:o,isLeaf:!o.length}),e()}))}))}function Ne(){we()}function Ce(a){const e=Pe()?.getSelectedNode(a[0]),t=e.isLeaf?e.field:e.table;ba.value?.insert(t)}function Fe(a,e){if(e.hasChildren||1!==e.type)return;const t=e.field||e.fullName,o=1==e.parameter?"{"+t+"}":"{@"+t+"}";ba.value?.insert(o)}function we(){Sa.treeKey=+new Date,_a.value=[],ne.currentPage=1,ie.value=!1,E((()=>{ye()}))}function qe(){we()}function xe(){oe(!0)}function Oe(){return 0===Sa.activeKey||1===Sa.activeKey||2===Sa.activeKey&&(1===Sa.apiData.bodyType||2===Sa.apiData.bodyType)}function Ee(){if(_e()&&2!==Sa.dataForm.type)return!0;if(3===Sa.dataForm.type){if(Sa.activeStep===m(pe).length-1&&1==Sa.dataForm.isPostPosition)return!0;if(Sa.activeStep===m(pe).length-2&&1!==Sa.dataForm.isPostPosition)return!0}return!1}function _e(){return Sa.activeStep===m(pe).length-1&&(3!==Sa.dataForm.type||1!=Sa.dataForm.isPostPosition)}function Te(a){Sa.apiData.body=1==a||2==a?[]:""}return s((()=>Sa.activeStep),((a,e)=>{3===Sa.dataForm.type&&(1==e&&(Sa.dataConfigJson.apiData=JSON.parse(JSON.stringify(Sa.apiData))),2==e&&Sa.dataForm.hasPage&&(Sa.dataEchoJson.apiData=JSON.parse(JSON.stringify(Sa.apiData))),1===a&&(Sa.apiData=JSON.parse(JSON.stringify(Sa.dataConfigJson.apiData))),2===a&&Sa.dataForm.hasPage&&(Sa.apiData=JSON.parse(JSON.stringify(Sa.dataEchoJson.apiData))))})),(a,e)=>{const t=r("a-step"),o=r("a-steps"),l=r("a-button"),n=r("a-space"),i=r("JnpfSwitch"),s=r("a-col"),d=r("a-row"),x=r("jnpf-select"),O=r("BasicHelp"),E=r("a-menu-item"),_=r("a-menu-divider"),T=r("a-menu"),V=r("a-dropdown"),j=r("a-input"),K=r("a-form-item"),R=r("a-form"),z=r("a-tab-pane"),H=r("a-tabs"),ma=r("jnpf-radio"),ya=r("a-popover");return p(),u(m(L),w({class:"full-popup data-interface-popup"},a.$attrs,{continueLoading:m(Pa)<pe.value.length-1,onRegister:m(Ya),onOk:ge,destroyOnClose:"",showOkBtn:""}),{title:c((()=>[f("div",W,[(p(),u(o,{current:m(Pa),"onUpdate:current":e[0]||(e[0]=a=>y(Pa)?Pa.value=a:null),type:"navigation",size:"small",key:m(Ia)},{default:c((()=>[(p(!0),g(h,null,v(pe.value,(a=>(p(),u(t,{key:a,title:a,disabled:""},null,8,["title"])))),128))])),_:1},8,["current"]))])])),insertToolbar:c((()=>[J(n,{size:10},{default:c((()=>[J(l,{onClick:ve,disabled:m(Pa)<=0},{default:c((()=>[b(D(m(va)("common.prev")),1)])),_:1},8,["disabled"]),J(l,{onClick:Je,disabled:m(Pa)>=pe.value.length-1},{default:c((()=>[b(D(m(va)("common.next")),1)])),_:1},8,["disabled"])])),_:1})])),default:c((()=>[S(J(d,{class:"mt-20px overflow-auto h-full"},{default:c((()=>[J(s,{span:14,offset:5},{default:c((()=>[J(m(I),{onRegister:m(Ha)},{hasPage:c((({model:a,field:e})=>[J(i,{value:a[e],"onUpdate:value":t=>a[e]=t,checkedValue:1,unCheckedValue:0,onChange:he,disabled:m(Ua)},null,8,["value","onUpdate:value","disabled"]),f("span",{class:"page-explain",onClick:xe},"分页使用说明")])),_:1},8,["onRegister"])])),_:1})])),_:1},512),[[P,0===m(Pa)]]),S(f("div",$,[f("div",G,[1===m(Pa)?(p(),u(x,{key:0,class:"!w-full",value:m(Na).sqlData.dbLinkId,"onUpdate:value":e[1]||(e[1]=a=>m(Na).sqlData.dbLinkId=a),showSearch:"",options:m(Ea),placeholder:"选择数据库",onChange:Ne,fieldNames:{options:"children"}},null,8,["value","options"])):k("",!0),2===m(Pa)?(p(),u(x,{key:1,class:"!w-full",value:m(Ca).sqlData.dbLinkId,"onUpdate:value":e[2]||(e[2]=a=>m(Ca).sqlData.dbLinkId=a),showSearch:"",options:m(Ea),placeholder:"选择数据库",onChange:Ne,fieldNames:{options:"children"}},null,8,["value","options"])):k("",!0),3===m(Pa)?(p(),u(x,{key:2,class:"!w-full",value:m(Fa).sqlData.dbLinkId,"onUpdate:value":e[3]||(e[3]=a=>m(Fa).sqlData.dbLinkId=a),showSearch:"",options:m(Ea),placeholder:"选择数据库",onChange:Ne,fieldNames:{options:"children"}},null,8,["value","options"])):k("",!0),f("div",X,[J(m(N),{class:"search-box",placeholder:m(va)("common.enterKeyword"),allowClear:"",value:m(Ta),"onUpdate:value":e[4]||(e[4]=a=>y(Ta)?Ta.value=a:null),onSearch:qe},null,8,["placeholder","value"]),J(m(C),{ref_key:"infiniteBody",ref:se},{default:c((()=>[J(m(F),w({class:"tree-box remove-active-tree",ref_key:"leftTreeRef",ref:Da},de.value),null,16)])),_:1},512)])]),f("div",Y,[f("div",Z,[f("span",null,[e[17]||(e[17]=b(" SQL语句")),J(O,{text:"支持SQL语句&存储过程语句"})]),J(V,null,{overlay:c((()=>[J(T,null,{default:c((()=>[J(E,{disabled:""},{default:c((()=>e[19]||(e[19]=[b("当前系统变量仅支持内部接口引用")]))),_:1,__:[19]}),J(_),(p(!0),g(h,null,v(ue.value,((a,e)=>(p(),u(E,{key:e,onClick:e=>{return t=a.value,void ba.value?.insert(t);var t}},{default:c((()=>[f("span",null,D(a.value),1),f("span",ea,D(a.tips),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:c((()=>[f("span",aa,[e[18]||(e[18]=b("系统变量")),J(m(q))])])),_:1})]),1===m(Pa)?(p(),u(m(M),{key:0,class:"h-full",ref_key:"sqlEditorRef",ref:ba,language:"sql",modelValue:m(Na).sqlData.sql,"onUpdate:modelValue":e[5]||(e[5]=a=>m(Na).sqlData.sql=a)},null,8,["modelValue"])):k("",!0),2===m(Pa)?(p(),u(m(M),{key:1,class:"h-full",ref_key:"sqlEditorRef",ref:ba,language:"sql",modelValue:m(Ca).sqlData.sql,"onUpdate:modelValue":e[6]||(e[6]=a=>m(Ca).sqlData.sql=a)},null,8,["modelValue"])):k("",!0),3===m(Pa)?(p(),u(m(M),{key:2,class:"h-full",ref_key:"sqlEditorRef",ref:ba,language:"sql",modelValue:m(Fa).sqlData.sql,"onUpdate:modelValue":e[7]||(e[7]=a=>m(Fa).sqlData.sql=a)},null,8,["modelValue"])):k("",!0)]),m(ka).isPostPosition?k("",!0):(p(),g("div",ta,[J(A,{list:m(Oa),onItemClick:Se},null,8,["list"]),J(A,{list:m(xa),type:1},null,8,["list"])]))],512),[[P,1===Sa.dataForm.type&&(1===Sa.activeStep||!(!Sa.dataForm.hasPage||2!==Sa.activeStep&&3!==Sa.activeStep)||void 0)]]),1===Sa.activeStep&&3===Sa.dataForm.type||2===Sa.activeStep&&3===Sa.dataForm.type&&Sa.dataForm.hasPage?(p(),g("div",oa,[f("div",la,[J(R,{colon:!1,model:m(Ra),ref_key:"formElRef",ref:le},{default:c((()=>[J(K,{label:"",name:"url",rules:m(Va),class:"!mt-20px !mx-20px"},{default:c((()=>[J(j,{value:m(Ra).url,"onUpdate:value":e[9]||(e[9]=a=>m(Ra).url=a),placeholder:"请输入接口路径"},{addonBefore:c((()=>[f("div",na,[J(x,{value:m(Ra).method,"onUpdate:value":e[8]||(e[8]=a=>m(Ra).method=a),options:m(La)},null,8,["value","options"])])])),_:1},8,["value"])])),_:1},8,["rules"])])),_:1},8,["model"]),e[21]||(e[21]=f("div",{class:"title title-box"},"请求参数",-1)),J(H,{activeKey:m(ja),"onUpdate:activeKey":e[10]||(e[10]=a=>y(ja)?ja.value=a:null),class:"tabs-box"},{default:c((()=>[(p(),g(h,null,v(Ba,(a=>J(z,{key:a.key,tab:a.title},null,8,["tab"]))),64))])),_:1},8,["activeKey"]),2===m(ja)?(p(),u(ma,{key:0,value:m(Ra).bodyType,"onUpdate:value":e[11]||(e[11]=a=>m(Ra).bodyType=a),class:"!mb-20px !ml-20px",options:za,onChange:Te},null,8,["value"])):k("",!0),Oe()?(p(),g(h,{key:1},[Oe()?(p(),u(Q,{key:0,list:ce.value,hasPage:m(ka).hasPage,activeStep:m(Pa),fieldTreeData:m(Ka),parameterJson:m(Oa),sourceDisabled:!!m(ka).isPostPosition},null,8,["list","hasPage","activeStep","fieldTreeData","parameterJson","sourceDisabled"])):k("",!0),f("div",{class:"table-actions",onClick:e[12]||(e[12]=a=>{Sa.list.push({field:"",defaultValue:"",dataType:"varchar",source:Sa.dataForm.isPostPosition?3:1})})},[J(l,{type:"link",preIcon:"icon-ym icon-ym-btn-add"},{default:c((()=>[b(D(re.value),1)])),_:1})])],64)):k("",!0),2===m(ja)&&0===m(Ra).bodyType?(p(),g("div",ia,"该请求没有Body主体")):k("",!0),2!==m(ja)||3!==m(Ra).bodyType&&4!==m(Ra).bodyType?k("",!0):(p(),g("div",sa,[f("div",da,[f("span",null,D(3===m(Ra).bodyType?"JSON":"XML")+" Body",1),J(ya,{placement:"bottom"},{content:c((()=>[J(m(U),{class:"tree-box w-200px h-400px overflow-auto",ref_key:"leftTreeRef",ref:Da,defaultExpandAll:"",treeData:fe.value,onSelect:Fe},null,8,["treeData"])])),default:c((()=>[m(ka).isPostPosition?k("",!0):(p(),g("span",ra,[e[20]||(e[20]=b("插入参数")),J(m(q))]))])),_:1})]),3===m(Ra).bodyType||4===m(Ra).bodyType?(p(),u(m(M),{key:0,class:"h-full",ref_key:"sqlEditorRef",ref:ba,language:"sql",modelValue:m(Ra).body,"onUpdate:modelValue":e[13]||(e[13]=a=>m(Ra).body=a)},null,8,["modelValue"])):k("",!0)]))]),m(ka).isPostPosition?k("",!0):(p(),g("div",pa,[J(A,{list:m(Oa),onItemClick:Se},null,8,["list"]),J(A,{list:m(xa),type:1},null,8,["list"])]))])):k("",!0),1===m(Pa)&&2==m(ka).type?(p(),g("div",ua,[J(m(M),{class:"h-full middle-pane",ref:"editorRef",modelValue:m(Na).staticData,"onUpdate:modelValue":e[14]||(e[14]=a=>m(Na).staticData=a),language:"json"},null,8,["modelValue"]),m(ka).isPostPosition?k("",!0):(p(),u(A,{key:0,class:"static-right-pane",list:m(xa),type:1,scrollY:"calc(100vh - 312px)"},null,8,["list"]))])):k("",!0),Ee()?(p(),g("div",ca,[f("div",fa,[_e()?(p(),u(m(M),{key:0,class:"h-full",ref:"codeEditorRef",modelValue:m(wa),"onUpdate:modelValue":e[15]||(e[15]=a=>y(wa)?wa.value=a:null),language:"javascript"},null,8,["modelValue"])):(p(),u(m(M),{key:1,class:"h-full",ref:"codeEditorRef",modelValue:m(qa),"onUpdate:modelValue":e[16]||(e[16]=a=>y(qa)?qa.value=a:null),language:"javascript"},null,8,["modelValue"]))]),e[22]||(e[22]=f("div",{class:"jsTips"},[f("p",null,"1、支持JavaScript的脚本"),f("p",null,"2、小程序不支持在线JS脚本")],-1))])):k("",!0),J(B,{onRegister:m(te)},null,8,["onRegister"])])),_:1},16,["continueLoading","onRegister"])}}});export{ga as _};
