import{d as e,u as t,aD as o,ad as n,r as a,hn as r,a7 as i,e as s,o as l,g as p,a4 as u,j as c,k as m,l as d,m as _,t as f,p as j,q as g,n as y,ho as b,hp as v,hq as x,ea as h,ah as w}from"./index-920db443.js";import{B as k}from"./BasicLeftTree-cd55d444.js";import{u as I,B as D}from"./useTable-dc8c9d84.js";import{T as S}from"./TableAction-adbe36f2.js";import{u as T}from"./index-9c138ba5.js";import{_ as C}from"./Form.vue_vue_type_style_index_0_lang-a0480703.js";import{_ as F}from"./Preview.vue_vue_type_script_setup_true_lang-8b4d505a.js";import P from"./index-7fc563c5.js";import"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import"./visualDev-8f54ab4b.js";import"./index.vue_vue_type_script_setup_true_lang-69353133.js";import"./index-143f5813.js";import"./useWindowSizeFn-05f906e2.js";import"./log-2a5f2c26.js";import"./index-999abbee.js";import"./ArrowLeftOutlined-3fbf15bc.js";import"./Parser.vue_vue_type_script_setup_true_lang-6ddfe448.js";import"./Item.vue_vue_type_script_setup_true_lang-fef56f78.js";import"./Form.vue_vue_type_script_setup_true_lang-63005a4d.js";import"./createAsyncComponent-7e8f72ac.js";import"./DataLogList.vue_vue_type_script_setup_true_lang-c225eb8c.js";import"./index-0be8277c.js";import"./jquery-6353a699.js";import"./useDefineSetting-7df030ff.js";import"./CustomForm.vue_vue_type_script_setup_true_lang-1aa664f4.js";import"./config-06ca91cd.js";import"./upperFirst-2cd1a2f7.js";import"./useTabs-ceeccdba.js";import"./uniqBy-e868edd7.js";import"./sortable.esm-02d0fe44.js";import"./SettingOutlined-dd6150a2.js";import"./index-1cfe4e28.js";import"./dataModel-ea807f46.js";import"./dataSource-ed26da12.js";import"./index-3b5bee70.js";import"./PageExplainModal-5690c6dc.js";import"./Field.vue_vue_type_script_setup_true_lang-f47f93dd.js";import"./FieldForm.vue_vue_type_script_setup_true_lang-31f4df5b.js";import"./index.vue_vue_type_script_setup_true_lang-cf683205.js";import"./variate-1d177fc7.js";import"./Form.vue_vue_type_script_setup_true_lang-ebd8eecb.js";const M={class:"jnpf-content-wrapper"},R={class:"jnpf-content-wrapper-left"},N={class:"jnpf-content-wrapper-center"},O={class:"jnpf-content-wrapper-content"},A=e({name:"systemData-dataInterface",__name:"index",setup(e){const{createMessage:A}=w(),{t:L}=t(),q=o(),[B,{openPopup:Y}]=T(),[E,{openPopup:H}]=T(),[K,{openPopup:z}]=T(),Q=n({category:""}),W=n({expand:!1}),G=a(null),J=a(!1),Z=a([]),[$,{reload:U,setLoading:V,getForm:X}]=I({api:r,columns:[{title:"名称",dataIndex:"fullName"},{title:"编码",dataIndex:"enCode"},{title:"类型",dataIndex:"type",width:100},{title:"创建时间",dataIndex:"creatorTime",width:150,format:"date|YYYY-MM-DD HH:mm:ss"},{title:"排序",dataIndex:"sortCode",width:70,align:"center"},{title:"状态",dataIndex:"enabledMark",width:70,align:"center"}],immediate:!1,useSearchForm:!0,formConfig:{schemas:[{field:"keyword",label:L("common.keyword"),component:"Input",componentProps:{placeholder:L("common.enterKeyword"),submitOnPressEnter:!0}},{field:"type",label:"类型",component:"Select",componentProps:{placeholder:"请选择",options:[{fullName:"静态数据",id:2},{fullName:"SQL操作",id:1},{fullName:"API操作",id:3}]}},{field:"enabledMark",label:"状态",component:"Select",componentProps:{placeholder:"请选择",options:[{fullName:"启用",id:1},{fullName:"禁用",id:0}]}}]},actionColumn:{width:150,title:"操作",dataIndex:"action"}});function ee(e){return[{label:L("common.editText"),onClick:re.bind(null,e.id)},{label:L("common.delText"),color:"error",modelConfirm:{onOk:ie.bind(null,e.id)}}]}function te(e){return[{label:L("common.previewText"),onClick:se.bind(null,e)},{label:L("common.copyText"),modelConfirm:{content:"您确定要复制该数据接口, 是否继续?",onOk:le.bind(null,e.id)}},{label:L("common.exportText"),modelConfirm:{content:"您确定要导出该数据接口, 是否继续?",onOk:pe.bind(null,e.id)}},{ifShow:!!e.isPostPosition,label:"变量",onClick:ue.bind(null,e.id)}]}async function oe(e=!1){J.value=!0,e&&V(!0),Z.value=await q.getDictionaryData("DataInterfaceType"),y((()=>{e&&(Q.category=m(Z)[0].id);const t=m(G);t?.setSelectedKeys([Q.category]),e&&Q.category&&U(),J.value=!1}))}function ne(){Z.value=[],oe()}function ae(e){e&&Q.category!==e&&(Q.category=e,X().resetFields())}function re(e=""){Y(!0,{id:e,...Q})}function ie(e){b(e).then((e=>{A.success(e.msg),q.setDictionaryList(),U()}))}function se(e){const{id:t,enabledMark:o,tenantId:n,fullName:a}=e;if(0===o)return A.error("接口已被禁用，请先开启接口");H(!0,{id:t,tenantId:n,fullName:a})}function le(e){v(e).then((e=>{A.success(e.msg),U()}))}function pe(e){x(e).then((e=>{h({url:e.data.url})}))}function ue(e){z(!0,{id:e})}return i((()=>{oe(!0)})),(e,t)=>{const o=s("a-button"),n=s("jnpf-upload-btn"),a=s("a-tag");return l(),p("div",M,[u("div",R,[c(m(k),{title:"接口分类",ref_key:"leftTreeRef",ref:G,treeData:Z.value,loading:J.value,showSearch:!1,onReload:ne,onSelect:ae,showToolbar:""},null,8,["treeData","loading"])]),u("div",N,[u("div",O,[c(m(D),{onRegister:m($),searchInfo:Q,tableSetting:W},{tableTitle:d((()=>[c(o,{type:"primary",preIcon:"icon-ym icon-ym-btn-add",onClick:t[0]||(t[0]=e=>re())},{default:d((()=>[_(f(m(L)("common.addText")),1)])),_:1}),c(n,{url:"/api/system/DataInterface/Actions/Import",accept:".bd",onOnSuccess:m(U)},null,8,["onOnSuccess"])])),bodyCell:d((({column:e,record:t})=>["enabledMark"===e.key?(l(),j(a,{key:0,color:1==t.enabledMark?"success":"error"},{default:d((()=>[_(f(1==t.enabledMark?"启用":"禁用"),1)])),_:2},1032,["color"])):g("",!0),"action"===e.key?(l(),j(m(S),{key:1,actions:ee(t),dropDownActions:te(t)},null,8,["actions","dropDownActions"])):g("",!0)])),_:1},8,["onRegister","searchInfo","tableSetting"])])]),c(C,{onRegister:m(B),onReload:m(U)},null,8,["onRegister","onReload"]),c(P,{onRegister:m(K)},null,8,["onRegister"]),c(F,{onRegister:m(E)},null,8,["onRegister"])])}}});export{A as default};
