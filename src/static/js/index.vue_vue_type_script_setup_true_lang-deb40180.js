import{a as e,d as t}from"./formAuthorize-51125b44.js";import{g as a}from"./dataSource-ed26da12.js";import{b as o}from"./authorize-05422727.js";import{a as n,B as i}from"./index-999abbee.js";import{u as d,B as l}from"./useTable-dc8c9d84.js";import{T as s}from"./TableAction-adbe36f2.js";import{u as r}from"./index-143f5813.js";import{d as c,ad as m,a0 as u,u as p,n as f,e as y,o as b,g as _,j as h,l as g,k,m as x,t as R,p as I,q as j,V as C,F as T,ah as M}from"./index-920db443.js";import{_ as w}from"./Form.vue_vue_type_script_setup_true_lang-89db0f67.js";import L from"./BatchForm-731e2b2d.js";import{_ as N}from"./Form.vue_vue_type_script_setup_true_lang-d579ecae.js";const v=c({__name:"index",setup(c){const v=m({id:"",title:"",type:"",dbOptions:[],dataList:{},tableName:""}),{title:O,type:F}=u(v),{createMessage:B}=M(),{t:z}=p(),[A,{}]=n((function(e){v.id=e.id,v.title=`表单权限 - ${e.fullName}`,E.id=e.id,v.type=e.type,f((()=>{J(),"2"==v.type&&(a().then((e=>{let t=e.data.list||[];t=t.filter((e=>e.children&&e.children.length)),t[0]&&t[0].children&&t[0].children.length&&(t[0]=t[0].children[0]),delete t[0].children,v.dbOptions=t})),K())}))})),[$,{openModal:q}]=r(),[D,{openModal:G}]=r(),[S,{openModal:V}]=r(),E=m({id:""}),[H,{reload:J}]=d({api:e,searchInfo:E,columns:[{title:"数据库表",dataIndex:"bindTable",width:120},{title:"字段名称",dataIndex:"enCode",width:160},{title:"字段说明",dataIndex:"fullName"},{title:"排序",dataIndex:"sortCode",width:70,align:"center"},{title:"状态",dataIndex:"enabledMark",width:70,align:"center"}],pagination:!1,immediate:!1,showIndexColumn:!1,actionColumn:{width:100,title:"操作",dataIndex:"action"}});function K(){o(v.id,2).then((e=>{v.dataList=e.data||{},v.tableName=v.dataList.linkTables||""}))}function P(e){v.tableName=e||"",K()}function Q(e){return[{label:z("common.editText"),onClick:W.bind(null,e.id)},{label:z("common.delText"),color:"error",disabled:1==e.isMain,modelConfirm:{onOk:U.bind(null,e.id)}}]}function U(e){t(e).then((e=>{B.success(e.msg),J()}))}function W(e=""){q(!0,{moduleId:v.id,id:e,type:v.type,dataType:2})}function X(){G(!0,{moduleId:v.id})}function Y(){V(!0,{moduleId:v.id,dataList:v.dataList,dbOptions:v.dbOptions,dataType:2})}return(e,t)=>{const a=y("a-button"),o=y("a-tag");return b(),_(T,null,[h(k(i),C(e.$attrs,{onRegister:k(A),title:k(O),width:700,class:"full-drawer"}),{default:g((()=>[h(k(l),{onRegister:k(H)},{tableTitle:g((()=>[h(a,{type:"primary",preIcon:"icon-ym icon-ym-btn-add",onClick:t[0]||(t[0]=e=>W())},{default:g((()=>[x(R(k(z)("common.addText")),1)])),_:1}),h(a,{type:"link",preIcon:"ym-custom ym-custom-content-copy",onClick:X},{default:g((()=>t[1]||(t[1]=[x("批量新增")]))),_:1,__:[1]}),"2"==k(F)?(b(),I(a,{key:0,type:"link",preIcon:"icon-ym icon-ym-dbLink",onClick:Y},{default:g((()=>t[2]||(t[2]=[x("数据连接")]))),_:1,__:[2]})):j("",!0)])),bodyCell:g((({column:e,record:t})=>["enabledMark"===e.key?(b(),I(o,{key:0,color:1==t.enabledMark?"success":"error"},{default:g((()=>[x(R(1==t.enabledMark?"启用":"禁用"),1)])),_:2},1032,["color"])):j("",!0),"action"===e.key?(b(),I(k(s),{key:1,actions:Q(t)},null,8,["actions"])):j("",!0)])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title"]),h(w,{onRegister:k($),onReload:k(J)},null,8,["onRegister","onReload"]),h(L,{onRegister:k(D),onReload:k(J)},null,8,["onRegister","onReload"]),h(N,{onRegister:k(S),onReload:P},null,8,["onRegister"])],64)}}});export{v as _};
