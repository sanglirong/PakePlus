import{D as e}from"./visualDev-8f54ab4b.js";import{b as a,u as l,B as t}from"./index-143f5813.js";import{d as o,aD as s,r,ad as n,a0 as u,n as i,e as d,o as m,g as p,j as c,l as f,m as g,k as _,p as b,q as y,V as v,F as h,ea as k}from"./index-920db443.js";import{_ as w}from"./PreviewModal.vue_vue_type_script_setup_true_lang-d0fb777b.js";import{_ as F}from"./AliasModal.vue_vue_type_script_setup_true_lang-1a1a8529.js";const N=o({__name:"DownloadModal",emits:["register"],setup(o){const N=s(),[j,{changeOkLoading:P,closeModal:O}]=a((function(e){q.tables=e.tables?JSON.parse(e.tables):[],q.id=e.id,q.type=e.type||0,q.hasPackage=!!e.hasPackage,q.fullName=e.fullName||"",q.webType=e.webType||2,q.dataForm.description="",q.dataForm.enableFlow=0,N.getDictionaryData("createModule").then((e=>{q.moduleOptions=e,q.moduleOptions.length&&(q.dataForm.module=q.moduleOptions[0].id)})),i((()=>{if(T.value?.clearValidate(),4==e.webType)return;const a=q.tables.length?q.tables.filter((e=>"1"==e.typeId))[0].table:"";q.dataForm.description=a}))})),[x,{openModal:M}]=l(),[R,{openModal:D}]=l(),T=r(),q=n({dataForm:{module:"",modulePackageName:"jnpf",description:"",enableFlow:0},moduleOptions:[],tables:[],type:0,id:"",hasPackage:!1,fullName:"",webType:2}),{dataForm:U,type:C,moduleOptions:B,hasPackage:I,webType:S}=u(q);async function V(){try{if(!(await(T.value?.validate())))return;P(!0),e(q.id,q.dataForm).then((e=>{k({url:e.data.url}),O()})).catch((()=>{P(!1)}))}catch(a){}}function z(){M(!0,{id:q.id,fullName:q.fullName,...q.dataForm})}function A(){D(!0,{id:q.id,fullName:q.fullName})}return(e,a)=>{const l=d("a-button"),o=d("a-space"),s=d("a-alert"),r=d("jnpf-select"),n=d("a-form-item"),u=d("BasicHelp"),i=d("a-input"),k=d("jnpf-switch"),N=d("a-form");return m(),p(h,null,[c(_(t),v(e.$attrs,{onRegister:_(j),title:"输出设置",okText:"下载代码",onOk:V}),{insertFooter:f((()=>[c(o,{size:10,class:"float-left"},{default:f((()=>[c(l,{onClick:z},{default:f((()=>a[4]||(a[4]=[g("代码预览")]))),_:1,__:[4]}),4!=_(S)?(m(),b(l,{key:0,onClick:A},{default:f((()=>a[5]||(a[5]=[g("命名规范")]))),_:1,__:[5]})):y("",!0)])),_:1})])),default:f((()=>[c(s,{message:"注意：以下只能包含数字、字母、下划线、小圆点，不能用数字开头，不能是关键字或保留字。",type:"warning",showIcon:"",class:"!mb-18px"}),c(N,{colon:!1,labelCol:{style:{width:"100px"}},model:_(U),ref_key:"formElRef",ref:T},{default:f((()=>[3!=_(C)?(m(),b(n,{key:0,label:"模块命名",name:"module",rules:[{required:!0,message:"必填",trigger:"change"}]},{default:f((()=>[c(r,{value:_(U).module,"onUpdate:value":a[0]||(a[0]=e=>_(U).module=e),options:_(B),placeholder:"请选择",showSearch:""},null,8,["value","options"])])),_:1})):y("",!0),_(I)?(m(),b(n,{key:1,name:"modulePackageName",rules:[{required:!0,message:"必填",trigger:"blur"}]},{label:f((()=>[a[6]||(a[6]=g("模块包名")),c(u,{text:"修改包名需要调整controller和mapper扫描配置"})])),default:f((()=>[c(i,{value:_(U).modulePackageName,"onUpdate:value":a[1]||(a[1]=e=>_(U).modulePackageName=e),placeholder:"请输入"},null,8,["value"])])),_:1})):y("",!0),c(n,{label:"功能描述",name:"description",rules:[{required:!0,message:"必填",trigger:"blur"}]},{default:f((()=>[c(i,{value:_(U).description,"onUpdate:value":a[2]||(a[2]=e=>_(U).description=e),placeholder:"请输入"},null,8,["value"])])),_:1}),4!=_(S)?(m(),b(n,{key:2,label:"流程模板",name:"enableFlow"},{default:f((()=>[c(k,{value:_(U).enableFlow,"onUpdate:value":a[3]||(a[3]=e=>_(U).enableFlow=e)},null,8,["value"])])),_:1})):y("",!0)])),_:1},8,["model"])])),_:1},16,["onRegister"]),c(w,{onRegister:_(x)},null,8,["onRegister"]),c(F,{onRegister:_(R)},null,8,["onRegister"])],64)}}});export{N as _};
