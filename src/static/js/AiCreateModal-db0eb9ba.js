import{x as a,t as e}from"./visualDev-8f54ab4b.js";import{b as t,B as o}from"./index-143f5813.js";import{d as s,r as l,ad as r,a0 as n,U as i,M as d,k as c,n as u,e as m,o as g,p,l as f,a4 as v,j as y,ae as h,dz as x,g as F,af as j,q as _,V as b,aP as k,ah as w,a5 as C}from"./index-920db443.js";import{f as M}from"./formValidate-c8ab8d29.js";import{a as U}from"./aiUtils-9712c454.js";import"./useWindowSizeFn-05f906e2.js";import"./log-2a5f2c26.js";import"./componentMap-a7ede5fc.js";import"./config-06ca91cd.js";const O={class:"!pb-35px"},q={class:"ai-textarea"},L={class:"ai-button"},N=C(s({__name:"AiCreateModal",emits:["register","reload"],setup(s,{emit:C}){const N=C,{createMessage:A}=w(),[I,{changeOkLoading:R,closeModal:V}]=t((function(a){B.categoryOptions=a.categoryList||[],B.content="",B.loading=!1,B.showForm=!1,B.dataForm={},u((()=>{z.value?.clearValidate()}))})),z=l(),B=r({dataForm:{},content:"",loading:!1,categoryOptions:[],showForm:!1}),{dataForm:D,content:P,loading:S,categoryOptions:E,showForm:K}=n(B),Q=i({excludeDefaultKeys:!1}),W={fullName:[{required:!0,message:"必填",trigger:"blur"}],enCode:[{required:!0,message:"必填",trigger:"blur"},{validator:M("enCode"),trigger:"blur"}],category:[{required:!0,message:"必填",trigger:"change"}]},G=d((()=>{const a={...c(Q),title:"AI建表",okButtonProps:{disabled:B.loading}};return B.showForm||(a.footer=null),a}));function H(){B.content&&(B.loading=!0,a({keyword:B.content}).then((a=>{B.showForm=!0,B.loading=!1,B.dataForm={...a.data,category:B.dataForm.category}})).catch((()=>{B.loading=!1})))}async function J(){try{if(!(await(z.value?.validate())))return;B.dataForm={...U(B.dataForm.aiModelList||[]),...k(B.dataForm,["aiModelList"])},R(!0),e(B.dataForm).then((a=>{R(!1),V(),A.success(a.msg),N("reload",a.data)})).catch((()=>{R(!1)}))}catch(a){}}return(a,e)=>{const t=m("jnpf-textarea"),s=m("jnpf-input"),l=m("a-form-item"),r=m("jnpf-select"),n=m("a-form");return g(),p(c(o),b(G.value,{onRegister:c(I),onOk:J,destroyOnClose:""}),{default:f((()=>[v("div",O,[e[4]||(e[4]=v("div",{class:"text-tips"},"通过AI生成表单 ，根据文字描述智能生成推荐表单",-1)),v("div",q,[y(t,{value:c(P),"onUpdate:value":e[0]||(e[0]=a=>h(P)?P.value=a:null),placeholder:"输入你的需求描述",maxlength:100},null,8,["value"]),v("div",L,[c(S)?(g(),p(c(x),{key:0,class:"mr-5px"})):(g(),F("i",{key:1,class:j(["ym-custom ym-custom-send cursor-pointer",{"icon-selected":c(P)}]),onClick:H},null,2))])])]),c(K)?(g(),p(n,{key:0,colon:!1,labelCol:{style:{width:"77px"}},model:c(D),rules:W,ref_key:"formElRef",ref:z},{default:f((()=>[e[5]||(e[5]=v("div",{class:"text-tips"},"表单已生成，请继续确认表单名称、编码及分类",-1)),y(l,{label:"表单名称",name:"fullName"},{default:f((()=>[y(s,{value:c(D).fullName,"onUpdate:value":e[1]||(e[1]=a=>c(D).fullName=a),placeholder:"请输入",maxlength:100},null,8,["value"])])),_:1}),y(l,{label:"表单编码",name:"enCode"},{default:f((()=>[y(s,{value:c(D).enCode,"onUpdate:value":e[2]||(e[2]=a=>c(D).enCode=a),placeholder:"请输入",maxlength:50},null,8,["value"])])),_:1}),y(l,{label:"表单分类",name:"category"},{default:f((()=>[y(r,{value:c(D).category,"onUpdate:value":e[3]||(e[3]=a=>c(D).category=a),options:c(E),showSearch:""},null,8,["value","options"])])),_:1})])),_:1,__:[5]},8,["model"])):_("",!0)])),_:1},16,["onRegister"])}}}),[["__scopeId","data-v-5621fe14"]]);export{N as default};
