import{d as e,r as l,k as a,a7 as n,c as t,e as i,o as d,g as o,j as r,l as c,p as f,q as u,m as s,a4 as p,F as _,ah as m}from"./index-920db443.js";import{i as y,s as k,a as h}from"./componentMap-a7ede5fc.js";const g=e({__name:"FieldForm",props:["conf"],setup(e,{expose:g}){g({getData:function(){return new Promise(((e,l)=>{(function(){let e=!0;for(let l=0;l<a(x).length;l++){const n=a(x)[l];if(!n.filedName){b.error("名称不能为空"),e=!1;break}if(!n.filedId){b.error("字段不能为空"),e=!1;break}if(a(x).filter((e=>e.filedId==n.filedId)).length>1){b.error(`字段'${n.filedId}'已重复`),e=!1;break}}return e})()&&(a(x).length?e({formData:a(x),target:1}):l({msg:"表单列表不允许为空",target:1}))}))}});const v=e,{createMessage:b}=m(),j=["divider","text","link","alert","button","table"],I=[{title:"序号",width:50,align:"center",customRender:({index:e})=>e+1},{title:"名称",dataIndex:"filedName",key:"filedName"},{title:"字段",dataIndex:"filedId",key:"filedId"},{title:"控件类型",dataIndex:"jnpfKey",key:"jnpfKey",width:150},{title:"必填",dataIndex:"required",key:"required",width:50,align:"center"},{title:"多选",dataIndex:"multiple",key:"multiple",width:50,align:"center"},{title:"操作",dataIndex:"action",key:"action",width:50,align:"center"}],N=l([]),x=l([]);function K(){x.value.push({filedName:"",filedId:"",jnpfKey:"",required:!1,multiple:!1})}return n((()=>{!function(){const e=y.filter((e=>!j.includes(e.__config__.jnpfKey))).map((e=>({id:e.__config__.jnpfKey,fullName:e.__config__.label}))),l=k.filter((e=>!j.includes(e.__config__.jnpfKey))).map((e=>({id:e.__config__.jnpfKey,fullName:e.__config__.label}))),a=h.map((e=>({id:e.__config__.jnpfKey,fullName:e.__config__.label})));N.value=[{id:"1",fullName:"基础控件",children:e},{id:"2",fullName:"高级控件",children:l},{id:"3",fullName:"系统控件",children:a}]}(),"object"==typeof v.conf&&null!==v.conf&&(x.value=t(v.conf))})),(e,l)=>{const a=i("jnpf-group-title"),n=i("a-input"),t=i("jnpf-select"),m=i("a-checkbox"),y=i("a-button"),k=i("a-table");return d(),o(_,null,[r(a,{content:"字段设置",bordered:!1}),r(k,{"data-source":x.value,columns:I,size:"small",pagination:!1,rowKey:"id",class:"search-table"},{bodyCell:c((({column:e,record:a,index:i})=>["filedName"===e.key?(d(),f(n,{key:0,value:a.filedName,"onUpdate:value":e=>a.filedName=e,placeholder:"输入名称",allowClear:""},null,8,["value","onUpdate:value"])):u("",!0),"filedId"===e.key?(d(),f(n,{key:1,value:a.filedId,"onUpdate:value":e=>a.filedId=e,placeholder:"输入字段",allowClear:""},null,8,["value","onUpdate:value"])):u("",!0),"jnpfKey"===e.key?(d(),f(t,{key:2,value:a.jnpfKey,"onUpdate:value":e=>a.jnpfKey=e,options:N.value,fieldNames:{options:"children"},showSearch:"",allowClear:""},null,8,["value","onUpdate:value","options"])):u("",!0),"required"===e.key||"multiple"===e.key?(d(),f(m,{key:3,checked:a[e.key],"onUpdate:checked":l=>a[e.key]=l},null,8,["checked","onUpdate:checked"])):u("",!0),"action"===e.key?(d(),f(y,{key:4,class:"action-btn",type:"link",color:"error",onClick:e=>function(e){x.value.splice(e,1)}(i),size:"small"},{default:c((()=>l[0]||(l[0]=[s("删除")]))),_:2,__:[0]},1032,["onClick"])):u("",!0)])),_:1},8,["data-source"]),p("div",{class:"table-add-action",onClick:K},[r(y,{type:"link",preIcon:"icon-ym icon-ym-btn-add"},{default:c((()=>l[1]||(l[1]=[s("新增一行")]))),_:1,__:[1]})])],64)}}});export{g as _};
