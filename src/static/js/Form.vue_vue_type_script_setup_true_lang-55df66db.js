import{b as e,B as a}from"./index-143f5813.js";import{u as o,B as t}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{f as r}from"./formValidate-c8ab8d29.js";import{d as n,ad as s,a0 as d,u as i,fp as l,e as m,o as c,p,l as g,j as u,k as f,m as h,V as F,fq as b,fr as x,ah as L}from"./index-920db443.js";const _=n({__name:"Form",emits:["register","reload","design"],setup(n,{emit:_}){const j=s({dataForm:{},btnLoading:!1}),{dataForm:y,btnLoading:P}=d(j),{createMessage:k}=L(),{t:q}=i(),C=_,[R,{closeModal:V,changeLoading:w,changeOkLoading:I}]=e((function(e){T(),j.dataForm.id=e.id||"",B([{field:"category",componentProps:{options:e.categoryList||[]}}]),j.dataForm.id&&(w(!0),l(j.dataForm.id).then((e=>{j.dataForm=e.data,S(j.dataForm),w(!1)})).catch((()=>{w(!1)})))})),[M,{setFieldsValue:S,resetFields:T,validate:v,updateSchema:B}]=o({schemas:[{field:"fullName",label:"名称",component:"Input",componentProps:{placeholder:"请输入",maxlength:100},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"enCode",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:r("enCode"),trigger:"blur"}]},{field:"category",label:"分类",component:"Select",componentProps:{placeholder:"请选择",showSearch:!0},rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"sortCode",label:"排序",defaultValue:0,component:"InputNumber",componentProps:{min:0,max:999999}},{field:"description",label:"说明 ",component:"Textarea",componentProps:{placeholder:"请输入"}}]});async function N(e=0){const a=await v();if(!a)return;1===e?j.btnLoading=!0:I(!0);const o={...a,id:j.dataForm.id};(j.dataForm.id?b:x)(o).then((o=>{k.success(o.msg),I(!1),j.btnLoading=!1,V(),C("reload"),j.dataForm.id||(j.dataForm.id=o.data),1==e&&C("design",{...a,id:j.dataForm.id})})).catch((()=>{I(!1),j.btnLoading=!1}))}return(e,o)=>{const r=m("a-button");return c(),p(f(a),F(e.$attrs,{onRegister:f(R),title:f(y).id?f(q)("common.editText"):f(q)("common.addText"),onOk:o[1]||(o[1]=e=>N())}),{appendFooter:g((()=>[u(r,{type:"primary",loading:f(P),onClick:o[0]||(o[0]=e=>N(1))},{default:g((()=>o[2]||(o[2]=[h("确定并设计")]))),_:1,__:[2]},8,["loading"])])),default:g((()=>[u(f(t),{onRegister:f(M)},null,8,["onRegister"])])),_:1},16,["onRegister","title"])}}});export{_};
