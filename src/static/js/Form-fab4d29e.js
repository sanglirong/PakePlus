import{b as e,B as t}from"./index-143f5813.js";import{u as s,B as i}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{d as a,ad as o,a0 as r,u as n,o as p,p as m,l as u,j as c,k as l,g as d,F as _,h as j,a4 as g,t as v,m as f,V as y,ah as h,a5 as x}from"./index-920db443.js";import{h as T,s as k,i as F}from"./table-3a9e3e55.js";import{T as b,a as L}from"./index-0be8277c.js";import"./useWindowSizeFn-05f906e2.js";import"./log-2a5f2c26.js";import"./useTabs-ceeccdba.js";import"./upperFirst-2cd1a2f7.js";import"./uniqBy-e868edd7.js";import"./visualDev-8f54ab4b.js";import"./index.vue_vue_type_script_setup_true_lang-69353133.js";import"./index-9c138ba5.js";import"./ArrowLeftOutlined-3fbf15bc.js";import"./index-999abbee.js";import"./Parser.vue_vue_type_script_setup_true_lang-6ddfe448.js";import"./Item.vue_vue_type_script_setup_true_lang-fef56f78.js";import"./Form.vue_vue_type_script_setup_true_lang-63005a4d.js";import"./createAsyncComponent-7e8f72ac.js";import"./DataLogList.vue_vue_type_script_setup_true_lang-c225eb8c.js";import"./jquery-6353a699.js";import"./useDefineSetting-7df030ff.js";import"./CustomForm.vue_vue_type_script_setup_true_lang-1aa664f4.js";import"./config-06ca91cd.js";const w={class:"timeline-content"},O={class:"text"},C={class:"time"},B=["onClick"],R=x(a({__name:"Form",emits:["register","reload"],setup(a,{emit:x}){const R=o({id:"",activities:[]}),{activities:q}=r(R),D=x,{t:I}=n(),{createMessage:J,createConfirm:M}=h(),[P,{validate:S,resetFields:A,updateSchema:z}]=s({labelWidth:0,schemas:[{field:"text",label:" ",component:"Textarea",componentProps:{placeholder:"请输入",rows:3},rules:[{required:!0,trigger:"blur",message:"必填"}]}]}),[N,{changeLoading:W,changeOkLoading:E}]=e(G);function G(e){A(),R.id=e.id,e.industryTypeList&&z({field:"projectType",componentProps:{options:e.industryTypeList}}),R.id&&(W(!0),T(R.id).then((e=>{R.activities=e.data.postilJson?JSON.parse(e.data.postilJson):[],W(!1)})))}async function H(){const e=await S();e&&(E(!0),k(R.id,e).then((e=>{J.success(e.msg),E(!1),G({id:R.id}),D("reload")})).catch((()=>{E(!1)})))}return(e,s)=>(p(),m(l(t),y(e.$attrs,{onRegister:l(N),title:"添加批注",showOkBtn:"",okText:"发送",onOk:H}),{default:u((()=>[c(l(i),{onRegister:l(P),hideRequiredMark:!0},null,8,["onRegister"]),c(l(b),{class:"!pt-5px"},{default:u((()=>[(p(!0),d(_,null,j(l(q),((e,t)=>(p(),m(l(L),{key:t},{default:u((()=>[g("div",w,[g("p",O,v(e.text),1),g("p",C,[g("span",null,v(e.userId)+" 提交于 "+v(e.creatorTime),1),g("span",{class:"del",onClick:e=>function(e){M({iconType:"warning",title:I("common.tipTitle"),content:I("common.tipTitle"),onOk:()=>{F(R.id,e).then((t=>{R.activities.splice(e,1),J.success(t.msg),D("reload")}))}})}(t)},s[0]||(s[0]=[g("i",{class:"icon-ym icon-ym-delete"},null,-1),f("删除")]),8,B)])])])),_:2},1024)))),128))])),_:1})])),_:1},16,["onRegister"]))}}),[["__scopeId","data-v-e87bb7ff"]]);export{R as default};
