import{a as e,B as a}from"./index-9c138ba5.js";import{g as l}from"./msgTemplate-ce5c0fa7.js";import{u as t,B as s}from"./useTable-dc8c9d84.js";import{d,ad as i,a0 as n,r as o,u as r,aD as m,M as p,e as u,o as c,p as f,l as y,j as g,k,a4 as x,t as h,ae as T,g as _,q as b,m as L,F as C,V as w}from"./index-920db443.js";const F={class:"parameter-box"},S={class:"left-pane"},v={class:"left-pane-list"},I={class:"list"},N={class:"search-box"},M=["title"],D=["title"],V={key:0,class:"right-pane"},R=["innerHTML"],j={key:1,class:"right-pane"},A={class:"msg-pane"},H={class:"list"},P={key:0},U={key:1},B=d({__name:"Detail",setup(d){const B=i({dataForm:{id:"",fullName:"",enCode:"",templateType:0,messageType:"",messageSource:"",enabledMark:1,sortCode:0,description:"",title:"",content:"",templateCode:"",wxSkip:"1",xcxAppId:""},parameterList:[],allParameterList:[],smsList:[],messageTypeList:[],messageSourceList:[],keyword:""}),{dataForm:E,keyword:q,parameterList:z,smsList:O}=n(B),$=o(),{t:G}=r(),J=m(),[K,{changeLoading:Q}]=e((async function(e){$.value?.resetFields(),B.dataForm={id:"",fullName:"",enCode:"",templateType:0,messageType:"",messageSource:"",enabledMark:1,sortCode:0,description:"",title:"",content:"",templateCode:"",wxSkip:1,xcxAppId:""},void(B.smsList=[]),B.dataForm.id=e.id||"",B.messageTypeList=e.msgTypeList||[],B.dataForm.id&&(Q(!0),B.messageSourceList=await J.getDictionaryData("msgSourceType"),B.messageSourceList.map((e=>e.id=e.enCode)),l(B.dataForm.id).then((e=>{Q(!1),e.data.smsFieldList.map((e=>{e.isTitle=!!e.isTitle})),B.dataForm=e.data,B.parameterList=e.data.templateParamList,B.allParameterList=B.parameterList,B.smsList=e.data.smsFieldList;const a=B.messageSourceList.find((e=>e.enCode==B.dataForm.messageSource)),l=B.messageTypeList.find((e=>e.enCode==B.dataForm.messageType));a&&(B.dataForm.messageSourceVal=a.fullName),l&&(B.dataForm.messageTypeVal=l.fullName)})).catch((()=>{Q(!1)})))})),[W]=t({columns:[{title:"参数名称",dataIndex:"field",key:"field",width:170},{title:"参数说明",dataIndex:"fieldName",key:"fieldName",width:170}],useSearchForm:!1,showTableSetting:!1,pagination:!1,showHeader:!1,showIndexColumn:!1,scroll:{y:327}}),X=p((()=>{const e=[{title:"序号",dataIndex:"index",key:"index",align:"center",width:50,customRender:({index:e})=>e+1},{title:"变量",dataIndex:"smsField",key:"smsField",helpMessage:["阿里云：在【阿里云管理后台-模板管理】维护模板变量参数","腾讯云：在【腾讯云管理后台-正⽂模板管理】维护模板变量参数"]},{title:"参数",dataIndex:"field",key:"field",width:200},{title:"标题",dataIndex:"isTitle",key:"isTitle",width:70,align:"center"}];let a=[];return 3==B.dataForm.messageType?a=e.filter((e=>"isTitle"!=e.key)):(a=e,a[1].helpMessage="在【微信公众号管理后台-广告与服务-模板消息】维护模板参数"),a}));function Y(){B.parameterList=B.allParameterList.filter((e=>{if(e.field.toLowerCase().includes(B.keyword.toLowerCase())||e.fieldName.toLowerCase().includes(B.keyword.toLowerCase()))return e}))}return(e,l)=>{const t=u("a-form-item"),d=u("a-col"),i=u("a-switch"),n=u("a-input-search"),o=u("BasicHelp"),r=u("a-row"),m=u("a-checkbox"),p=u("a-table"),B=u("a-form");return c(),f(k(a),w(e.$attrs,{onRegister:k(K),title:k(G)("common.detailText"),"destroy-on-close":""}),{default:y((()=>[g(B,{class:"!mx-20px",colon:!1,model:k(E),ref_key:"formElRef",ref:$,labelCol:{style:{width:"100px"}}},{default:y((()=>[g(r,{gutter:20},{default:y((()=>[g(d,{span:12},{default:y((()=>[g(t,{label:"名称",name:"fullName"},{default:y((()=>[x("p",null,h(k(E).fullName),1)])),_:1})])),_:1}),g(d,{span:12},{default:y((()=>[g(t,{label:"编码",name:"enCode"},{default:y((()=>[x("p",null,h(k(E).enCode),1)])),_:1})])),_:1}),g(d,{span:12},{default:y((()=>[g(t,{label:"模板类型"},{default:y((()=>[x("p",null,h("0"==k(E).templateType?"自定义模板":"系统模板"),1)])),_:1})])),_:1}),g(d,{span:12},{default:y((()=>[g(t,{label:"消息来源",name:"messageSource"},{default:y((()=>[x("p",null,h(k(E).messageSourceVal),1)])),_:1})])),_:1}),g(d,{span:12},{default:y((()=>[g(t,{label:"消息类型",name:"messageType"},{default:y((()=>[x("p",null,h(k(E).messageTypeVal),1)])),_:1})])),_:1}),g(d,{span:12},{default:y((()=>[g(t,{label:"状态",name:"enabledMark"},{default:y((()=>[g(i,{checked:k(E).enabledMark,"onUpdate:checked":l[0]||(l[0]=e=>k(E).enabledMark=e),checkedValue:1,unCheckedValue:0,disabled:""},null,8,["checked"])])),_:1})])),_:1}),g(d,{span:12},{default:y((()=>[g(t,{label:"排序",name:"sortCode"},{default:y((()=>[x("p",null,h(k(E).sortCode),1)])),_:1})])),_:1}),g(d,{span:24},{default:y((()=>[g(t,{label:"说明",name:"description"},{default:y((()=>[x("p",null,h(k(E).description),1)])),_:1})])),_:1}),g(d,{span:24},{default:y((()=>[x("div",F,[x("div",S,[x("div",v,[x("div",I,[l[2]||(l[2]=x("div",{class:"header detail-header"},[x("span",null,"参数名称"),x("span",null,"参数说明")],-1)),x("div",N,[g(n,{class:"search",value:k(q),"onUpdate:value":l[1]||(l[1]=e=>T(q)?q.value=e:null),placeholder:"输入关键字",allowClear:"",onInput:Y},null,8,["value"])]),g(k(s),{onRegister:k(W),"data-source":k(z)},{bodyCell:y((({column:e,record:a})=>["field"===e.key?(c(),_("span",{key:0,class:"cursor-pointer",title:a.field},h(a.field),9,M)):b("",!0),"fieldName"===e.key?(c(),_("span",{key:1,class:"cursor-pointer",title:a.fieldName},h(a.fieldName),9,D)):b("",!0)])),_:1},8,["onRegister","data-source"])])])]),3!=k(E).messageType&&7!=k(E).messageType?(c(),_("div",V,[g(t,{name:"title"},{label:y((()=>[l[3]||(l[3]=L("消息标题")),g(o,{text:"参数格式：{参数名}"})])),default:y((()=>[x("p",null,h(k(E).title),1)])),_:1}),2==k(E).messageType?(c(),f(t,{key:0,name:"content"},{label:y((()=>[l[4]||(l[4]=L("消息内容")),g(o,{text:"参数格式：{参数名}"})])),default:y((()=>[x("p",{innerHTML:k(E).content},null,8,R)])),_:1})):1!=k(E).messageType?(c(),f(t,{key:1,name:"content"},{label:y((()=>[l[5]||(l[5]=L("消息内容")),g(o,{text:"参数格式：{参数名}"})])),default:y((()=>[x("p",null,h(k(E).content),1)])),_:1})):b("",!0)])):(c(),_("div",j,[g(r,{gutter:20},{default:y((()=>[g(d,{span:12},{default:y((()=>[g(t,{name:"templateCode"},{label:y((()=>[l[6]||(l[6]=L(" 模板编号 ")),g(o,{text:3==k(E).messageType?["阿里云：请在【阿里云管理后台-模板管理】⻚⾯查看模板CODE","腾讯云：请在【腾讯云管理后台-正⽂模板管理】⻚⾯查看模板ID"]:"在【微信公众号管理后台-广告与服务-模板消息】⻚⾯查看模板ID"},null,8,["text"])])),default:y((()=>[x("p",null,h(k(E).templateCode),1)])),_:1})])),_:1}),g(d,{span:12,offset:"12"}),7==k(E).messageType?(c(),f(d,{key:0,span:12},{default:y((()=>[g(t,{label:"跳转方式",name:"wxSkip"},{default:y((()=>[x("p",null,h(1==k(E).wxSkip?"小程序":"页面"),1)])),_:1})])),_:1})):b("",!0),7==k(E).messageType&&1==k(E).wxSkip?(c(),f(d,{key:1,span:12},{default:y((()=>[g(t,{name:"xcxAppId"},{label:y((()=>[l[7]||(l[7]=L("消息内容")),g(o,{text:"请在【微信公众号管理后台-广告与服务-小程序管理】⻚⾯查看小程序ID"})])),default:y((()=>[x("p",null,h(k(E).xcxAppId),1)])),_:1})])),_:1})):b("",!0)])),_:1}),x("div",A,[x("div",H,[g(p,{"data-source":k(O),columns:X.value,size:"small",pagination:!1},{headerCell:y((({column:e})=>["smsField"===e.key?(c(),_(C,{key:0},[x("span",null,h(e.title),1),g(o,{text:e.helpMessage},null,8,["text"])],64)):b("",!0)])),bodyCell:y((({column:e,record:a})=>["smsField"===e.key?(c(),_("p",P,h(a.smsField),1)):b("",!0),"field"===e.key?(c(),_("p",U,h(a.field),1)):b("",!0),"isTitle"===e.key?(c(),f(m,{key:2,checked:a.isTitle,"onUpdate:checked":e=>a.isTitle=e,disabled:""},null,8,["checked","onUpdate:checked"])):b("",!0)])),_:1},8,["data-source","columns"])])])]))])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},16,["onRegister","title"])}}});export{B as _};
