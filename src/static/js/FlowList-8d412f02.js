import{d as e,ad as t,a0 as s,aD as o,u as a,r as i,w as n,a7 as l,e as r,a9 as c,o as u,g as p,j as m,l as d,p as y,q as g,F as f,h as _,k as w,ae as v,a4 as j,i as k,am as b,af as h,t as F,cl as x,ab as C,n as L,ah as P,a5 as B}from"./index-920db443.js";import{A as S,a as D}from"./template-c6142676.js";import{u as E,B as A}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import"./useTabs-ceeccdba.js";import"./upperFirst-2cd1a2f7.js";import"./log-2a5f2c26.js";import"./uniqBy-e868edd7.js";import"./index-143f5813.js";import"./useWindowSizeFn-05f906e2.js";import"./visualDev-8f54ab4b.js";import"./index.vue_vue_type_script_setup_true_lang-69353133.js";import"./index-9c138ba5.js";import"./ArrowLeftOutlined-3fbf15bc.js";import"./index-999abbee.js";import"./Parser.vue_vue_type_script_setup_true_lang-6ddfe448.js";import"./Item.vue_vue_type_script_setup_true_lang-fef56f78.js";import"./Form.vue_vue_type_script_setup_true_lang-63005a4d.js";import"./createAsyncComponent-7e8f72ac.js";import"./DataLogList.vue_vue_type_script_setup_true_lang-c225eb8c.js";import"./index-0be8277c.js";import"./jquery-6353a699.js";import"./useDefineSetting-7df030ff.js";import"./CustomForm.vue_vue_type_script_setup_true_lang-1aa664f4.js";import"./config-06ca91cd.js";const Q={class:"flow-list-container"},T={class:"flow-list"},U={class:"jnpf-common-search-box"},z={class:"list"},K={key:0,class:"px-10px pt-10px"},I={class:"item-title"},N=["onClick"],q=B(e({__name:"FlowList",props:{isEntrust:{type:Boolean,default:!1},delegateUser:{type:String,default:""},flowType:{type:Number,default:0}},emits:["select"],setup(e,{emit:B}){const q=e,H=B,M=t({category:"",categoryList:[],list:[],listQuery:{currentPage:1,pageSize:50,sort:"desc",sidx:""},keyword:"",loading:!1,finish:!1,total:0,flowList:[],userList:[],activeFlow:{}}),{category:O,categoryList:R,list:G,listQuery:W,loading:J}=s(M),V=o(),{createMessage:X}=P(),{t:Y}=a(),[Z,{resetFields:$}]=E({baseColProps:{span:6},showActionButtonGroup:!0,showAdvancedButton:!0,compact:!0,schemas:[{field:"keyword",label:Y("common.keyword"),component:"Input",componentProps:{placeholder:Y("common.enterKeyword"),submitOnPressEnter:!0}}]}),ee=i(null);function te(){M.loading=!0;let e={...M.listQuery,keyword:M.keyword,category:M.category,flowType:q.flowType||0,isLaunch:1};q.isEntrust&&(e.delegateUser=q.delegateUser);D(e).then((e=>{e.data.list.length<M.listQuery.pageSize&&(M.finish=!0),M.list=[...M.list,...e.data.list],M.total=e.data.pagination.total,M.loading=!1}))}async function se(){const e=await V.getDictionaryData("businessType");M.categoryList=e,te(),L((()=>{!function(){const e=ee.value,t=e?.getScrollWrap();t?.addEventListener("scroll",(()=>{t.scrollHeight-t.clientHeight-t.scrollTop<=200&&!M.loading&&!M.finish&&(M.listQuery.currentPage+=1,te())}))}()}))}function oe(e){M.loading||(M.keyword=e?.keyword||"",ie())}function ae(){M.loading||(M.keyword="",ie())}function ie(){M.list=[],M.finish=!1,M.listQuery={currentPage:1,pageSize:50,sort:"desc",sidx:""},te()}function ne(e){if(!e.id)return X.error("流程不存在");!function(e){e.delegateUser=q.delegateUser,H("select",e)}(e)}return n((()=>M.category),(()=>{$()})),l((()=>{se()})),(t,s)=>{const o=r("a-tab-pane"),a=r("a-tabs"),i=r("a-tooltip"),n=r("a-card"),l=r("a-col"),L=r("a-row"),P=r("jnpf-empty"),B=c("loading");return u(),p("div",Q,[m(a,{activeKey:w(O),"onUpdate:activeKey":s[0]||(s[0]=e=>v(O)?O.value=e:null),"tab-position":"left",class:"common-left-tabs flow-left-tabs"},{default:d((()=>[m(o,{key:"",tab:"全部流程"}),e.isEntrust?g("",!0):(u(),y(o,{key:"commonFlow",tab:"常用流程"})),(u(!0),p(f,null,_(w(R),(e=>(u(),y(o,{key:e.id,tab:e.fullName},null,8,["tab"])))),128))])),_:1},8,["activeKey"]),j("div",T,[j("div",U,[m(w(A),{class:"search-form",onRegister:w(Z),onSubmit:oe,onReset:ae},null,8,["onRegister"])]),j("div",z,[k((u(),y(w(C),{ref_key:"infiniteBody",ref:ee},{default:d((()=>[w(G).length?(u(),p("div",K,[m(L,{gutter:20},{default:d((()=>[(u(!0),p(f,null,_(w(G),((t,s)=>(u(),y(l,{span:6,key:s,class:"item",onClick:e=>ne(t)},{default:d((()=>[m(n,{hoverable:""},{default:d((()=>[j("div",{class:"item-icon",style:b({backgroundColor:t.iconBackground||"#008cff"})},[j("i",{class:h(t.icon||"icon-ym icon-ym-funcFlow")},null,2)],4),j("span",I,F(t.fullName),1),e.isEntrust?g("",!0):(u(),y(i,{key:0,placement:"bottom",title:t.isCommonFlow?"移除常用流程":"设置常用流程"},{default:d((()=>[j("div",{class:"item-star",onClick:x((e=>function(e,t){S(e.id).then((s=>{X.success(s.msg),e.isCommonFlow=!e.isCommonFlow,"commonFlow"!=M.category||e.isCommonFlow||M.list.splice(t,1)}))}(t,s)),["stop"])},[j("i",{class:h(["icon-ym icon-ym-header-star-fill",{"common-flow":t.isCommonFlow}])},null,2)],8,N)])),_:2},1032,["title"]))])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])):g("",!0),w(G).length?g("",!0):(u(),y(P,{key:1}))])),_:1})),[[B,w(J)&&1===w(W).currentPage]])])])])}}}),[["__scopeId","data-v-eaa84adb"]]);export{q as default};
