import{j as e,ar as t,bh as n,hF as s,hG as a,ao as o,d as l,bv as i,T as r,M as u,u as c,a5 as d,o as m,g as p,af as g,q as h,m as f,t as y,bA as v,e as b,p as C,l as w,V as S,aS as M,F as T,h as k,dB as _,k as I,aF as L,aU as x,hH as O,hI as N,r as E,ad as P,a0 as R,aB as A,hJ as D,hK as H,w as F,hL as j,hM as B,Z as U,aJ as z,aI as Q,a1 as W,aj as J,K as $,a7 as G,n as K,hN as V,aL as q,bt as Y,cl as Z,am as X,hO as ee,bc as te,s as ne,I as se,b1 as ae,bo as oe,a4 as le,i as ie,v as re,aT as ue,dl as ce,aY as de,dC as me,fQ as pe,hP as ge,bZ as he,hQ as fe,hR as ye,hS as ve,hT as be,e5 as Ce,an as we,L as Se,ab as Me,hU as Te,dp as ke,bC as _e,hV as Ie,ac as Le,bF as xe,a6 as Oe,aw as Ne,dD as Ee,hW as Pe,ah as Re,co as Ae,ae as De,ay as He,dv as Fe,hX as je,hY as Be,hZ as Ue,ag as ze,eF as Qe,di as We,aE as Je,aD as $e,bN as Ge,h_ as Ke,az as Ve,er as qe,aN as Ye,ef as Ze,aH as Xe,bl as et,dz as tt,eh as nt,h$ as st,i0 as at,i1 as ot,i2 as lt,i3 as it,i4 as rt,b$ as ut,i5 as ct,aa as dt,i6 as mt,a9 as pt,i7 as gt,bb as ht,aR as ft,bg as yt,i8 as vt,i9 as bt,ce as Ct,bM as wt,bB as St,ia as Mt,a8 as Tt,e0 as kt}from"./index-920db443.js";import{c as _t}from"./createAsyncComponent-7e8f72ac.js";import{a as It,B as Lt,u as xt}from"./index-999abbee.js";import{h as Ot,i as Nt,j as Et,g as Pt,k as Rt,r as At}from"./message-22b8b6a8.js";import{e as Dt}from"./emoji-a68b5251.js";import{B as Ht}from"./index-1cfe4e28.js";import{u as Ft,b as jt,B as Bt}from"./index-143f5813.js";import Ut from"./Detail-4e2b49fe.js";import{_ as zt}from"./Detail.vue_vue_type_script_setup_true_lang-645a467a.js";import{g as Qt}from"./schedule-74da51ff.js";import{C as Wt}from"./CopyOutlined-8d46c8b2.js";import{F as Jt,u as $t,a as Gt}from"./index-e1b7f8ad.js";import{u as Kt}from"./uniqBy-e868edd7.js";import{u as Vt}from"./useTabs-ceeccdba.js";import{u as qt}from"./lock-efa36e19.js";const Yt={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(t){Xt(e,t,n[t])}))}return e}function Xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var en=function(n,s){var a=Zt({},n,s.attrs);return e(t,Zt({},a,{icon:Yt}),null)};en.displayName="ExportOutlined",en.inheritAttrs=!1;const tn=en;const nn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"};function sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(t){an(e,t,n[t])}))}return e}function an(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var on=function(n,s){var a=sn({},n,s.attrs);return e(t,sn({},a,{icon:nn}),null)};on.displayName="MenuFoldOutlined",on.inheritAttrs=!1;const ln=on;const rn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(t){cn(e,t,n[t])}))}return e}function cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dn=function(n,s){var a=un({},n,s.attrs);return e(t,un({},a,{icon:rn}),null)};dn.displayName="MenuUnfoldOutlined",dn.inheritAttrs=!1;const mn=dn;const pn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(t){hn(e,t,n[t])}))}return e}function hn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fn=function(n,s){var a=gn({},n,s.attrs);return e(t,gn({},a,{icon:pn}),null)};fn.displayName="MessageOutlined",fn.inheritAttrs=!1;const yn=fn;const vn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(t){Cn(e,t,n[t])}))}return e}function Cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wn=function(n,s){var a=bn({},n,s.attrs);return e(t,bn({},a,{icon:vn}),null)};wn.displayName="SyncOutlined",wn.inheritAttrs=!1;const Sn=wn,Mn={items:{type:Array,default:()=>[]},collapsedShowTitle:n.bool,inlineIndent:n.number.def(20),mode:{type:String,default:s.INLINE},type:{type:String,default:a.MIX},theme:{type:String,default:o.DARK},inlineCollapsed:n.bool,mixSider:n.bool,isHorizontal:n.bool,accordion:n.bool.def(!0),beforeClickFn:{type:Function}},Tn={item:{type:Object,default:()=>({})},level:n.number,theme:n.oneOf(["dark","light"]),showTitle:n.bool,isHorizontal:n.bool},kn={item:{type:Object,default:null},showTitle:n.bool.def(!0),level:n.number.def(0),isHorizontal:n.bool.def(!0)},{t:_n}=c(),In=l({name:"MenuItemContent",components:{Icon:i},props:kn,setup(e){const{prefixCls:t}=r("basic-menu-item-content");return{prefixCls:t,getI18nName:u((()=>_n("routes."+e.item?.enCode.replace(/\./g,"-"),e.item?.fullName))),getIcon:u((()=>e.item?.icon))}}}),Ln=["title"];const xn=d(In,[["render",function(e,t,n,s,a,o){return m(),p("span",{class:g(`${e.prefixCls}- flex items-center `),title:e.getI18nName},[e.getIcon?(m(),p("span",{key:0,class:g(`${e.prefixCls}-wrapper__icon mr-2 ${e.getIcon}`)},null,2)):h("",!0),f(" "+y(e.getI18nName),1)],10,Ln)}]]),On=l({name:"BasicMenuItem",components:{MenuItem:v.Item,MenuItemContent:xn},props:Tn,setup:()=>({})});const Nn=l({name:"BasicSubMenuItem",isSubMenu:!0,components:{BasicMenuItem:d(On,[["render",function(t,n,s,a,o,l){const i=b("MenuItemContent"),r=b("MenuItem");return m(),C(r,{key:t.item.path},{default:w((()=>[e(i,S(t.$props,{item:t.item}),null,16,["item"])])),_:1})}]]),SubMenu:v.SubMenu,MenuItemContent:xn},props:Tn,setup(e){const{prefixCls:t}=r("basic-menu-item");return{prefixCls:t,menuHasChildren:function(e){return!e.meta?.hideChildrenInMenu&&Reflect.has(e,"children")&&!!e.children&&e.children.length>0},getShowMenu:u((()=>!e.item.meta?.hideMenu))}}});const En=d(l({name:"BasicMenu",components:{Menu:v,BasicSubMenuItem:d(Nn,[["render",function(t,n,s,a,o,l){const i=b("BasicMenuItem"),r=b("MenuItemContent"),u=b("BasicSubMenuItem",!0),c=b("SubMenu");return m(),p(T,null,[!t.menuHasChildren(t.item)&&t.getShowMenu?(m(),C(i,M(S({key:0},t.$props)),null,16)):h("",!0),t.menuHasChildren(t.item)&&t.getShowMenu?(m(),C(c,{class:g([t.theme]),key:`submenu-${t.item.path}`,popupClassName:"app-top-menu-popup"},{title:w((()=>[e(r,S(t.$props,{item:t.item}),null,16,["item"])])),default:w((()=>[(m(!0),p(T,null,k(t.item.children||[],(e=>(m(),C(u,S({key:e.path,ref_for:!0},t.$props,{item:e}),null,16,["item"])))),128))])),_:1},8,["class"])):h("",!0)],64)}]])},props:Mn,emits:["menuClick"],setup(e,{emit:t}){const n=E(!1),o=E(""),l=P({defaultSelectedKeys:[],openKeys:[],selectedKeys:[],collapsedOpenKeys:[]}),{prefixCls:i}=r("basic-menu"),{items:c,mode:d,accordion:m}=R(e),{getCollapsed:p,getTopMenuAlign:g,getSplit:h}=_(),{currentRoute:f}=A(),{handleOpenChange:y,setOpenKeys:v,getOpenKeys:b}=function(e,t,n,a){const{getCollapsed:o,getIsMixSidebar:l}=_();return{setOpenKeys:async function(o){if(n.value===s.HORIZONTAL)return;const i=I(l);L((()=>{const n=x(t.value);0!==n?.length?I(a)?e.openKeys=N(n,o):e.openKeys=O([...e.openKeys,...N(n,o)]):e.openKeys=[]}),16,!i)},resetKeys:function(){e.selectedKeys=[],e.openKeys=[]},getOpenKeys:u((()=>!I(l)&&I(o)?e.collapsedOpenKeys:e.openKeys)),handleOpenChange:function(i){if(I(n)===s.HORIZONTAL||!I(a)||I(l))e.openKeys=i;else{const n=[];for(const{children:e,path:s}of I(t))e&&e.length>0&&n.push(s);if(I(o))e.collapsedOpenKeys=i;else{const t=i.find((t=>-1===e.openKeys.indexOf(t)));-1===n.indexOf(t)?e.openKeys=i:e.openKeys=t?[t]:[]}}}}}(l,c,d,m),C=u((()=>{const{type:t,mode:n}=e;return t===a.TOP_MENU&&n===s.HORIZONTAL||e.isHorizontal&&I(h)})),w=u((()=>{const t=e.isHorizontal&&I(h)?"start":I(g);return[i,`justify-${t}`,{[`${i}__second`]:!e.isHorizontal&&I(h),[`${i}__sidebar-hor`]:I(C)}]})),S=u((()=>{const t={};return e.mode===s.INLINE&&(t.inlineCollapsed=!e.mixSider&&I(p)),t}));async function M(t){if(I(n))return void(n.value=!1);const s=(t||I(f)).meta?.currentActiveMenu||(t||I(f)).path;if(v(s),!I(o))if(e.isHorizontal&&I(h)){const e=await j(s);l.selectedKeys=[e]}else{const t=await N(e.items,s);l.selectedKeys=t}}return D((e=>{e.name!==H&&(M(e),o.value=e.meta?.currentActiveMenu,I(o)&&(l.selectedKeys=[I(o)],v(I(o))))})),!e.mixSider&&F((()=>e.items),(()=>{M()})),{handleMenuClick:async function({key:s}){let a=s,o=(await B()).filter((e=>e.path===s&&1===e.type));const i=e=>{if(e.length){let t=e[0];t.children?.length&&(1!=t.children[0].type?a=t.children[0].path:i(t.children))}};i(o);const{beforeClickFn:r}=e;if(r&&U(r)){if(!(await r(a)))return}t("menuClick",a),n.value=!0,l.selectedKeys=[s]},getInlineCollapseOptions:S,getMenuClass:w,handleOpenChange:y,getOpenKeys:b,...R(l)}}}),[["render",function(e,t,n,s,a,o){const l=b("BasicSubMenuItem"),i=b("Menu");return m(),C(i,S({selectedKeys:e.selectedKeys,defaultSelectedKeys:e.defaultSelectedKeys,mode:e.mode,openKeys:e.getOpenKeys,inlineIndent:e.inlineIndent,theme:e.theme,onOpenChange:e.handleOpenChange,class:e.getMenuClass,onClick:e.handleMenuClick,subMenuOpenDelay:.2},e.getInlineCollapseOptions),{default:w((()=>[(m(!0),p(T,null,k(e.items,(t=>(m(),C(l,{key:t.path,item:t,theme:e.theme,isHorizontal:e.isHorizontal},null,8,["item","theme","isHorizontal"])))),128))])),_:1},16,["selectedKeys","defaultSelectedKeys","mode","openKeys","inlineIndent","theme","onOpenChange","class","onClick"])}]]),Pn=Symbol();function Rn(){return Q(Pn)}const An=d(l({name:"Menu",props:{theme:n.oneOf(["light","dark"]).def("light"),activeName:n.oneOfType([n.string,n.number]),openNames:{type:Array,default:()=>[]},accordion:n.bool.def(!0),width:n.string.def("100%"),collapsedWidth:n.string.def("48px"),indentSize:n.number.def(16),collapse:n.bool.def(!0),activeSubMenuNames:{type:Array,default:()=>[]}},emits:["select","open-change"],setup(e,{emit:t}){const n=V(),s=W(),a=E(""),o=E([]),{prefixCls:l}=r("menu"),i=E(!1);z({rootMenuEmitter:n,activeName:a},Pn,{readonly:!1,native:!0});const c=u((()=>{const{theme:t}=e;return[l,`${l}-${t}`,`${l}-vertical`,{[`${l}-collapse`]:e.collapse}]}));function d(){n.emit("on-update-opened",o.value)}function m(){o.value=[],d()}return J((()=>{o.value=e.openNames})),J((()=>{e.activeName&&(a.value=e.activeName)})),F((()=>e.openNames),(()=>{K((()=>{d()}))})),$(`subMenu:${s?.uid}`,{addSubMenu:function(e){o.value.includes(e)||(o.value.push(e),d())},removeSubMenu:function(e){o.value=o.value.filter((t=>t!==e)),d()},getOpenNames:()=>o.value,removeAll:m,isRemoveAllPopup:i,sliceIndex:function(e){-1!==e&&(o.value=o.value.slice(0,e+1),d())},level:0,props:e}),G((()=>{o.value=e.collapse?[]:[...e.openNames],d(),n.on("on-menu-item-select",(n=>{const{name:s,item:o}=n;a.value=s,K((()=>{e.collapse&&m()})),1!==o.type&&t("select",s)})),n.on("open-name-change",(({name:e,opened:t})=>{if(t&&!o.value.includes(e))o.value.push(e);else if(!t){const t=o.value.findIndex((t=>t===e));-1!==t&&o.value.splice(t,1)}}))})),{getClass:c,openedNames:o}}}),[["render",function(e,t,n,s,a,o){return m(),p("ul",{class:g(e.getClass)},[q(e.$slots,"default")],2)}]]);function Dn(e){const t=u((()=>o(["Menu","SubMenu"]))),n=u((()=>o(["Menu"]))),s=u((()=>o(["SubMenu"]))),a=u((()=>{let t=e?.parent;if(!t)return{};const s=I(n)?.props.indentSize??20;let a=s;if(I(n)?.props.collapse)a=s;else for(;t&&"Menu"!==t.type.name;)"SubMenu"===t.type.name&&(a+=s),t=t.parent;return{paddingLeft:a+"px"}}));function o(t){let n=e?.parent;if(!n)return null;for(;n&&-1===t.indexOf(n.type.name);)n=n.parent;return n}return{getParentMenu:t,getParentInstance:function(e,t="SubMenu"){let n=e.parent;for(;n;){if(n.type.name!==t)return n;n=n.parent}return n},getParentRootMenu:n,getParentList:function(){let t=e;if(!t)return{uidList:[],list:[]};const n=[];for(;t&&"Menu"!==t.type.name;)"SubMenu"===t.type.name&&n.push(t),t=t.parent;return{uidList:n.map((e=>e.uid)),list:n}},getParentSubMenu:s,getItemStyle:a}}const Hn=d(l({name:"MenuItem",components:{Tooltip:Y},props:{name:{type:[String,Number],required:!0},disabled:n.bool,item:{type:Object,default:()=>({})}},setup(e,{slots:t}){const n=W(),s=E(!1),{getItemStyle:a,getParentList:o,getParentMenu:l,getParentRootMenu:i}=Dn(n),{prefixCls:c}=r("menu"),{rootMenuEmitter:d,activeName:m}=Rn(),p=u((()=>[`${c}-item`,{[`${c}-item-active`]:I(s),[`${c}-item-selected`]:I(s),[`${c}-item-disabled`]:!!e.disabled}])),g=u((()=>I(i)?.props.collapse)),h=u((()=>"Menu"===I(l)?.type.name&&I(g)&&t.title));return F((()=>m.value),(t=>{if(t===e.name){const{list:e,uidList:t}=o();s.value=!0,e.forEach((e=>{e.proxy&&(e.proxy.active=!0)})),d.emit("on-update-active-name:submenu",t)}else s.value=!1}),{immediate:!0}),{getClass:p,prefixCls:c,getItemStyle:a,getCollapse:g,handleClickItem:function(){const{disabled:t,item:s}=e;if(t)return;if(d.emit("on-menu-item-select",{name:e.name,item:s}),I(g))return;const{uidList:a}=o();d.emit("on-update-opened",{opend:!1,parent:n?.parent,uidList:a})},showTooptip:h}}}),[["render",function(e,t,n,s,a,o){return m(),p("li",{class:g(e.getClass),onClick:t[0]||(t[0]=Z(((...t)=>e.handleClickItem&&e.handleClickItem(...t)),["stop"])),style:X(e.getCollapse?{}:e.getItemStyle)},[e.showTooptip?(m(),p("div",{key:0,class:g(`${e.prefixCls}-tooltip`)},[q(e.$slots,"default")],2)):(m(),p(T,{key:1},[q(e.$slots,"default"),q(e.$slots,"title")],64))],6)}]]),Fn=l({name:"SubMenu",components:{Icon:i,CollapseTransition:ee,Popover:te},props:{name:{type:[String,Number],required:!0},disabled:n.bool,collapsedShowTitle:n.bool},setup(e){const t=W(),n=P({active:!1,opened:!1}),s=P({timeout:null,mouseInChild:!1,isChild:!1}),{getParentSubMenu:a,getItemStyle:o,getParentMenu:l,getParentList:i}=Dn(t),{prefixCls:c}=r("menu"),d=V(),{rootMenuEmitter:m}=Rn(),{addSubMenu:p,removeSubMenu:g,removeAll:h,getOpenNames:f,isRemoveAllPopup:y,sliceIndex:v,level:b,props:C,handleMouseleave:w}=ne(`subMenu:${l.value?.uid}`),S=u((()=>[`${c}-submenu`,{[`${c}-item-active`]:n.active,[`${c}-opened`]:n.opened,[`${c}-submenu-disabled`]:e.disabled,[`${c}-submenu-has-parent-submenu`]:I(a),[`${c}-child-item-active`]:n.active}])),M=u((()=>C.accordion)),T=u((()=>C.collapse)),k=u((()=>C.theme)),_=u((()=>({minWidth:"200px"}))),L=u((()=>{const t=e.name;return I(T)?f().includes(t):n.opened})),x=u((()=>{const t=C.activeSubMenuNames.includes(e.name);return[`${c}-submenu-title`,{[`${c}-submenu-active`]:t,[`${c}-submenu-active-border`]:t&&0===b,[`${c}-submenu-collapse`]:I(T)&&0===b}]}));function O(){if(e.disabled)return;d.emit("submenu:mouse-enter-child");const t=f().findIndex((t=>t===e.name));v(t);0===b&&2===f().length&&h(),s.isChild=f().includes(e.name),clearTimeout(s.timeout),s.timeout=setTimeout((()=>{p(e.name)}),200)}function N(t=!1){const n=l.value?.props.name;n||(y.value=!0),f().slice(-1)[0]===e.name&&(s.isChild=!1),d.emit("submenu:mouse-leave-child"),s.timeout&&(clearTimeout(s.timeout),s.timeout=setTimeout((()=>{y.value?h():s.mouseInChild||g(e.name)}),200)),t&&a.value&&w?.(!0)}return se((()=>{d.on("submenu:mouse-enter-child",(()=>{s.mouseInChild=!0,y.value=!1,clearTimeout(s.timeout)})),d.on("submenu:mouse-leave-child",(()=>{s.isChild||(s.mouseInChild=!1,clearTimeout(s.timeout))})),m.on("on-update-opened",(s=>{if(!I(T))if(ae(s))n.opened=s;else if(oe(s)&&C.accordion){const{opend:e,parent:a,uidList:o}=s;a===t?.parent?n.opened=e:o.includes(t?.uid)||(n.opened=!1)}else e.name&&Array.isArray(s)&&(n.opened=s.includes(e.name))})),m.on("on-update-active-name:submenu",(e=>{t?.uid&&(n.active=e.includes(t?.uid))}))})),$(`subMenu:${t?.uid}`,{addSubMenu:p,removeSubMenu:g,getOpenNames:f,removeAll:h,isRemoveAllPopup:y,sliceIndex:v,level:b+1,handleMouseleave:N,props:C}),{getClass:S,prefixCls:c,getCollapse:T,getItemStyle:o,handleClick:function(){const{disabled:s}=e;if(s||I(T))return;const a=n.opened;if(I(M)){const{uidList:e}=i();m.emit("on-update-opened",{opend:!1,parent:t?.parent,uidList:e})}else m.emit("open-name-change",{name:e.name,opened:!a});n.opened=!a},handleOpenChange:function(e){n.opened=e},getParentSubMenu:a,getOverlayStyle:_,getTheme:k,getIsOpend:L,getEvents:function(e){return I(T)?{onMouseenter:O,onMouseleave:()=>N(e)}:{}},getSubClass:x,...R(n),...R(s)}}});const jn=l({name:"SimpleSubMenu",components:{SubMenu:d(Fn,[["render",function(t,n,s,a,o,l){const i=b("Icon"),r=b("CollapseTransition"),u=b("Popover");return m(),p("li",{class:g(t.getClass)},[t.getCollapse?(m(),C(u,{key:1,placement:"right",overlayClassName:`${t.prefixCls}-menu-popover`,open:t.getIsOpend,onOpenChange:t.handleOpenChange,overlayStyle:t.getOverlayStyle,align:{offset:[0,0]}},{content:w((()=>[le("div",M(ue(t.getEvents(!0))),[le("ul",{class:g([t.prefixCls,`${t.prefixCls}-${t.getTheme}`,`${t.prefixCls}-popup`])},[q(t.$slots,"default")],2)],16)])),default:w((()=>[le("div",S({class:t.getSubClass},t.getEvents(!1)),[le("div",{class:g([{[`${t.prefixCls}-submenu-popup`]:!t.getParentSubMenu,[`${t.prefixCls}-submenu-collapsed-show-tit`]:t.collapsedShowTitle}])},[q(t.$slots,"title")],2),t.getParentSubMenu?(m(),C(i,{key:0,icon:"eva:arrow-ios-downward-outline",size:14,class:g(`${t.prefixCls}-submenu-title-icon`)},null,8,["class"])):h("",!0)],16)])),_:3},8,["overlayClassName","open","onOpenChange","overlayStyle"])):(m(),p(T,{key:0},[le("div",{class:g(`${t.prefixCls}-submenu-title`),onClick:n[0]||(n[0]=Z(((...e)=>t.handleClick&&t.handleClick(...e)),["stop"])),style:X(t.getItemStyle)},[q(t.$slots,"title"),e(i,{icon:"eva:arrow-ios-downward-outline",size:14,class:g(`${t.prefixCls}-submenu-title-icon`)},null,8,["class"])],6),e(r,null,{default:w((()=>[ie(le("ul",{class:g(t.prefixCls)},[q(t.$slots,"default")],2),[[re,t.opened]])])),_:3})],64))],2)}]]),MenuItem:Hn,SimpleMenuTag:_t((()=>ce((()=>Promise.resolve().then((()=>Wn))),void 0))),Icon:i},props:{item:{type:Object,default:()=>({})},parent:n.bool,collapsedShowTitle:n.bool,collapse:n.bool,theme:n.oneOf(["dark","light"])},setup(e){const{t:t}=c(),{prefixCls:n}=r("simple-menu"),s=u((()=>!0)),a=u((()=>e.item?.icon)),o=u((()=>t("routes."+e.item?.enCode.replace(/\./g,"-"),e.item?.fullName))),l=u((()=>!e.collapse||!e.parent)),i=u((()=>!!e.collapse&&!!e.parent)),d=u((()=>[{[`${n}__parent`]:e.parent,[`${n}__children`]:!e.parent}]));return{prefixCls:n,menuHasChildren:function(e){return Reflect.has(e,"children")&&!!e.children&&e.children.length>0},getShowMenu:s,getIcon:a,getI18nName:o,getShowSubTitle:l,getLevelClass:d,getIsCollapseParent:i}}}),Bn={key:1,class:"mt-1 collapse-title"},Un={key:1,class:"mt-2 collapse-title"};const zn=d(l({name:"SimpleMenu",components:{Menu:An,SimpleSubMenu:d(jn,[["render",function(t,n,s,a,o,l){const i=b("SimpleMenuTag"),r=b("MenuItem"),u=b("SimpleSubMenu",!0),c=b("SubMenu");return m(),p(T,null,[!t.menuHasChildren(t.item)&&t.getShowMenu?(m(),C(r,S({key:0,name:t.item.path},t.$props,{class:t.getLevelClass,title:t.getI18nName}),{title:w((()=>[le("span",{class:g(["ml-2",`${t.prefixCls}-sub-title`])},y(t.getI18nName),3),e(i,{item:t.item,collapseParent:t.getIsCollapseParent},null,8,["item","collapseParent"])])),default:w((()=>[t.getIcon?(m(),p("span",{key:0,class:g(t.getIcon)},null,2)):h("",!0),t.collapsedShowTitle&&t.getIsCollapseParent?(m(),p("div",Bn,y(t.getI18nName),1)):h("",!0)])),_:1},16,["name","class","title"])):h("",!0),t.menuHasChildren(t.item)&&t.getShowMenu?(m(),C(c,{key:1,name:t.item.path,class:g([t.getLevelClass,t.theme]),collapsedShowTitle:t.collapsedShowTitle,title:t.getI18nName},{title:w((()=>[t.getIcon?(m(),p("span",{key:0,class:g(t.getIcon)},null,2)):h("",!0),t.collapsedShowTitle&&t.getIsCollapseParent?(m(),p("div",Un,y(t.getI18nName),1)):h("",!0),ie(le("span",{class:g(["ml-2",`${t.prefixCls}-sub-title`])},y(t.getI18nName),3),[[re,t.getShowSubTitle]]),e(i,{item:t.item,collapseParent:!!t.collapse&&!!t.parent},null,8,["item","collapseParent"])])),default:w((()=>[(m(!0),p(T,null,k(t.item.children||[],(e=>(m(),C(u,S({key:e.path,ref_for:!0},t.$props,{item:e,parent:!1}),null,16,["item"])))),128))])),_:1},8,["name","class","collapsedShowTitle","title"])):h("",!0)],64)}]])},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},collapse:n.bool.def(!1),mixSider:n.bool.def(!1),theme:n.string,accordion:n.bool.def(!0),collapsedShowTitle:n.bool,beforeClickFn:{type:Function},isSplitMenu:n.bool},emits:["menuClick"],setup(e,{attrs:t,emit:n}){const s=E(""),a=E(!1),o=P({activeName:"",openNames:[],activeSubMenuNames:[]}),{currentRoute:l}=A(),{prefixCls:i}=r("simple-menu"),{items:c,accordion:d,mixSider:m,collapse:p}=R(e),{setOpenKeys:g,getOpenKeys:h}=function(e,t,n,s,a){return{setOpenKeys:de((async function(a){if("/profile"===a)return;const o=!s.value,l=x(t.value);L((()=>{if(0===l?.length)return e.activeSubMenuNames=[],void(e.openNames=[]);const t=N(l,a);I(n)?e.openNames=t:e.openNames=O([...e.openNames,...t]),"/home"!==a&&"/404"!==a||1!==l[0].type||(e.openNames=[l[0].path]),e.activeSubMenuNames=e.openNames}),30,o)}),50),getOpenKeys:u((()=>I(a)?[]:e.openNames))}}(o,c,d,m,p),f=u((()=>({...t,...e})));return F((()=>e.collapse),(e=>{e?o.openNames=[]:g(l.value.path)}),{immediate:!0}),F((()=>e.items),(()=>{e.isSplitMenu&&g(l.value.path)}),{flush:"post"}),D((e=>{e.name!==H&&(s.value=e.meta?.currentActiveMenu,async function(e){if(I(a))return void(a.value=!1);const t=(e||I(l)).path;o.activeName=t,g(t)}(e),I(s)&&(o.activeName=I(s),g(I(s))))})),{prefixCls:i,getBindValues:f,handleSelect:async function(t){if(t=t.replace("bearer ","bearer%20"),me(t))return void pe(t);const{beforeClickFn:s}=e;if(s&&U(s)){if(!(await s(t)))return}n("menuClick",t),a.value=!0,g(t),o.activeName=t},getOpenKeys:h,...R(o)}}}),[["render",function(e,t,n,s,a,o){const l=b("SimpleSubMenu"),i=b("Menu");return m(),C(i,S(e.getBindValues,{activeName:e.activeName,openNames:e.getOpenKeys,class:e.prefixCls,activeSubMenuNames:e.activeSubMenuNames,onSelect:e.handleSelect}),{default:w((()=>[(m(!0),p(T,null,k(e.items,(t=>(m(),C(l,{key:t.path,item:t,parent:!0,collapsedShowTitle:e.collapsedShowTitle,collapse:e.collapse},null,8,["item","collapsedShowTitle","collapse"])))),128))])),_:1},16,["activeName","openNames","class","activeSubMenuNames","onSelect"])}]]);const Qn=d(l({name:"SimpleMenuTag",props:{item:{type:Object,default:()=>({})},dot:n.bool,collapseParent:n.bool},setup(e){const{prefixCls:t}=r("simple-menu"),n=u((()=>{const{item:t}=e;if(!t)return!1;const{tag:n}=t;if(!n)return!1;const{dot:s,content:a}=n;return!(!s&&!a)})),s=u((()=>{if(!n.value)return"";const{item:t,collapseParent:s}=e,{tag:a}=t,{dot:o,content:l}=a;return o||s?"":l}));return{getTagClass:u((()=>{const{item:n,collapseParent:s}=e,{tag:a={}}=n||{},{dot:o,type:l="error"}=a,i=`${t}-tag`;return[i,[`${i}--${l}`],{[`${i}--collapse`]:s,[`${i}--dot`]:o||e.dot}]})),getShowTag:n,getContent:s}}}),[["render",function(e,t,n,s,a,o){return e.getShowTag?(m(),p("span",{key:0,class:g(e.getTagClass)},y(e.getContent),3)):h("",!0)}]]),Wn=Object.freeze(Object.defineProperty({__proto__:null,default:Qn},Symbol.toStringTag,{value:"Module"}));const Jn=l({name:"LayoutMenu",props:{theme:n.oneOf(["light","dark"]),splitType:{type:Number,default:ye.NONE},isHorizontal:n.bool,menuMode:{type:[String],default:""}},setup(t){const n=Ce(),{getMenuMode:a,getMenuType:o,getMenuTheme:l,getCollapsed:i,getCollapsedShowTitle:c,getAccordion:d,getIsHorizontal:m,getIsSidebarType:p,getSplit:g}=_();we();const{prefixCls:h}=r("layout-menu"),{menusRef:f}=function(e){const t=E([]),{currentRoute:n}=A(),{getIsMobile:s}=ge(),a=he(),{setMenuSetting:o,getIsHorizontal:l,getSplit:i}=_(),r=fe((async function(e){if(I(d)||I(s))return;const n=await ve(e);if(!n||!n.length)return o({hidden:!0}),void(t.value=[]);o({hidden:!1}),t.value=n}),50),c=u((()=>I(e)!==ye.LEFT&&!I(l))),d=u((()=>!I(i)||I(e)!==ye.LEFT)),m=u((()=>I(e)===ye.TOP)),p=u((()=>I(e)===ye.NONE||!I(i)));async function g(){if(I(p)||I(s))t.value=await B();else if(I(m)){const e=await be();t.value=e}}return F([()=>I(n).path,()=>I(e)],(async([e])=>{if(I(c)||I(s))return;const{meta:t}=I(n),a=t.currentActiveMenu;let o=await j(e);o||(o=await j(a)),o&&r(o)}),{immediate:!0}),F([()=>a.getLastBuildMenuTime,()=>a.getMenuList],(()=>{g()}),{immediate:!0}),F((()=>i.value),(()=>{I(c)||g()})),F((()=>e.value),(()=>{g()})),{menusRef:t}}(Se(t,"splitType")),{getIsMobile:y}=ge(),v=u((()=>I(y)?s.INLINE:t.menuMode||I(a))),b=u((()=>t.theme||I(l))),C=u((()=>!1)),w=u((()=>!I(m)&&(I(p)||t.splitType===ye.LEFT||t.splitType===ye.NONE))),M=u((()=>({height:`calc(100% - ${I(C)?"48px":"0px"})`,background:"rgba(255, 255, 255, 0.4)"}))),k=u((()=>[`${h}-logo`,I(b),{[`${h}--mobile`]:I(y)}])),L=u((()=>{const e=I(f);return{menus:e,beforeClickFn:O,items:e,theme:I(b),accordion:I(d),collapse:I(i),collapsedShowTitle:I(c),onMenuClick:x}}));function x(e){n(e)}async function O(e){return!me(e)||(pe(e),!1)}function N(){const{menus:n,...s}=I(L);return n&&n.length?t.isHorizontal?e(En,S(s,{isHorizontal:t.isHorizontal,type:I(o),showLogo:I(C),mode:I(v),items:n}),null):e(zn,S(s,{isSplitMenu:I(g),items:n}),null):null}return()=>e(T,null,[I(C)||I(y)?e(Te,{showTitle:!I(i),class:I(k),theme:I(b)},null):null,I(w)?e(Me,{style:I(M)},{default:()=>N()}):N()])}}),$n=l({name:"HeaderTrigger",__name:"HeaderTrigger",props:{theme:n.oneOf(["light","dark"])},setup(e){const{getCollapsed:t,toggleCollapsed:n}=_(),{prefixCls:s}=r("layout-header-trigger");return(a,o)=>(m(),p("span",{class:g([I(s),e.theme]),onClick:o[0]||(o[0]=(...e)=>I(n)&&I(n)(...e))},[I(t)?(m(),C(I(mn),{key:0})):(m(),C(I(ln),{key:1}))],2))}});const Gn=d(l({name:"SiderTrigger",components:{DoubleRightOutlined:ke,DoubleLeftOutlined:_e},setup(){const{getCollapsed:e,toggleCollapsed:t}=_();return{getCollapsed:e,toggleCollapsed:t}}}),[["render",function(e,t,n,s,a,o){const l=b("DoubleRightOutlined"),i=b("DoubleLeftOutlined");return m(),p("div",{onClick:t[0]||(t[0]=Z(((...t)=>e.toggleCollapsed&&e.toggleCollapsed(...t)),["stop"]))},[e.getCollapsed?(m(),C(l,{key:0})):(m(),C(i,{key:1}))])}]]),Kn=l({name:"LayoutTrigger",__name:"index",props:{sider:n.bool.def(!0),theme:n.oneOf(["light","dark"])},setup:e=>(t,n)=>e.sider?(m(),C(Gn,{key:0})):(m(),C($n,{key:1,theme:e.theme},null,8,["theme"]))});function Vn(){Ie();const e=Le(),t=u((()=>!0)),n=u((()=>!I(v)&&!I(t))),a=u((()=>!1)),{getMenuMode:o,getSplit:l,getShowHeaderTrigger:i,getIsSidebarType:r,getIsMixSidebar:c,getIsTopMenu:d}=_(),{getShowBreadCrumb:m,getShowLogo:p}=we(),g=u((()=>!I(r)&&I(y))),h=u((()=>e.getHeaderSetting.showDoc)),f=u((()=>e.getHeaderSetting.theme)),y=u((()=>e.getHeaderSetting.show)),v=u((()=>e.getHeaderSetting.fixed)),b=u((()=>e.getHeaderSetting.bgColor)),C=u((()=>e.getHeaderSetting.showSearch)),w=u((()=>e.getHeaderSetting.useLockPage)),S=u((()=>e.getHeaderSetting.showFullScreen)),M=u((()=>e.getHeaderSetting.showNotice)),T=u((()=>I(o)!==s.HORIZONTAL&&I(m)&&!I(l))),k=u((()=>I(p)&&!I(r)&&!I(c))),L=u((()=>I(T)||I(i)));return{setHeaderSetting:function(t){e.setProjectConfig({headerSetting:t})},getShowDoc:h,getShowSearch:C,getHeaderTheme:f,getUseLockPage:w,getShowFullScreen:S,getShowNotice:M,getShowBread:T,getShowContent:L,getShowHeaderLogo:k,getShowHeader:y,getFixed:v,getShowMixHeaderRef:g,getShowFullHeaderRef:t,getShowInsetHeaderRef:a,getUnFixedAndFull:n,getHeaderBgColor:b}}const qn=l({name:"FullScreen",components:{Tooltip:Y},setup(){const{t:e}=c(),{toggle:t,isFullscreen:n}=xe();n.value=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement);return{getTitle:u((()=>I(n)?e("layout.header.tooltipExitFull"):e("layout.header.tooltipEntryFull"))),isFullscreen:n,toggle:t}}}),Yn={key:0,class:"icon-ym icon-ym-header-fullscreen"},Zn={key:1,class:"icon-ym icon-ym-header-fullscreen-exit"};const Xn=d(qn,[["render",function(e,t,n,s,a,o){const l=b("Tooltip");return m(),C(l,{title:e.getTitle,placement:"bottom",mouseEnterDelay:.5},{default:w((()=>[le("span",{onClick:t[0]||(t[0]=(...t)=>e.toggle&&e.toggle(...t))},[e.isFullscreen?(m(),p("i",Zn)):(m(),p("i",Yn))])])),_:1},8,["title"])}]]),es=l({__name:"Notify",props:{count:{type:Number,default:0}},setup(t){const{t:n}=c(),{prefixCls:s}=r("header-notify");return(a,o)=>(m(),C(I(Y),{title:I(n)("layout.header.tooltipNotify"),placement:"bottom",mouseEnterDelay:.5},{default:w((()=>[e(I(Ht),{count:t.count,offset:[-8,2]},{default:w((()=>[le("div",{class:g(I(s))},o[0]||(o[0]=[le("i",{class:"icon-ym icon-ym-header-notice"},null,-1)]),2)])),_:1},8,["count"])])),_:1},8,["title"]))}}),ts=_t((()=>ce((()=>import("./index-dad4df5f.js")),["static/js/index-dad4df5f.js","static/js/index-920db443.js","static/css/index-648461a4.css","static/js/lock-efa36e19.js","static/js/createAsyncComponent-7e8f72ac.js","static/js/index-143f5813.js","static/js/useWindowSizeFn-05f906e2.js","static/js/log-2a5f2c26.js","static/css/index-e7d3e030.css","static/js/index-999abbee.js","static/js/ArrowLeftOutlined-3fbf15bc.js","static/css/index-cddfced7.css","static/js/message-22b8b6a8.js","static/js/emoji-a68b5251.js","static/js/index-1cfe4e28.js","static/js/Detail-4e2b49fe.js","static/css/Detail-fc9a8883.css","static/js/Detail.vue_vue_type_script_setup_true_lang-645a467a.js","static/js/schedule-74da51ff.js","static/js/CopyOutlined-8d46c8b2.js","static/js/index-e1b7f8ad.js","static/css/index-574b63fa.css","static/js/uniqBy-e868edd7.js","static/js/useTabs-ceeccdba.js","static/css/index-cc4de007.css"])),{loading:!0}),ns=_t((()=>ce((()=>import("./Breadcrumb-4f05db3f.js")),["static/js/Breadcrumb-4f05db3f.js","static/js/index-920db443.js","static/css/index-648461a4.css","static/js/index-5aed445a.js","static/css/Breadcrumb-c9412fde.css"]))),ss=_t((()=>ce((()=>import("./ErrorAction-4e49435b.js")),["static/js/ErrorAction-4e49435b.js","static/js/index-920db443.js","static/css/index-648461a4.css","static/js/index-1cfe4e28.js"])));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var as=function(e,t){return(as=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function os(e,t){function n(){this.constructor=e}as(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ls=function(e,t){this.target=t,this.type=e},is=function(e){function t(t,n){var s=e.call(this,"error",n)||this;return s.message=t.message,s.error=t,s}return os(t,e),t}(ls),rs=function(e){function t(t,n,s){void 0===t&&(t=1e3),void 0===n&&(n="");var a=e.call(this,"close",s)||this;return a.wasClean=!0,a.code=t,a.reason=n,a}return os(t,e),t}(ls),us={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:Infinity,maxEnqueuedMessages:Infinity,startClosed:!1,debug:!1},cs=function(){function e(e,t,n){var s=this;void 0===n&&(n={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){s._debug("open event");var t=s._options.minUptime,n=void 0===t?us.minUptime:t;clearTimeout(s._connectTimeout),s._uptimeTimeout=setTimeout((function(){return s._acceptOpen()}),n),s._ws.binaryType=s._binaryType,s._messageQueue.forEach((function(e){return s._ws.send(e)})),s._messageQueue=[],s.onopen&&s.onopen(e),s._listeners.open.forEach((function(t){return s._callEventListener(e,t)}))},this._handleMessage=function(e){s._debug("message event"),s.onmessage&&s.onmessage(e),s._listeners.message.forEach((function(t){return s._callEventListener(e,t)}))},this._handleError=function(e){s._debug("error event",e.message),s._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),s.onerror&&s.onerror(e),s._debug("exec error listeners"),s._listeners.error.forEach((function(t){return s._callEventListener(e,t)})),s._connect()},this._handleClose=function(e){s._debug("close event"),s._clearTimeouts(),s._shouldReconnect&&s._connect(),s.onclose&&s.onclose(e),s._listeners.close.forEach((function(t){return s._callEventListener(e,t)}))},this._url=e,this._protocols=t,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce((function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e}),0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,n=void 0===t?us.maxEnqueuedMessages:t;this._messageQueue.length<n&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,n,s=this._listeners[e.type];if(s)try{for(var a=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(s),o=a.next();!o.done;o=a.next()){var l=o.value;this._callEventListener(e,l)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter((function(e){return e!==t})))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,n=void 0===t?us.reconnectionDelayGrowFactor:t,s=e.minReconnectionDelay,a=void 0===s?us.minReconnectionDelay:s,o=e.maxReconnectionDelay,l=void 0===o?us.maxReconnectionDelay:o,i=0;return this._retryCount>0&&(i=a*Math.pow(n,this._retryCount-1))>l&&(i=l),this._debug("next delay",i),i},e.prototype._wait=function(){var e=this;return new Promise((function(t){setTimeout(t,e._getNextDelay())}))},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,n=t.maxRetries,s=void 0===n?us.maxRetries:n,a=t.connectionTimeout,o=void 0===a?us.connectionTimeout:a,l=t.WebSocket,i=void 0===l?function(){if("undefined"!=typeof WebSocket)return WebSocket}():l;if(this._retryCount>=s)this._debug("max retries reached",this._retryCount,">=",s);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),void 0===(r=i)||!r||2!==r.CLOSING)throw Error("No valid WebSocket class provided");var r;this._wait().then((function(){return e._getNextUrl(e._url)})).then((function(t){e._closeCalled||(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new i(t,e._protocols):new i(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout((function(){return e._handleTimeout()}),o))}))}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new is(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new rs(e,t,this))}catch(n){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}();const ds=Oe(),ms=ds.getUserInfo,{createMessage:ps}=Re(),gs=Ne(),hs=(gs.webSocketUrl?gs.webSocketUrl+"/websocket/":window.location.origin+"/websocket/").replace("https://","wss://").replace("http://","ws://");let fs;const ys=new Map;function vs(){const e=Ee(),t=E(hs+encodeURIComponent(e));function n(t){try{const n=JSON.parse(t);n.token=e;let s=JSON.stringify(n);fs.send(s)}catch(n){}}return{initWebSocket:function(){fs&&(fs.close(),fs=null),fs=new cs(t.value),fs.onopen=function(){const e={method:"OnConnection",mobileDevice:!1,systemId:ms.systemId,isSeparate:!!Pe()};n(JSON.stringify(e))},fs.onerror=function(e){},fs.onmessage=function(t){if(t.data)try{let s=t.data;const a=JSON.parse(s);for(const e of ys.keys())try{e(a)}catch(n){}switch(a.method){case"refresh":a.msg?(ps.error(a.msg),setTimeout((()=>{location.reload()}),2e3)):location.reload();break;case"closeSocket":fs&&(fs.close(),fs=null);break;case"logout":if(a.token&&a.token!==e)return location.reload();fs&&(fs.close(),fs=null),ps.error(a.msg||"登录过期,请重新登录").then((()=>{ds.resetToken()}))}}catch(n){}}},sendWsMsg:n,onWebSocket:function(e){ys.has(e)||"function"==typeof e&&ys.set(e,null)},offWebSocket:function(e){ys.delete(e)},getWebSocket:function(){return fs},closeWebSocket:function(){fs&&(fs.close(),fs=null)}}}const bs={key:0,class:"im-container"},Cs={class:"header"},ws={class:"name"},Ss={class:"main"},Ms={class:"chatBox"},Ts={key:0,class:"chatList-user"},ks={key:1,class:"chatList-user"},_s={class:"chatList-text"},Is=["innerHTML"],Ls=["src","onClick"],xs=["src"],Os=["src"],Ns={class:"toolBox"},Es={class:"toolBox-left"},Ps={class:"emojiBox"},Rs={class:"emoji"},As=["onClick"],Ds=["src"],Hs={class:"writeBox"},Fs={class:"btns"},js={key:0,class:"historyBox"},Bs={class:"chatList historyList"},Us={key:0,class:"chatList-user"},zs={key:1,class:"chatList-user"},Qs={class:"chatList-text"},Ws=["innerHTML"],Js=["src","onClick"],$s=["src"],Gs=["src"],Ks=d(l({__name:"Im",setup(t,{expose:n}){const{onWebSocket:s,sendWsMsg:a}=vs();s((e=>{"messageList"==e.method&&function(e){let t=[];for(let n=0;n<e.list.length;n++){const s=e.list[n];"text"===s.contentType?s.content=F(s.content):s.content=JSON.parse(s.content),t.push({userId:s.sendUserId,messageType:s.contentType,message:s.content,dateTime:Ae(s.sendTime).format("YYYY-MM-DD HH:mm:ss")})}M.showHistory?(M.historyList=[...M.historyList,...t],M.currentPage+=1,M.finish=t.length<e.pagination.pageSize):(M.list=t,K((()=>{j(500)})));M.loading=!1}(e)}));const{createMessage:o}=Re(),{t:l}=c(),i=Ne(),r=E(i.apiUrl),d=E(i.uploadUrl),v=E(null),C=E(null),S=Oe(),M=P({visible:!1,showHistory:!1,list:[],otherUser:{},userInfo:S.getUserInfo,emojiList:Dt,historyList:[],historyDefaultList:[],currentPage:1,pageSize:50,finish:!1,loading:!1,messageContent:"",keyword:"",popoverVisible:!1}),{visible:_,userInfo:L,list:x,otherUser:O,historyList:N,showHistory:A,messageContent:D}=R(M),H=u((()=>({Authorization:Ee()})));function F(e){let t=e.replace(/\[([^(\]|\[)]*)\]/g,(e=>{let t="";for(let n=0;n<M.emojiList.length;n++){let s=M.emojiList[n];if(s.alt==e){t=`<img src="/resource/emoji/${s.url}" class="chatList-text-emoji" />`;break}}return t}));return e=t}function j(e=0){setTimeout((()=>{K((()=>{let e=v.value;e&&e.scrollHeight>e.clientHeight&&(e.scrollTop=e.scrollHeight)}))}),e)}function B(){if(!M.messageContent)return;const e={method:"SendMessage",toUserId:M.otherUser.id,messageType:"text",messageContent:M.messageContent};a(JSON.stringify(e)),M.messageContent=""}function U(){M.showHistory=!M.showHistory,M.showHistory&&(M.historyList=[],M.currentPage=1,M.pageSize=50,M.finish=!1,z(),K((()=>{!function(){const e=C.value;if(!e)return;e.addEventListener("scroll",(function(){M.finish||M.loading||e.scrollTop>=e.scrollHeight-e.clientHeight-100&&z()}))}()})))}function z(){M.loading=!0;const e={method:"MessageList",toUserId:M.otherUser.id,formUserId:M.userInfo.userId,currentPage:M.currentPage,pageSize:M.pageSize,sord:"asc",keyword:M.keyword};a(JSON.stringify(e))}function Q(e){const t=e.size<5242880;return t||o.error("图片大小不能超过5M"),t}function W({file:e}){if("error"!==e.status){if("done"===e.status)if(200===e.response.code){if(!e.response.data||!e.response.data.name)return;const t=e.response.data.name;(function(e){return new Promise((function(t,n){let s=new FileReader,a={base64:"",e:null};s.readAsDataURL(e),s.onload=function(e){a.base64=s.result.replace(/data:image\/.*;base64,/,""),a.e=e},s.onerror=function(e){n(e)},s.onloadend=function(){t(a)}}))})(e.originFileObj).then((e=>{var n;(n=e.e,new Promise((function(e,t){let s={width:0,height:0};const a=n.target.result,o=document.createElement("img");o.src=a,o.onload=function(){s.width=o.width,s.height=o.height,e(s)},o.onerror=function(e){t(e)}}))).then((e=>{let n={name:t,width:e.width,height:e.height};const s={method:"SendMessage",toUserId:M.otherUser.id,messageType:"image",messageContent:n};a(JSON.stringify(s)),K((()=>{j(500)}))}))}))}else o.error(e.response.msg)}else o.error("上传失败")}function J(e){Fe({imageList:[e]})}return n({getImVisible:function(){return M.visible},getOtherUser:function(){return M.otherUser},openIm:function(e){M.visible=!0,M.showHistory=!1,M.otherUser=e;const t={method:"MessageList",toUserId:e.id,formUserId:M.userInfo.userId,currentPage:1,pageSize:30,sord:"desc"};a(JSON.stringify(t)),M.list=[]},closeIm:function(){M.showHistory=!1,M.visible=!1},addItem:function(e){"text"===e.messageType&&(e.message=F(e.message));M.list.push(e),j(200),M.showHistory&&M.historyList.push(e)}}),(t,n)=>{const s=b("a-avatar"),a=b("a-popover"),o=b("a-upload"),i=b("jnpf-textarea"),u=b("a-button"),c=b("a-input-search");return I(_)?(m(),p("div",bs,[le("div",Cs,[e(s,{size:30,src:r.value+I(O).headIcon},null,8,["src"]),le("span",ws,y(I(O).realName)+"/"+y(I(O).account),1),le("i",{class:"icon-ym icon-ym-nav-close",onClick:n[0]||(n[0]=e=>_.value=!1)})]),le("div",Ss,[le("div",Ms,[le("div",{class:"chatList",ref_key:"chatListRef",ref:v},[(m(!0),p(T,null,k(I(x),((t,a)=>(m(),p("div",{class:g(["chatList-item",{"chatList-item--mine":t.userId==I(L).userId}]),key:a},[t.userId==I(L).userId?(m(),p("div",Ts,[e(s,{size:40,src:r.value+I(L).headIcon},null,8,["src"]),le("cite",null,[le("i",null,y(t.dateTime),1),n[7]||(n[7]=f(" 我 "))])])):(m(),p("div",ks,[e(s,{size:40,src:r.value+I(O).headIcon},null,8,["src"]),le("cite",null,[f(y(I(O).realName),1),le("i",null,y(t.dateTime),1)])])),le("div",_s,[n[8]||(n[8]=le("div",{class:"chatList-arrow"},null,-1)),"text"==t.messageType?(m(),p("p",{key:0,innerHTML:t.message,class:"chatList__msg--text"},null,8,Is)):h("",!0),"image"==t.messageType&&t.message.path?(m(),p("img",{key:1,src:r.value+t.message.path,class:"chatList__msg--img",onClick:e=>J(r.value+t.message.path)},null,8,Ls)):h("",!0),"voice"==t.messageType&&t.message.path?(m(),p("audio",{key:2,class:"chatList__msg--audio",controls:"",src:r.value+t.message.path},null,8,xs)):h("",!0),"video"==t.messageType?(m(),p("video",{key:3,src:t.message,controls:"",class:"chatList__msg--video"},null,8,Os)):h("",!0)])],2)))),128))],512),le("div",Ns,[le("div",Es,[e(a,{placement:"topLeft",trigger:"click",overlayClassName:"emoji-popover",open:M.popoverVisible,"onUpdate:open":n[1]||(n[1]=e=>M.popoverVisible=e)},{content:w((()=>[le("div",Ps,[le("ul",Rs,[(m(!0),p(T,null,k(M.emojiList,((e,t)=>(m(),p("li",{key:t,onClick:t=>function(e){M.messageContent+=e.alt,M.popoverVisible=!1}(e)},[le("img",{src:"/resource/emoji/"+e.url},null,8,Ds)],8,As)))),128))])])])),default:w((()=>[n[9]||(n[9]=le("i",{class:"link-text ym-custom ym-custom-emoticon-neutral",title:"发送表情"},null,-1))])),_:1,__:[9]},8,["open"]),e(o,{showUploadList:!1,action:d.value+"/IM",class:"uploadImg-btn",headers:H.value,accept:"image/*","before-upload":Q,onChange:W},{default:w((()=>n[10]||(n[10]=[le("i",{class:"link-text ym-custom ym-custom-image",title:"发送图片"},null,-1)]))),_:1,__:[10]},8,["action","headers"])]),le("div",{class:"toolBox-right",onClick:U},n[11]||(n[11]=[le("i",{class:"link-text icon-ym icon-ym-generator-time"},null,-1),le("span",null,"聊天记录",-1)]))]),le("div",Hs,[e(i,{placeholder:"点击这里，直接输入消息咨询",value:I(D),"onUpdate:value":n[2]||(n[2]=e=>De(D)?D.value=e:null),valueModifiers:{trim:!0},onKeyup:n[3]||(n[3]=He((e=>B()),["enter","native"]))},null,8,["value"]),le("div",Fs,[e(u,{type:"primary",onClick:n[4]||(n[4]=e=>B())},{default:w((()=>n[12]||(n[12]=[f("发送")]))),_:1,__:[12]})])])]),I(A)?(m(),p("div",js,[e(c,{placeholder:I(l)("common.drawerSearchText"),allowClear:"",value:M.keyword,"onUpdate:value":n[5]||(n[5]=e=>M.keyword=e),onSearch:n[6]||(n[6]=e=>(M.currentPage=1,M.pageSize=50,M.finish=!1,M.historyList=[],z(),void K((()=>{const e=C.value;e&&(e.scrollTop=0)}))))},null,8,["placeholder","value"]),le("div",{class:"historyList-box",ref_key:"historyListRef",ref:C},[le("div",Bs,[(m(!0),p(T,null,k(I(N),((t,a)=>(m(),p("div",{class:"chatList-item",key:a},[t.userId==I(L).userId?(m(),p("div",Us,[e(s,{size:40,src:r.value+I(L).headIcon},null,8,["src"]),le("cite",null,[n[13]||(n[13]=f(" 我")),le("i",null,y(t.dateTime),1)])])):(m(),p("div",zs,[e(s,{size:40,src:r.value+I(O).headIcon},null,8,["src"]),le("cite",null,[f(y(I(O).realName),1),le("i",null,y(t.dateTime),1)])])),le("div",Qs,[n[14]||(n[14]=le("div",{class:"chatList-arrow"},null,-1)),"text"==t.messageType?(m(),p("span",{key:0,innerHTML:t.message},null,8,Ws)):h("",!0),"image"==t.messageType&&t.message.path?(m(),p("img",{key:1,src:r.value+t.message.path,class:"chatList__msg--img",onClick:e=>J(r.value+t.message.path)},null,8,Js)):h("",!0),"voice"==t.messageType&&t.message.path?(m(),p("audio",{key:2,class:"chatList__msg--audio",controls:"",src:r.value+t.message.path},null,8,$s)):h("",!0),"video"==t.messageType?(m(),p("video",{key:3,src:t.message,controls:"",class:"chatList__msg--video"},null,8,Gs)):h("",!0)])])))),128))])],512)])):h("",!0)])])):h("",!0)}}}),[["__scopeId","data-v-824835ca"]]),Vs=["onClick","onContextmenu"],qs={class:"user-list-item-main"},Ys={class:"user-list-txt"},Zs={class:"title"},Xs={class:"title-left"},ea={class:"name"},ta={class:"content"},na={class:"time"},sa={class:"tool"},aa=["onClick"],oa={class:"user-list-item-main"},la={class:"user-list-txt"},ia={class:"title"},ra={class:"title-left"},ua={class:"name"},ca=l({__name:"ChatDrawer",emits:["register","toggleTwinkle"],setup(t,{emit:n}){const s=n,{createConfirm:a}=Re(),{t:o}=c(),[l]=je(),i=Ne(),r=E(i.apiUrl),u=E(null),[d,{changeLoading:g}]=It((function(){g(!0),v.activeKey="reply",Ot().then((e=>{v.replyList=e.data.list,g(!1)}))})),f=E(null),v=P({activeKey:"reply",replyList:[],finish:!1,loading:!1,listQuery:{keyword:"",currentPage:1,pageSize:20},userList:[]}),{activeKey:M,replyList:_,userList:L,listQuery:x}=R(v),{onWebSocket:O,sendWsMsg:N}=vs();function A(e){"contacts"!==e||v.userList.length||(D(),K((()=>{!function(){const e=f.value,t=e?.getScrollWrap();t?.addEventListener("scroll",(()=>{t.scrollHeight-t.clientHeight-t.scrollTop<=200&&!v.loading&&!v.finish&&(v.listQuery.currentPage+=1,D())}))}()})))}function D(){v.loading=!0,Be(v.listQuery).then((e=>{e.data.list.length<v.listQuery.pageSize&&(v.finish=!0),v.userList=[...v.userList,...e.data.list],v.loading=!1}))}function H(e,t=!1){const n={method:"UpdateReadMessage",formUserId:e.id};if(N(JSON.stringify(n)),t)e.unreadMessage=0;else for(let s=0;s<v.replyList.length;s++)if(e.id===v.replyList[s].id){v.replyList[s].unreadMessage=0;break}j(),u.value?.openIm(e)}function F(e,t){l({event:e,items:[{label:"移除",handler:()=>{!function(e){u.value?.closeIm(),Nt(e.id).then((()=>{v.replyList=v.replyList.filter((t=>t.id!==e.id))}))}(t)}},{label:"删除聊天记录",handler:()=>{!function(e){u.value?.closeIm(),a({iconType:"warning",title:"提示",content:"是否清空当前聊天的所有记录?",onOk:()=>{Et(e.id).then((()=>{e.latestMessage="",e.messageType="",e.unreadMessage=0,j()}))}})}(t)}}]})}function j(){const e=v.replyList.some((e=>e.unreadMessage));s("toggleTwinkle",e)}function B(){v.userList=[],v.finish=!1,v.listQuery.currentPage=1,v.listQuery.pageSize=20,D()}async function U(){return u.value?.closeIm(),!0}function z(e,t=0){let n=!1;const s=v.replyList.length;for(let a=0;a<s;a++)if(e.formUserId===v.replyList[a].id){t&&(v.replyList[a].unreadMessage+=1),v.replyList[a].latestMessage=e.formMessage,v.replyList[a].messageType=e.messageType,v.replyList[a].latestDate=e.latestDate,n=!0;break}n||(t&&(e.unreadMessage=1),e.latestMessage=e.formMessage,e.id=e.formUserId,v.replyList.unshift(e))}return O((e=>{if("receiveMessage"==e.method){if(!u.value?.getImVisible()||u.value?.getOtherUser().id!==e.formUserId)return z(e,1),void s("toggleTwinkle",!0);const t={userId:e.formUserId,messageType:e.messageType,message:e.formMessage,dateTime:Ae(e.dateTime).format("YYYY-MM-DD HH:mm:ss")};u.value?.addItem(t);const n={method:"UpdateReadMessage",formUserId:e.formUserId};N(JSON.stringify(n)),z(e)}if("sendMessage"==e.method){if(u.value?.getOtherUser().id!==e.toUserId)return;const t={userId:e.UserId,messageType:e.messageType,message:e.toMessage,dateTime:Ae(e.dateTime).format("YYYY-MM-DD HH:mm:ss")};!function(e){let t=!1;const n=v.replyList.length;for(let a=0;a<n;a++)if(e.toUserId===v.replyList[a].id){v.replyList[a].latestMessage=e.toMessage,v.replyList[a].messageType=e.messageType,v.replyList[a].latestDate=e.latestDate,t=!0;break}if(t)return;const s={account:e.toAccount,headIcon:e.toHeadIcon,id:e.toUserId,latestDate:e.latestDate,latestMessage:e.toMessage,messageType:e.messageType,realName:e.toRealName,unreadMessage:0};v.replyList.unshift(s)}(e),u.value?.addItem(t)}})),(t,n)=>{const s=b("a-avatar"),a=b("jnpf-empty"),l=b("a-tab-pane"),i=b("a-input-search"),c=b("a-tabs");return m(),C(I(Lt),S(t.$attrs,{onRegister:I(d),title:"内部聊天",width:"340px",class:"full-drawer chat-drawer",closeFunc:U}),{default:w((()=>[e(c,{activeKey:I(M),"onUpdate:activeKey":n[1]||(n[1]=e=>De(M)?M.value=e:null),tabBarGutter:10,class:"average-tabs h-full",onChange:A,size:"small"},{default:w((()=>[e(l,{key:"reply",tab:"消息"},{default:w((()=>[e(I(Me),null,{default:w((()=>[I(_).length?(m(!0),p(T,{key:0},k(I(_),((t,n)=>{return m(),p("div",{key:n,class:"user-list-item",onClick:e=>H(t,!0),onContextmenu:e=>F(e,t)},[le("div",qs,[e(s,{size:36,src:r.value+t.headIcon},null,8,["src"]),le("div",Ys,[le("p",Zs,[le("span",Xs,y(t.realName)+"/"+y(t.account),1),t.unreadMessage?(m(),C(I(Ht),{key:0,count:t.unreadMessage},null,8,["count"])):h("",!0)]),le("p",ea,[le("span",ta,y((a=t.latestMessage,o=t.messageType,"voice"===o?"[语音]":"image"===o?"[图片]":a)),1),le("span",na,y(I(Ue)(t.latestDate)),1)])])])],40,Vs);var a,o})),128)):h("",!0),I(_).length?h("",!0):(m(),C(a,{key:1}))])),_:1})])),_:1}),e(l,{key:"contacts",tab:"联系人"},{default:w((()=>[le("div",sa,[e(i,{placeholder:I(o)("common.drawerSearchText"),allowClear:"",value:I(x).keyword,"onUpdate:value":n[0]||(n[0]=e=>I(x).keyword=e),onSearch:B},null,8,["placeholder","value"])]),e(I(Me),{ref_key:"infiniteBody",ref:f,class:"user-list"},{default:w((()=>[I(L).length?(m(!0),p(T,{key:0},k(I(L),((t,n)=>(m(),p("div",{key:n,class:"user-list-item",onClick:e=>H(t)},[le("div",oa,[e(s,{size:36,src:r.value+t.headIcon},null,8,["src"]),le("div",la,[le("p",ia,[le("span",ra,y(t.realName)+"/"+y(t.account),1)]),le("p",ua,[le("span",null,y(t.department),1)])])])],8,aa)))),128)):h("",!0),I(L).length?h("",!0):(m(),C(a,{key:1}))])),_:1},512)])),_:1})])),_:1},8,["activeKey"]),e(Ks,{ref_key:"imRef",ref:u},null,512)])),_:1},16,["onRegister"])}}}),da={class:"tool"},ma={class:"main"},pa={key:0,class:"item"},ga={class:"item-list"},ha=["onClick"],fa=["title"],ya=l({__name:"SystemTriggerDrawer",emits:["register"],setup(t){const n=P({list:[],keyword:""}),{keyword:s}=R(n),{createMessage:a}=Re(),{t:o}=c(),[l,{changeLoading:i,closeDrawer:r}]=It((function(e){n.keyword="",n.list=e.list||[]})),d=A(),h=u((()=>n.keyword?n.list.filter((e=>-1!==e.name.indexOf(n.keyword))):n.list));function f(e){return e.enCode?o("routes."+e.enCode.replace(/\./g,"-"),e.name):e.name}return(t,n)=>{const u=b("a-input-search"),c=b("jnpf-empty");return m(),C(I(Lt),S(t.$attrs,{onRegister:I(l),width:"340px",class:"full-drawer portal-toggle-drawer",title:I(o)("layout.header.systemChange")}),{default:w((()=>[le("div",da,[e(u,{placeholder:I(o)("common.drawerSearchText"),allowClear:"",value:I(s),"onUpdate:value":n[0]||(n[0]=e=>De(s)?s.value=e:null)},null,8,["placeholder","value"])]),le("div",ma,[h.value.length?(m(),p("div",pa,[le("div",ga,[(m(!0),p(T,null,k(h.value,((t,n)=>(m(),p("div",{class:g(["item-list-item",{active:t.currentSystem}]),key:n,onClick:e=>function(e){if(e.currentSystem)return;i(!0);let t={majorId:e.id,majorType:"System"};Qe(t).then((e=>{a.success(e.msg).then((()=>{d.replace("/"),setTimeout((()=>{i(!1),r(),location.reload()}),500)}))})).catch((()=>{i(!1)}))}(t)},[e(I(tn),{class:"icon-left",onClick:Z((e=>function(e){const t=`${window.location.origin}/JNPF_APP_${e}`;t&&pe(t)}(t.enCode)),["stop"])},null,8,["onClick"]),le("p",{class:"item-list-item-name com-hover",title:f(t)},y(f(t)),9,fa),e(I(ze),{class:"icon-right"})],10,ha)))),128))])])):(m(),C(c,{key:1}))])])),_:1},16,["onRegister","title"])}}});const va={class:"tool"},ba={class:"main"},Ca={key:0,class:"item"},wa={class:"item-list"},Sa=["onClick"],Ma={class:"item-list-item-name"},Ta=["onClick"],ka=l({__name:"CommonMenusDrawer",emits:["register"],setup(t){const n=P({list:[],keyword:""}),{list:s,keyword:a}=R(n),o=Ne(),{createMessage:l}=Re(),{t:i}=c(),r=A(),[u,{changeLoading:d,closeDrawer:h}]=It((function(){n.keyword="",v()}));function v(){var e;d(!0),(e={keyword:n.keyword},We.get({url:"/api/system/MenuData",data:e})).then((e=>{n.list=e.data.list,d(!1)}))}function M(e){(function(e){return We.delete({url:"/api/system/MenuData/"+e})})(e).then((e=>{l.success(e.msg).then((()=>{v()}))}))}return(t,n)=>{const l=b("a-input-search"),c=b("jnpf-empty");return m(),C(I(Lt),S(t.$attrs,{onRegister:I(u),width:"340px",class:"full-drawer portal-toggle-drawer common-menus-drawer",title:I(i)("layout.header.commonMenus")}),{default:w((()=>[le("div",va,[e(l,{placeholder:I(i)("common.drawerSearchText"),allowClear:"",value:I(a),"onUpdate:value":n[0]||(n[0]=e=>De(a)?a.value=e:null),onSearch:v},null,8,["placeholder","value"])]),le("div",ba,[I(s).length?(m(),p("div",Ca,[le("div",wa,[(m(!0),p(T,null,k(I(s),((e,t)=>(m(),p("div",{class:g(["item-list-item",{active:e.currentSystem}]),key:t,onClick:t=>function(e){let t="/"+e.urlAddress;if(6==e.type){let n=e.propertyJson?JSON.parse(e.propertyJson):null,s="";n&&(s=n.moduleId||""),t=`${o.dataVUrl}view/${s}?token=${Ee()}`}7==e.type&&(t="_self"===e.linkTarget?`/externalLink?href=${encodeURIComponent(Je(e.urlAddress))}`:e.urlAddress.replace(/\${dataV}/g,o.dataVUrl).replace(/\${jnpfToken}/g,Ee())),r.push(t),h()}(e)},[le("p",Ma,[le("i",{class:g(e.icon)},null,2),f(y(e.fullName),1)]),le("i",{class:"icon-ym icon-ym-header-star-fill",onClick:Z((t=>M(e.id)),["stop"])},null,8,Ta)],10,Sa)))),128))])])):(m(),C(c,{key:1}))])])),_:1},16,["onRegister","title"])}}}),_a={class:"tool"},Ia=["title","onClick"],La={class:"msg-list-item-main"},xa={key:0,class:"icon-ym icon-ym-xitong item-icon"},Oa={key:1,class:"icon-ym icon-ym-generator-notice item-icon notice-icon"},Na={key:2,class:"icon-ym icon-ym-portal-schedule item-icon schedule-icon"},Ea={key:3,class:"icon-ym icon-ym icon-ym-generator-flow item-icon flow-icon"},Pa={class:"msg-list-txt"},Ra={class:"title"},Aa={class:"title-left"},Da={class:"name"},Ha={class:"content"},Fa={class:"time"},ja={class:"bottom-box"},Ba={class:"bottom-box-item bottom-box-item-left"},Ua={class:"bottom-box-item"},za=l({__name:"MessageDrawer",emits:["register","readMsg"],setup(t,{emit:n}){const s=n,a=A(),{createMessage:o,createConfirm:l}=Re(),{t:i}=c(),[r,{openModal:u}]=Ft(),[d,{openModal:g}]=Ft(),[v,{changeLoading:M,closeDrawer:_,getOpen:L}]=It((function(){N.listQuery.isRead=0,N.listQuery.keyword="",N.isNoRead=!0,Q(),K((()=>{!function(){const e=x.value,t=e?.getScrollWrap();t?.addEventListener("scroll",(()=>{t.scrollHeight-t.clientHeight-t.scrollTop<=200&&!N.loading&&!N.finish&&(N.listQuery.currentPage+=1,W())}))}(),async function(){const e={id:"",fullName:"全部",enCode:""},t=await U.getDictionaryData("msgSourceType")||[];N.messageType=[e,...t]}()}))})),x=E(null),O=de(Q,300),N=P({finish:!1,loading:!1,listQuery:{keyword:"",currentPage:1,pageSize:20,sort:"desc",type:"",isRead:0},list:[],type:"全部",isNoRead:!0,messageType:[]}),{list:D,listQuery:H,type:F,isNoRead:j,messageType:B}=R(N),U=$e(),{onWebSocket:z}=vs();function Q(){M(!0),N.finish=!1,N.listQuery.currentPage=1,N.list=[],W()}function W(){N.loading=!0,Pt(N.listQuery).then((e=>{e.data.list.length<N.listQuery.pageSize&&(N.finish=!0),N.list=[...N.list,...e.data.list],N.loading=!1,M(!1)}))}function J({key:e}){let t=N.messageType.filter((t=>t.enCode==e))[0];N.type=t.fullName,N.listQuery.type=e||"",Q()}function $(e){N.listQuery.isRead=e?0:"",Q()}function G(){Q()}async function V(){const e=x.value,t=e?.getScrollWrap();return t?.removeEventListener("scroll",(function(){})),!0}function q(){_(),a.push("/messageRecord")}function Y(){l({iconType:"warning",title:"提示",content:"您确定全部标识为已读状态, 是否继续?",onOk:()=>{const e={keyword:N.listQuery.keyword,type:N.listQuery.type,isRead:N.isNoRead?0:""};Rt(e).then((e=>{if(o.success(e.msg),s("readMsg",!0),N.isNoRead)Q();else for(let t=0;t<N.list.length;t++)N.list[t].isRead="1"}))}})}return z((e=>{"messagePush"==e.method&&I(L)&&O()})),(t,n)=>{const o=b("a-menu-item"),l=b("a-menu"),c=b("a-dropdown"),M=b("a-input-search"),L=b("jnpf-empty"),O=b("a-switch"),N=b("a-button"),E=b("a-tooltip");return m(),C(I(Lt),S(t.$attrs,{onRegister:I(v),title:"站内消息",width:"340px",class:"full-drawer message-drawer",closeFunc:V}),{default:w((()=>[le("div",_a,[e(c,null,{overlay:w((()=>[e(l,{onClick:J},{default:w((()=>[(m(!0),p(T,null,k(I(B),(e=>(m(),C(o,{key:e.enCode},{default:w((()=>[f(y(e.fullName),1)])),_:2},1024)))),128))])),_:1})])),default:w((()=>[le("span",null,[f(y(I(F)),1),e(I(Ge))])])),_:1}),e(M,{placeholder:I(i)("common.drawerSearchText"),allowClear:"",value:I(H).keyword,"onUpdate:value":n[0]||(n[0]=e=>I(H).keyword=e),onSearch:G},null,8,["placeholder","value"])]),e(I(Me),{ref_key:"infiniteBody",ref:x,class:"msg-list"},{default:w((()=>[I(D).length?(m(!0),p(T,{key:0},k(I(D),((t,n)=>(m(),p("div",{key:n,class:"msg-list-item",title:t.title,onClick:e=>function(e){At(e.id).then((t=>{if("0"==e.isRead&&(e.isRead="1",s("readMsg")),4==e.type){let e=t.data.bodyText?JSON.parse(t.data.bodyText):{};if(3==e.type)return;Qt(e.groupId,e.id).then((()=>{g(!0,{id:e.id,groupId:e.groupId})}))}else if(2==e.type&&2==e.flowType){const e=JSON.parse(t.data.bodyText);if(0==e.type)return;_(),a.push("/profile?config="+e.type)}else if(1==e.type||3==e.type)u(!0,{id:e.id,type:1});else{if(!t.data.bodyText)return;_(),a.push("/workFlowDetail?config="+encodeURIComponent(Je(t.data.bodyText)))}}))}(t)},[le("div",La,[e(I(Ht),{dot:"1"!=t.isRead,status:"warning"},{default:w((()=>[1==t.type?(m(),p("i",xa)):3==t.type?(m(),p("i",Oa)):4==t.type?(m(),p("i",Na)):(m(),p("i",Ea))])),_:2},1032,["dot"]),le("div",Pa,[le("p",Ra,[le("span",Aa,y(t.title),1)]),le("p",Da,[le("span",Ha,y(t.releaseUser),1),le("span",Fa,y(I(Ke)(t.releaseTime)),1)])])])],8,Ia)))),128)):h("",!0),I(D).length?h("",!0):(m(),C(L,{key:1}))])),_:1},512),le("div",ja,[le("div",Ba,[e(O,{checked:I(j),"onUpdate:checked":n[1]||(n[1]=e=>De(j)?j.value=e:null),size:"small",onChange:$},null,8,["checked"]),n[2]||(n[2]=f(" 只显示未读 "))]),le("div",Ua,[e(E,{title:"全部已读"},{default:w((()=>[e(N,{type:"text",class:"bottom-box-item-btn",onClick:Y},{default:w((()=>n[3]||(n[3]=[le("i",{class:"icon-ym icon-ym-msg-read-all"},null,-1)]))),_:1,__:[3]})])),_:1}),e(E,{title:"站内消息"},{default:w((()=>[e(N,{type:"text",class:"bottom-box-item-btn",onClick:q},{default:w((()=>n[4]||(n[4]=[le("i",{class:"icon-ym icon-ym-more"},null,-1)]))),_:1,__:[4]})])),_:1})])]),e(Ut,{onRegister:I(r)},null,8,["onRegister"]),e(zt,{onRegister:I(d)},null,8,["onRegister"])])),_:1},16,["onRegister"])}}}),Qa=["src"],Wa=l({__name:"ResetPwdForm",setup(t){const n=Oe();const s=P({dataForm:{id:"",account:"",oldPassword:"",password:"",password2:"",code:""},codeImg:"",timestamp:0,dataRule:{oldPassword:[{required:!0,message:"旧密码不能为空",trigger:"blur"}],password:[{required:!0,validator:(e,t)=>{const n=/[0-9]+/,s=/[a-z]+/,a=/[A-Z]+/,o=/\W/,l=/_/;return t?1==I(M)?.passwordStrengthLimit?I(M)?.passwordLengthMin&&t.length<I(M)?.passwordLengthMinNumber?Promise.reject("新密码长度不能小于"+I(M)?.passwordLengthMinNumber+"位"):I(M)?.containsNumbers&&!n.test(t)?Promise.reject("新密码必须包含数字"):I(M)?.includeLowercaseLetters&&!s.test(t)?Promise.reject("新密码必须包含小写字母"):I(M)?.includeUppercaseLetters&&!a.test(t)?Promise.reject("新密码必须包含大写字母"):!I(M)?.containsCharacters||o.test(t)||l.test(t)?Promise.resolve():Promise.reject("新密码必须包含字符"):Promise.resolve():Promise.reject("新密码不能为空")},trigger:"blur"}],password2:[{required:!0,message:"重复密码不能为空",trigger:"blur"},{validator:(e,t)=>t!==s.dataForm.password?Promise.reject("两次密码输入不一致"):Promise.resolve(),trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}]}}),{dataForm:a,codeImg:o,dataRule:l}=R(s),i=E(),{t:r}=c(),{createMessage:d}=Re(),p=Le(),g=Ne(),h=E(g.apiUrl),[f,{changeOkLoading:y,closeModal:v}]=jt((function(e){s.dataForm={id:"",account:"",oldPassword:"",password:"",password2:"",code:""},s.dataForm.id=e.id,s.dataForm.account=e.account,T()})),M=u((()=>p.getSysConfigInfo));function T(){s.timestamp=Math.random(),s.codeImg=`/api/file/ImageCode/${s.timestamp}`}async function k(){try{if(!(await(i.value?.validate())))return;y(!0);let e={oldPassword:Ve(s.dataForm.oldPassword),password:Ve(s.dataForm.password),code:s.dataForm.code,timestamp:s.timestamp};qe(e).then((e=>{y(!1),v(),d.success(e.msg).then((()=>{n.resetToken()}))})).catch((()=>{y(!1)}))}catch(e){}}return(t,n)=>{const s=b("a-input-password"),u=b("a-form-item"),c=b("a-input"),d=b("a-col"),p=b("a-row"),g=b("a-form");return m(),C(I(Bt),S(t.$attrs,{onRegister:I(f),title:I(r)("sys.login.forgetFormTitle"),onOk:k}),{default:w((()=>[e(g,{colon:!1,labelCol:{style:{width:"80px"}},model:I(a),rules:I(l),ref_key:"formElRef",ref:i},{default:w((()=>[e(u,{label:"旧密码",name:"oldPassword"},{default:w((()=>[e(s,{value:I(a).oldPassword,"onUpdate:value":n[0]||(n[0]=e=>I(a).oldPassword=e),placeholder:"旧密码"},null,8,["value"])])),_:1}),e(u,{label:"新密码",name:"password"},{default:w((()=>[e(s,{value:I(a).password,"onUpdate:value":n[1]||(n[1]=e=>I(a).password=e),placeholder:"新密码"},null,8,["value"])])),_:1}),e(u,{label:"重复密码",name:"password2"},{default:w((()=>[e(s,{value:I(a).password2,"onUpdate:value":n[2]||(n[2]=e=>I(a).password2=e),placeholder:"重复密码"},null,8,["value"])])),_:1}),e(u,{label:"验证码",name:"code"},{default:w((()=>[e(p,null,{default:w((()=>[e(d,{span:17},{default:w((()=>[e(c,{value:I(a).code,"onUpdate:value":n[3]||(n[3]=e=>I(a).code=e),placeholder:"验证码"},null,8,["value"])])),_:1}),e(d,{span:6,offset:1,style:{height:"32px"}},{default:w((()=>[le("img",{alt:"点击切换验证码",title:"点击切换验证码",src:h.value+I(o),onClick:T,class:"cursor-pointer"},null,8,Qa)])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},16,["onRegister","title"])}}});function Ja(e){return We.post({url:"/api/system/Aichat/history/save",data:e})}const $a={class:"ai-container"},Ga={class:"chat-sidebar"},Ka={class:"chat-list"},Va=["onClick"],qa={class:"chat-info"},Ya={class:"chat-title"},Za={class:"chat-date"},Xa=["onClick"],eo={key:1,class:"noData-txt"},to={class:"chat-main"},no={key:0,class:"chat-title"},so={key:0,class:"welcome-message"},ao={key:1,class:"message-list"},oo={class:"message-content"},lo={class:"message-actions"},io={class:"action-buttons"},ro={key:1,class:"message-content"},uo={class:"chat-footer"},co={class:"quick-questions"},mo=["onClick"],po={class:"input-container"},go=l({name:"AIChatModal",inheritAttrs:!1,__name:"AIChatModal",setup(t,{expose:n}){n({openModal:function(){s.value=!0,a.value=!1,o.value="",d.value=[],v.value=!1,S.value="",i.value=0,H()}});const s=E(!1),a=E(!1),o=E(""),l=E(!1),i=E(0),r=E(null),d=E([]),v=E(!1),S=E(""),M=E(),_=["JNPF是什么","JNPF的性能特点","JNPF支持哪些数据库"],L=E([]),x=u((()=>L.value[i.value])),{createMessage:O,createConfirm:N}=Re(),{t:P}=c();function R(){s.value=!1}function A(e){if("Enter"===e.key)return z()}function D(e){N({iconType:"warning",title:P("common.tipTitle"),content:P("common.delTip"),onOk:()=>{(function(e){return We.delete({url:`/api/system/Aichat/history/delete/${e}`})})(e).then((e=>{O.success(e.msg),d.value=[],H()}))}})}async function H(){We.get({url:"/api/system/Aichat/history/list"}).then((e=>{L.value=e.data,L.value.length&&!a.value&&U()}))}function F(){S.value=x.value.fullName,v.value=!0,K((()=>{M.value?.focus()}))}function j(){S.value.trim()&&(x.value.title=S.value.trim());Ja({id:x.value.id||"",fullName:S.value.trim()}).then((()=>{H()})),v.value=!1}function B(){if(!d.value.length&&L.value.length||l.value)return;const e={id:"",fullName:"新对话",data:[]};Ja(e).then((()=>{L.value.unshift(e),i.value=0,d.value=[],H()}))}async function U(){const e=await(t=L.value[i.value]?.id,We.get({url:`/api/system/Aichat/history/get/${t}`}));var t;d.value=e.data}async function z(e,t=!1){if(a.value)return;if((!o.value||l.value)&&!t)return O.warning("请输入问题描述");a.value=!0;const n=t?e:o.value,s={content:n,type:1};d.value.push(s);const i={id:x.value?.id||"",fullName:x.value?.id?"":n,data:d.value};await Ja(i),x.value?.id||await H();d.value.push({type:"loading"}),K((()=>{Q()}));try{o.value="",l.value=!0;const e=await(r={keyword:n},We.post({url:"/api/system/Aichat/send",data:r}));d.value=d.value.filter((e=>"loading"!==e.type)),setTimeout((()=>{const t={questionText:n,content:e.data,type:0};d.value.push(t);Ja({id:x.value.id||"",fullName:"",data:d.value}),l.value=!1,a.value=!1,K((()=>{Q()}))}),1e3)}catch(u){d.value=d.value.filter((e=>"loading"!==e.type)),l.value=!1,a.value=!1}var r}async function Q(){r.value&&(r.value.scrollTop=r.value.scrollHeight)}return(t,n)=>{const a=b("a-divider"),l=b("a-input"),u=b("a-button"),c=b("a-textarea");return m(),C(I(Xe),{open:s.value,"onUpdate:open":n[3]||(n[3]=e=>s.value=e),title:"AI助手",width:1e3,class:"ai-modal",footer:null,maskClosable:!1,onCancel:R},{closeIcon:w((()=>[e(Ye,{canFullscreen:!1,onCancel:R})])),default:w((()=>[le("div",$a,[le("div",Ga,[le("div",{class:"new-chat-btn",onClick:B},[e(I(Ze)),n[4]||(n[4]=le("span",null,"开启新对话",-1))]),e(a),le("div",Ka,[L.value.length?(m(!0),p(T,{key:0},k(L.value,((e,t)=>(m(),p("div",{key:e.id,class:g(["chat-item",{active:i.value===t}]),onClick:e=>async function(e){i.value=e,U()}(t)},[le("div",qa,[le("span",Ya,y(e.fullName),1),le("span",Za,[f(y(I(et)(e.creatorTime))+" ",1),le("span",{class:"close-btn",onClick:t=>D(e.id)},n[5]||(n[5]=[le("i",{class:"icon-ym icon-ym-btn-clearn"},null,-1)]),8,Xa)])])],10,Va)))),128)):(m(),p("div",eo,n[6]||(n[6]=[le("img",{src:"data:image/png;base64,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",class:"noData-img"},null,-1),f("暂无历史对话")])))])]),le("div",to,[x.value?(m(),p("div",no,[v.value?(m(),C(l,{key:0,value:S.value,"onUpdate:value":n[0]||(n[0]=e=>S.value=e),maxlength:30,class:"title-input",onPressEnter:j,onBlur:j,ref_key:"titleInputRef",ref:M},null,8,["value"])):(m(),p("div",{key:1,class:"title-text",onClick:F},y(x.value.fullName),1))])):h("",!0),le("div",{class:"chat-content",ref_key:"chatContentRef",ref:r},[0===d.value.length?(m(),p("div",so,n[7]||(n[7]=[le("div",{class:"message-item"},[le("div",{class:"ai-avatar"},[le("img",{src:"data:image/png;base64,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",alt:"AI助手头像"})]),le("div",{class:"content"},[le("div",{class:"title"}," 我是大迈，JnpfAI智能助手，很高兴能为您服务！ "),le("div",{class:"subtitle"}," 我可以为您解答各种问题，请问有什么能帮助您的吗？ ")])],-1)]))):(m(),p("div",ao,[(m(!0),p(T,null,k(d.value,((t,n)=>(m(),p("div",{key:n,class:g(["message-item",1===t.type?"user":"ai"])},[0===t.type?(m(),p(T,{key:0},[le("div",oo,y(t.content),1),le("div",lo,[le("div",io,[e(u,{type:"text",class:"action-btn",onClick:e=>async function(e){if(!e)return;const{isSuccessRef:t}=nt(e);I(t)&&O.success("复制成功")}(t.content)},{default:w((()=>[e(I(Wt))])),_:2},1032,["onClick"]),e(u,{type:"text",class:"action-btn",onClick:e=>{z(t.questionText,!0)}},{default:w((()=>[e(I(Sn))])),_:2},1032,["onClick"])])])],64)):1===t.type?(m(),p("div",ro,y(t.content),1)):"loading"===t.type?(m(),C(I(tt),{key:2,style:{fontSize:"24px"}})):h("",!0)],2)))),128))]))],512),le("div",uo,[le("div",co,[(m(),p(T,null,k(_,(e=>le("a",{key:e,class:"question-link",onClick:t=>async function(e){o.value=e,await z()}(e)},y(e),9,mo))),64))]),le("div",po,[e(c,{value:o.value,"onUpdate:value":n[1]||(n[1]=e=>o.value=e),class:"input-box",placeholder:"请输入问题描述",onKeydown:A},null,8,["value"]),le("div",{class:"send-button",onClick:n[2]||(n[2]=e=>z())},n[8]||(n[8]=[le("i",{class:"icon-ym icon-ym-release"},null,-1)]))])])])])])),_:1},8,["open"])}}});const ho=d(l({name:"LayoutHeader",components:{Header:st.Header,AppLogo:Te,LayoutTrigger:Kn,LayoutBreadcrumb:ns,LayoutMenu:Jn,UserDropDown:ts,AppLocalePicker:at,FullScreen:Xn,Notify:es,AppSearch:ot,ErrorAction:ss,SettingDrawer:_t((()=>ce((()=>import("./index-f2378b30.js").then((e=>e.i))),["static/js/index-f2378b30.js","static/js/index-999abbee.js","static/js/index-920db443.js","static/css/index-648461a4.css","static/js/ArrowLeftOutlined-3fbf15bc.js","static/js/log-2a5f2c26.js","static/css/index-cddfced7.css","static/js/createAsyncComponent-7e8f72ac.js"])),{loading:!0}),ChatDrawer:ca,SystemTriggerDrawer:ya,CommonMenusDrawer:ka,MessageDrawer:za,MessageOutlined:yn,ResetPwdForm:Wa,AIChatModal:go},props:{fixed:n.bool},setup(e){const{t:t}=c(),{prefixCls:n}=r("layout-header"),[a,{openDrawer:o}]=xt(),[l,{openDrawer:i}]=xt(),[d,{openDrawer:m}]=xt(),[p,{openDrawer:g}]=xt(),{getShowTopMenu:h,getShowHeaderTrigger:f,getSplit:y,getIsMixMode:v,getMenuWidth:b,getIsMixSidebar:C}=_(),{getUseErrorHandle:w,getShowSettingButton:S,getSettingButtonPosition:M}=we(),{getHeaderTheme:T,getShowFullScreen:k,getShowNotice:L,getShowContent:x,getShowBread:O,getShowHeaderLogo:N,getShowHeader:A,getShowSearch:D}=Vn(),{getShowLocalePicker:H}=lt(),{getIsMobile:F}=ge(),j=P({isTwinkle:!1,messageCount:0,aiModalVisible:!1}),B=E(null),{onWebSocket:U}=vs(),z=Oe(),Q=Le(),[W,{openModal:J}]=Ft();U((e=>{"initMessage"==e.method&&(j.messageCount=e.unreadTotalCount||0,j.isTwinkle=!!e.unreadNums.length),"messagePush"==e.method&&(j.messageCount+=e.unreadNoticeCount)}));const $=u((()=>{const t=I(T);return[n,{[`${n}--fixed`]:e.fixed,[`${n}--mobile`]:I(F),[`${n}--${t}`]:t}]})),K=u((()=>{if(!I(S))return!1;const e=I(M);return e===it.AUTO?I(A):e===it.HEADER})),V=u((()=>{if(!I(v)||I(F))return{};return{width:`${I(b)<180?180:I(b)}px`}})),q=u((()=>I(y)?ye.TOP:ye.NONE)),Y=u((()=>I(y)?s.HORIZONTAL:null)),Z=u((()=>z.getUserInfo||{})),X=u((()=>Q.getSysConfigInfo));function ee(){rt(),!I(Z)?.changePasswordDate&&I(X).mandatoryModificationOfInitialPassword&&J(!0,{id:I(Z)?.userId,account:I(Z)?.userAccount})}return G((()=>{ee()})),{t:t,...R(j),prefixCls:n,getHeaderClass:$,getShowHeaderLogo:N,getHeaderTheme:T,getShowHeaderTrigger:f,getIsMobile:F,getShowBread:O,getShowContent:x,getSplitType:q,getSplit:y,getMenuMode:Y,getShowTopMenu:h,getShowLocalePicker:H,getShowFullScreen:k,getShowNotice:L,getUseErrorHandle:w,getLogoWidth:V,getIsMixSidebar:C,getShowSettingButton:S,getShowSetting:K,getShowSearch:D,registerChatDrawer:a,openChatDrawer:o,registerSystemTriggerDrawer:l,openSystemTriggerDrawer:i,registerCommonMenusDrawer:d,openCommonMenusDrawer:m,registerMessageDrawer:p,openMessageDrawer:g,toggleTwinkle:function(e=!1){j.isTwinkle=e},registerForm:W,readMsg:function(e=!1){e?j.messageCount=0:(j.messageCount-=1,j.messageCount=j.messageCount>=0?j.messageCount:0)},initData:ee,getUserInfo:Z,getJnpfAppId:Pe,handleOpenAIModal:function(){I(B)?.openModal()},AIModalRef:B}}}),[["render",function(t,n,s,a,o,l){const i=b("AppLogo"),r=b("LayoutTrigger"),u=b("LayoutMenu"),c=b("AppSearch"),d=b("a-tooltip"),f=b("ErrorAction"),y=b("Notify"),v=b("FullScreen"),S=b("AppLocalePicker"),M=b("SettingDrawer"),T=b("UserDropDown"),k=b("ChatDrawer"),_=b("SystemTriggerDrawer"),I=b("CommonMenusDrawer"),L=b("MessageDrawer"),x=b("ResetPwdForm"),O=b("AIChatModal"),N=b("Header");return m(),C(N,{class:g(t.getHeaderClass)},{default:w((()=>[le("div",{class:g(`${t.prefixCls}-left`)},[e(i,{class:g(`${t.prefixCls}-logo`),theme:t.getHeaderTheme,style:X(t.getLogoWidth)},null,8,["class","theme","style"]),t.getShowContent&&t.getShowHeaderTrigger&&!t.getSplit&&!t.getIsMixSidebar||t.getIsMobile?(m(),C(r,{key:0,theme:t.getHeaderTheme,sider:!1},null,8,["theme"])):h("",!0)],2),t.getShowTopMenu&&!t.getIsMobile?(m(),p("div",{key:0,class:g(`${t.prefixCls}-menu`)},[e(u,{isHorizontal:!0,theme:t.getHeaderTheme,splitType:t.getSplitType,menuMode:t.getMenuMode},null,8,["theme","splitType","menuMode"])],2)):h("",!0),le("div",{class:g(`${t.prefixCls}-action`)},[t.getShowSearch?(m(),C(c,{key:0,class:g(`${t.prefixCls}-action__item search-item`)},null,8,["class"])):h("",!0),e(d,{title:t.t("layout.header.commonMenus"),mouseEnterDelay:.5},{default:w((()=>[le("div",{class:g(`${t.prefixCls}-action__item`),onClick:n[0]||(n[0]=e=>t.openCommonMenusDrawer(!0,{}))},n[5]||(n[5]=[le("i",{class:"icon-ym icon-ym-header-star"},null,-1)]),2)])),_:1},8,["title"]),e(d,{title:"AI助手"},{default:w((()=>[le("div",{class:g(`${t.prefixCls}-action__item`),onClick:n[1]||(n[1]=(...e)=>t.handleOpenAIModal&&t.handleOpenAIModal(...e))},n[6]||(n[6]=[le("i",{class:"icon-ym icon-ym-ai"},null,-1)]),2)])),_:1}),t.getUseErrorHandle?(m(),C(f,{key:1,class:g(`${t.prefixCls}-action__item error-action`)},null,8,["class"])):h("",!0),e(d,{title:t.t("layout.header.tooltipChat"),placement:"bottom",mouseEnterDelay:.5},{default:w((()=>[le("div",{class:g(`${t.prefixCls}-action__item`),onClick:n[2]||(n[2]=e=>t.openChatDrawer(!0,{}))},[le("i",{class:g(["icon-ym icon-ym-header-chat",{twinkle:t.isTwinkle}])},null,2)],2)])),_:1},8,["title"]),t.getShowNotice?(m(),C(y,{key:2,count:t.messageCount,class:g(`${t.prefixCls}-action__item notify-item`),onClick:n[3]||(n[3]=e=>t.openMessageDrawer(!0,{}))},null,8,["count","class"])):h("",!0),t.getUserInfo.systemIds&&t.getUserInfo.systemIds.length>1&&!t.getJnpfAppId()?(m(),C(d,{key:3,title:t.t("layout.header.systemChange"),placement:"bottom",mouseEnterDelay:.5},{default:w((()=>[le("div",{class:g(`${t.prefixCls}-action__item`),onClick:n[4]||(n[4]=e=>t.openSystemTriggerDrawer(!0,{list:t.getUserInfo.systemIds}))},n[7]||(n[7]=[le("i",{class:"icon-ym icon-ym-header-sys-toggle"},null,-1)]),2)])),_:1},8,["title"])):h("",!0),t.getShowFullScreen?(m(),C(v,{key:4,class:g(`${t.prefixCls}-action__item fullscreen-item`)},null,8,["class"])):h("",!0),t.getShowLocalePicker?(m(),C(S,{key:5,showText:!1,class:g(`${t.prefixCls}-action__item`)},null,8,["class"])):h("",!0),t.getShowSetting?(m(),C(M,{key:6,class:g(`${t.prefixCls}-action__item`)},null,8,["class"])):h("",!0),e(T,{theme:t.getHeaderTheme},null,8,["theme"]),e(k,{onRegister:t.registerChatDrawer,onToggleTwinkle:t.toggleTwinkle},null,8,["onRegister","onToggleTwinkle"]),e(_,{onRegister:t.registerSystemTriggerDrawer},null,8,["onRegister"]),e(I,{onRegister:t.registerCommonMenusDrawer},null,8,["onRegister"]),e(L,{onRegister:t.registerMessageDrawer,onReadMsg:t.readMsg},null,8,["onRegister","onReadMsg"]),e(x,{onRegister:t.registerForm},null,8,["onRegister"]),e(O,{ref:"AIModalRef"},null,512)],2)])),_:1},8,["class"])}]]);function fo(){const e=Le();return{setMultipleTabSetting:function(t){e.setProjectConfig({multiTabsSetting:t})},getShowMultipleTab:u((()=>e.getMultiTabsSetting.show)),getShowQuick:u((()=>e.getMultiTabsSetting.showQuick)),getShowRedo:u((()=>e.getMultiTabsSetting.showRedo)),getShowFold:u((()=>e.getMultiTabsSetting.showFold)),getShowIcon:u((()=>e.getMultiTabsSetting.showIcon))}}const yo=l({name:"FrameLayout",components:{FramePage:Jt},setup(){const{getFramePages:e,hasRenderFrame:t,showIframe:n}=function(){const e=A(),{currentRoute:t}=e,{getShowMultipleTab:n}=fo(),s=ut(),a=u((()=>l(x(e.getRoutes()))||[])),o=u((()=>s.getTabList.reduce(((e,t)=>(t.meta&&Reflect.has(t.meta,"frameSrc")&&e.push(t.name),e)),[])));function l(e){let t=[];for(const n of e){const{meta:{frameSrc:e}={},children:s}=n;e&&t.push(n),s&&s.length&&t.push(...l(s))}return t=Kt(t,"name"),t}return{hasRenderFrame:function(t){return I(n)?I(o).includes(t):e.currentRoute.value.name===t},getFramePages:a,showIframe:function(e){return e.name===I(t).name},getAllFramePages:l}}(),s=u((()=>I(e).length>0));return{getFramePages:e,hasRenderFrame:t,showIframe:n,showFrame:s}}}),vo={key:0};function bo({route:e,openCache:t,cacheTabs:n,enableTransition:s,def:a}){if(!s)return;const o=n.includes(e.name),l="fade-slide";let i=l;return t&&(i=o&&e.meta.loaded?l:void 0),i||e.meta.transitionName||a}const Co=l({name:"PageLayout",components:{FrameLayout:d(yo,[["render",function(e,t,n,s,a,o){const l=b("FramePage");return e.showFrame?(m(),p("div",vo,[(m(!0),p(T,null,k(e.getFramePages,(t=>(m(),p(T,{key:t.path},[t.meta.frameSrc&&e.hasRenderFrame(t.name)?ie((m(),C(l,{key:0,frameSrc:t.meta.frameSrc},null,8,["frameSrc"])),[[re,e.showIframe(t)]]):h("",!0)],64)))),128))])):h("",!0)}]])},setup(){const{getShowMultipleTab:e}=fo(),t=ut(),{getOpenKeepAlive:n,getCanEmbedIFramePage:s}=we(),{getBasicTransition:a,getEnableTransition:o}=ct();return{getTransitionName:bo,openCache:u((()=>I(n)&&I(e))),getEnableTransition:o,getBasicTransition:a,getCaches:u((()=>I(n)?t.getCachedTabList:[])),getCanEmbedIFramePage:s}}});const wo=l({name:"LayoutContent",components:{PageLayout:d(Co,[["render",function(t,n,s,a,o,l){const i=b("RouterView"),r=b("FrameLayout");return m(),p(T,null,[e(i,null,{default:w((({Component:e,route:n})=>[t.openCache?(m(),C(mt,{key:0,include:t.getCaches},[(m(),C(dt(e),{key:n.fullPath}))],1032,["include"])):(m(),C(dt(e),{key:n.fullPath}))])),_:1}),t.getCanEmbedIFramePage?(m(),C(r,{key:0})):h("",!0)],64)}]])},setup(){const{prefixCls:e}=r("layout-content"),{getOpenPageLoading:t}=ct(),{getLayoutContentMode:n,getPageLoading:s}=we(),a=Le(),{copyright:o}=a.getSysConfigInfo;return $t(),{prefixCls:e,getOpenPageLoading:t,getLayoutContentMode:n,getPageLoading:s,copyright:o}}}),So=["copyright"],Mo={class:"app-main h-full"};const To=d(wo,[["render",function(t,n,s,a,o,l){const i=b("PageLayout"),r=pt("loading");return m(),p("div",{class:g([t.prefixCls,t.getLayoutContentMode]),copyright:t.copyright},[ie((m(),p("div",Mo,[e(i)])),[[r,t.getOpenPageLoading&&t.getPageLoading]])],10,So)}]]);function ko(e,t,n=!1){const{getMiniWidthNumber:s,getCollapsed:a,setMenuSetting:o}=_();function l(e){const t=I(e);return t?Reflect.has(t,"$el")?I(e)?.$el:I(e):null}function i(){const i=l(t);if(!i)return;const r=l(e);r&&(i.onmousedown=t=>{r.style.transition="unset";const u=t?.clientX;return i.left=i.offsetLeft,function(e,t,n){document.onmousemove=function(a){let o=e.left+(a.clientX-n);a=a||window.event;const l=I(s);return o<0&&(o=0),o>800&&(o=800),o<l&&(o=l),e.style.left=t.style.width=o+"px",!1}}(i,r,u),function(t){const i=l(e);document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,i.style.transition="width 0.2s";const e=parseInt(i.style.width);if(n)o({menuWidth:e});else{const t=I(s);I(a)?e>t&&o({collapsed:!1,menuWidth:e}):o(e>t+20?{menuWidth:e}:{collapsed:!0})}t.releaseCapture?.()}}(i),i.setCapture?.(),!1})}return G((()=>{K((()=>{de(i,80)()}))})),{}}const _o=d(l({name:"DargBar",props:{mobile:Boolean},setup(e){const{getMiniWidthNumber:t,getCollapsed:n,getCanDrag:s}=_(),{prefixCls:a}=r("darg-bar"),o=u((()=>I(n)?{left:`${I(t)}px`}:{})),l=u((()=>[a,{[`${a}--hide`]:!I(s)||e.mobile}]));return{prefixCls:a,getDragBarStyle:o,getClass:l}}}),[["render",function(e,t,n,s,a,o){return m(),p("div",{class:g(e.getClass),style:X(e.getDragBarStyle)},null,6)}],["__scopeId","data-v-9aa98b50"]]);const Io=d(l({name:"LayoutSideBar",components:{Sider:st.Sider,LayoutMenu:Jn,DragBar:_o,LayoutTrigger:Kn},setup(){const e=E(null),t=E(null),{getCollapsed:n,getMenuWidth:a,getSplit:o,getMenuTheme:l,getRealWidth:i,getMenuHidden:c,getMenuFixed:d,getIsMixMode:m,toggleCollapsed:p}=_(),{prefixCls:g}=r("layout-sideBar"),{getIsMobile:h}=ge(),{getTriggerAttr:f,getShowTrigger:y}=function(e){const{getTrigger:t,getSplit:n}=_(),s=u((()=>{const s=I(t);return s!==gt.NONE&&!I(e)&&(s===gt.FOOTER||I(n))}));return{getTriggerAttr:u((()=>I(s)?{}:{trigger:null})),getShowTrigger:s}}(h);ko(t,e);const{getCollapsedWidth:v,onBreakpointChange:b}=function(){const e=Le(),{getMiniWidthNumber:t}=_();return{getCollapsedWidth:u((()=>I(t))),onBreakpointChange:function(t){e.setProjectConfig({menuSetting:{siderHidden:t}})}}}(),C=u((()=>I(o)?s.INLINE:null)),w=u((()=>I(o)?ye.LEFT:ye.NONE)),S=u((()=>!I(o)||!I(c))),M=u((()=>[g,{[`${g}--fixed`]:I(d),[`${g}--mix`]:!0}])),T=u((()=>{const e=`${I(i)}px`;return{width:e,overflow:"hidden",flex:`0 0 ${e}`,maxWidth:e,minWidth:e,transition:"all 0.2s",marginLeft:"10px"}})),k=ht(Kn);return{prefixCls:g,sideRef:t,dragBarRef:e,getIsMobile:h,getHiddenDomStyle:T,getSiderClass:M,getTrigger:k,getTriggerAttr:f,getCollapsedWidth:v,getMenuFixed:d,showClassSideBarRef:S,getMenuWidth:a,getCollapsed:n,getMenuTheme:l,onBreakpointChange:b,getMode:C,getSplitType:w,getShowTrigger:y,toggleCollapsed:p}}}),[["render",function(t,n,s,a,o,l){const i=b("LayoutTrigger"),r=b("LayoutMenu"),u=b("DragBar"),c=b("Sider");return m(),p(T,null,[t.getMenuFixed&&!t.getIsMobile?ie((m(),p("div",{key:0,style:X(t.getHiddenDomStyle)},null,4)),[[re,t.showClassSideBarRef]]):h("",!0),ie(e(c,S({ref:"sideRef",breakpoint:"lg",collapsible:"",class:t.getSiderClass,width:t.getMenuWidth,collapsed:t.getCollapsed,collapsedWidth:t.getCollapsedWidth,theme:t.getMenuTheme,onBreakpoint:t.onBreakpointChange,trigger:t.getTrigger},t.getTriggerAttr),ft({default:w((()=>[e(r,{theme:t.getMenuTheme,menuMode:t.getMode,splitType:t.getSplitType},null,8,["theme","menuMode","splitType"]),e(u,{ref:"dragBarRef"},null,512)])),_:2},[t.getShowTrigger?{name:"trigger",fn:w((()=>[e(i)])),key:"0"}:void 0]),1040,["class","width","collapsed","collapsedWidth","theme","onBreakpoint","trigger"]),[[re,t.showClassSideBarRef]])],64)}]]),Lo=l({name:"LayoutMixSider",components:{ScrollContainer:Me,AppLogo:Te,SimpleMenu:zn,Icon:i,LayoutTrigger:Kn,SimpleMenuTag:Qn},directives:{clickOutside:yt},setup(){let e=E([]);const t=E(""),n=E([]),s=E(!1),a=E(null),o=E(null),l=E(null),{prefixCls:i}=r("layout-mix-sider"),d=Ce(),{t:m}=c(),{getMenuWidth:p,getCanDrag:g,getCloseMixSidebarOnChange:h,getMenuTheme:f,getMixSideTrigger:y,getRealWidth:v,getMixSideFixed:b,mixSideHasChildren:C,setMenuSetting:w,getIsMixSidebar:S,getCollapsed:M}=_(),{title:T}=Ne(),k=he();ko(o,a,!0);const L=u((()=>({width:I(s)?`${I(p)}px`:0,left:`${I(O)+10}px`}))),x=u((()=>{C.value=I(n).length>0;const e=I(b)&&I(C);return e&&(s.value=!0),e})),O=u((()=>I(M)?vt:bt)),N=u((()=>{const e=I(x)?I(v):0;return H(`${I(O)+e+10}px`)})),P=u((()=>H(`${I(O)}px`))),R=u((()=>I(b)?{}:{onMouseleave:()=>{U(!0),z()}})),A=u((()=>I(g)));function H(e){return{width:e,maxWidth:e,minWidth:e,flex:`0 0 ${e}`}}async function B(e,a=!1){const o=await ve(e);if(I(t)===e?(a?I(s)||(s.value=!0):I(s)?z():s.value=!0,I(s)||U()):(s.value=!0,t.value=e),!o||0===o.length)return a||d(e),n.value=[],void z();n.value=o}async function U(a=!1){const o=l.value?.path;if(o&&(t.value=await j(o),I(S))){const o=I(e).find((e=>e.path===I(t))),l=o?.path;if(l){const e=await ve(l);a&&(n.value=e,I(b)&&(s.value=e.length>0)),0===e.length&&(n.value=[])}}}function z(){I(x)||(s.value=!1)}return G((async()=>{e.value=await be()})),F([()=>k.getLastBuildMenuTime,()=>k.getMenuList],(async()=>{e.value=await be()}),{immediate:!0}),D((e=>{l.value=e,U(!0),I(h)&&z()})),{t:m,prefixCls:i,menuModules:e,handleModuleClick:B,activePath:t,childrenMenus:n,getShowDragBar:A,handleMenuClick:function(e){d(e)},getMenuStyle:L,handleClickOutside:function(){U(!0),z()},sideRef:o,dragBarRef:a,title:T,openMenu:s,getMenuTheme:f,getItemEvents:function(e){return"hover"===I(y)?{onMouseenter:()=>B(e.path,!0),onClick:async()=>{const t=await ve(e.path);!e.path||t&&0!==t.length||d(e.path)}}:{onClick:()=>B(e.path)}},getMenuEvents:R,getDomStyle:N,handleFixedMenu:function(){w({mixSideFixed:!I(x)})},getMixSideFixed:b,getWrapStyle:P,getCollapsed:M}}}),xo=["title"],Oo={class:"text"};const No=d(l({name:"SiderWrapper",components:{Sider:Io,Drawer:Ct,MixSider:d(Lo,[["render",function(t,n,s,a,o,l){const i=b("LayoutTrigger"),r=b("SimpleMenuTag"),u=b("ScrollContainer"),c=b("Icon"),d=b("SimpleMenu"),h=pt("click-outside");return m(),p(T,null,[le("div",{class:g(`${t.prefixCls}-dom`),style:X(t.getDomStyle)},null,6),ie((m(),p("div",S({style:t.getWrapStyle,class:[t.prefixCls,t.getMenuTheme,{open:t.openMenu,mini:t.getCollapsed}]},t.getMenuEvents),[e(i,{class:g(`${t.prefixCls}-trigger`)},null,8,["class"]),e(u,null,{default:w((()=>[le("ul",{class:g(`${t.prefixCls}-module`)},[(m(!0),p(T,null,k(t.menuModules,(n=>(m(),p("li",S({class:[`${t.prefixCls}-module__item `,{[`${t.prefixCls}-module__item--active`]:n.path===t.activePath}]},{ref_for:!0},t.getItemEvents(n),{key:n.path,title:t.t("routes."+n.enCode,n.fullName)}),[e(r,{item:n,collapseParent:"",dot:""},null,8,["item"]),le("span",{class:g(`${t.prefixCls}-module__icon ${n.icon}`)},null,2),le("p",{class:g(`${t.prefixCls}-module__name`)},y(t.t("routes."+n.enCode,n.fullName)),3)],16,xo)))),128))],2)])),_:1}),le("div",{class:g(`${t.prefixCls}-menu-list`),ref:"sideRef",style:X(t.getMenuStyle)},[ie(le("div",{class:g([`${t.prefixCls}-menu-list__title`,{show:t.openMenu}])},[le("span",Oo,y(t.title),1),e(c,{size:16,icon:t.getMixSideFixed?"ri:pushpin-2-fill":"ri:pushpin-2-line",class:"pushpin",onClick:t.handleFixedMenu},null,8,["icon","onClick"])],2),[[re,t.openMenu&&!1]]),e(u,{class:g(`${t.prefixCls}-menu-list__content`)},{default:w((()=>[e(d,{items:t.childrenMenus,theme:t.getMenuTheme,mixSider:"",onMenuClick:t.handleMenuClick},null,8,["items","theme","onMenuClick"])])),_:1},8,["class"]),ie(le("div",{class:g(`${t.prefixCls}-drag-bar`),ref:"dragBarRef"},null,2),[[re,t.getShowDragBar&&t.openMenu]])],6)],16)),[[h,t.handleClickOutside]])],64)}]])},setup(){const{prefixCls:e}=r("layout-sider-wrapper"),{getIsMobile:t}=ge(),{setMenuSetting:n,getCollapsed:s,getMenuWidth:a,getIsMixSidebar:o}=_();return{prefixCls:e,getIsMobile:t,getCollapsed:s,handleClose:function(){n({collapsed:!0})},getMenuWidth:a,getIsMixSidebar:o}}}),[["render",function(t,n,s,a,o,l){const i=b("Sider"),r=b("Drawer"),u=b("MixSider");return t.getIsMobile?(m(),C(r,{key:0,placement:"left",class:g(t.prefixCls),width:t.getMenuWidth,getContainer:!1,open:!t.getCollapsed,onClose:t.handleClose},{default:w((()=>[e(i)])),_:1},8,["class","width","open","onClose"])):t.getIsMixSidebar?(m(),C(u,{key:1})):(m(),C(i,{key:2}))}]]);var Eo=(e=>(e[e.REFRESH_PAGE=0]="REFRESH_PAGE",e[e.CLOSE_CURRENT=1]="CLOSE_CURRENT",e[e.CLOSE_LEFT=2]="CLOSE_LEFT",e[e.CLOSE_RIGHT=3]="CLOSE_RIGHT",e[e.CLOSE_OTHER=4]="CLOSE_OTHER",e[e.CLOSE_ALL=5]="CLOSE_ALL",e[e.SCALE=6]="SCALE",e[e.SET_COMMON=7]="SET_COMMON",e))(Eo||{});const{createMessage:Po}=Re();function Ro(e,t){const n=P({current:null,currentIndex:0}),{t:s}=c(),a=ut(),{currentRoute:o}=A(),{refreshPage:l,closeAll:i,close:r,closeLeft:d,closeOther:m,closeRight:p}=Vt(),g=u((()=>I(t)?e.tabItem:I(o)));function h(){const t=e.tabItem?.meta?.modelId||"";var n;t&&(n=t,We.post({url:"/api/system/MenuData/"+n})).then((e=>{Po.success(e.msg)}))}return{getDropMenuList:u((()=>{if(!I(g))return;const{meta:e}=I(g),{path:t}=I(o),l=n.current,i=!!l&&l.path===t,r=n.currentIndex,u=!i,c=0===r||!i,d=1===a.getTabList.length,m=!i||r===a.getTabList.length-1&&a.getLastDragEndIndex>=0;return[{icon:"ion:reload-sharp",event:Eo.REFRESH_PAGE,text:s("layout.multipleTab.reload"),disabled:u},{icon:"clarity:close-line",event:Eo.CLOSE_CURRENT,text:s("layout.multipleTab.close"),disabled:!!e?.affix||d,divider:!0},{icon:"line-md:arrow-close-left",event:Eo.CLOSE_LEFT,text:s("layout.multipleTab.closeLeft"),disabled:c,divider:!1},{icon:"line-md:arrow-close-right",event:Eo.CLOSE_RIGHT,text:s("layout.multipleTab.closeRight"),disabled:m,divider:!0},{icon:"dashicons:align-center",event:Eo.CLOSE_OTHER,text:s("layout.multipleTab.closeOther"),disabled:d||!i},{icon:"clarity:minus-line",event:Eo.CLOSE_ALL,text:s("layout.multipleTab.closeAll"),disabled:d,divider:!0},{icon:"",event:Eo.SET_COMMON,text:s("layout.multipleTab.setCommon"),disabled:!e?.modelId}]})),handleMenuEvent:function(t){const{event:n}=t;switch(n){case Eo.SET_COMMON:h();break;case Eo.REFRESH_PAGE:l();break;case Eo.CLOSE_CURRENT:r(e.tabItem);break;case Eo.CLOSE_LEFT:d();break;case Eo.CLOSE_RIGHT:p();break;case Eo.CLOSE_OTHER:m();break;case Eo.CLOSE_ALL:i()}},handleContextMenu:function(e){return t=>{if(!e)return;t?.preventDefault();const s=a.getTabList.findIndex((t=>t.path===e.path));n.current=e,n.currentIndex=s}}}}const Ao=l({name:"TabContent",components:{Dropdown:wt},props:{tabItem:{type:Object,default:null},isExtra:Boolean},setup(e){const{prefixCls:t}=r("multiple-tabs-content"),{t:n}=c(),s=u((()=>{const{tabItem:{meta:t}={}}=e;return t&&t.icon})),a=u((()=>{const{tabItem:{meta:t}={}}=e;return t&&n(t.title,t.defaultTitle)})),o=u((()=>!e.isExtra)),l=u((()=>I(o)?["contextmenu"]:["click"])),{getDropMenuList:i,handleMenuEvent:d,handleContextMenu:m}=Ro(e,o),{getShowIcon:p}=fo();return{prefixCls:t,getDropMenuList:i,handleMenuEvent:d,handleContext:function(t){e.tabItem&&m(e.tabItem)(t)},getTrigger:l,getIsTabs:o,getIcon:s,getTitle:a,getShowIcon:p}}}),Do={key:1,class:"ml-1"};const Ho=d(Ao,[["render",function(e,t,n,s,a,o){const l=b("Dropdown");return m(),C(l,{dropMenuList:e.getDropMenuList,trigger:e.getTrigger,placement:"bottom",overlayClassName:"multiple-tabs__dropdown",onMenuEvent:e.handleMenuEvent},{default:w((()=>[e.getIsTabs?(m(),p("div",{key:0,class:g(`${e.prefixCls}__info`),onContextmenu:t[0]||(t[0]=(...t)=>e.handleContext&&e.handleContext(...t))},[e.getShowIcon||"home"==e.tabItem.name?(m(),p("span",{key:0,class:g(`${e.getIcon} ${e.prefixCls}__icon`)},null,2)):h("",!0),"home"!==e.tabItem.name?(m(),p("span",Do,y(e.getTitle),1)):h("",!0)],34)):(m(),p("span",{key:1,class:g(`${e.prefixCls}__extra-quick`),onClick:t[1]||(t[1]=(...t)=>e.handleContext&&e.handleContext(...t))},t[2]||(t[2]=[le("i",{class:"icon-ym icon-ym-report-icon-arrow-down"},null,-1)]),2))])),_:1},8,["dropMenuList","trigger","onMenuEvent"])}]]),Fo=l({name:"TabRedo",components:{RedoOutlined:St},setup(){const e=E(!1),{prefixCls:t}=r("multiple-tabs-content"),{refreshPage:n}=Vt();return{prefixCls:t,handleRedo:async function(){e.value=!0,await n(),setTimeout((()=>{e.value=!1}),1200)},loading:e}}});function jo(){const e=E([]),t=ut(),n=A();let s=!1;return s||(!function(){const s=function(e){const t=[];return e&&e.forEach((e=>{e.meta&&e.meta.affix&&t.push(x(e))})),t}(n.getRoutes());e.value=s;for(const e of s)t.addTab({meta:e.meta,name:e.name,path:e.path})}(),s=!0),e.value.map((e=>e.meta?.title)).filter(Boolean)}const Bo=l({name:"MultipleTabs",components:{TabRedo:d(Fo,[["render",function(t,n,s,a,o,l){const i=b("RedoOutlined");return m(),p("span",{class:g(`${t.prefixCls}__extra-redo`),onClick:n[0]||(n[0]=(...e)=>t.handleRedo&&t.handleRedo(...e))},[e(i,{spin:t.loading},null,8,["spin"])],2)}]]),Tabs:Mt,TabPane:Mt.TabPane,TabContent:Ho},setup(){jo();const e=E(""),t=ut(),n=Oe(),s=A(),{prefixCls:a}=r("multiple-tabs"),o=Ce(),{getShowQuick:l,getShowRedo:i,getShowFold:c}=fo(),d=u((()=>t.getTabList.filter((e=>!e.meta?.hideTab)))),m=u((()=>1===I(d).length)),p=u((()=>[a,{[`${a}--hide-close`]:I(m)}]));return D((a=>{const{name:o}=a;if(o===H||!a||!n.getToken)return;const{path:l,fullPath:i,meta:r={}}=a,{currentActiveMenu:u,hideTab:c}=r,d=c?u:null,m=d||i||l;if(e.value!==m&&(e.value=m),d){const e=s.getRoutes().find((e=>e.path===u));e&&t.addTab(e)}else t.addTab(I(a))})),{getWrapClass:p,handleEdit:function(e){I(m)||t.closeTabByKey(e,s)},handleChange:function(t){e.value=t,o(t,!1)},activeKeyRef:e,getTabsState:d,getShowQuick:l,getShowRedo:i,getShowFold:c}}});const Uo=d(l({name:"LayoutMultipleHeader",components:{LayoutHeader:ho,MultipleTabs:d(Bo,[["render",function(t,n,s,a,o,l){const i=b("TabContent"),r=b("TabPane"),u=b("TabRedo"),c=b("Tabs");return m(),p("div",{class:g(t.getWrapClass)},[e(c,{type:"editable-card",size:"small",animated:!1,hideAdd:!0,tabBarGutter:0,activeKey:t.activeKeyRef,onChange:t.handleChange,onEdit:t.handleEdit},ft({default:w((()=>[(m(!0),p(T,null,k(t.getTabsState,(t=>(m(),C(r,{key:t.query?t.fullPath:t.path,closable:!(t&&t.meta&&t.meta.affix)},{tab:w((()=>[e(i,{tabItem:t},null,8,["tabItem"])])),_:2},1032,["closable"])))),128))])),_:2},[t.getShowRedo||t.getShowQuick?{name:"rightExtra",fn:w((()=>[t.getShowRedo?(m(),C(u,{key:0})):h("",!0),t.getShowQuick?(m(),C(i,{key:1,isExtra:"",tabItem:t.$route},null,8,["tabItem"])):h("",!0)])),key:"0"}:void 0]),1032,["activeKey","onChange","onEdit"])],2)}]])},setup(){const{setHeaderHeight:e}=Gt(),{prefixCls:t}=r("layout-multiple-header"),{getCalcContentWidth:n,getSplit:s}=_(),{getIsMobile:a}=ge(),{getFixed:o,getShowInsetHeaderRef:l,getShowFullHeaderRef:i,getHeaderTheme:c,getShowHeader:d}=Vn(),{getFullContent:m}=Ie(),{getShowMultipleTab:p}=fo(),g=u((()=>I(p)&&!I(m))),h=u((()=>I(o)||I(i))),f=u((()=>{const e={};return I(o)&&(e.width=I(a)?"100%":I(n)),I(i)&&(e.top="60px"),e})),y=u((()=>I(o)||I(i))),v=u((()=>{let t=0;return!I(i)&&I(s)||!I(d)||I(m)||(t+=60),I(p)&&!I(m)&&(t+=40),e(t),{height:`${t}px`}}));return{getClass:u((()=>[t,`${t}--${I(c)}`,{[`${t}--fixed`]:I(y)}])),prefixCls:t,getPlaceholderDomStyle:v,getIsFixed:y,getWrapStyle:f,getIsShowPlaceholderDom:h,getShowTabs:g,getShowInsetHeaderRef:l}}}),[["render",function(e,t,n,s,a,o){const l=b("LayoutHeader"),i=b("MultipleTabs");return m(),p(T,null,[e.getIsShowPlaceholderDom?(m(),p("div",{key:0,style:X(e.getPlaceholderDomStyle)},null,4)):h("",!0),le("div",{style:X(e.getWrapStyle),class:g(e.getClass)},[e.getShowInsetHeaderRef?(m(),C(l,{key:0})):h("",!0),e.getShowTabs?(m(),C(i,{key:1})):h("",!0)],6)],64)}],["__scopeId","data-v-b45ccef6"]]);function zo(){const{getLockTime:e}=we(),t=qt(),n=Oe(),s=Le();let a;function o(){window.clearTimeout(a)}function l(){if(!n.getToken)return void o();const e=s.getProjectConfig.lockTime;!e||e<1?o():(o(),a=setTimeout((()=>{t.setLockInfo({isLock:!0})}),60*e*1e3))}J((e=>{n.getToken?l():o(),e((()=>{o()}))})),Tt((()=>{o()}));const i=fe(l,2e3);return u((()=>I(e)?{onKeyup:i,onMousemove:i}:(o(),{})))}const Qo=d(l({name:"DefaultLayout",components:{LayoutFeatures:_t((()=>ce((()=>import("./index-8732f141.js")),["static/js/index-8732f141.js","static/js/index-920db443.js","static/css/index-648461a4.css","static/js/createAsyncComponent-7e8f72ac.js","static/js/SessionTimeoutLogin-e0c5cd95.js","static/js/Login.vue_vue_type_style_index_0_lang-c2fd63a3.js","static/js/LoginFormTitle.vue_vue_type_script_setup_true_lang-1cb7a948.js","static/js/LoginForm.vue_vue_type_script_setup_true_lang-65f6f273.js","static/js/index-143f5813.js","static/js/useWindowSizeFn-05f906e2.js","static/js/log-2a5f2c26.js","static/css/index-e7d3e030.css","static/js/QrCodeForm.vue_vue_type_script_setup_true_lang-cb8c88cc.js","static/js/ReloadOutlined-5b95234b.js","static/css/Login-008f76e4.css","static/css/SessionTimeoutLogin-4b431ddb.css","static/js/index-1cfe4e28.js","static/js/index-999abbee.js","static/js/ArrowLeftOutlined-3fbf15bc.js","static/css/index-cddfced7.css","static/js/message-22b8b6a8.js","static/js/emoji-a68b5251.js","static/js/Detail-4e2b49fe.js","static/css/Detail-fc9a8883.css","static/js/Detail.vue_vue_type_script_setup_true_lang-645a467a.js","static/js/schedule-74da51ff.js","static/js/CopyOutlined-8d46c8b2.js","static/js/index-e1b7f8ad.js","static/css/index-574b63fa.css","static/js/uniqBy-e868edd7.js","static/js/useTabs-ceeccdba.js","static/js/lock-efa36e19.js","static/css/index-1db37ef0.css"]))),LayoutHeader:ho,LayoutContent:To,LayoutSideBar:No,LayoutMultipleHeader:Uo,Layout:st},setup(){const{prefixCls:e}=r("default-layout"),{getIsMobile:t}=ge(),{getShowFullHeaderRef:n}=Vn(),{getShowSidebar:s,getIsMixSidebar:a,getShowMenu:l}=_(),{getDarkMode:i}=we(),d=Le(),m=zo(),p=u((()=>d.getProjectConfig.sysBg)),g=u((()=>{let e=["ant-layout"];return(I(a)||I(l))&&e.push("ant-layout-has-sider"),e})),h=u((()=>[e,{[`${I(p)}-bg`]:I(p)&&i.value===o.LIGHT}])),{initWebSocket:f}=vs(),y=A(),v=Oe(),{notification:b}=Re(),{t:C}=c();return G((()=>{f(),y.beforeEach((async(e,t,n)=>{const s=v.getUserInfo;1==s.prevLogin&&"/login"==t.path&&(b?.destroy(),b.open({message:C("sys.login.lastLoginInfo"),description:()=>ht("div",{class:"pt-10px"},[ht("p",null,`时间： ${kt(s.prevLoginTime)}`),ht("p",null,`地点： ${s.prevLoginIPAddressName||""}`),ht("p",null,`IP： ${s.prevLoginIPAddress||""}`)]),placement:"bottomRight",style:{width:"300px"}})),n()}))})),{getClass:h,getShowFullHeaderRef:n,getShowSidebar:s,prefixCls:e,getIsMobile:t,getIsMixSidebar:a,layoutClass:g,lockEvents:m}}}),[["render",function(t,n,s,a,o,l){const i=b("LayoutFeatures"),r=b("LayoutHeader"),u=b("LayoutSideBar"),c=b("LayoutMultipleHeader"),d=b("LayoutContent"),p=b("Layout");return m(),C(p,S({class:t.getClass},t.lockEvents),{default:w((()=>[e(i),t.getShowFullHeaderRef?(m(),C(r,{key:0,fixed:""})):h("",!0),e(p,{class:g([t.layoutClass])},{default:w((()=>[t.getShowSidebar||t.getIsMobile?(m(),C(u,{key:0})):h("",!0),e(p,{class:g(`${t.prefixCls}-main`)},{default:w((()=>[e(c),e(d)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1},16,["class"])}]]),Wo=Object.freeze(Object.defineProperty({__proto__:null,default:Qo},Symbol.toStringTag,{value:"Module"}));export{fo as a,Wo as i,Vn as u};
