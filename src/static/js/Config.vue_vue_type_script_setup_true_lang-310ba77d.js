import{b as e,B as s}from"./index-143f5813.js";import{u as a,B as t}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{g as o,c as r,s as n}from"./email-d835ba48.js";import{d as l,ad as i,e as p,o as d,p as c,l as u,j as m,k as g,dz as b,q as f,a4 as h,V as P,ah as w}from"./index-920db443.js";const L=l({__name:"Config",emits:["register"],setup(l){const L=i({testLoading:!1}),{createMessage:q}=w(),[x,{setFieldsValue:I,validate:S,resetFields:j,clearValidate:k}]=a({labelWidth:80,schemas:[{field:"pop3Host",label:"POP3服务",component:"Input",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"pop3Port",label:"POP3端口",component:"InputNumber",componentProps:{min:0,max:999999},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"smtpHost",label:"SMTP服务",component:"Input",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"smtpPort",label:"SMTP端口",component:"InputNumber",componentProps:{min:0,max:999999},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"senderName",label:"显示名称",component:"Input",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"account",label:"邮箱地址",component:"Input",componentProps:{placeholder:"请输入"},rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"password",label:"邮箱密码",component:"InputSearch",slot:"password",rules:[{required:!0,trigger:"blur",message:"必填"}]},{field:"emailSsl",label:"SSL登录",component:"Switch",defaultValue:0}]}),[O,{closeModal:_,changeLoading:v,changeOkLoading:M}]=e((function(){L.testLoading=!1,j(),v(!0),o().then((e=>{I(e.data),k(),v(!1)}))}));async function y(){const e=await S();e&&(M(!0),n(e).then((e=>{q.success(e.msg),M(!1),_()})).catch((()=>{M(!1)})))}return(e,a)=>{const o=p("a-input");return d(),c(g(s),P(e.$attrs,{onRegister:g(O),title:"邮箱配置",showOkBtn:"",onOk:y,destroyOnClose:""}),{default:u((()=>[m(g(t),{onRegister:g(x)},{password:u((({model:e,field:s})=>[m(o,{value:e[s],"onUpdate:value":a=>e[s]=a,allowClear:"",placeholder:"邮箱密码"},{addonAfter:u((()=>[L.testLoading?(d(),c(g(b),{key:0,class:"mr-5px"})):f("",!0),h("span",{class:"cursor-pointer",disabled:"",onClick:a[0]||(a[0]=e=>async function(){const e=await S();e&&(L.testLoading=!0,r(e).then((e=>{q.success(e.msg),L.testLoading=!1})).catch((()=>{L.testLoading=!1})))}())},"连接测试")])),_:2},1032,["value","onUpdate:value"])])),_:1},8,["onRegister"])])),_:1},16,["onRegister"])}}});export{L as _};
