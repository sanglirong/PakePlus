import{a as e,u as a,c as t}from"./commonFields-6e52637f.js";import{b as l,B as r}from"./index-143f5813.js";import{u as s,B as o}from"./useForm-1d28ee0b.js";import"./componentMap-c91676b4.js";import{d as i,r as n,u as m,M as d,k as u,o as c,p as g,l as p,j as f,V as h,ah as b}from"./index-920db443.js";import{f as N}from"./formValidate-c8ab8d29.js";const x=i({__name:"Form",emits:["register","reload"],setup(i,{emit:x}){const v=x,[_,{setFieldsValue:j,resetFields:q,validate:w}]=s({labelWidth:60,schemas:[{field:"field",label:"列名",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{pattern:/(^_([a-zA-Z0-9]_?)*$)|(^[a-zA-Z](_?[a-zA-Z0-9])*_?$)/,message:"请输入正确的列名",trigger:"blur"}]},{field:"fieldName",label:"编码",component:"Input",componentProps:{placeholder:"请输入",maxlength:50},rules:[{required:!0,trigger:"blur",message:"必填"},{validator:N("fullName","不能含有特殊符号"),trigger:"blur"}]},{field:"dataType",label:"类型",component:"Select",componentProps:{options:[{fullName:"字符串",id:"varchar"},{fullName:"整型",id:"int"},{fullName:"日期时间",id:"datetime"},{fullName:"浮点",id:"decimal"},{fullName:"长整型",id:"bigint"},{fullName:"文本",id:"text"}],placeholder:"请选择",showSearch:!0},rules:[{required:!0,trigger:"change",message:"必填"}]},{field:"dataLength",label:"长度",defaultValue:50,component:"InputNumber",componentProps:{min:1,max:999999},rules:[{required:!0,trigger:"blur",message:"必填",type:"number"}]},{field:"allowNull",label:"允许空",defaultValue:1,component:"Switch",rules:[{required:!0,trigger:"change",message:"必填"}]}]}),[F,{closeModal:L,changeLoading:V,changeOkLoading:M}]=l((function(a){V(!0),q(),P.value=a.id,P.value?e(P.value).then((e=>{e.data.dataLength=Number(e.data.dataLength),j(e.data),V(!1)})):V(!1)})),P=n(""),{createMessage:R}=b(),{t:T}=m(),k=d((()=>u(P)?T("common.editText"):T("common.addText")));async function y(){const e=await w();if(!e)return;M(!0);const l={...e,id:P.value};(P.value?a:t)(l).then((e=>{R.success(e.msg),M(!1),L(),setTimeout((()=>{v("reload")}),200)})).catch((()=>{M(!1)}))}return(e,a)=>(c(),g(u(r),h(e.$attrs,{onRegister:u(F),title:k.value,onOk:y}),{default:p((()=>[f(u(o),{onRegister:u(_)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{x as _};
